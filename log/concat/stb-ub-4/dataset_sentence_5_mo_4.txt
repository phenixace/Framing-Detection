Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 1.041092270299008, 'Valid Loss': 1.0050789976119996, 'Validation Metric': {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.9483372655354048, 'Valid Loss': 0.8627963638305665, 'Validation Metric': {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7645912429219798, 'Valid Loss': 0.6787016892433166, 'Validation Metric': {'Precision': 0.12121212121212122, 'Recall': 0.2857142857142857, 'F1': 0.1702127659574468, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.5846606665535977, 'Valid Loss': 0.5536560559272766, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.44415090350728287, 'Valid Loss': 0.46266968846321105, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.328210588936743, 'Valid Loss': 0.4149737286567688, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.25915796211675596, 'Valid Loss': 0.4175371840596199, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.23657230934814402, 'Valid Loss': 0.43095310896635053, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.22745735061011815, 'Valid Loss': 0.44075400739908216, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.21763172922165772, 'Valid Loss': 0.4444741517305374, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.21048633018998722, 'Valid Loss': 0.4492236429452896, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.20654236809595636, 'Valid Loss': 0.4529306425154209, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19569533029081007, 'Valid Loss': 0.4519339068233967, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18597444328234383, 'Valid Loss': 0.4558489489555359, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.18437089918083266, 'Valid Loss': 0.45542732581496237, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.171623227235518, 'Valid Loss': 0.45534055337309837, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1618226673944216, 'Valid Loss': 0.4570910458266735, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1545443692685742, 'Valid Loss': 0.4593958878517151, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.15587860100755566, 'Valid Loss': 0.4604750555753708, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.154426395746046, 'Valid Loss': 0.4609022091329098, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.14, 'Recall': 1.0, 'F1': 0.24561403508771928, 'Acc': 0.14}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.11, 'Recall': 1.0, 'F1': 0.19819819819819817, 'Acc': 0.11}; Test loss: 1.0288102436065674
