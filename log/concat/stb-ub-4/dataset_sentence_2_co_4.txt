Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6529285609722137, 'Valid Loss': 0.642478140592575, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6572800235528695, 'Valid Loss': 0.6418986749649048, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6542537090809721, 'Valid Loss': 0.6416752862930298, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6496996636453428, 'Valid Loss': 0.6408662068843841, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6468137471299422, 'Valid Loss': 0.6391909158229828, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6354191738523935, 'Valid Loss': 0.637038881778717, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6148359603003452, 'Valid Loss': 0.6356030762195587, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5945498892351201, 'Valid Loss': 0.6362750732898712, 'Validation Metric': {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.561954457901026, 'Valid Loss': 0.6413866126537323, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 0.9846153846153847, 'F1': 0.7852760736196319, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.539102072778501, 'Valid Loss': 0.6450744235515594, 'Validation Metric': {'Precision': 0.6494845360824743, 'Recall': 0.9692307692307692, 'F1': 0.7777777777777778, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.49908502792057235, 'Valid Loss': 0.6495975458621979, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.9230769230769231, 'F1': 0.7547169811320755, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4592436044231841, 'Valid Loss': 0.6525492072105408, 'Validation Metric': {'Precision': 0.6413043478260869, 'Recall': 0.9076923076923077, 'F1': 0.7515923566878981, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.43566533727081197, 'Valid Loss': 0.6671889424324036, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.8615384615384616, 'F1': 0.7320261437908497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.42326577341085986, 'Valid Loss': 0.6733302307128907, 'Validation Metric': {'Precision': 0.6395348837209303, 'Recall': 0.8461538461538461, 'F1': 0.728476821192053, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.38525184263524254, 'Valid Loss': 0.6803399753570557, 'Validation Metric': {'Precision': 0.6395348837209303, 'Recall': 0.8461538461538461, 'F1': 0.728476821192053, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.35019706228846, 'Valid Loss': 0.6846349370479584, 'Validation Metric': {'Precision': 0.6463414634146342, 'Recall': 0.8153846153846154, 'F1': 0.7210884353741497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.34697447795616954, 'Valid Loss': 0.6808256316184997, 'Validation Metric': {'Precision': 0.6463414634146342, 'Recall': 0.8153846153846154, 'F1': 0.7210884353741497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3387827249734025, 'Valid Loss': 0.6828948724269867, 'Validation Metric': {'Precision': 0.654320987654321, 'Recall': 0.8153846153846154, 'F1': 0.726027397260274, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.31947799987698855, 'Valid Loss': 0.6849649405479431, 'Validation Metric': {'Precision': 0.6585365853658537, 'Recall': 0.8307692307692308, 'F1': 0.7346938775510204, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3305005678220799, 'Valid Loss': 0.6855873072147369, 'Validation Metric': {'Precision': 0.6585365853658537, 'Recall': 0.8307692307692308, 'F1': 0.7346938775510204, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}; Test loss: 0.6375299864090406
