Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6420085430145264, 'Valid Loss': 0.6910741420892569, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6431898113928343, 'Valid Loss': 0.6917887341517669, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6477349843633803, 'Valid Loss': 0.6925380837458831, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6421489503822828, 'Valid Loss': 0.693922507075163, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6365420783036634, 'Valid Loss': 0.6944821660335248, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6294228795327639, 'Valid Loss': 0.692370266868518, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6110514316119646, 'Valid Loss': 0.6969454196783212, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5891603988252188, 'Valid Loss': 0.7011775408799832, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.55520842930204, 'Valid Loss': 0.7110849618911743, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5269030793324897, 'Valid Loss': 0.7267895077283566, 'Validation Metric': {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4863405741359058, 'Valid Loss': 0.7252596433346088, 'Validation Metric': {'Precision': 0.5957446808510638, 'Recall': 0.9032258064516129, 'F1': 0.7179487179487178, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4652370414451549, 'Valid Loss': 0.7258428621750611, 'Validation Metric': {'Precision': 0.5978260869565217, 'Recall': 0.8870967741935484, 'F1': 0.7142857142857144, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4252227058536128, 'Valid Loss': 0.738352527985206, 'Validation Metric': {'Precision': 0.6043956043956044, 'Recall': 0.8870967741935484, 'F1': 0.718954248366013, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.39920864862046745, 'Valid Loss': 0.7419287917705683, 'Validation Metric': {'Precision': 0.6086956521739131, 'Recall': 0.9032258064516129, 'F1': 0.7272727272727272, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3854437460632701, 'Valid Loss': 0.7513546863427529, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.8870967741935484, 'F1': 0.7236842105263158, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3578892867816122, 'Valid Loss': 0.7551817538646551, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.8870967741935484, 'F1': 0.7236842105263158, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.344078111609346, 'Valid Loss': 0.7576844841241837, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.8870967741935484, 'F1': 0.7236842105263158, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.32798080558055326, 'Valid Loss': 0.7584696159912989, 'Validation Metric': {'Precision': 0.6136363636363636, 'Recall': 0.8709677419354839, 'F1': 0.72, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.32326727203632655, 'Valid Loss': 0.7596953545625393, 'Validation Metric': {'Precision': 0.6136363636363636, 'Recall': 0.8709677419354839, 'F1': 0.72, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3211626708507538, 'Valid Loss': 0.7606959331494111, 'Validation Metric': {'Precision': 0.6136363636363636, 'Recall': 0.8709677419354839, 'F1': 0.72, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}; Test loss: 0.6093384516239166
