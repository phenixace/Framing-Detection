Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7350761137510601, 'Valid Loss': 0.7991628062725067, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7280003844123137, 'Valid Loss': 0.7750597023963928, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7170558469860178, 'Valid Loss': 0.7446282649040222, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7005083584471753, 'Valid Loss': 0.7210431361198425, 'Validation Metric': {'Precision': 0.422680412371134, 'Recall': 0.9534883720930233, 'F1': 0.5857142857142857, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6875376442545339, 'Valid Loss': 0.7087600445747375, 'Validation Metric': {'Precision': 0.44047619047619047, 'Recall': 0.8604651162790697, 'F1': 0.5826771653543307, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6796146576341829, 'Valid Loss': 0.7007220458984375, 'Validation Metric': {'Precision': 0.4342105263157895, 'Recall': 0.7674418604651163, 'F1': 0.5546218487394958, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6668882628804759, 'Valid Loss': 0.7012546443939209, 'Validation Metric': {'Precision': 0.4507042253521127, 'Recall': 0.7441860465116279, 'F1': 0.5614035087719298, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6408394539826795, 'Valid Loss': 0.6931834888458251, 'Validation Metric': {'Precision': 0.47692307692307695, 'Recall': 0.7209302325581395, 'F1': 0.5740740740740741, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6241326598744643, 'Valid Loss': 0.7010023617744445, 'Validation Metric': {'Precision': 0.46774193548387094, 'Recall': 0.6744186046511628, 'F1': 0.5523809523809524, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5772832381097894, 'Valid Loss': 0.6985766291618347, 'Validation Metric': {'Precision': 0.4576271186440678, 'Recall': 0.627906976744186, 'F1': 0.5294117647058824, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5450541753517953, 'Valid Loss': 0.7253404629230499, 'Validation Metric': {'Precision': 0.40350877192982454, 'Recall': 0.5348837209302325, 'F1': 0.4599999999999999, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5050569231572904, 'Valid Loss': 0.7294506776332855, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.5116279069767442, 'F1': 0.4444444444444445, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4591849371790886, 'Valid Loss': 0.7363927781581878, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.4883720930232558, 'F1': 0.42424242424242425, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4209381943862689, 'Valid Loss': 0.7431249332427978, 'Validation Metric': {'Precision': 0.36, 'Recall': 0.4186046511627907, 'F1': 0.38709677419354843, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4015689592220281, 'Valid Loss': 0.7450296139717102, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.46511627906976744, 'F1': 0.4210526315789474, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.37179048026078626, 'Valid Loss': 0.7585996174812317, 'Validation Metric': {'Precision': 0.37254901960784315, 'Recall': 0.4418604651162791, 'F1': 0.4042553191489362, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.36103984595913635, 'Valid Loss': 0.7654778301715851, 'Validation Metric': {'Precision': 0.38, 'Recall': 0.4418604651162791, 'F1': 0.40860215053763443, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3380180520838813, 'Valid Loss': 0.7689600276947022, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.46511627906976744, 'F1': 0.4301075268817204, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3422342927048081, 'Valid Loss': 0.7679416847229004, 'Validation Metric': {'Precision': 0.3877551020408163, 'Recall': 0.4418604651162791, 'F1': 0.4130434782608695, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3188685863033721, 'Valid Loss': 0.7710461139678955, 'Validation Metric': {'Precision': 0.3877551020408163, 'Recall': 0.4418604651162791, 'F1': 0.4130434782608695, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.55, 'Recall': 1.0, 'F1': 0.7096774193548387, 'Acc': 0.55}; Test loss: 0.727863438129425
