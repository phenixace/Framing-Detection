Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6479667033019819, 'Valid Loss': 0.6093384516239166, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6528750861945906, 'Valid Loss': 0.6088022243976593, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6560664227918575, 'Valid Loss': 0.6081197011470795, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6458447269703212, 'Valid Loss': 0.6083006119728088, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6428539149071041, 'Valid Loss': 0.6084443795680999, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6343046164042071, 'Valid Loss': 0.6082925844192505, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6113333941290253, 'Valid Loss': 0.6088347899913787, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5900042378588727, 'Valid Loss': 0.6226896369457244, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.8873239436619719, 'F1': 0.782608695652174, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5701194276150904, 'Valid Loss': 0.6042547738552093, 'Validation Metric': {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5339454792832073, 'Valid Loss': 0.6110676252841949, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.9577464788732394, 'F1': 0.8143712574850299, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.48611460371237053, 'Valid Loss': 0.6175862854719162, 'Validation Metric': {'Precision': 0.7032967032967034, 'Recall': 0.9014084507042254, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.44186468147917796, 'Valid Loss': 0.6276221525669098, 'Validation Metric': {'Precision': 0.6896551724137931, 'Recall': 0.8450704225352113, 'F1': 0.759493670886076, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.39884283060306, 'Valid Loss': 0.6339787095785141, 'Validation Metric': {'Precision': 0.6987951807228916, 'Recall': 0.8169014084507042, 'F1': 0.7532467532467533, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.39486123209721163, 'Valid Loss': 0.6472204583883285, 'Validation Metric': {'Precision': 0.6875, 'Recall': 0.7746478873239436, 'F1': 0.728476821192053, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3691779561340809, 'Valid Loss': 0.6531171572208404, 'Validation Metric': {'Precision': 0.6746987951807228, 'Recall': 0.7887323943661971, 'F1': 0.7272727272727272, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.35353685327266393, 'Valid Loss': 0.6573948097229004, 'Validation Metric': {'Precision': 0.6867469879518072, 'Recall': 0.8028169014084507, 'F1': 0.7402597402597403, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.31341439603190674, 'Valid Loss': 0.6661251264810563, 'Validation Metric': {'Precision': 0.6835443037974683, 'Recall': 0.7605633802816901, 'F1': 0.72, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.30219099347136524, 'Valid Loss': 0.6671575739979744, 'Validation Metric': {'Precision': 0.6829268292682927, 'Recall': 0.7887323943661971, 'F1': 0.7320261437908497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.31066942489460897, 'Valid Loss': 0.6730439949035645, 'Validation Metric': {'Precision': 0.6835443037974683, 'Recall': 0.7605633802816901, 'F1': 0.72, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.30615042287268135, 'Valid Loss': 0.6746326857805252, 'Validation Metric': {'Precision': 0.6835443037974683, 'Recall': 0.7605633802816901, 'F1': 0.72, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}; Test loss: 0.6554999923706055
