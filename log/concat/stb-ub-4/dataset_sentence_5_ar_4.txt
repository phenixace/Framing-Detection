Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7356632226391843, 'Valid Loss': 0.7265039694309234, 'Validation Metric': {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7299642974608823, 'Valid Loss': 0.7141677582263947, 'Validation Metric': {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7171956049768549, 'Valid Loss': 0.700466001033783, 'Validation Metric': {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.703276839303343, 'Valid Loss': 0.6922340512275695, 'Validation Metric': {'Precision': 0.5353535353535354, 'Recall': 0.9814814814814815, 'F1': 0.6928104575163399, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6945010800110666, 'Valid Loss': 0.6892814874649048, 'Validation Metric': {'Precision': 0.53125, 'Recall': 0.9444444444444444, 'F1': 0.6799999999999999, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6852080845519116, 'Valid Loss': 0.6892402410507202, 'Validation Metric': {'Precision': 0.550561797752809, 'Recall': 0.9074074074074074, 'F1': 0.6853146853146853, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6685760272176642, 'Valid Loss': 0.6936459922790528, 'Validation Metric': {'Precision': 0.5487804878048781, 'Recall': 0.8333333333333334, 'F1': 0.6617647058823529, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.654844258176653, 'Valid Loss': 0.6925826954841614, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.8148148148148148, 'F1': 0.6567164179104479, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6341116742083901, 'Valid Loss': 0.6975600504875183, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.6666666666666666, 'F1': 0.5901639344262295, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6149160920789367, 'Valid Loss': 0.6886983346939087, 'Validation Metric': {'Precision': 0.5441176470588235, 'Recall': 0.6851851851851852, 'F1': 0.6065573770491803, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.573658145179874, 'Valid Loss': 0.6899649405479431, 'Validation Metric': {'Precision': 0.578125, 'Recall': 0.6851851851851852, 'F1': 0.6271186440677967, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5306012363810289, 'Valid Loss': 0.6978272926807404, 'Validation Metric': {'Precision': 0.5689655172413793, 'Recall': 0.6111111111111112, 'F1': 0.5892857142857143, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.506229104180085, 'Valid Loss': 0.7031227540969849, 'Validation Metric': {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4544221300043558, 'Valid Loss': 0.7045820152759552, 'Validation Metric': {'Precision': 0.6181818181818182, 'Recall': 0.6296296296296297, 'F1': 0.6238532110091743, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4480876942214213, 'Valid Loss': 0.7129723644256591, 'Validation Metric': {'Precision': 0.5517241379310345, 'Recall': 0.5925925925925926, 'F1': 0.5714285714285714, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.40722836985399846, 'Valid Loss': 0.7142204296588898, 'Validation Metric': {'Precision': 0.5689655172413793, 'Recall': 0.6111111111111112, 'F1': 0.5892857142857143, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3995708093831414, 'Valid Loss': 0.7247246766090393, 'Validation Metric': {'Precision': 0.5666666666666667, 'Recall': 0.6296296296296297, 'F1': 0.5964912280701755, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3787164225390083, 'Valid Loss': 0.7286827588081359, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.6481481481481481, 'F1': 0.6140350877192983, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3664680115486446, 'Valid Loss': 0.7281439077854156, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.6111111111111112, 'F1': 0.5789473684210527, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3596011290424748, 'Valid Loss': 0.730067183971405, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.6296296296296297, 'F1': 0.6071428571428571, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}; Test loss: 0.7991628062725067
