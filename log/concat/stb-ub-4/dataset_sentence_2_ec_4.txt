Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.819953411033279, 'Valid Loss': 0.8026610612869263, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7920370552884904, 'Valid Loss': 0.7632830119132996, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7287364366807436, 'Valid Loss': 0.7185791444778442, 'Validation Metric': {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6960121699069676, 'Valid Loss': 0.6921597790718078, 'Validation Metric': {'Precision': 0.42, 'Recall': 0.4883720930232558, 'F1': 0.45161290322580644, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6744779309159831, 'Valid Loss': 0.6840652585029602, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.11627906976744186, 'F1': 0.18867924528301888, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6617500664372193, 'Valid Loss': 0.6813549733161927, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.046511627906976744, 'F1': 0.0851063829787234, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6556690037250519, 'Valid Loss': 0.6765758454799652, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.046511627906976744, 'F1': 0.0851063829787234, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6355320917148339, 'Valid Loss': 0.6779487943649292, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.06976744186046512, 'F1': 0.12, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6138136182960711, 'Valid Loss': 0.6785013699531555, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.16279069767441862, 'F1': 0.24561403508771928, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.577314870922189, 'Valid Loss': 0.6913862490653991, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.18604651162790697, 'F1': 0.2711864406779661, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5656976750806758, 'Valid Loss': 0.7053847312927246, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.2558139534883721, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5204253265340077, 'Valid Loss': 0.7132093906402588, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.23255813953488372, 'F1': 0.29850746268656714, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.48524409532546997, 'Valid Loss': 0.7214339399337768, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.23255813953488372, 'F1': 0.30769230769230765, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4510491292335485, 'Valid Loss': 0.739416799545288, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.2558139534883721, 'F1': 0.3188405797101449, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.43920078893241127, 'Valid Loss': 0.7407859444618226, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.23255813953488372, 'F1': 0.29411764705882354, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.41903757774516154, 'Valid Loss': 0.7621324253082276, 'Validation Metric': {'Precision': 0.3870967741935484, 'Recall': 0.27906976744186046, 'F1': 0.32432432432432434, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.39076401371704905, 'Valid Loss': 0.7605778801441193, 'Validation Metric': {'Precision': 0.48148148148148145, 'Recall': 0.3023255813953488, 'F1': 0.37142857142857144, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.37102380904712173, 'Valid Loss': 0.7665372717380524, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.2558139534883721, 'F1': 0.3098591549295775, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.36615268670414625, 'Valid Loss': 0.7713381981849671, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.27906976744186046, 'F1': 0.34285714285714286, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.35790475712795006, 'Valid Loss': 0.772514556646347, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.27906976744186046, 'F1': 0.3478260869565218, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}; Test loss: 0.8794547411111685
