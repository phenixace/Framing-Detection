Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6362836996714274, 'Valid Loss': 0.6241526844409796, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6415425741672516, 'Valid Loss': 0.6239942690500846, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6423085176944733, 'Valid Loss': 0.623711782006117, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6375017722447713, 'Valid Loss': 0.624039059648147, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6358774018287658, 'Valid Loss': 0.6251211567566946, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6212474044164021, 'Valid Loss': 0.6276048204073539, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6114696220556894, 'Valid Loss': 0.6335156926741967, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5829871718088786, 'Valid Loss': 0.645025657919737, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5518160506089529, 'Valid Loss': 0.6550890791874665, 'Validation Metric': {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5022284320990245, 'Valid Loss': 0.6545396836904379, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4665229501326879, 'Valid Loss': 0.6765624158657514, 'Validation Metric': {'Precision': 0.7078651685393258, 'Recall': 0.875, 'F1': 0.782608695652174, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4298413721720378, 'Valid Loss': 0.6751617193222046, 'Validation Metric': {'Precision': 0.7045454545454546, 'Recall': 0.8611111111111112, 'F1': 0.775, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.41211839218934376, 'Valid Loss': 0.6688874512910843, 'Validation Metric': {'Precision': 0.7159090909090909, 'Recall': 0.875, 'F1': 0.7875000000000001, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.38031764845053356, 'Valid Loss': 0.6657738869006817, 'Validation Metric': {'Precision': 0.7176470588235294, 'Recall': 0.8472222222222222, 'F1': 0.7770700636942675, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3425438559055328, 'Valid Loss': 0.671287820316278, 'Validation Metric': {'Precision': 0.7108433734939759, 'Recall': 0.8194444444444444, 'F1': 0.7612903225806451, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3307082990805308, 'Valid Loss': 0.6727695470819106, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.8333333333333334, 'F1': 0.7692307692307692, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.31006615817546845, 'Valid Loss': 0.6698732731434015, 'Validation Metric': {'Precision': 0.7176470588235294, 'Recall': 0.8472222222222222, 'F1': 0.7770700636942675, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3079735122124354, 'Valid Loss': 0.6717013453061764, 'Validation Metric': {'Precision': 0.7176470588235294, 'Recall': 0.8472222222222222, 'F1': 0.7770700636942675, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.31873138149579366, 'Valid Loss': 0.6717502698302269, 'Validation Metric': {'Precision': 0.7176470588235294, 'Recall': 0.8472222222222222, 'F1': 0.7770700636942675, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.30052183628082274, 'Valid Loss': 0.6728929321353252, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.8333333333333334, 'F1': 0.7692307692307692, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}; Test loss: 0.6910741420892569
