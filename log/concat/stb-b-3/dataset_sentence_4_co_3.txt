Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6986671910427584, 'Valid Loss': 0.7286548752051133, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7111722891873652, 'Valid Loss': 0.7261595038267282, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.03225806451612903, 'F1': 0.05797101449275363, 'Acc': 0.3564356435643564}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.711418871242221, 'Valid Loss': 0.7257753220888284, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7085800973495634, 'Valid Loss': 0.7284305600019602, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6825350298739896, 'Valid Loss': 0.7496705788832444, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.36633663366336633}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6820433685685149, 'Valid Loss': 0.75812317774846, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.37623762376237624}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03225806451612903, 'F1': 0.0588235294117647, 'Acc': 0.36633663366336633}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6691356044594604, 'Valid Loss': 0.7500078563506787, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.06451612903225806, 'F1': 0.11594202898550726, 'Acc': 0.39603960396039606}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.06451612903225806, 'F1': 0.11594202898550726, 'Acc': 0.39603960396039606}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6156359969979466, 'Valid Loss': 0.7710682795597956, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.04838709677419355, 'F1': 0.08695652173913042, 'Acc': 0.37623762376237624}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.06451612903225806, 'F1': 0.11594202898550726, 'Acc': 0.39603960396039606}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5731445958118627, 'Valid Loss': 0.7732122792647436, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.20967741935483872, 'F1': 0.29545454545454547, 'Acc': 0.38613861386138615}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.20967741935483872, 'F1': 0.29545454545454547, 'Acc': 0.38613861386138615}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5119983896170512, 'Valid Loss': 0.7864708808752207, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.16129032258064516, 'F1': 0.25, 'Acc': 0.40594059405940597}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.20967741935483872, 'F1': 0.29545454545454547, 'Acc': 0.38613861386138615}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.48001872519455335, 'Valid Loss': 0.7713266427700336, 'Validation Metric': {'Precision': 0.5777777777777777, 'Recall': 0.41935483870967744, 'F1': 0.4859813084112149, 'Acc': 0.45544554455445546}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5777777777777777, 'Recall': 0.41935483870967744, 'F1': 0.4859813084112149, 'Acc': 0.45544554455445546}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4211177237258099, 'Valid Loss': 0.7767230925651697, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.43548387096774194, 'F1': 0.4909090909090909, 'Acc': 0.44554455445544555}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5625, 'Recall': 0.43548387096774194, 'F1': 0.4909090909090909, 'Acc': 0.44554455445544555}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3938567507089955, 'Valid Loss': 0.7746377392457082, 'Validation Metric': {'Precision': 0.5689655172413793, 'Recall': 0.532258064516129, 'F1': 0.5499999999999999, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5689655172413793, 'Recall': 0.532258064516129, 'F1': 0.5499999999999999, 'Acc': 0.46534653465346537}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3467473768361724, 'Valid Loss': 0.7886492541203132, 'Validation Metric': {'Precision': 0.5818181818181818, 'Recall': 0.5161290322580645, 'F1': 0.5470085470085471, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5689655172413793, 'Recall': 0.532258064516129, 'F1': 0.5499999999999999, 'Acc': 0.46534653465346537}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.30783956313487326, 'Valid Loss': 0.7972151063955747, 'Validation Metric': {'Precision': 0.576271186440678, 'Recall': 0.5483870967741935, 'F1': 0.5619834710743801, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.576271186440678, 'Recall': 0.5483870967741935, 'F1': 0.5619834710743801, 'Acc': 0.4752475247524752}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2884481348613701, 'Valid Loss': 0.812102619272012, 'Validation Metric': {'Precision': 0.578125, 'Recall': 0.5967741935483871, 'F1': 0.5873015873015873, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.578125, 'Recall': 0.5967741935483871, 'F1': 0.5873015873015873, 'Acc': 0.48514851485148514}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2626643741484916, 'Valid Loss': 0.8205308214976237, 'Validation Metric': {'Precision': 0.5692307692307692, 'Recall': 0.5967741935483871, 'F1': 0.5826771653543306, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.578125, 'Recall': 0.5967741935483871, 'F1': 0.5873015873015873, 'Acc': 0.48514851485148514}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.25980355834016705, 'Valid Loss': 0.8262941814385928, 'Validation Metric': {'Precision': 0.5645161290322581, 'Recall': 0.5645161290322581, 'F1': 0.5645161290322581, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.578125, 'Recall': 0.5967741935483871, 'F1': 0.5873015873015873, 'Acc': 0.48514851485148514}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2498570946183535, 'Valid Loss': 0.8271234276203009, 'Validation Metric': {'Precision': 0.5692307692307692, 'Recall': 0.5967741935483871, 'F1': 0.5826771653543306, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.578125, 'Recall': 0.5967741935483871, 'F1': 0.5873015873015873, 'Acc': 0.48514851485148514}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.23571979011049365, 'Valid Loss': 0.8286045766793765, 'Validation Metric': {'Precision': 0.5757575757575758, 'Recall': 0.6129032258064516, 'F1': 0.59375, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5757575757575758, 'Recall': 0.6129032258064516, 'F1': 0.59375, 'Acc': 0.48514851485148514}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6949152542372882, 'Recall': 0.5774647887323944, 'F1': 0.6307692307692307, 'Acc': 0.52}; Test loss: 0.8091573679447174
