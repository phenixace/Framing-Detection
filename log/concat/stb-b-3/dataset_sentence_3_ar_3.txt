Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7033720040007642, 'Valid Loss': 0.6925231676835281, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.12, 'F1': 0.19672131147540983, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.12, 'F1': 0.19672131147540983, 'Acc': 0.5148514851485149}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7058561428597099, 'Valid Loss': 0.6918450502248911, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.16, 'F1': 0.24242424242424243, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.16, 'F1': 0.24242424242424243, 'Acc': 0.504950495049505}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7010706898413206, 'Valid Loss': 0.6920427061044253, 'Validation Metric': {'Precision': 0.4782608695652174, 'Recall': 0.22, 'F1': 0.30136986301369867, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4782608695652174, 'Recall': 0.22, 'F1': 0.30136986301369867, 'Acc': 0.49504950495049505}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7048832836904024, 'Valid Loss': 0.6922270861955789, 'Validation Metric': {'Precision': 0.4482758620689655, 'Recall': 0.26, 'F1': 0.3291139240506329, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4482758620689655, 'Recall': 0.26, 'F1': 0.3291139240506329, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.696411918652685, 'Valid Loss': 0.69380145577284, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.32, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.684358476023925, 'Valid Loss': 0.6918148077451266, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.22, 'F1': 0.29729729729729726, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.32, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6784814337366506, 'Valid Loss': 0.6949006777543288, 'Validation Metric': {'Precision': 0.4411764705882353, 'Recall': 0.3, 'F1': 0.35714285714285715, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.32, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6479130136339288, 'Valid Loss': 0.6947751320325412, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.32, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6312767918172636, 'Valid Loss': 0.6982506926243122, 'Validation Metric': {'Precision': 0.4857142857142857, 'Recall': 0.34, 'F1': 0.4, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4857142857142857, 'Recall': 0.34, 'F1': 0.4, 'Acc': 0.49504950495049505}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6098242009940901, 'Valid Loss': 0.6981775416777685, 'Validation Metric': {'Precision': 0.5357142857142857, 'Recall': 0.3, 'F1': 0.38461538461538464, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.4857142857142857, 'Recall': 0.34, 'F1': 0.4, 'Acc': 0.49504950495049505}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5887828602602607, 'Valid Loss': 0.7069703180056351, 'Validation Metric': {'Precision': 0.4888888888888889, 'Recall': 0.44, 'F1': 0.4631578947368421, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.44, 'F1': 0.4631578947368421, 'Acc': 0.49504950495049505}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5553760230541229, 'Valid Loss': 0.7104010341259149, 'Validation Metric': {'Precision': 0.5111111111111111, 'Recall': 0.46, 'F1': 0.4842105263157895, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.46, 'F1': 0.4842105263157895, 'Acc': 0.5148514851485149}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5266092674512612, 'Valid Loss': 0.7158854546455237, 'Validation Metric': {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5084122576211628, 'Valid Loss': 0.7206172690941737, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.44, 'F1': 0.48888888888888893, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4821369671507886, 'Valid Loss': 0.7301110613804597, 'Validation Metric': {'Precision': 0.46296296296296297, 'Recall': 0.5, 'F1': 0.4807692307692307, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.46073211455031443, 'Valid Loss': 0.7376294422608155, 'Validation Metric': {'Precision': 0.4897959183673469, 'Recall': 0.48, 'F1': 0.48484848484848486, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.44416052573605586, 'Valid Loss': 0.7374556167767599, 'Validation Metric': {'Precision': 0.5106382978723404, 'Recall': 0.48, 'F1': 0.49484536082474223, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4341132531040593, 'Valid Loss': 0.7435043866817768, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5, 'F1': 0.5, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4332958024583365, 'Valid Loss': 0.7459237094108875, 'Validation Metric': {'Precision': 0.49019607843137253, 'Recall': 0.5, 'F1': 0.495049504950495, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4170393449695487, 'Valid Loss': 0.7448104528280405, 'Validation Metric': {'Precision': 0.5102040816326531, 'Recall': 0.5, 'F1': 0.5050505050505051, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.48, 'F1': 0.505263157894737, 'Acc': 0.5346534653465347}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5531914893617021, 'Recall': 0.49056603773584906, 'F1': 0.52, 'Acc': 0.5247524752475248}; Test loss: 0.7109966518787237
