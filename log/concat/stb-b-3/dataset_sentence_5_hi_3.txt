Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7013094323022026, 'Valid Loss': 0.6708700037002564, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.14705882352941177, 'F1': 0.22222222222222224, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.14705882352941177, 'F1': 0.22222222222222224, 'Acc': 0.65}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7047788937886555, 'Valid Loss': 0.6761598253250122, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.20588235294117646, 'F1': 0.2745098039215686, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4117647058823529, 'Recall': 0.20588235294117646, 'F1': 0.2745098039215686, 'Acc': 0.63}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7018399777866545, 'Valid Loss': 0.6875584292411804, 'Validation Metric': {'Precision': 0.3103448275862069, 'Recall': 0.2647058823529412, 'F1': 0.28571428571428575, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3103448275862069, 'Recall': 0.2647058823529412, 'F1': 0.28571428571428575, 'Acc': 0.55}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6965870312282018, 'Valid Loss': 0.7009351277351379, 'Validation Metric': {'Precision': 0.3018867924528302, 'Recall': 0.47058823529411764, 'F1': 0.367816091954023, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3018867924528302, 'Recall': 0.47058823529411764, 'F1': 0.367816091954023, 'Acc': 0.45}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.67844363791602, 'Valid Loss': 0.7148045969009399, 'Validation Metric': {'Precision': 0.3088235294117647, 'Recall': 0.6176470588235294, 'F1': 0.4117647058823529, 'Acc': 0.4}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3088235294117647, 'Recall': 0.6176470588235294, 'F1': 0.4117647058823529, 'Acc': 0.4}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.657738747483208, 'Valid Loss': 0.7301861071586608, 'Validation Metric': {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6209735941319239, 'Valid Loss': 0.7243657493591309, 'Validation Metric': {'Precision': 0.32075471698113206, 'Recall': 0.5, 'F1': 0.39080459770114945, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5785921156406403, 'Valid Loss': 0.736306037902832, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.5, 'F1': 0.4, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5426161016736711, 'Valid Loss': 0.7374321722984314, 'Validation Metric': {'Precision': 0.28205128205128205, 'Recall': 0.3235294117647059, 'F1': 0.3013698630136986, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.477375358626956, 'Valid Loss': 0.7327311372756958, 'Validation Metric': {'Precision': 0.2702702702702703, 'Recall': 0.29411764705882354, 'F1': 0.28169014084507044, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.44347120381536936, 'Valid Loss': 0.7277500534057617, 'Validation Metric': {'Precision': 0.2903225806451613, 'Recall': 0.2647058823529412, 'F1': 0.27692307692307694, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3897048620950608, 'Valid Loss': 0.7367674314975738, 'Validation Metric': {'Precision': 0.1935483870967742, 'Recall': 0.17647058823529413, 'F1': 0.18461538461538463, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.35865099046911514, 'Valid Loss': 0.7293430435657501, 'Validation Metric': {'Precision': 0.19047619047619047, 'Recall': 0.11764705882352941, 'F1': 0.14545454545454542, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3155893734523228, 'Valid Loss': 0.7376641094684601, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.11764705882352941, 'F1': 0.14814814814814817, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2876458019018173, 'Valid Loss': 0.744695633649826, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.08823529411764706, 'F1': 0.11538461538461539, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.26238320264078324, 'Valid Loss': 0.7597410929203033, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.11764705882352941, 'F1': 0.14814814814814817, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.24761132583731696, 'Valid Loss': 0.7538849198818207, 'Validation Metric': {'Precision': 0.08333333333333333, 'Recall': 0.029411764705882353, 'F1': 0.04347826086956522, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.23418512720437276, 'Valid Loss': 0.7619475734233856, 'Validation Metric': {'Precision': 0.07142857142857142, 'Recall': 0.029411764705882353, 'F1': 0.041666666666666664, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2176282720906394, 'Valid Loss': 0.7640712487697602, 'Validation Metric': {'Precision': 0.07692307692307693, 'Recall': 0.029411764705882353, 'F1': 0.0425531914893617, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2154853962007023, 'Valid Loss': 0.7694558334350586, 'Validation Metric': {'Precision': 0.1875, 'Recall': 0.08823529411764706, 'F1': 0.12, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32857142857142857, 'Recall': 0.6764705882352942, 'F1': 0.44230769230769235, 'Acc': 0.42}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.24242424242424243, 'Recall': 0.5714285714285714, 'F1': 0.3404255319148936, 'Acc': 0.38}; Test loss: 0.7249762034416198
