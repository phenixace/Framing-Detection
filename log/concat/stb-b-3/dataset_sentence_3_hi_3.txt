Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6971686025267666, 'Valid Loss': 0.6690844228634467, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.07142857142857142, 'F1': 0.10526315789473682, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.07142857142857142, 'F1': 0.10526315789473682, 'Acc': 0.6633663366336634}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7003081400417587, 'Valid Loss': 0.6781342717317435, 'Validation Metric': {'Precision': 0.21428571428571427, 'Recall': 0.10714285714285714, 'F1': 0.14285714285714285, 'Acc': 0.6435643564356436}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.21428571428571427, 'Recall': 0.10714285714285714, 'F1': 0.14285714285714285, 'Acc': 0.6435643564356436}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.696172071892081, 'Valid Loss': 0.6898750639878787, 'Validation Metric': {'Precision': 0.18518518518518517, 'Recall': 0.17857142857142858, 'F1': 0.18181818181818182, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.18518518518518517, 'Recall': 0.17857142857142858, 'F1': 0.18181818181818182, 'Acc': 0.5544554455445545}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6913359824893544, 'Valid Loss': 0.7003423365262839, 'Validation Metric': {'Precision': 0.1794871794871795, 'Recall': 0.25, 'F1': 0.208955223880597, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1794871794871795, 'Recall': 0.25, 'F1': 0.208955223880597, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.679207354494669, 'Valid Loss': 0.7246661575940939, 'Validation Metric': {'Precision': 0.2033898305084746, 'Recall': 0.42857142857142855, 'F1': 0.2758620689655173, 'Acc': 0.37623762376237624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2033898305084746, 'Recall': 0.42857142857142855, 'F1': 0.2758620689655173, 'Acc': 0.37623762376237624}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6590639433814484, 'Valid Loss': 0.737500942670382, 'Validation Metric': {'Precision': 0.203125, 'Recall': 0.4642857142857143, 'F1': 0.2826086956521739, 'Acc': 0.3465346534653465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.203125, 'Recall': 0.4642857142857143, 'F1': 0.2826086956521739, 'Acc': 0.3465346534653465}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6319580442697099, 'Valid Loss': 0.7436385063024668, 'Validation Metric': {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5768925078864237, 'Valid Loss': 0.7455461712983938, 'Validation Metric': {'Precision': 0.22448979591836735, 'Recall': 0.39285714285714285, 'F1': 0.2857142857142857, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5221843247853436, 'Valid Loss': 0.7884314564558176, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.39285714285714285, 'F1': 0.26506024096385544, 'Acc': 0.39603960396039606}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4764770184037755, 'Valid Loss': 0.8288772908540872, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.39285714285714285, 'F1': 0.26506024096385544, 'Acc': 0.39603960396039606}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.42598028698013823, 'Valid Loss': 0.770262197806285, 'Validation Metric': {'Precision': 0.1875, 'Recall': 0.21428571428571427, 'F1': 0.19999999999999998, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.36250562821198434, 'Valid Loss': 0.799202405489408, 'Validation Metric': {'Precision': 0.20588235294117646, 'Recall': 0.25, 'F1': 0.22580645161290322, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3265370982653886, 'Valid Loss': 0.7207293109251902, 'Validation Metric': {'Precision': 0.2631578947368421, 'Recall': 0.17857142857142858, 'F1': 0.2127659574468085, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2852524584068835, 'Valid Loss': 0.7334214196755335, 'Validation Metric': {'Precision': 0.2777777777777778, 'Recall': 0.17857142857142858, 'F1': 0.21739130434782608, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2625096344832078, 'Valid Loss': 0.685997445995991, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.14285714285714285, 'F1': 0.19047619047619047, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.23683282841467163, 'Valid Loss': 0.726183452285253, 'Validation Metric': {'Precision': 0.29411764705882354, 'Recall': 0.17857142857142858, 'F1': 0.22222222222222224, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.21087800718626928, 'Valid Loss': 0.6991085547667283, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.14285714285714285, 'F1': 0.19047619047619047, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.20429874920439953, 'Valid Loss': 0.7090739688047996, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.14285714285714285, 'F1': 0.19047619047619047, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.19634713753334526, 'Valid Loss': 0.7100658714771271, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.14285714285714285, 'F1': 0.19047619047619047, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1958109566453591, 'Valid Loss': 0.7233240249065253, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.14285714285714285, 'F1': 0.19047619047619047, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.2222222222222222, 'Recall': 0.5, 'F1': 0.30769230769230765, 'Acc': 0.37623762376237624}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3389830508474576, 'Recall': 0.625, 'F1': 0.43956043956043955, 'Acc': 0.49504950495049505}; Test loss: 0.7148996339394496
