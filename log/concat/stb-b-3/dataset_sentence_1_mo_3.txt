Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7061057326604994, 'Valid Loss': 0.6237975430488586, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7057556068296913, 'Valid Loss': 0.6521270680427551, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 0.18181818181818182, 'F1': 0.13793103448275862, 'Acc': 0.75}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1111111111111111, 'Recall': 0.18181818181818182, 'F1': 0.13793103448275862, 'Acc': 0.75}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6900671941342114, 'Valid Loss': 0.7109360408782959, 'Validation Metric': {'Precision': 0.125, 'Recall': 0.6363636363636364, 'F1': 0.208955223880597, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.6363636363636364, 'F1': 0.208955223880597, 'Acc': 0.47}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.650013312590208, 'Valid Loss': 0.8258601808547974, 'Validation Metric': {'Precision': 0.10227272727272728, 'Recall': 0.8181818181818182, 'F1': 0.18181818181818182, 'Acc': 0.19}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.6363636363636364, 'F1': 0.208955223880597, 'Acc': 0.47}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.5913054310589385, 'Valid Loss': 0.9118773698806762, 'Validation Metric': {'Precision': 0.10989010989010989, 'Recall': 0.9090909090909091, 'F1': 0.19607843137254902, 'Acc': 0.18}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.6363636363636364, 'F1': 0.208955223880597, 'Acc': 0.47}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.47930446165285523, 'Valid Loss': 0.9453500580787658, 'Validation Metric': {'Precision': 0.11627906976744186, 'Recall': 0.9090909090909091, 'F1': 0.20618556701030924, 'Acc': 0.23}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.6363636363636364, 'F1': 0.208955223880597, 'Acc': 0.47}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.3586834845997447, 'Valid Loss': 0.7624462413787841, 'Validation Metric': {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2511217576994313, 'Valid Loss': 0.563293000459671, 'Validation Metric': {'Precision': 0.19047619047619047, 'Recall': 0.36363636363636365, 'F1': 0.25, 'Acc': 0.76}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.17255405559063816, 'Valid Loss': 0.4607422387599945, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.18181818181818182, 'F1': 0.17391304347826086, 'Acc': 0.81}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.1289742679583083, 'Valid Loss': 0.39394155621528626, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.85}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.09611838905931376, 'Valid Loss': 0.37227287083864213, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.87}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.07743194275837151, 'Valid Loss': 0.37137155354022977, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.87}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.06502386037823107, 'Valid Loss': 0.3759008586406708, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.055168589456475896, 'Valid Loss': 0.37990210711956024, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.04950448067979418, 'Valid Loss': 0.3870504625141621, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.047228328870247596, 'Valid Loss': 0.3899042421579361, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.03969093710988117, 'Valid Loss': 0.3942824201285839, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.03777433138528316, 'Valid Loss': 0.3986855058372021, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.03531915541711471, 'Valid Loss': 0.40145098105072974, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.03442140243840303, 'Valid Loss': 0.4023634675145149, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.1509433962264151, 'Recall': 0.7272727272727273, 'F1': 0.25, 'Acc': 0.52}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.09375, 'Recall': 0.3333333333333333, 'F1': 0.14634146341463417, 'Acc': 0.65}; Test loss: 0.6705423414707183
