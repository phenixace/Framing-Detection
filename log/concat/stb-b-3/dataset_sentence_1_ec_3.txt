Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6989846370193395, 'Valid Loss': 0.6650330662727356, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6963143998317505, 'Valid Loss': 0.6686573529243469, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.17142857142857143, 'F1': 0.23529411764705876, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.375, 'Recall': 0.17142857142857143, 'F1': 0.23529411764705876, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6904687405971999, 'Valid Loss': 0.6730763101577759, 'Validation Metric': {'Precision': 0.36, 'Recall': 0.2571428571428571, 'F1': 0.3, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.2571428571428571, 'F1': 0.3, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6909574939963523, 'Valid Loss': 0.6736948370933533, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6766397832484727, 'Valid Loss': 0.6738377022743225, 'Validation Metric': {'Precision': 0.36, 'Recall': 0.2571428571428571, 'F1': 0.3, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6691138483165355, 'Valid Loss': 0.6746153259277343, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.17142857142857143, 'F1': 0.21818181818181817, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6384097873494866, 'Valid Loss': 0.678783164024353, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.17142857142857143, 'F1': 0.21428571428571427, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.599620633915569, 'Valid Loss': 0.6863434505462647, 'Validation Metric': {'Precision': 0.22727272727272727, 'Recall': 0.14285714285714285, 'F1': 0.17543859649122806, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5568781270739738, 'Valid Loss': 0.6965639555454254, 'Validation Metric': {'Precision': 0.2916666666666667, 'Recall': 0.2, 'F1': 0.23728813559322035, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5146304271864087, 'Valid Loss': 0.6991797971725464, 'Validation Metric': {'Precision': 0.2916666666666667, 'Recall': 0.2, 'F1': 0.23728813559322035, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4708225974875889, 'Valid Loss': 0.7032674694061279, 'Validation Metric': {'Precision': 0.25925925925925924, 'Recall': 0.2, 'F1': 0.22580645161290322, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.43051404665025433, 'Valid Loss': 0.7166310095787048, 'Validation Metric': {'Precision': 0.27586206896551724, 'Recall': 0.22857142857142856, 'F1': 0.25, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3885542591301243, 'Valid Loss': 0.7215112292766571, 'Validation Metric': {'Precision': 0.25806451612903225, 'Recall': 0.22857142857142856, 'F1': 0.24242424242424246, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3754504487085878, 'Valid Loss': 0.7253116226196289, 'Validation Metric': {'Precision': 0.2692307692307692, 'Recall': 0.2, 'F1': 0.22950819672131148, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.34234515167354196, 'Valid Loss': 0.734267817735672, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.2, 'F1': 0.22222222222222224, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3288037283032128, 'Valid Loss': 0.7457630944252014, 'Validation Metric': {'Precision': 0.25806451612903225, 'Recall': 0.22857142857142856, 'F1': 0.24242424242424246, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2993471640047063, 'Valid Loss': 0.7484708917140961, 'Validation Metric': {'Precision': 0.26666666666666666, 'Recall': 0.22857142857142856, 'F1': 0.24615384615384614, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.27850042953250115, 'Valid Loss': 0.7523574101924896, 'Validation Metric': {'Precision': 0.25806451612903225, 'Recall': 0.22857142857142856, 'F1': 0.24242424242424246, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2800183484560988, 'Valid Loss': 0.7575507593154908, 'Validation Metric': {'Precision': 0.25806451612903225, 'Recall': 0.22857142857142856, 'F1': 0.24242424242424246, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.26755324399538255, 'Valid Loss': 0.7603241026401519, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.22857142857142856, 'F1': 0.23880597014925375, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.2857142857142857, 'F1': 0.32786885245901637, 'Acc': 0.59}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.55, 'Recall': 0.2558139534883721, 'F1': 0.34920634920634924, 'Acc': 0.59}; Test loss: 0.677401659488678
