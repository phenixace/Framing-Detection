Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7023474163222081, 'Valid Loss': 0.7274529075622559, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7162751295034168, 'Valid Loss': 0.7246942019462586, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.046875, 'F1': 0.08571428571428572, 'Acc': 0.36}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7162711776575996, 'Valid Loss': 0.7245595741271973, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7112083614451213, 'Valid Loss': 0.7279573702812194, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.03125, 'F1': 0.05970149253731343, 'Acc': 0.37}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7032588268946676, 'Valid Loss': 0.7343127799034118, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.36}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6978055938933659, 'Valid Loss': 0.7385604739189148, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.36}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.678025984648362, 'Valid Loss': 0.7327384114265442, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.33}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6578692174652248, 'Valid Loss': 0.7299522495269776, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.046875, 'F1': 0.08219178082191782, 'Acc': 0.33}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6183455314451051, 'Valid Loss': 0.7308010864257812, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.125, 'F1': 0.19753086419753085, 'Acc': 0.35}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47058823529411764, 'Recall': 0.125, 'F1': 0.19753086419753085, 'Acc': 0.35}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5761694604332007, 'Valid Loss': 0.7320846343040466, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.234375, 'F1': 0.3409090909090909, 'Acc': 0.42}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.234375, 'F1': 0.3409090909090909, 'Acc': 0.42}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5311284646825883, 'Valid Loss': 0.7276413273811341, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.375, 'F1': 0.4800000000000001, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.375, 'F1': 0.4800000000000001, 'Acc': 0.48}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4742405232295249, 'Valid Loss': 0.7057128262519836, 'Validation Metric': {'Precision': 0.660377358490566, 'Recall': 0.546875, 'F1': 0.5982905982905983, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.660377358490566, 'Recall': 0.546875, 'F1': 0.5982905982905983, 'Acc': 0.53}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4307360458142549, 'Valid Loss': 0.7217015838623047, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 0.5, 'F1': 0.5663716814159292, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.660377358490566, 'Recall': 0.546875, 'F1': 0.5982905982905983, 'Acc': 0.53}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.38771441694602227, 'Valid Loss': 0.709875283241272, 'Validation Metric': {'Precision': 0.6779661016949152, 'Recall': 0.625, 'F1': 0.6504065040650406, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6779661016949152, 'Recall': 0.625, 'F1': 0.6504065040650406, 'Acc': 0.57}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.35972882546846147, 'Valid Loss': 0.7110799729824067, 'Validation Metric': {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3353898448562159, 'Valid Loss': 0.7094698441028595, 'Validation Metric': {'Precision': 0.6811594202898551, 'Recall': 0.734375, 'F1': 0.7067669172932332, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3078776773029161, 'Valid Loss': 0.707901200056076, 'Validation Metric': {'Precision': 0.6714285714285714, 'Recall': 0.734375, 'F1': 0.7014925373134329, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3017536313499062, 'Valid Loss': 0.7106290817260742, 'Validation Metric': {'Precision': 0.676056338028169, 'Recall': 0.75, 'F1': 0.7111111111111111, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2757577770253987, 'Valid Loss': 0.7092862582206726, 'Validation Metric': {'Precision': 0.6714285714285714, 'Recall': 0.734375, 'F1': 0.7014925373134329, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2757924319181627, 'Valid Loss': 0.7103484249114991, 'Validation Metric': {'Precision': 0.676056338028169, 'Recall': 0.75, 'F1': 0.7111111111111111, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7076923076923077, 'Recall': 0.71875, 'F1': 0.7131782945736435, 'Acc': 0.63}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6333333333333333, 'Recall': 0.5846153846153846, 'F1': 0.608, 'Acc': 0.51}; Test loss: 0.6659434819221497
