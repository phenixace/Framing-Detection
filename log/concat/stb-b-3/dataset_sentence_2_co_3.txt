Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7062149017748206, 'Valid Loss': 0.7235549569129944, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.1076923076923077, 'F1': 0.18918918918918923, 'Acc': 0.4}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 0.1076923076923077, 'F1': 0.18918918918918923, 'Acc': 0.4}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7112749074444626, 'Valid Loss': 0.7165890288352966, 'Validation Metric': {'Precision': 0.7333333333333333, 'Recall': 0.16923076923076924, 'F1': 0.275, 'Acc': 0.42}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7333333333333333, 'Recall': 0.16923076923076924, 'F1': 0.275, 'Acc': 0.42}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.712166408697764, 'Valid Loss': 0.7186001777648926, 'Validation Metric': {'Precision': 0.8333333333333334, 'Recall': 0.15384615384615385, 'F1': 0.25974025974025977, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.7333333333333333, 'Recall': 0.16923076923076924, 'F1': 0.275, 'Acc': 0.42}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7119410224635192, 'Valid Loss': 0.7178962302207946, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.1076923076923077, 'F1': 0.18918918918918923, 'Acc': 0.4}}
Best validation metric so far: {'Precision': 0.7333333333333333, 'Recall': 0.16923076923076924, 'F1': 0.275, 'Acc': 0.42}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7025235448822831, 'Valid Loss': 0.7183687281608582, 'Validation Metric': {'Precision': 0.9, 'Recall': 0.13846153846153847, 'F1': 0.24, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.7333333333333333, 'Recall': 0.16923076923076924, 'F1': 0.275, 'Acc': 0.42}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6897930611263622, 'Valid Loss': 0.7315392518043518, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03076923076923077, 'F1': 0.059701492537313446, 'Acc': 0.37}}
Best validation metric so far: {'Precision': 0.7333333333333333, 'Recall': 0.16923076923076924, 'F1': 0.275, 'Acc': 0.42}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6740706629223294, 'Valid Loss': 0.7238476419448853, 'Validation Metric': {'Precision': 0.9166666666666666, 'Recall': 0.16923076923076924, 'F1': 0.28571428571428575, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.9166666666666666, 'Recall': 0.16923076923076924, 'F1': 0.28571428571428575, 'Acc': 0.45}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6468143646765236, 'Valid Loss': 0.7203171133995057, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.2153846153846154, 'F1': 0.3373493975903615, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 0.2153846153846154, 'F1': 0.3373493975903615, 'Acc': 0.45}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6176861994194262, 'Valid Loss': 0.6987545847892761, 'Validation Metric': {'Precision': 0.7692307692307693, 'Recall': 0.3076923076923077, 'F1': 0.4395604395604395, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7692307692307693, 'Recall': 0.3076923076923077, 'F1': 0.4395604395604395, 'Acc': 0.49}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5580454890174095, 'Valid Loss': 0.6965148496627808, 'Validation Metric': {'Precision': 0.8076923076923077, 'Recall': 0.3230769230769231, 'F1': 0.4615384615384616, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8076923076923077, 'Recall': 0.3230769230769231, 'F1': 0.4615384615384616, 'Acc': 0.51}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5104942893741107, 'Valid Loss': 0.7162172198295593, 'Validation Metric': {'Precision': 0.7894736842105263, 'Recall': 0.23076923076923078, 'F1': 0.35714285714285715, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.8076923076923077, 'Recall': 0.3230769230769231, 'F1': 0.4615384615384616, 'Acc': 0.51}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4790522377900403, 'Valid Loss': 0.6779169964790345, 'Validation Metric': {'Precision': 0.7560975609756098, 'Recall': 0.47692307692307695, 'F1': 0.5849056603773585, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7560975609756098, 'Recall': 0.47692307692307695, 'F1': 0.5849056603773585, 'Acc': 0.56}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.42387725367690576, 'Valid Loss': 0.6727611470222473, 'Validation Metric': {'Precision': 0.7441860465116279, 'Recall': 0.49230769230769234, 'F1': 0.5925925925925926, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7441860465116279, 'Recall': 0.49230769230769234, 'F1': 0.5925925925925926, 'Acc': 0.56}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3944197515345583, 'Valid Loss': 0.6633555150032043, 'Validation Metric': {'Precision': 0.6981132075471698, 'Recall': 0.5692307692307692, 'F1': 0.6271186440677967, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6981132075471698, 'Recall': 0.5692307692307692, 'F1': 0.6271186440677967, 'Acc': 0.56}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3770656239504766, 'Valid Loss': 0.6603030645847321, 'Validation Metric': {'Precision': 0.6491228070175439, 'Recall': 0.5692307692307692, 'F1': 0.6065573770491803, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6981132075471698, 'Recall': 0.5692307692307692, 'F1': 0.6271186440677967, 'Acc': 0.56}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.342270431494472, 'Valid Loss': 0.6547742784023285, 'Validation Metric': {'Precision': 0.6721311475409836, 'Recall': 0.6307692307692307, 'F1': 0.6507936507936507, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6721311475409836, 'Recall': 0.6307692307692307, 'F1': 0.6507936507936507, 'Acc': 0.56}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3132630880131866, 'Valid Loss': 0.6536400210857392, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.6461538461538462, 'F1': 0.65625, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.6461538461538462, 'F1': 0.65625, 'Acc': 0.56}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3070993566452855, 'Valid Loss': 0.6517112350463867, 'Validation Metric': {'Precision': 0.6567164179104478, 'Recall': 0.676923076923077, 'F1': 0.6666666666666667, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6567164179104478, 'Recall': 0.676923076923077, 'F1': 0.6666666666666667, 'Acc': 0.56}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.29070546922057566, 'Valid Loss': 0.6545696520805359, 'Validation Metric': {'Precision': 0.6571428571428571, 'Recall': 0.7076923076923077, 'F1': 0.6814814814814816, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.7076923076923077, 'F1': 0.6814814814814816, 'Acc': 0.57}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.28643100640990515, 'Valid Loss': 0.6553005146980285, 'Validation Metric': {'Precision': 0.6527777777777778, 'Recall': 0.7230769230769231, 'F1': 0.6861313868613138, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6527777777777778, 'Recall': 0.7230769230769231, 'F1': 0.6861313868613138, 'Acc': 0.57}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7083333333333334, 'Recall': 0.7083333333333334, 'F1': 0.7083333333333334, 'Acc': 0.5841584158415841}; Test loss: 0.747035964177205
