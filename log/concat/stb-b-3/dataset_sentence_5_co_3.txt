Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7008410584926605, 'Valid Loss': 0.7530117917060852, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.04225352112676056, 'F1': 0.08, 'Acc': 0.31}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.04225352112676056, 'F1': 0.08, 'Acc': 0.31}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7103549021482468, 'Valid Loss': 0.7456680703163147, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.056338028169014086, 'F1': 0.10256410256410255, 'Acc': 0.3}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.056338028169014086, 'F1': 0.10256410256410255, 'Acc': 0.3}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7100226092338562, 'Valid Loss': 0.7442347645759583, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.70896404504776, 'Valid Loss': 0.7455210542678833, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6995011061429978, 'Valid Loss': 0.7570909833908082, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.028169014084507043, 'F1': 0.054054054054054064, 'Acc': 0.3}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6952323585748672, 'Valid Loss': 0.756323311328888, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.028169014084507043, 'F1': 0.05263157894736842, 'Acc': 0.28}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6720429298281669, 'Valid Loss': 0.7590296626091003, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.04225352112676056, 'F1': 0.07692307692307691, 'Acc': 0.28}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.056338028169014086, 'F1': 0.1038961038961039, 'Acc': 0.31}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6435194444656372, 'Valid Loss': 0.7508438372612, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.16901408450704225, 'F1': 0.2608695652173913, 'Acc': 0.32}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.16901408450704225, 'F1': 0.2608695652173913, 'Acc': 0.32}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5913803571462631, 'Valid Loss': 0.7714563870429992, 'Validation Metric': {'Precision': 0.6190476190476191, 'Recall': 0.18309859154929578, 'F1': 0.2826086956521739, 'Acc': 0.34}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6190476190476191, 'Recall': 0.18309859154929578, 'F1': 0.2826086956521739, 'Acc': 0.34}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5670776623487472, 'Valid Loss': 0.7602962136268616, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.28169014084507044, 'F1': 0.3883495145631068, 'Acc': 0.37}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.28169014084507044, 'F1': 0.3883495145631068, 'Acc': 0.37}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.52314447671175, 'Valid Loss': 0.7405896258354187, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.43661971830985913, 'F1': 0.5254237288135594, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.43661971830985913, 'F1': 0.5254237288135594, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4596612846851349, 'Valid Loss': 0.741219880580902, 'Validation Metric': {'Precision': 0.673469387755102, 'Recall': 0.4647887323943662, 'F1': 0.55, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.673469387755102, 'Recall': 0.4647887323943662, 'F1': 0.55, 'Acc': 0.46}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.42654335290193557, 'Valid Loss': 0.7291947710514068, 'Validation Metric': {'Precision': 0.6727272727272727, 'Recall': 0.5211267605633803, 'F1': 0.5873015873015874, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6727272727272727, 'Recall': 0.5211267605633803, 'F1': 0.5873015873015874, 'Acc': 0.48}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3855562628805637, 'Valid Loss': 0.7395954120159149, 'Validation Metric': {'Precision': 0.6909090909090909, 'Recall': 0.5352112676056338, 'F1': 0.6031746031746031, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6909090909090909, 'Recall': 0.5352112676056338, 'F1': 0.6031746031746031, 'Acc': 0.5}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3590122327208519, 'Valid Loss': 0.7350410354137421, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5633802816901409, 'F1': 0.6106870229007634, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.5633802816901409, 'F1': 0.6106870229007634, 'Acc': 0.49}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3311186774075031, 'Valid Loss': 0.7265832614898682, 'Validation Metric': {'Precision': 0.6911764705882353, 'Recall': 0.6619718309859155, 'F1': 0.6762589928057554, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6911764705882353, 'Recall': 0.6619718309859155, 'F1': 0.6762589928057554, 'Acc': 0.55}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3203397598862648, 'Valid Loss': 0.727952299118042, 'Validation Metric': {'Precision': 0.7101449275362319, 'Recall': 0.6901408450704225, 'F1': 0.7, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7101449275362319, 'Recall': 0.6901408450704225, 'F1': 0.7, 'Acc': 0.58}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.30198662608861926, 'Valid Loss': 0.7251707804203034, 'Validation Metric': {'Precision': 0.7123287671232876, 'Recall': 0.7323943661971831, 'F1': 0.7222222222222221, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7123287671232876, 'Recall': 0.7323943661971831, 'F1': 0.7222222222222221, 'Acc': 0.6}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.29266268968582154, 'Valid Loss': 0.725939724445343, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.7183098591549296, 'F1': 0.7132867132867133, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.7123287671232876, 'Recall': 0.7323943661971831, 'F1': 0.7222222222222221, 'Acc': 0.6}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.27826782494783403, 'Valid Loss': 0.7233911907672882, 'Validation Metric': {'Precision': 0.7123287671232876, 'Recall': 0.7323943661971831, 'F1': 0.7222222222222221, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.7123287671232876, 'Recall': 0.7323943661971831, 'F1': 0.7222222222222221, 'Acc': 0.6}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6567164179104478, 'Recall': 0.6875, 'F1': 0.6717557251908397, 'Acc': 0.57}; Test loss: 0.7180082058906555
