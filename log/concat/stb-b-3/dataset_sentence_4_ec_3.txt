Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6972768763278393, 'Valid Loss': 0.6920496775553777, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6890659306911712, 'Valid Loss': 0.6935908106657175, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.2608695652173913, 'F1': 0.33333333333333337, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.2608695652173913, 'F1': 0.33333333333333337, 'Acc': 0.5247524752475248}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.692265454758989, 'Valid Loss': 0.6942204947655017, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.3695652173913043, 'F1': 0.425, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.3695652173913043, 'F1': 0.425, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6818050634353718, 'Valid Loss': 0.6954969694981208, 'Validation Metric': {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6704061608365242, 'Valid Loss': 0.6931925920339731, 'Validation Metric': {'Precision': 0.4857142857142857, 'Recall': 0.3695652173913043, 'F1': 0.4197530864197531, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.65344792794674, 'Valid Loss': 0.6950677060163938, 'Validation Metric': {'Precision': 0.5128205128205128, 'Recall': 0.43478260869565216, 'F1': 0.47058823529411764, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6154563984972365, 'Valid Loss': 0.6961769576256092, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.34782608695652173, 'F1': 0.3902439024390244, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5768129562443876, 'Valid Loss': 0.6990400965397174, 'Validation Metric': {'Precision': 0.4864864864864865, 'Recall': 0.391304347826087, 'F1': 0.43373493975903615, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5389556463094468, 'Valid Loss': 0.701782287313388, 'Validation Metric': {'Precision': 0.5172413793103449, 'Recall': 0.32608695652173914, 'F1': 0.4, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4918020808316292, 'Valid Loss': 0.705297433412992, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.30434782608695654, 'F1': 0.3943661971830986, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4408791832467343, 'Valid Loss': 0.7158287408260199, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.30434782608695654, 'F1': 0.3943661971830986, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.39959322470933833, 'Valid Loss': 0.7328369399675956, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.34782608695652173, 'F1': 0.4155844155844156, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3713377663429747, 'Valid Loss': 0.7396041922844373, 'Validation Metric': {'Precision': 0.5909090909090909, 'Recall': 0.2826086956521739, 'F1': 0.38235294117647056, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.335718257947171, 'Valid Loss': 0.7533808935147065, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.30434782608695654, 'F1': 0.4, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3050912934890453, 'Valid Loss': 0.7664656077439969, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.2608695652173913, 'F1': 0.3529411764705882, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.28889593331420677, 'Valid Loss': 0.7766690116662246, 'Validation Metric': {'Precision': 0.5769230769230769, 'Recall': 0.32608695652173914, 'F1': 0.41666666666666663, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.26482515576037957, 'Valid Loss': 0.7848917773136725, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.30434782608695654, 'F1': 0.4, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2555006482499711, 'Valid Loss': 0.7921454425041492, 'Validation Metric': {'Precision': 0.5769230769230769, 'Recall': 0.32608695652173914, 'F1': 0.41666666666666663, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2529606153356268, 'Valid Loss': 0.7969283014535904, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.34782608695652173, 'F1': 0.4383561643835616, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.23471635477022923, 'Valid Loss': 0.7990402189584879, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.34782608695652173, 'F1': 0.4383561643835616, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.4888888888888889, 'Recall': 0.4782608695652174, 'F1': 0.4835164835164835, 'Acc': 0.5346534653465347}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.47619047619047616, 'Recall': 0.46511627906976744, 'F1': 0.4705882352941176, 'Acc': 0.55}; Test loss: 0.6889557790756226
