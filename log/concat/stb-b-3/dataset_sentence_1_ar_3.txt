Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6992646003071266, 'Valid Loss': 0.6855768394470215, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.11627906976744186, 'F1': 0.1818181818181818, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.11627906976744186, 'F1': 0.1818181818181818, 'Acc': 0.55}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7028641549846794, 'Valid Loss': 0.6865295481681823, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.13953488372093023, 'F1': 0.2105263157894737, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.13953488372093023, 'F1': 0.2105263157894737, 'Acc': 0.55}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7037265715719778, 'Valid Loss': 0.687635509967804, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.37209302325581395, 'F1': 0.45070422535211263, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.37209302325581395, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6980733667747884, 'Valid Loss': 0.6906407690048217, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.46511627906976744, 'F1': 0.4819277108433735, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.46511627906976744, 'F1': 0.4819277108433735, 'Acc': 0.57}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6906544105916084, 'Valid Loss': 0.6998541331291199, 'Validation Metric': {'Precision': 0.45, 'Recall': 0.627906976744186, 'F1': 0.5242718446601942, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45, 'Recall': 0.627906976744186, 'F1': 0.5242718446601942, 'Acc': 0.51}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6758510311947593, 'Valid Loss': 0.6901881241798401, 'Validation Metric': {'Precision': 0.4888888888888889, 'Recall': 0.5116279069767442, 'F1': 0.5, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.45, 'Recall': 0.627906976744186, 'F1': 0.5242718446601942, 'Acc': 0.51}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6676291657399528, 'Valid Loss': 0.7002277183532715, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.6976744186046512, 'F1': 0.5660377358490566, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47619047619047616, 'Recall': 0.6976744186046512, 'F1': 0.5660377358490566, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6234685722031171, 'Valid Loss': 0.6929568266868591, 'Validation Metric': {'Precision': 0.54, 'Recall': 0.627906976744186, 'F1': 0.5806451612903226, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.627906976744186, 'F1': 0.5806451612903226, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6073677577549899, 'Valid Loss': 0.6822852420806885, 'Validation Metric': {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5799281057677691, 'Valid Loss': 0.7052847933769226, 'Validation Metric': {'Precision': 0.4426229508196721, 'Recall': 0.627906976744186, 'F1': 0.5192307692307692, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5404519880119758, 'Valid Loss': 0.6847881770133972, 'Validation Metric': {'Precision': 0.5365853658536586, 'Recall': 0.5116279069767442, 'F1': 0.5238095238095238, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5256602745267409, 'Valid Loss': 0.7119236564636231, 'Validation Metric': {'Precision': 0.4716981132075472, 'Recall': 0.5813953488372093, 'F1': 0.5208333333333334, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4916202905057352, 'Valid Loss': 0.6943275499343872, 'Validation Metric': {'Precision': 0.4883720930232558, 'Recall': 0.4883720930232558, 'F1': 0.4883720930232558, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4641271833377548, 'Valid Loss': 0.7048320817947388, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.5581395348837209, 'F1': 0.5052631578947369, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4477885337192801, 'Valid Loss': 0.7135540437698364, 'Validation Metric': {'Precision': 0.4528301886792453, 'Recall': 0.5581395348837209, 'F1': 0.5, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.41896557543851154, 'Valid Loss': 0.7240853142738343, 'Validation Metric': {'Precision': 0.44642857142857145, 'Recall': 0.5813953488372093, 'F1': 0.5050505050505051, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.40848574212080313, 'Valid Loss': 0.7146205258369446, 'Validation Metric': {'Precision': 0.48, 'Recall': 0.5581395348837209, 'F1': 0.5161290322580644, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3934780644087852, 'Valid Loss': 0.7190360164642334, 'Validation Metric': {'Precision': 0.4716981132075472, 'Recall': 0.5813953488372093, 'F1': 0.5208333333333334, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3918130958004843, 'Valid Loss': 0.717595329284668, 'Validation Metric': {'Precision': 0.48, 'Recall': 0.5581395348837209, 'F1': 0.5161290322580644, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.37392352823215197, 'Valid Loss': 0.7215608632564545, 'Validation Metric': {'Precision': 0.4716981132075472, 'Recall': 0.5813953488372093, 'F1': 0.5208333333333334, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.6744186046511628, 'F1': 0.6041666666666666, 'Acc': 0.62}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5306122448979592, 'Recall': 0.4727272727272727, 'F1': 0.5, 'Acc': 0.48}; Test loss: 0.7298891067504882
