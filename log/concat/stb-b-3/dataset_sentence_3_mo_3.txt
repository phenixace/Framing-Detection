Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6969604510113709, 'Valid Loss': 0.6076980943863208, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.900990099009901}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.900990099009901}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6995838208306104, 'Valid Loss': 0.6400296458831201, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7623762376237624}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.900990099009901}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6838092940642422, 'Valid Loss': 0.7097403475871453, 'Validation Metric': {'Precision': 0.02, 'Recall': 0.2, 'F1': 0.03636363636363636, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.02, 'Recall': 0.2, 'F1': 0.03636363636363636, 'Acc': 0.4752475247524752}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6573281805766257, 'Valid Loss': 0.8076945153566507, 'Validation Metric': {'Precision': 0.03296703296703297, 'Recall': 0.6, 'F1': 0.0625, 'Acc': 0.10891089108910891}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.03296703296703297, 'Recall': 0.6, 'F1': 0.0625, 'Acc': 0.10891089108910891}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6107608299506339, 'Valid Loss': 0.8907154340010422, 'Validation Metric': {'Precision': 0.04395604395604396, 'Recall': 0.8, 'F1': 0.08333333333333336, 'Acc': 0.12871287128712872}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.04395604395604396, 'Recall': 0.8, 'F1': 0.08333333333333336, 'Acc': 0.12871287128712872}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5302902482506028, 'Valid Loss': 0.9055682627054361, 'Validation Metric': {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.43072451404610973, 'Valid Loss': 0.7779994606971741, 'Validation Metric': {'Precision': 0.01818181818181818, 'Recall': 0.2, 'F1': 0.03333333333333333, 'Acc': 0.42574257425742573}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.32686859929471984, 'Valid Loss': 0.6486884103371546, 'Validation Metric': {'Precision': 0.030303030303030304, 'Recall': 0.2, 'F1': 0.052631578947368425, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2512367377267744, 'Valid Loss': 0.5377640288609725, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7623762376237624}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.1886746340564319, 'Valid Loss': 0.4354855836584018, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8712871287128713}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.1513608654862956, 'Valid Loss': 0.39770806523469776, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8910891089108911}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.12185636243986007, 'Valid Loss': 0.35915821676070875, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8910891089108911}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1022689393476436, 'Valid Loss': 0.33223952840153986, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8910891089108911}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.08604015902917188, 'Valid Loss': 0.30985324915785056, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9108910891089109}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.07805517411097548, 'Valid Loss': 0.2954047775039306, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9207920792079208}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.06887449681254706, 'Valid Loss': 0.2889097539278177, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9207920792079208}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.06312996835300796, 'Valid Loss': 0.2809155643559419, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9306930693069307}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.057389906866658, 'Valid Loss': 0.2778767284292441, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9306930693069307}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.05455401618229715, 'Valid Loss': 0.27379080710502773, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9306930693069307}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.052901236550476315, 'Valid Loss': 0.2713113089020436, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.046511627906976744, 'Recall': 0.8, 'F1': 0.0879120879120879, 'Acc': 0.1782178217821782}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.05194805194805195, 'Recall': 0.8, 'F1': 0.0975609756097561, 'Acc': 0.26732673267326734}; Test loss: 0.8758671581745148
