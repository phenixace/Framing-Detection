Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7003671343509967, 'Valid Loss': 0.6503733491897583, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.125, 'F1': 0.20512820512820512, 'Acc': 0.69}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.125, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7000435017622434, 'Valid Loss': 0.6570753264427185, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.25, 'F1': 0.34782608695652173, 'Acc': 0.7}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.25, 'F1': 0.34782608695652173, 'Acc': 0.7}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6985702228087646, 'Valid Loss': 0.6639348149299622, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.375, 'F1': 0.4444444444444444, 'Acc': 0.7}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.375, 'F1': 0.4444444444444444, 'Acc': 0.7}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.690575486765458, 'Valid Loss': 0.6737324714660644, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6795094288312472, 'Valid Loss': 0.682379379272461, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.6875, 'F1': 0.5365853658536586, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.667999573625051, 'Valid Loss': 0.6826920485496522, 'Validation Metric': {'Precision': 0.44680851063829785, 'Recall': 0.65625, 'F1': 0.5316455696202532, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6315768980062925, 'Valid Loss': 0.6964873576164246, 'Validation Metric': {'Precision': 0.38596491228070173, 'Recall': 0.6875, 'F1': 0.49438202247191015, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5931956108946067, 'Valid Loss': 0.7064736437797546, 'Validation Metric': {'Precision': 0.37037037037037035, 'Recall': 0.625, 'F1': 0.4651162790697674, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5435733273625374, 'Valid Loss': 0.7276267123222351, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.5625, 'F1': 0.43373493975903615, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.503972780246001, 'Valid Loss': 0.6926546573638916, 'Validation Metric': {'Precision': 0.39473684210526316, 'Recall': 0.46875, 'F1': 0.4285714285714286, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.44135297863529277, 'Valid Loss': 0.6887665915489197, 'Validation Metric': {'Precision': 0.38235294117647056, 'Recall': 0.40625, 'F1': 0.393939393939394, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3892027337390643, 'Valid Loss': 0.693308311700821, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.28125, 'F1': 0.29032258064516125, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3616962404205249, 'Valid Loss': 0.6814133501052857, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.25, 'F1': 0.2962962962962963, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.32585355969002616, 'Valid Loss': 0.6659786176681518, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.15625, 'F1': 0.2127659574468085, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.30607307988863725, 'Valid Loss': 0.6668110370635987, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.15625, 'F1': 0.21739130434782608, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2808323269709945, 'Valid Loss': 0.6726749300956726, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.15625, 'F1': 0.21739130434782608, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.24479539814190224, 'Valid Loss': 0.6778666162490845, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.15625, 'F1': 0.2127659574468085, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2321485339019161, 'Valid Loss': 0.683147549033165, 'Validation Metric': {'Precision': 0.3125, 'Recall': 0.15625, 'F1': 0.20833333333333334, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.22445322129015738, 'Valid Loss': 0.6861525869369507, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.15625, 'F1': 0.2127659574468085, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.21548353959448063, 'Valid Loss': 0.6906465482711792, 'Validation Metric': {'Precision': 0.3125, 'Recall': 0.15625, 'F1': 0.20833333333333334, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.65625, 'F1': 0.5675675675675675, 'Acc': 0.68}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.1956521739130435, 'Recall': 0.32142857142857145, 'F1': 0.24324324324324326, 'Acc': 0.44554455445544555}; Test loss: 0.7049129192645733
