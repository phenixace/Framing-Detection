Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6951786008146074, 'Valid Loss': 0.6634779755885785, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.11428571428571428, 'F1': 0.18604651162790695, 'Acc': 0.6534653465346535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.11428571428571428, 'F1': 0.18604651162790695, 'Acc': 0.6534653465346535}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6970363616943359, 'Valid Loss': 0.6704090787814214, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.17142857142857143, 'F1': 0.2553191489361702, 'Acc': 0.6534653465346535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17142857142857143, 'F1': 0.2553191489361702, 'Acc': 0.6534653465346535}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6900806771384345, 'Valid Loss': 0.6777611947976626, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6740120238727993, 'Valid Loss': 0.685042530298233, 'Validation Metric': {'Precision': 0.3684210526315789, 'Recall': 0.4, 'F1': 0.3835616438356164, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6648936026626163, 'Valid Loss': 0.6811208106004275, 'Validation Metric': {'Precision': 0.34615384615384615, 'Recall': 0.2571428571428571, 'F1': 0.29508196721311475, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6470874869161182, 'Valid Loss': 0.6687072928135211, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.2, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6094082087278366, 'Valid Loss': 0.6777458603565509, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.2571428571428571, 'F1': 0.3103448275862069, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5694415433539285, 'Valid Loss': 0.6780701165015881, 'Validation Metric': {'Precision': 0.3157894736842105, 'Recall': 0.17142857142857143, 'F1': 0.22222222222222224, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5291371315717697, 'Valid Loss': 0.6783897085831716, 'Validation Metric': {'Precision': 0.2777777777777778, 'Recall': 0.14285714285714285, 'F1': 0.18867924528301885, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.48357069227430555, 'Valid Loss': 0.6781801283359528, 'Validation Metric': {'Precision': 0.2777777777777778, 'Recall': 0.14285714285714285, 'F1': 0.18867924528301885, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4595038081208865, 'Valid Loss': 0.6807121611558474, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.17142857142857143, 'F1': 0.22641509433962265, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.42512733721070817, 'Valid Loss': 0.6840073397526374, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.17142857142857143, 'F1': 0.21818181818181817, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3858090642425749, 'Valid Loss': 0.6871778357487458, 'Validation Metric': {'Precision': 0.38095238095238093, 'Recall': 0.22857142857142856, 'F1': 0.2857142857142857, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.35867871824238035, 'Valid Loss': 0.689287652189915, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.2571428571428571, 'F1': 0.30508474576271183, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3137603470020824, 'Valid Loss': 0.6916752428962634, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.2571428571428571, 'F1': 0.30508474576271183, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2966790307727125, 'Valid Loss': 0.6944169745995448, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2880099109477467, 'Valid Loss': 0.6961830453230784, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.2571428571428571, 'F1': 0.3214285714285714, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2832065705623892, 'Valid Loss': 0.7007716384071571, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.2857142857142857, 'F1': 0.3389830508474576, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2663815789752536, 'Valid Loss': 0.7008166937873914, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.2571428571428571, 'F1': 0.3214285714285714, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.25124479689531853, 'Valid Loss': 0.7032785942921271, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.2571428571428571, 'F1': 0.3103448275862069, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.3142857142857143, 'F1': 0.39285714285714285, 'Acc': 0.6633663366336634}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5, 'Recall': 0.3695652173913043, 'F1': 0.425, 'Acc': 0.5445544554455446}; Test loss: 0.6962865522274604
