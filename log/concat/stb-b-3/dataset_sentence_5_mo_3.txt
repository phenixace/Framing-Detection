Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.707549598435281, 'Valid Loss': 0.6192286968231201, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.83}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.83}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7056250966770549, 'Valid Loss': 0.6524696779251099, 'Validation Metric': {'Precision': 0.19047619047619047, 'Recall': 0.2857142857142857, 'F1': 0.22857142857142854, 'Acc': 0.73}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.2857142857142857, 'F1': 0.22857142857142854, 'Acc': 0.73}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6708309675606203, 'Valid Loss': 0.7359495973587036, 'Validation Metric': {'Precision': 0.1323529411764706, 'Recall': 0.6428571428571429, 'F1': 0.21951219512195122, 'Acc': 0.36}}
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.2857142857142857, 'F1': 0.22857142857142854, 'Acc': 0.73}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6184576882023207, 'Valid Loss': 0.8265901255607605, 'Validation Metric': {'Precision': 0.12345679012345678, 'Recall': 0.7142857142857143, 'F1': 0.21052631578947367, 'Acc': 0.25}}
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.2857142857142857, 'F1': 0.22857142857142854, 'Acc': 0.73}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.5181892546759524, 'Valid Loss': 0.8588195371627808, 'Validation Metric': {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.39114370123601294, 'Valid Loss': 0.7915437626838684, 'Validation Metric': {'Precision': 0.1206896551724138, 'Recall': 0.5, 'F1': 0.19444444444444445, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.27854165823107035, 'Valid Loss': 0.6725676918029785, 'Validation Metric': {'Precision': 0.15151515151515152, 'Recall': 0.35714285714285715, 'F1': 0.21276595744680848, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.19707959979562692, 'Valid Loss': 0.5600200319290161, 'Validation Metric': {'Precision': 0.0625, 'Recall': 0.07142857142857142, 'F1': 0.06666666666666667, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.13756679496924643, 'Valid Loss': 0.47861591100692746, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.82}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.09974221499558066, 'Valid Loss': 0.4630281352996826, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.82}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.07684995617035409, 'Valid Loss': 0.4588741457462311, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.84}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.06226257637510417, 'Valid Loss': 0.46971165597438813, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.051735848936081776, 'Valid Loss': 0.48093530267477036, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.043795188862672994, 'Valid Loss': 0.49030716955661774, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.03783539945626972, 'Valid Loss': 0.4974973811209202, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.033507671482651165, 'Valid Loss': 0.5058253486454487, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.03151994066076799, 'Valid Loss': 0.5145056813955307, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.02967553503785125, 'Valid Loss': 0.5211227030307054, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.027284846398454736, 'Valid Loss': 0.5256402753293514, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.02713635441204402, 'Valid Loss': 0.5273254048079252, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.136986301369863, 'Recall': 0.7142857142857143, 'F1': 0.22988505747126436, 'Acc': 0.33}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.10126582278481013, 'Recall': 0.7272727272727273, 'F1': 0.17777777777777778, 'Acc': 0.26}; Test loss: 0.9490562653541565
