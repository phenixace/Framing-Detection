Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7087285110824987, 'Valid Loss': 0.7380950582027436, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.712355657627708, 'Valid Loss': 0.7329752278327942, 'Validation Metric': {'Precision': 0.4222222222222222, 'Recall': 0.8837209302325582, 'F1': 0.5714285714285714, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6957596532608333, 'Valid Loss': 0.7256484723091126, 'Validation Metric': {'Precision': 0.42168674698795183, 'Recall': 0.813953488372093, 'F1': 0.5555555555555556, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6939779292596014, 'Valid Loss': 0.7185799860954285, 'Validation Metric': {'Precision': 0.40789473684210525, 'Recall': 0.7209302325581395, 'F1': 0.5210084033613445, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7022079456793634, 'Valid Loss': 0.7142634844779968, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.627906976744186, 'F1': 0.4821428571428572, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6860633829706594, 'Valid Loss': 0.7092537760734559, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.5116279069767442, 'F1': 0.4444444444444445, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6757494179826034, 'Valid Loss': 0.7064993977546692, 'Validation Metric': {'Precision': 0.4126984126984127, 'Recall': 0.6046511627906976, 'F1': 0.49056603773584895, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6418309074483419, 'Valid Loss': 0.7038954710960388, 'Validation Metric': {'Precision': 0.3877551020408163, 'Recall': 0.4418604651162791, 'F1': 0.4130434782608695, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6349993230480897, 'Valid Loss': 0.711152880191803, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.6511627906976745, 'F1': 0.49557522123893805, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5869538846768831, 'Valid Loss': 0.7123754680156708, 'Validation Metric': {'Precision': 0.40384615384615385, 'Recall': 0.4883720930232558, 'F1': 0.4421052631578947, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5558889253359092, 'Valid Loss': 0.7152867758274079, 'Validation Metric': {'Precision': 0.41509433962264153, 'Recall': 0.5116279069767442, 'F1': 0.45833333333333337, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5049622831375975, 'Valid Loss': 0.756638548374176, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.4186046511627907, 'F1': 0.40909090909090917, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4661142775102666, 'Valid Loss': 0.7787401008605958, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.4186046511627907, 'F1': 0.40909090909090917, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.43430000269099284, 'Valid Loss': 0.7977329015731811, 'Validation Metric': {'Precision': 0.41304347826086957, 'Recall': 0.4418604651162791, 'F1': 0.4269662921348315, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.42169998429323496, 'Valid Loss': 0.8074116861820221, 'Validation Metric': {'Precision': 0.42592592592592593, 'Recall': 0.5348837209302325, 'F1': 0.4742268041237113, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.37373539119174604, 'Valid Loss': 0.8188951826095581, 'Validation Metric': {'Precision': 0.42105263157894735, 'Recall': 0.5581395348837209, 'F1': 0.48, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.34927091374993324, 'Valid Loss': 0.8340326070785522, 'Validation Metric': {'Precision': 0.41818181818181815, 'Recall': 0.5348837209302325, 'F1': 0.4693877551020408, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.33257755323460225, 'Valid Loss': 0.8381404435634613, 'Validation Metric': {'Precision': 0.39622641509433965, 'Recall': 0.4883720930232558, 'F1': 0.4375, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.31794082667482526, 'Valid Loss': 0.8378757643699646, 'Validation Metric': {'Precision': 0.40425531914893614, 'Recall': 0.4418604651162791, 'F1': 0.4222222222222222, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.32811946872817843, 'Valid Loss': 0.8479455399513245, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.5116279069767442, 'F1': 0.44897959183673475, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5434782608695652, 'Recall': 0.9090909090909091, 'F1': 0.6802721088435375, 'Acc': 0.53}; Test loss: 0.7058412384986877
