Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7597958539661608, 'Valid Loss': 0.7593987226486206, 'Validation Metric': {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7269860231562665, 'Valid Loss': 0.7107941555976868, 'Validation Metric': {'Precision': 0.3492063492063492, 'Recall': 0.6875, 'F1': 0.46315789473684205, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6596733680681178, 'Valid Loss': 0.6547287023067474, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.125, 'F1': 0.19047619047619047, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6304212604698382, 'Valid Loss': 0.6321873927116394, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6085061121143793, 'Valid Loss': 0.6375083029270172, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6078698376291677, 'Valid Loss': 0.6382704043388366, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5939423779123708, 'Valid Loss': 0.6346380388736725, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5648498099885488, 'Valid Loss': 0.649459364414215, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.0625, 'F1': 0.11764705882352941, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5215690767294482, 'Valid Loss': 0.6639221233129501, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.0625, 'F1': 0.10810810810810811, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5160868807058585, 'Valid Loss': 0.6747846508026123, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.09375, 'F1': 0.14285714285714285, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4721757348038648, 'Valid Loss': 0.6915747845172882, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.125, 'F1': 0.17777777777777778, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.42468028946926717, 'Valid Loss': 0.6965508729219436, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.125, 'F1': 0.18181818181818182, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.41177541880231155, 'Valid Loss': 0.7134560489654541, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.21875, 'F1': 0.2641509433962264, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3612570052868442, 'Valid Loss': 0.7114174479246139, 'Validation Metric': {'Precision': 0.3684210526315789, 'Recall': 0.21875, 'F1': 0.2745098039215686, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.334117694316726, 'Valid Loss': 0.7266819041967392, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.21875, 'F1': 0.2641509433962264, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3268417414081724, 'Valid Loss': 0.729509100317955, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.28125, 'F1': 0.3272727272727273, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2981696899392103, 'Valid Loss': 0.7415796911716461, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.3125, 'F1': 0.3448275862068966, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.28499757576929896, 'Valid Loss': 0.7448067420721054, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.3125, 'F1': 0.3508771929824561, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.297185408441644, 'Valid Loss': 0.7512286102771759, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.3125, 'F1': 0.3448275862068966, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2732067031687812, 'Valid Loss': 0.7557822006940842, 'Validation Metric': {'Precision': 0.37037037037037035, 'Recall': 0.3125, 'F1': 0.3389830508474576, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.28125, 'Recall': 0.9642857142857143, 'F1': 0.4354838709677419, 'Acc': 0.3069306930693069}; Test loss: 0.7843726185651926
