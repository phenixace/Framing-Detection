Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6651951882400011, 'Valid Loss': 0.6607205891609191, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6774409130999917, 'Valid Loss': 0.6550099182128907, 'Validation Metric': {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.667772856589995, 'Valid Loss': 0.6501380717754364, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6616483828739116, 'Valid Loss': 0.6468900430202484, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6530257686972618, 'Valid Loss': 0.645687153339386, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6493717824157915, 'Valid Loss': 0.6440884602069855, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6445628204628041, 'Valid Loss': 0.6431491994857788, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6283266226712027, 'Valid Loss': 0.6420035243034363, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6186425415308852, 'Valid Loss': 0.6397550666332245, 'Validation Metric': {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6017841234018928, 'Valid Loss': 0.6389033913612365, 'Validation Metric': {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5813464671373367, 'Valid Loss': 0.637640254497528, 'Validation Metric': {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5588271484563225, 'Valid Loss': 0.636393735408783, 'Validation Metric': {'Precision': 0.6597938144329897, 'Recall': 0.9846153846153847, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5421972604174363, 'Valid Loss': 0.6356159281730652, 'Validation Metric': {'Precision': 0.6597938144329897, 'Recall': 0.9846153846153847, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5231000790862661, 'Valid Loss': 0.6342780339717865, 'Validation Metric': {'Precision': 0.6597938144329897, 'Recall': 0.9846153846153847, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.49416522740533475, 'Valid Loss': 0.640456268787384, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.48444909308301776, 'Valid Loss': 0.6439388799667358, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4683996825233886, 'Valid Loss': 0.6453151059150696, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4506955342857461, 'Valid Loss': 0.6473693454265594, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.44901890346878454, 'Valid Loss': 0.6478400254249572, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.44002916663885117, 'Valid Loss': 0.6486691331863403, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}; Test loss: 0.6357420545357925
