Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7091470758120219, 'Valid Loss': 0.7271537562975516, 'Validation Metric': {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7094144225120544, 'Valid Loss': 0.7224398484596839, 'Validation Metric': {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6971784969170888, 'Valid Loss': 0.7172371584635514, 'Validation Metric': {'Precision': 0.4725274725274725, 'Recall': 0.86, 'F1': 0.6099290780141844, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6957095265388489, 'Valid Loss': 0.7130095454362723, 'Validation Metric': {'Precision': 0.47126436781609193, 'Recall': 0.82, 'F1': 0.5985401459854015, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6920049309730529, 'Valid Loss': 0.710247821532763, 'Validation Metric': {'Precision': 0.4578313253012048, 'Recall': 0.76, 'F1': 0.5714285714285715, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6834278249740601, 'Valid Loss': 0.7082145030681903, 'Validation Metric': {'Precision': 0.43548387096774194, 'Recall': 0.54, 'F1': 0.4821428571428571, 'Acc': 0.42574257425742573}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6735541979471843, 'Valid Loss': 0.7089823209322416, 'Validation Metric': {'Precision': 0.42105263157894735, 'Recall': 0.48, 'F1': 0.44859813084112143, 'Acc': 0.4158415841584158}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6601827120780945, 'Valid Loss': 0.7135751637128683, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.5, 'F1': 0.45454545454545453, 'Acc': 0.40594059405940597}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6367952108383179, 'Valid Loss': 0.7237651164715106, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.44, 'F1': 0.44, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5962071494261424, 'Valid Loss': 0.7478759804597268, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.3, 'F1': 0.3488372093023256, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6051100285847982, 'Valid Loss': 0.7511208263727335, 'Validation Metric': {'Precision': 0.4722222222222222, 'Recall': 0.68, 'F1': 0.5573770491803278, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5363860972722372, 'Valid Loss': 0.7786205044159522, 'Validation Metric': {'Precision': 0.49019607843137253, 'Recall': 0.5, 'F1': 0.495049504950495, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4901198168595632, 'Valid Loss': 0.7977762715174601, 'Validation Metric': {'Precision': 0.4603174603174603, 'Recall': 0.58, 'F1': 0.5132743362831858, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.45296355287233986, 'Valid Loss': 0.7982441599552448, 'Validation Metric': {'Precision': 0.4782608695652174, 'Recall': 0.66, 'F1': 0.5546218487394958, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.429430481394132, 'Valid Loss': 0.8100142925977707, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.62, 'F1': 0.5535714285714285, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.41306896090507506, 'Valid Loss': 0.8302221963038812, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.6, 'F1': 0.5454545454545454, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3888337121407191, 'Valid Loss': 0.8411075690617928, 'Validation Metric': {'Precision': 0.4918032786885246, 'Recall': 0.6, 'F1': 0.5405405405405406, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3793097863594691, 'Valid Loss': 0.8451892733573914, 'Validation Metric': {'Precision': 0.5079365079365079, 'Recall': 0.64, 'F1': 0.5663716814159292, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3719308910767237, 'Valid Loss': 0.8526607820620904, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.62, 'F1': 0.5535714285714285, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3621456452210744, 'Valid Loss': 0.8552387448457571, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.62, 'F1': 0.5535714285714285, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.92, 'F1': 0.6301369863013699, 'Acc': 0.46534653465346537}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}; Test loss: 0.7108910863216107
