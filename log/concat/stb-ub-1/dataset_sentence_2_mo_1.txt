Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.799273199156711, 'Valid Loss': 0.8202076721191406, 'Validation Metric': {'Precision': 0.09473684210526316, 'Recall': 1.0, 'F1': 0.17307692307692307, 'Acc': 0.14}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09473684210526316, 'Recall': 1.0, 'F1': 0.17307692307692307, 'Acc': 0.14}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7239079898909518, 'Valid Loss': 0.6566234135627746, 'Validation Metric': {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.5416932815783903, 'Valid Loss': 0.48237672924995423, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.42316650756095586, 'Valid Loss': 0.40528482794761655, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.3852969090405263, 'Valid Loss': 0.36374985456466674, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.35408276672426026, 'Valid Loss': 0.33973846018314363, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.3277372174749249, 'Valid Loss': 0.3197213840484619, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.30980248327710125, 'Valid Loss': 0.3090505880117416, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2924984408248412, 'Valid Loss': 0.30149720489978793, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.27596209521748516, 'Valid Loss': 0.3029807949066162, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.24596201981368818, 'Valid Loss': 0.3020278534293175, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.22914709444893033, 'Valid Loss': 0.304137287735939, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.21670115160706796, 'Valid Loss': 0.2926327136158943, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1900565831088706, 'Valid Loss': 0.3024853065609932, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.91}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1854436706849619, 'Valid Loss': 0.29078381180763246, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.17957463536999727, 'Valid Loss': 0.29184455767273904, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.15964822162334857, 'Valid Loss': 0.3029170921444893, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.17366255314922646, 'Valid Loss': 0.29733909279108045, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16298633759939357, 'Valid Loss': 0.3004583466053009, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.15837910129247526, 'Valid Loss': 0.30095878317952157, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9}}
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.4444444444444444, 'F1': 0.20512820512820512, 'Acc': 0.69}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.05405405405405406, 'Recall': 0.4, 'F1': 0.09523809523809523, 'Acc': 0.6237623762376238}; Test loss: 0.6663335584677182
