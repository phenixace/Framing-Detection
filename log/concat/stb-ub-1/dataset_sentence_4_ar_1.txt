Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7242337943691957, 'Valid Loss': 0.7108910863216107, 'Validation Metric': {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7219264515136418, 'Valid Loss': 0.7077138217595907, 'Validation Metric': {'Precision': 0.5212765957446809, 'Recall': 0.9245283018867925, 'F1': 0.6666666666666666, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7134667948672646, 'Valid Loss': 0.7038218745818505, 'Validation Metric': {'Precision': 0.5054945054945055, 'Recall': 0.8679245283018868, 'F1': 0.638888888888889, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7067086445657831, 'Valid Loss': 0.7012662176902478, 'Validation Metric': {'Precision': 0.48717948717948717, 'Recall': 0.7169811320754716, 'F1': 0.5801526717557253, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.704726896003673, 'Valid Loss': 0.7007366510537955, 'Validation Metric': {'Precision': 0.47297297297297297, 'Recall': 0.660377358490566, 'F1': 0.5511811023622047, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6953595892379159, 'Valid Loss': 0.7003154983887305, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5660377358490566, 'F1': 0.5309734513274337, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6825561860674306, 'Valid Loss': 0.7000537193738497, 'Validation Metric': {'Precision': 0.46938775510204084, 'Recall': 0.4339622641509434, 'F1': 0.4509803921568628, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6694585257454923, 'Valid Loss': 0.6987673067129575, 'Validation Metric': {'Precision': 0.4523809523809524, 'Recall': 0.3584905660377358, 'F1': 0.4, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6627356378655684, 'Valid Loss': 0.6984035968780518, 'Validation Metric': {'Precision': 0.42105263157894735, 'Recall': 0.3018867924528302, 'F1': 0.3516483516483517, 'Acc': 0.4158415841584158}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6396360197349599, 'Valid Loss': 0.7004551474864666, 'Validation Metric': {'Precision': 0.40476190476190477, 'Recall': 0.32075471698113206, 'F1': 0.3578947368421052, 'Acc': 0.39603960396039606}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6091037251447377, 'Valid Loss': 0.7070705661406884, 'Validation Metric': {'Precision': 0.45652173913043476, 'Recall': 0.39622641509433965, 'F1': 0.42424242424242425, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5823077563392488, 'Valid Loss': 0.720149828837468, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.4528301886792453, 'F1': 0.4752475247524752, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5465632022211426, 'Valid Loss': 0.7328809098555491, 'Validation Metric': {'Precision': 0.49019607843137253, 'Recall': 0.4716981132075472, 'F1': 0.4807692307692308, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4890118864806075, 'Valid Loss': 0.7378079375395408, 'Validation Metric': {'Precision': 0.5409836065573771, 'Recall': 0.6226415094339622, 'F1': 0.5789473684210527, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4715816888370012, 'Valid Loss': 0.749560324045328, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.660377358490566, 'F1': 0.6034482758620691, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.42373031515039894, 'Valid Loss': 0.7666141562736951, 'Validation Metric': {'Precision': 0.5409836065573771, 'Recall': 0.6226415094339622, 'F1': 0.5789473684210527, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4025479449253333, 'Valid Loss': 0.7726279210585815, 'Validation Metric': {'Precision': 0.5409836065573771, 'Recall': 0.6226415094339622, 'F1': 0.5789473684210527, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.41602899055731923, 'Valid Loss': 0.7730542031618265, 'Validation Metric': {'Precision': 0.5423728813559322, 'Recall': 0.6037735849056604, 'F1': 0.5714285714285714, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.37422294640227366, 'Valid Loss': 0.7746926901432184, 'Validation Metric': {'Precision': 0.5423728813559322, 'Recall': 0.6037735849056604, 'F1': 0.5714285714285714, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.37140656792019544, 'Valid Loss': 0.7767206098024662, 'Validation Metric': {'Precision': 0.5423728813559322, 'Recall': 0.6037735849056604, 'F1': 0.5714285714285714, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5416666666666666, 'Recall': 0.9629629629629629, 'F1': 0.6933333333333334, 'Acc': 0.54}; Test loss: 0.6851094603538513
