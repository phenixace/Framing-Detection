Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7285068889981822, 'Valid Loss': 0.7493854808807373, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7213640369867024, 'Valid Loss': 0.7220024394989014, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.7714285714285715, 'F1': 0.4655172413793103, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6908298032848459, 'Valid Loss': 0.6915359115600586, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.45714285714285713, 'F1': 0.3950617283950617, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6745920181274414, 'Valid Loss': 0.6731971228122711, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.08571428571428572, 'F1': 0.1276595744680851, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6697099722529712, 'Valid Loss': 0.6662445747852326, 'Validation Metric': {'Precision': 0.2222222222222222, 'Recall': 0.05714285714285714, 'F1': 0.0909090909090909, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6659277536367115, 'Valid Loss': 0.669242148399353, 'Validation Metric': {'Precision': 0.2222222222222222, 'Recall': 0.05714285714285714, 'F1': 0.0909090909090909, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6322186855893386, 'Valid Loss': 0.674086332321167, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6363530249187821, 'Valid Loss': 0.6694851684570312, 'Validation Metric': {'Precision': 0.2222222222222222, 'Recall': 0.11428571428571428, 'F1': 0.1509433962264151, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.58147035186228, 'Valid Loss': 0.6907692980766297, 'Validation Metric': {'Precision': 0.2727272727272727, 'Recall': 0.17142857142857143, 'F1': 0.21052631578947367, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.552814240910505, 'Valid Loss': 0.695762380361557, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.37142857142857144, 'F1': 0.3661971830985915, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5067047555195657, 'Valid Loss': 0.7101174569129944, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4, 'F1': 0.37837837837837845, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4848574752870359, 'Valid Loss': 0.765513744354248, 'Validation Metric': {'Precision': 0.35185185185185186, 'Recall': 0.5428571428571428, 'F1': 0.42696629213483145, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.43845887737054573, 'Valid Loss': 0.7661301660537719, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.5142857142857142, 'F1': 0.43373493975903615, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4050507933685654, 'Valid Loss': 0.775419716835022, 'Validation Metric': {'Precision': 0.3617021276595745, 'Recall': 0.4857142857142857, 'F1': 0.41463414634146345, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3789318496067273, 'Valid Loss': 0.7705765402317047, 'Validation Metric': {'Precision': 0.3488372093023256, 'Recall': 0.42857142857142855, 'F1': 0.38461538461538464, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3558317275815888, 'Valid Loss': 0.8067172563076019, 'Validation Metric': {'Precision': 0.3541666666666667, 'Recall': 0.4857142857142857, 'F1': 0.40963855421686746, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3418085655491603, 'Valid Loss': 0.816285504102707, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.45714285714285713, 'F1': 0.3950617283950617, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3587739300963126, 'Valid Loss': 0.8163358235359192, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.45714285714285713, 'F1': 0.3950617283950617, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3373347816890792, 'Valid Loss': 0.8168734192848206, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.45714285714285713, 'F1': 0.3950617283950617, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.30005983635783195, 'Valid Loss': 0.822155864238739, 'Validation Metric': {'Precision': 0.35555555555555557, 'Recall': 0.45714285714285713, 'F1': 0.4, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}; Test loss: 0.7315681219100952
