Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.8065043993686375, 'Valid Loss': 0.8335516881942749, 'Validation Metric': {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7225350243480582, 'Valid Loss': 0.6664992141723632, 'Validation Metric': {'Precision': 0.10526315789473684, 'Recall': 0.36363636363636365, 'F1': 0.16326530612244897, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.5260197226154176, 'Valid Loss': 0.46478214621543884, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.4012923197526681, 'Valid Loss': 0.4157153630256653, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.3555111028254032, 'Valid Loss': 0.3865621799230576, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.32276534681257446, 'Valid Loss': 0.3664321005344391, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2950433473053731, 'Valid Loss': 0.35611778020858764, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.27966784156466784, 'Valid Loss': 0.35288265347480774, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2684262832136531, 'Valid Loss': 0.35152333199977875, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.253120164632013, 'Valid Loss': 0.3544070127606392, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.24232939679763818, 'Valid Loss': 0.3530347457528114, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.23367751046623053, 'Valid Loss': 0.35223146408796313, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.21232471154316476, 'Valid Loss': 0.3535260483622551, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.20563265955761859, 'Valid Loss': 0.3537757125496864, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1985036037176063, 'Valid Loss': 0.3558502650260925, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18976401969006187, 'Valid Loss': 0.35597515761852266, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18340099397066392, 'Valid Loss': 0.3573890990018845, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.181163132974976, 'Valid Loss': 0.3584313426911831, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16890032074757313, 'Valid Loss': 0.3592469552159309, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.16815187924198413, 'Valid Loss': 0.3592154701054096, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.11458333333333333, 'Recall': 1.0, 'F1': 0.205607476635514, 'Acc': 0.15}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.09473684210526316, 'Recall': 1.0, 'F1': 0.17307692307692307, 'Acc': 0.14}; Test loss: 0.8202076721191406
