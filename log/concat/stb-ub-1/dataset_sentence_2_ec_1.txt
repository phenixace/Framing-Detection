Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7263789376930186, 'Valid Loss': 0.7315681219100952, 'Validation Metric': {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7155780792236328, 'Valid Loss': 0.7155812287330627, 'Validation Metric': {'Precision': 0.41975308641975306, 'Recall': 0.7906976744186046, 'F1': 0.5483870967741935, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6829066605944383, 'Valid Loss': 0.6967208337783813, 'Validation Metric': {'Precision': 0.4864864864864865, 'Recall': 0.4186046511627907, 'F1': 0.45, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6711516827344894, 'Valid Loss': 0.6880675292015076, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.13953488372093023, 'F1': 0.22222222222222218, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6559383920148799, 'Valid Loss': 0.6987434840202331, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.046511627906976744, 'F1': 0.0851063829787234, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6489874081392037, 'Valid Loss': 0.6996118819713593, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6374624846012968, 'Valid Loss': 0.695359708070755, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6006913824301017, 'Valid Loss': 0.7108951842784882, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.32558139534883723, 'F1': 0.37333333333333335, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5719280909550818, 'Valid Loss': 0.7257883393764496, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.32558139534883723, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5192202623737486, 'Valid Loss': 0.7453512573242187, 'Validation Metric': {'Precision': 0.48, 'Recall': 0.27906976744186046, 'F1': 0.35294117647058815, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5035992005937978, 'Valid Loss': 0.7564804780483246, 'Validation Metric': {'Precision': 0.40476190476190477, 'Recall': 0.3953488372093023, 'F1': 0.4, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4806428622258337, 'Valid Loss': 0.7737317180633545, 'Validation Metric': {'Precision': 0.41304347826086957, 'Recall': 0.4418604651162791, 'F1': 0.4269662921348315, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4465097755585846, 'Valid Loss': 0.7965475869178772, 'Validation Metric': {'Precision': 0.39215686274509803, 'Recall': 0.46511627906976744, 'F1': 0.425531914893617, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.41887884273340825, 'Valid Loss': 0.8090398609638214, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.4186046511627907, 'F1': 0.42352941176470593, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.38216541511447805, 'Valid Loss': 0.8234719336032867, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.4883720930232558, 'F1': 0.45652173913043476, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.34958523355032267, 'Valid Loss': 0.8430664467811585, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.4883720930232558, 'F1': 0.45652173913043476, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3311423118177213, 'Valid Loss': 0.8538743829727173, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.46511627906976744, 'F1': 0.43956043956043955, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3287223377510121, 'Valid Loss': 0.8589751023054123, 'Validation Metric': {'Precision': 0.4318181818181818, 'Recall': 0.4418604651162791, 'F1': 0.4367816091954023, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3307962717586442, 'Valid Loss': 0.8648723304271698, 'Validation Metric': {'Precision': 0.4222222222222222, 'Recall': 0.4418604651162791, 'F1': 0.4318181818181818, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.30582854916390617, 'Valid Loss': 0.8706661128997802, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.46511627906976744, 'F1': 0.449438202247191, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3368421052631579, 'Recall': 0.9142857142857143, 'F1': 0.4923076923076923, 'Acc': 0.3465346534653465}; Test loss: 0.7631239019907438
