Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7143966312471189, 'Valid Loss': 0.7058412384986877, 'Validation Metric': {'Precision': 0.5434782608695652, 'Recall': 0.9090909090909091, 'F1': 0.6802721088435375, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5434782608695652, 'Recall': 0.9090909090909091, 'F1': 0.6802721088435375, 'Acc': 0.53}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7099836986315878, 'Valid Loss': 0.705797643661499, 'Validation Metric': {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7026483887120297, 'Valid Loss': 0.7071603560447692, 'Validation Metric': {'Precision': 0.5375, 'Recall': 0.7818181818181819, 'F1': 0.6370370370370371, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.697169367420046, 'Valid Loss': 0.7090870475769043, 'Validation Metric': {'Precision': 0.49206349206349204, 'Recall': 0.5636363636363636, 'F1': 0.5254237288135594, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.684562897211627, 'Valid Loss': 0.7139334011077881, 'Validation Metric': {'Precision': 0.43137254901960786, 'Recall': 0.4, 'F1': 0.41509433962264153, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6762480790677824, 'Valid Loss': 0.714025616645813, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.43636363636363634, 'F1': 0.4324324324324324, 'Acc': 0.37}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.655244759038875, 'Valid Loss': 0.7254373741149902, 'Validation Metric': {'Precision': 0.4222222222222222, 'Recall': 0.34545454545454546, 'F1': 0.37999999999999995, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.622032033769708, 'Valid Loss': 0.7536231088638305, 'Validation Metric': {'Precision': 0.4666666666666667, 'Recall': 0.38181818181818183, 'F1': 0.42, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5655194485658094, 'Valid Loss': 0.8086412763595581, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.2909090909090909, 'F1': 0.3516483516483517, 'Acc': 0.41}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5360369615648922, 'Valid Loss': 0.80520392537117, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.4727272727272727, 'F1': 0.49523809523809526, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4808295971076739, 'Valid Loss': 0.8112351751327515, 'Validation Metric': {'Precision': 0.5192307692307693, 'Recall': 0.4909090909090909, 'F1': 0.5046728971962617, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.43770135723446546, 'Valid Loss': 0.823392550945282, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.4727272727272727, 'F1': 0.49523809523809526, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.39550757172860596, 'Valid Loss': 0.8338968813419342, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5272727272727272, 'F1': 0.5132743362831858, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3628811297055922, 'Valid Loss': 0.8466640257835388, 'Validation Metric': {'Precision': 0.5178571428571429, 'Recall': 0.5272727272727272, 'F1': 0.5225225225225225, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.37189909207977745, 'Valid Loss': 0.8476623153686523, 'Validation Metric': {'Precision': 0.53125, 'Recall': 0.6181818181818182, 'F1': 0.5714285714285714, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.32372180921466726, 'Valid Loss': 0.864460905790329, 'Validation Metric': {'Precision': 0.5172413793103449, 'Recall': 0.5454545454545454, 'F1': 0.5309734513274337, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.30952221096346255, 'Valid Loss': 0.8671266293525696, 'Validation Metric': {'Precision': 0.5172413793103449, 'Recall': 0.5454545454545454, 'F1': 0.5309734513274337, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2987684901607664, 'Valid Loss': 0.8814879137277604, 'Validation Metric': {'Precision': 0.5172413793103449, 'Recall': 0.5454545454545454, 'F1': 0.5309734513274337, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2929536729658905, 'Valid Loss': 0.8815291231870651, 'Validation Metric': {'Precision': 0.5172413793103449, 'Recall': 0.5454545454545454, 'F1': 0.5309734513274337, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.27724392065092135, 'Valid Loss': 0.8842889344692231, 'Validation Metric': {'Precision': 0.5172413793103449, 'Recall': 0.5454545454545454, 'F1': 0.5309734513274337, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.550561797752809, 'Recall': 0.8909090909090909, 'F1': 0.6805555555555556, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4838709677419355, 'Recall': 0.9, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}; Test loss: 0.7223370304474463
