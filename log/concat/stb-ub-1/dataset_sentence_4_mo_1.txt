Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.8103289808097639, 'Valid Loss': 0.8488578567138085, 'Validation Metric': {'Precision': 0.05, 'Recall': 1.0, 'F1': 0.09523809523809523, 'Acc': 0.0594059405940594}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.05, 'Recall': 1.0, 'F1': 0.09523809523809523, 'Acc': 0.0594059405940594}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7162726686189049, 'Valid Loss': 0.6655677946714255, 'Validation Metric': {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.5302056360401606, 'Valid Loss': 0.4472486869646953, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.4010236392679967, 'Valid Loss': 0.3553532660007477, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.3621444223742736, 'Valid Loss': 0.3077655394489949, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.3255404365297995, 'Valid Loss': 0.2678023141164046, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.30480040100060013, 'Valid Loss': 0.23990022563017332, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.28042507818654966, 'Valid Loss': 0.2285792068220102, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2801819673102153, 'Valid Loss': 0.2274919476073522, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2666343983850981, 'Valid Loss': 0.2301797027198168, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.25157374074976696, 'Valid Loss': 0.2238219861800854, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.24033250728327976, 'Valid Loss': 0.2232438652561261, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.22867455294257716, 'Valid Loss': 0.2259355763403269, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.22481332964410908, 'Valid Loss': 0.22289517235297424, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.21874708388196795, 'Valid Loss': 0.22679207473993301, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.21301810884554134, 'Valid Loss': 0.22516653629449698, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.21256586909294128, 'Valid Loss': 0.22372219969446844, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.20682750980516798, 'Valid Loss': 0.22200368531048298, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2040031936607863, 'Valid Loss': 0.2222561498100941, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.20377366705552527, 'Valid Loss': 0.22212490969552443, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.08571428571428572, 'Recall': 0.6, 'F1': 0.15, 'Acc': 0.6633663366336634}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.17142857142857143, 'Recall': 0.42857142857142855, 'F1': 0.24489795918367346, 'Acc': 0.63}; Test loss: 0.6526182842254639
