Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7327314281934186, 'Valid Loss': 0.7243091922539932, 'Validation Metric': {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7253689765930176, 'Valid Loss': 0.7037070118463956, 'Validation Metric': {'Precision': 0.4878048780487805, 'Recall': 0.8695652173913043, 'F1': 0.625, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6877644634560535, 'Valid Loss': 0.686426981137349, 'Validation Metric': {'Precision': 0.5185185185185185, 'Recall': 0.30434782608695654, 'F1': 0.3835616438356165, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6713536162125436, 'Valid Loss': 0.6849511254292268, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.021739130434782608, 'F1': 0.041666666666666664, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6475937135125461, 'Valid Loss': 0.6869120299816132, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.021739130434782608, 'F1': 0.042553191489361694, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6462751795586786, 'Valid Loss': 0.6870740938645142, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.021739130434782608, 'F1': 0.042553191489361694, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6366034632450656, 'Valid Loss': 0.684448493214754, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.021739130434782608, 'F1': 0.042553191489361694, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6042597168370297, 'Valid Loss': 0.7150466430645722, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.043478260869565216, 'F1': 0.08, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5809459149053222, 'Valid Loss': 0.7147291474617444, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.17391304347826086, 'F1': 0.26666666666666666, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5213986556780966, 'Valid Loss': 0.726953020462623, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.21739130434782608, 'F1': 0.3125, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.48847122647260366, 'Valid Loss': 0.7429058941511008, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.30434782608695654, 'F1': 0.3783783783783784, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.44042395231755155, 'Valid Loss': 0.7602750395353024, 'Validation Metric': {'Precision': 0.5333333333333333, 'Recall': 0.34782608695652173, 'F1': 0.4210526315789474, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.40981315037137583, 'Valid Loss': 0.7709612857836944, 'Validation Metric': {'Precision': 0.5151515151515151, 'Recall': 0.3695652173913043, 'F1': 0.43037974683544306, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3617417202576211, 'Valid Loss': 0.7886433612841827, 'Validation Metric': {'Precision': 0.4857142857142857, 'Recall': 0.3695652173913043, 'F1': 0.4197530864197531, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3539779986205854, 'Valid Loss': 0.8048442304134369, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.3695652173913043, 'F1': 0.425, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.33218924642393466, 'Valid Loss': 0.8110593763681558, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.391304347826087, 'F1': 0.4235294117647059, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.29726202550687286, 'Valid Loss': 0.8253169460938528, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.391304347826087, 'F1': 0.4390243902439025, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3164556940135203, 'Valid Loss': 0.8289073659823492, 'Validation Metric': {'Precision': 0.5135135135135135, 'Recall': 0.41304347826086957, 'F1': 0.4578313253012048, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2899373961906684, 'Valid Loss': 0.8269670118506138, 'Validation Metric': {'Precision': 0.5151515151515151, 'Recall': 0.3695652173913043, 'F1': 0.43037974683544306, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2773787068497193, 'Valid Loss': 0.8302088781045034, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.3695652173913043, 'F1': 0.425, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}; Test loss: 0.7293875575065613
