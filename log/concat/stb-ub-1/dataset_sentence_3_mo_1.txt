Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7970390637715657, 'Valid Loss': 0.8535118974172152, 'Validation Metric': {'Precision': 0.04081632653061224, 'Recall': 0.8, 'F1': 0.07766990291262134, 'Acc': 0.0594059405940594}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.04081632653061224, 'Recall': 0.8, 'F1': 0.07766990291262134, 'Acc': 0.0594059405940594}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7152675994237264, 'Valid Loss': 0.682911386856666, 'Validation Metric': {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.5604818562666575, 'Valid Loss': 0.4761038434046965, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.4487341558933258, 'Valid Loss': 0.34746849422271436, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.40670474072297413, 'Valid Loss': 0.31572643782083804, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.3793784946203232, 'Valid Loss': 0.2766323181299063, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.36051225463549297, 'Valid Loss': 0.2551282180043367, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.3392971163988113, 'Valid Loss': 0.23988783531464064, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.32131494422753654, 'Valid Loss': 0.2314659649362931, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.30824833671251933, 'Valid Loss': 0.23291207964603716, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.28968391637007396, 'Valid Loss': 0.2380022696004464, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2823809142907461, 'Valid Loss': 0.23929004457134467, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.25799592018127443, 'Valid Loss': 0.24392018610468277, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2377474081516266, 'Valid Loss': 0.24675332496945673, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2260085928440094, 'Valid Loss': 0.22892734694939393, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.21280141562223434, 'Valid Loss': 0.2510445799965125, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.21215493669112523, 'Valid Loss': 0.23377294953052813, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9504950495049505}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.21059441626071929, 'Valid Loss': 0.23530074065694442, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.21457984586556753, 'Valid Loss': 0.24553375547895065, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19172718246777853, 'Valid Loss': 0.24577908619092062, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9405940594059405}}
Best validation metric so far: {'Precision': 0.044444444444444446, 'Recall': 0.4, 'F1': 0.07999999999999999, 'Acc': 0.5445544554455446}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.07317073170731707, 'Recall': 0.6, 'F1': 0.13043478260869565, 'Acc': 0.6039603960396039}; Test loss: 0.6796246812893794
