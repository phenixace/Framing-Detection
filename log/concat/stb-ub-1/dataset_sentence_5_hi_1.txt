Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7557665658624548, 'Valid Loss': 0.7485176301002503, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7165760311641192, 'Valid Loss': 0.6964894104003906, 'Validation Metric': {'Precision': 0.3709677419354839, 'Recall': 0.6764705882352942, 'F1': 0.47916666666666674, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6587951720545167, 'Valid Loss': 0.6525232791900635, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.058823529411764705, 'F1': 0.10256410256410256, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6138953974372462, 'Valid Loss': 0.641399291753769, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6080483017783416, 'Valid Loss': 0.6442335546016693, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5963663458824158, 'Valid Loss': 0.651194953918457, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.589836553523415, 'Valid Loss': 0.6579497802257538, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5793321869875255, 'Valid Loss': 0.6595487368106842, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5492602876926723, 'Valid Loss': 0.6599150508642196, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5139195242602574, 'Valid Loss': 0.6709501719474793, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.48422795671381447, 'Valid Loss': 0.6831890201568603, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.08823529411764706, 'F1': 0.13636363636363635, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.42630321650128616, 'Valid Loss': 0.6894512844085693, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.23529411764705882, 'F1': 0.3137254901960785, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.40227936012180227, 'Valid Loss': 0.7021948438882828, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.23529411764705882, 'F1': 0.31999999999999995, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3987723357583347, 'Valid Loss': 0.7132124173641204, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.2647058823529412, 'F1': 0.31034482758620696, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.35806020408084516, 'Valid Loss': 0.7295605099201202, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.2647058823529412, 'F1': 0.3214285714285714, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3144935061664958, 'Valid Loss': 0.7390815252065659, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.2647058823529412, 'F1': 0.3157894736842105, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2873876132071018, 'Valid Loss': 0.7530449825525284, 'Validation Metric': {'Precision': 0.36666666666666664, 'Recall': 0.3235294117647059, 'F1': 0.34375, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.28915571499811976, 'Valid Loss': 0.7477909123897553, 'Validation Metric': {'Precision': 0.45, 'Recall': 0.2647058823529412, 'F1': 0.33333333333333337, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.26299576147606496, 'Valid Loss': 0.7546148025989532, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.2647058823529412, 'F1': 0.32727272727272727, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.26829586334918676, 'Valid Loss': 0.7568526804447174, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.2647058823529412, 'F1': 0.3214285714285714, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9411764705882353, 'F1': 0.5079365079365079, 'Acc': 0.38}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2765957446808511, 'Recall': 0.9285714285714286, 'F1': 0.42622950819672134, 'Acc': 0.3}; Test loss: 0.7805064105987549
