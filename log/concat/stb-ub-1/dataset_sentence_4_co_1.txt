Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6667978677310442, 'Valid Loss': 0.677433756681589, 'Validation Metric': {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6718769183284358, 'Valid Loss': 0.6760664719801682, 'Validation Metric': {'Precision': 0.6020408163265306, 'Recall': 0.9516129032258065, 'F1': 0.7375, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6020408163265306, 'Recall': 0.9516129032258065, 'F1': 0.7375, 'Acc': 0.5841584158415841}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6698845581788766, 'Valid Loss': 0.6760227519732255, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6550109672703242, 'Valid Loss': 0.6779453399089667, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6429541197262312, 'Valid Loss': 0.6810143922383969, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.640427753329277, 'Valid Loss': 0.6821662554374108, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6265756538824031, 'Valid Loss': 0.6834365656742682, 'Validation Metric': {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6120563004361955, 'Valid Loss': 0.6896956562995911, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6019472566090132, 'Valid Loss': 0.6975993800621766, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5820368293084597, 'Valid Loss': 0.6992014692379878, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5688912374408621, 'Valid Loss': 0.7055902905189074, 'Validation Metric': {'Precision': 0.6020408163265306, 'Recall': 0.9516129032258065, 'F1': 0.7375, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5438183742134195, 'Valid Loss': 0.7060073637045347, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5229406223485344, 'Valid Loss': 0.7190400453714224, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5128408642975908, 'Valid Loss': 0.7326398709645638, 'Validation Metric': {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4780008038015742, 'Valid Loss': 0.7360221090225073, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.45753356853598043, 'Valid Loss': 0.7412789578621204, 'Validation Metric': {'Precision': 0.6129032258064516, 'Recall': 0.9193548387096774, 'F1': 0.7354838709677419, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.44633430340572405, 'Valid Loss': 0.7502632937752284, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4388318732380867, 'Valid Loss': 0.7554364187213091, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4155993745907357, 'Valid Loss': 0.7648271373831309, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4122586120900355, 'Valid Loss': 0.7687848898080679, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}; Test loss: 0.6194478762149811
