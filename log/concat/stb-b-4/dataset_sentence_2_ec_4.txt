Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7527872196743998, 'Valid Loss': 0.8026610612869263, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7435514320818226, 'Valid Loss': 0.7710942339897155, 'Validation Metric': {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7271901975187023, 'Valid Loss': 0.7326856255531311, 'Validation Metric': {'Precision': 0.42424242424242425, 'Recall': 0.9767441860465116, 'F1': 0.5915492957746479, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7035268725973837, 'Valid Loss': 0.7053345680236817, 'Validation Metric': {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6895175160986654, 'Valid Loss': 0.6906911277770996, 'Validation Metric': {'Precision': 0.47540983606557374, 'Recall': 0.6744186046511628, 'F1': 0.5576923076923077, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6716409774308794, 'Valid Loss': 0.6852201914787293, 'Validation Metric': {'Precision': 0.45652173913043476, 'Recall': 0.4883720930232558, 'F1': 0.47191011235955055, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6481875529449977, 'Valid Loss': 0.6978541040420532, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.46511627906976744, 'F1': 0.43956043956043955, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6027504949087508, 'Valid Loss': 0.7084930920600891, 'Validation Metric': {'Precision': 0.4186046511627907, 'Recall': 0.4186046511627907, 'F1': 0.4186046511627907, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5490198724725274, 'Valid Loss': 0.7206661534309388, 'Validation Metric': {'Precision': 0.3902439024390244, 'Recall': 0.37209302325581395, 'F1': 0.380952380952381, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5028876618722852, 'Valid Loss': 0.7452158331871033, 'Validation Metric': {'Precision': 0.425, 'Recall': 0.3953488372093023, 'F1': 0.40963855421686746, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.464384010668551, 'Valid Loss': 0.7670800876617432, 'Validation Metric': {'Precision': 0.4473684210526316, 'Recall': 0.3953488372093023, 'F1': 0.41975308641975306, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4229414668980609, 'Valid Loss': 0.7539071595668793, 'Validation Metric': {'Precision': 0.40540540540540543, 'Recall': 0.3488372093023256, 'F1': 0.375, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3729715916547882, 'Valid Loss': 0.7920369589328766, 'Validation Metric': {'Precision': 0.38235294117647056, 'Recall': 0.3023255813953488, 'F1': 0.33766233766233766, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.34931990621464976, 'Valid Loss': 0.789220814704895, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.3488372093023256, 'F1': 0.38461538461538464, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.33567841870061466, 'Valid Loss': 0.812174289226532, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.32558139534883723, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3050422599811233, 'Valid Loss': 0.8167683494091034, 'Validation Metric': {'Precision': 0.40625, 'Recall': 0.3023255813953488, 'F1': 0.3466666666666667, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2996318566330363, 'Valid Loss': 0.8221940970420838, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.32558139534883723, 'F1': 0.36363636363636365, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2784536288360531, 'Valid Loss': 0.8441916251182556, 'Validation Metric': {'Precision': 0.38235294117647056, 'Recall': 0.3023255813953488, 'F1': 0.33766233766233766, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2678475708941395, 'Valid Loss': 0.8537783980369568, 'Validation Metric': {'Precision': 0.37142857142857144, 'Recall': 0.3023255813953488, 'F1': 0.3333333333333333, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2540915986795104, 'Valid Loss': 0.8558098793029785, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.27906976744186046, 'F1': 0.31578947368421056, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.45054945054945056, 'Recall': 0.9534883720930233, 'F1': 0.6119402985074627, 'Acc': 0.48}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3404255319148936, 'Recall': 0.9142857142857143, 'F1': 0.49612403100775193, 'Acc': 0.3564356435643564}; Test loss: 0.7363457244176131
