Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7484351670742035, 'Valid Loss': 0.6241526844409796, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7362906989455223, 'Valid Loss': 0.6293767392635345, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7172735923528671, 'Valid Loss': 0.6478685163534604, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.698432525396347, 'Valid Loss': 0.6739929845699897, 'Validation Metric': {'Precision': 0.7032967032967034, 'Recall': 0.8888888888888888, 'F1': 0.7852760736196318, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.685212527513504, 'Valid Loss': 0.6974361401337844, 'Validation Metric': {'Precision': 0.7037037037037037, 'Recall': 0.5277777777777778, 'F1': 0.6031746031746033, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6857824718952179, 'Valid Loss': 0.714807716699747, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.4305555555555556, 'F1': 0.5210084033613445, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6258978310227394, 'Valid Loss': 0.7326662998933059, 'Validation Metric': {'Precision': 0.6792452830188679, 'Recall': 0.5, 'F1': 0.5760000000000001, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5392867131531238, 'Valid Loss': 0.7574760845074286, 'Validation Metric': {'Precision': 0.673469387755102, 'Recall': 0.4583333333333333, 'F1': 0.5454545454545454, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4776111149787903, 'Valid Loss': 0.7863255819449058, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 0.4444444444444444, 'F1': 0.5289256198347106, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4163788625597954, 'Valid Loss': 0.7927116264517491, 'Validation Metric': {'Precision': 0.6346153846153846, 'Recall': 0.4583333333333333, 'F1': 0.532258064516129, 'Acc': 0.42574257425742573}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.34136209115386007, 'Valid Loss': 0.8290646253870084, 'Validation Metric': {'Precision': 0.6346153846153846, 'Recall': 0.4583333333333333, 'F1': 0.532258064516129, 'Acc': 0.42574257425742573}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.30317824698984625, 'Valid Loss': 0.8298843199243913, 'Validation Metric': {'Precision': 0.660377358490566, 'Recall': 0.4861111111111111, 'F1': 0.56, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.25347036942839624, 'Valid Loss': 0.84464420320896, 'Validation Metric': {'Precision': 0.6481481481481481, 'Recall': 0.4861111111111111, 'F1': 0.5555555555555555, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.23484312452375888, 'Valid Loss': 0.8629767894744873, 'Validation Metric': {'Precision': 0.6415094339622641, 'Recall': 0.4722222222222222, 'F1': 0.5439999999999999, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.21548203833401203, 'Valid Loss': 0.8651127947064546, 'Validation Metric': {'Precision': 0.6607142857142857, 'Recall': 0.5138888888888888, 'F1': 0.578125, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2034863205254078, 'Valid Loss': 0.8485766580471625, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.5277777777777778, 'F1': 0.5937499999999999, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.17955793891102076, 'Valid Loss': 0.866358784528879, 'Validation Metric': {'Precision': 0.6724137931034483, 'Recall': 0.5416666666666666, 'F1': 0.6, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1537541899830103, 'Valid Loss': 0.8654347199660081, 'Validation Metric': {'Precision': 0.6833333333333333, 'Recall': 0.5694444444444444, 'F1': 0.6212121212121212, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16002152107656, 'Valid Loss': 0.8637479280049984, 'Validation Metric': {'Precision': 0.6885245901639344, 'Recall': 0.5833333333333334, 'F1': 0.631578947368421, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17144950974732637, 'Valid Loss': 0.8669111866217393, 'Validation Metric': {'Precision': 0.6885245901639344, 'Recall': 0.5833333333333334, 'F1': 0.631578947368421, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6138613861386139, 'Recall': 1.0, 'F1': 0.7607361963190183, 'Acc': 0.6138613861386139}; Test loss: 0.6910741420892569
