Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7503590893435788, 'Valid Loss': 0.7481792053351035, 'Validation Metric': {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7464500986910486, 'Valid Loss': 0.7307303822957553, 'Validation Metric': {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7170917182773738, 'Valid Loss': 0.7120901988102839, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.9811320754716981, 'F1': 0.6797385620915032, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6991557478904724, 'Valid Loss': 0.7017699434207036, 'Validation Metric': {'Precision': 0.5257731958762887, 'Recall': 0.9622641509433962, 'F1': 0.68, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6929520593061076, 'Valid Loss': 0.6979022874281957, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.8113207547169812, 'F1': 0.6187050359712231, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6851409805285467, 'Valid Loss': 0.6974111107679514, 'Validation Metric': {'Precision': 0.4714285714285714, 'Recall': 0.6226415094339622, 'F1': 0.5365853658536586, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6715870073863438, 'Valid Loss': 0.6942863968702463, 'Validation Metric': {'Precision': 0.49230769230769234, 'Recall': 0.6037735849056604, 'F1': 0.5423728813559323, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6524540464599411, 'Valid Loss': 0.6970885396003723, 'Validation Metric': {'Precision': 0.5263157894736842, 'Recall': 0.5660377358490566, 'F1': 0.5454545454545455, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6333506893027913, 'Valid Loss': 0.6995064547428718, 'Validation Metric': {'Precision': 0.5094339622641509, 'Recall': 0.5094339622641509, 'F1': 0.5094339622641509, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6011599569351642, 'Valid Loss': 0.7081978137676532, 'Validation Metric': {'Precision': 0.5526315789473685, 'Recall': 0.39622641509433965, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5883075633606354, 'Valid Loss': 0.7082767234398768, 'Validation Metric': {'Precision': 0.5652173913043478, 'Recall': 0.49056603773584906, 'F1': 0.5252525252525252, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5502070366562187, 'Valid Loss': 0.7084227318947132, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.4716981132075472, 'F1': 0.5102040816326532, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5209112987889872, 'Valid Loss': 0.712376288496531, 'Validation Metric': {'Precision': 0.5681818181818182, 'Recall': 0.4716981132075472, 'F1': 0.5154639175257733, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.49336860861097065, 'Valid Loss': 0.7111194030596659, 'Validation Metric': {'Precision': 0.5777777777777777, 'Recall': 0.49056603773584906, 'F1': 0.5306122448979591, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4767715358114862, 'Valid Loss': 0.7105859816074371, 'Validation Metric': {'Precision': 0.5957446808510638, 'Recall': 0.5283018867924528, 'F1': 0.56, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.43531015515327454, 'Valid Loss': 0.7163438212413055, 'Validation Metric': {'Precision': 0.5918367346938775, 'Recall': 0.5471698113207547, 'F1': 0.5686274509803921, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4243438530277896, 'Valid Loss': 0.7158268162837396, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.5283018867924528, 'F1': 0.5544554455445545, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4137800109463853, 'Valid Loss': 0.7173473857916318, 'Validation Metric': {'Precision': 0.574468085106383, 'Recall': 0.5094339622641509, 'F1': 0.54, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.401785803886203, 'Valid Loss': 0.7190074083896784, 'Validation Metric': {'Precision': 0.574468085106383, 'Recall': 0.5094339622641509, 'F1': 0.54, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.39965750528620436, 'Valid Loss': 0.7202444133850244, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.5283018867924528, 'F1': 0.5544554455445545, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5247524752475248, 'Recall': 1.0, 'F1': 0.6883116883116883, 'Acc': 0.5247524752475248}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}; Test loss: 0.7265039694309234
