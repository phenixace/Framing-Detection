Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7440684507290523, 'Valid Loss': 0.8794547411111685, 'Validation Metric': {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7392882449759377, 'Valid Loss': 0.8367494642734528, 'Validation Metric': {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.71937528749307, 'Valid Loss': 0.7820382026525644, 'Validation Metric': {'Precision': 0.34, 'Recall': 0.9714285714285714, 'F1': 0.5037037037037038, 'Acc': 0.33663366336633666}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7027196413940854, 'Valid Loss': 0.741139638882417, 'Validation Metric': {'Precision': 0.3229166666666667, 'Recall': 0.8857142857142857, 'F1': 0.47328244274809156, 'Acc': 0.31683168316831684}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6809963312413957, 'Valid Loss': 0.7151848100698911, 'Validation Metric': {'Precision': 0.352112676056338, 'Recall': 0.7142857142857143, 'F1': 0.47169811320754707, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6661726391977734, 'Valid Loss': 0.6997191676726708, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.5714285714285714, 'F1': 0.4597701149425288, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6349183470010757, 'Valid Loss': 0.6974580035759852, 'Validation Metric': {'Precision': 0.34545454545454546, 'Recall': 0.5428571428571428, 'F1': 0.4222222222222222, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.590476092033916, 'Valid Loss': 0.7046453517216903, 'Validation Metric': {'Precision': 0.36538461538461536, 'Recall': 0.5428571428571428, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5394245197375616, 'Valid Loss': 0.7115394037503463, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.42857142857142855, 'F1': 0.3529411764705882, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4959589754541715, 'Valid Loss': 0.7284052005180945, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4857142857142857, 'F1': 0.3953488372093023, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.446405234767331, 'Valid Loss': 0.7471470580651209, 'Validation Metric': {'Precision': 0.2916666666666667, 'Recall': 0.4, 'F1': 0.3373493975903615, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.411961207124922, 'Valid Loss': 0.7500624152330252, 'Validation Metric': {'Precision': 0.35555555555555557, 'Recall': 0.45714285714285713, 'F1': 0.4, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3597682539787557, 'Valid Loss': 0.7751518396230844, 'Validation Metric': {'Precision': 0.32653061224489793, 'Recall': 0.45714285714285713, 'F1': 0.3809523809523809, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.31345167979598043, 'Valid Loss': 0.7967996826538672, 'Validation Metric': {'Precision': 0.3409090909090909, 'Recall': 0.42857142857142855, 'F1': 0.379746835443038, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2933252783285247, 'Valid Loss': 0.8032470758144672, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.42857142857142855, 'F1': 0.375, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.28782324542601906, 'Valid Loss': 0.810911660010998, 'Validation Metric': {'Precision': 0.3409090909090909, 'Recall': 0.42857142857142855, 'F1': 0.379746835443038, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.25072959628370073, 'Valid Loss': 0.821874161179249, 'Validation Metric': {'Precision': 0.30952380952380953, 'Recall': 0.37142857142857144, 'F1': 0.33766233766233766, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.23487786220179663, 'Valid Loss': 0.8312213054070106, 'Validation Metric': {'Precision': 0.35555555555555557, 'Recall': 0.45714285714285713, 'F1': 0.4, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.23619466366039382, 'Valid Loss': 0.8381873609927984, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.45714285714285713, 'F1': 0.3950617283950617, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.22015817049476835, 'Valid Loss': 0.8453880433852856, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.45714285714285713, 'F1': 0.3950617283950617, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.3465346534653465, 'Recall': 1.0, 'F1': 0.5147058823529412, 'Acc': 0.3465346534653465}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.45544554455445546, 'Recall': 1.0, 'F1': 0.6258503401360545, 'Acc': 0.45544554455445546}; Test loss: 0.8121619797669924
