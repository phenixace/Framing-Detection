Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7494246369660503, 'Valid Loss': 0.642478140592575, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7377507716718347, 'Valid Loss': 0.6428815460205078, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7098573672048973, 'Valid Loss': 0.6539218473434448, 'Validation Metric': {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6987037776094495, 'Valid Loss': 0.6717326188087464, 'Validation Metric': {'Precision': 0.654320987654321, 'Recall': 0.8153846153846154, 'F1': 0.726027397260274, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6771952672438188, 'Valid Loss': 0.6878056716918945, 'Validation Metric': {'Precision': 0.6956521739130435, 'Recall': 0.49230769230769234, 'F1': 0.5765765765765766, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6694420910242832, 'Valid Loss': 0.6966493844985961, 'Validation Metric': {'Precision': 0.717948717948718, 'Recall': 0.4307692307692308, 'F1': 0.5384615384615385, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.633519683823441, 'Valid Loss': 0.6983367252349854, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.36923076923076925, 'F1': 0.4848484848484848, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5669004835865714, 'Valid Loss': 0.708041877746582, 'Validation Metric': {'Precision': 0.6470588235294118, 'Recall': 0.3384615384615385, 'F1': 0.4444444444444445, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.48743027373395786, 'Valid Loss': 0.7343730616569519, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.3230769230769231, 'F1': 0.4516129032258065, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.41499895655145547, 'Valid Loss': 0.7479691457748413, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.4153846153846154, 'F1': 0.5046728971962617, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.36344601650430697, 'Valid Loss': 0.7549276220798492, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.4307692307692308, 'F1': 0.5233644859813084, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.31652619260730164, 'Valid Loss': 0.7517484962940216, 'Validation Metric': {'Precision': 0.6976744186046512, 'Recall': 0.46153846153846156, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.26586999608711764, 'Valid Loss': 0.7497187280654907, 'Validation Metric': {'Precision': 0.6521739130434783, 'Recall': 0.46153846153846156, 'F1': 0.5405405405405406, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2537991667185167, 'Valid Loss': 0.7320653545856476, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.5538461538461539, 'F1': 0.6153846153846154, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.23681839130292034, 'Valid Loss': 0.7323210859298706, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.5538461538461539, 'F1': 0.6206896551724139, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2034304333907185, 'Valid Loss': 0.699205195903778, 'Validation Metric': {'Precision': 0.7090909090909091, 'Recall': 0.6, 'F1': 0.65, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18821293416649404, 'Valid Loss': 0.7095430684089661, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.6153846153846154, 'F1': 0.6611570247933884, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18841386533746815, 'Valid Loss': 0.6988713121414185, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.6153846153846154, 'F1': 0.6611570247933884, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17582306762536368, 'Valid Loss': 0.6936555886268616, 'Validation Metric': {'Precision': 0.7192982456140351, 'Recall': 0.6307692307692307, 'F1': 0.6721311475409837, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17194093496660995, 'Valid Loss': 0.6928459477424621, 'Validation Metric': {'Precision': 0.7321428571428571, 'Recall': 0.6307692307692307, 'F1': 0.6776859504132231, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}; Test loss: 0.6241526844409796
