Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7585015708594014, 'Valid Loss': 1.0288102436065674, 'Validation Metric': {'Precision': 0.11, 'Recall': 1.0, 'F1': 0.19819819819819817, 'Acc': 0.11}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11, 'Recall': 1.0, 'F1': 0.19819819819819817, 'Acc': 0.11}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7586053241071083, 'Valid Loss': 0.9510584807395935, 'Validation Metric': {'Precision': 0.11, 'Recall': 1.0, 'F1': 0.19819819819819817, 'Acc': 0.11}}
Best validation metric so far: {'Precision': 0.11, 'Recall': 1.0, 'F1': 0.19819819819819817, 'Acc': 0.11}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7345636429117738, 'Valid Loss': 0.8595351314544678, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 1.0, 'F1': 0.19999999999999998, 'Acc': 0.12}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1111111111111111, 'Recall': 1.0, 'F1': 0.19999999999999998, 'Acc': 0.12}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6986842464200027, 'Valid Loss': 0.8073523187637329, 'Validation Metric': {'Precision': 0.10752688172043011, 'Recall': 0.9090909090909091, 'F1': 0.1923076923076923, 'Acc': 0.16}}
Best validation metric so far: {'Precision': 0.1111111111111111, 'Recall': 1.0, 'F1': 0.19999999999999998, 'Acc': 0.12}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.651136631588284, 'Valid Loss': 0.794123318195343, 'Validation Metric': {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5461330153316045, 'Valid Loss': 0.924283435344696, 'Validation Metric': {'Precision': 0.10843373493975904, 'Recall': 0.8181818181818182, 'F1': 0.19148936170212766, 'Acc': 0.24}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.43384657199863047, 'Valid Loss': 0.7358351957798004, 'Validation Metric': {'Precision': 0.07317073170731707, 'Recall': 0.2727272727272727, 'F1': 0.11538461538461536, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.3026774801689086, 'Valid Loss': 0.7277539575099945, 'Validation Metric': {'Precision': 0.07142857142857142, 'Recall': 0.2727272727272727, 'F1': 0.11320754716981131, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2076328144603067, 'Valid Loss': 0.7806022739410401, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 0.2727272727272727, 'F1': 0.0967741935483871, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.1648315869593363, 'Valid Loss': 0.7075117886066437, 'Validation Metric': {'Precision': 0.08571428571428572, 'Recall': 0.2727272727272727, 'F1': 0.13043478260869562, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.12261390393908075, 'Valid Loss': 0.566577712893486, 'Validation Metric': {'Precision': 0.15, 'Recall': 0.2727272727272727, 'F1': 0.19354838709677416, 'Acc': 0.75}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.09806252530903267, 'Valid Loss': 0.5041879898309708, 'Validation Metric': {'Precision': 0.07142857142857142, 'Recall': 0.09090909090909091, 'F1': 0.08, 'Acc': 0.77}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.08312600374007396, 'Valid Loss': 0.4630014133453369, 'Validation Metric': {'Precision': 0.1, 'Recall': 0.09090909090909091, 'F1': 0.09523809523809525, 'Acc': 0.81}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.06969972886145115, 'Valid Loss': 0.44927308812737465, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 0.09090909090909091, 'F1': 0.09999999999999999, 'Acc': 0.82}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.0648864166368898, 'Valid Loss': 0.4072435811161995, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.09090909090909091, 'F1': 0.13333333333333333, 'Acc': 0.87}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.05032143551561472, 'Valid Loss': 0.4251182571798563, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.09090909090909091, 'F1': 0.13333333333333333, 'Acc': 0.87}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.04945649985197208, 'Valid Loss': 0.40272619158029554, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.09090909090909091, 'F1': 0.13333333333333333, 'Acc': 0.87}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.04138552472531367, 'Valid Loss': 0.4037129807472229, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.09090909090909091, 'F1': 0.13333333333333333, 'Acc': 0.87}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.03872300855306198, 'Valid Loss': 0.3993805178999901, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.09090909090909091, 'F1': 0.14285714285714288, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.042175876485894055, 'Valid Loss': 0.39680126279592515, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.09090909090909091, 'F1': 0.14285714285714288, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.11538461538461539, 'Recall': 0.8181818181818182, 'F1': 0.20224719101123595, 'Acc': 0.29}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.08791208791208792, 'Recall': 0.8888888888888888, 'F1': 0.16, 'Acc': 0.16}; Test loss: 0.7962979412078858
