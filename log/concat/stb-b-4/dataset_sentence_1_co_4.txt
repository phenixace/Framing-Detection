Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7540969703961344, 'Valid Loss': 0.6554999923706055, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.740544873533897, 'Valid Loss': 0.6551005399227142, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7146691775437698, 'Valid Loss': 0.6645736646652222, 'Validation Metric': {'Precision': 0.6326530612244898, 'Recall': 0.96875, 'F1': 0.7654320987654322, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6973966412173892, 'Valid Loss': 0.6818889617919922, 'Validation Metric': {'Precision': 0.620253164556962, 'Recall': 0.765625, 'F1': 0.6853146853146853, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6813122210572067, 'Valid Loss': 0.6977683448791504, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.46875, 'F1': 0.5660377358490566, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.678995155015038, 'Valid Loss': 0.7078947305679322, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.375, 'F1': 0.5, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6416161152922991, 'Valid Loss': 0.7039632272720336, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.46875, 'F1': 0.5660377358490566, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.571971730699817, 'Valid Loss': 0.763056128025055, 'Validation Metric': {'Precision': 0.6341463414634146, 'Recall': 0.40625, 'F1': 0.4952380952380952, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.49630436662910055, 'Valid Loss': 0.7757588362693787, 'Validation Metric': {'Precision': 0.59375, 'Recall': 0.296875, 'F1': 0.3958333333333333, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4208211470576166, 'Valid Loss': 0.7985099601745606, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.296875, 'F1': 0.41304347826086957, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3603982207121201, 'Valid Loss': 0.7851760458946228, 'Validation Metric': {'Precision': 0.6304347826086957, 'Recall': 0.453125, 'F1': 0.5272727272727272, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.30609788550335226, 'Valid Loss': 0.7975111389160157, 'Validation Metric': {'Precision': 0.6341463414634146, 'Recall': 0.40625, 'F1': 0.4952380952380952, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2685992528223297, 'Valid Loss': 0.8119290769100189, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.4375, 'F1': 0.5185185185185185, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2503666091457154, 'Valid Loss': 0.8084461903572082, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.484375, 'F1': 0.5535714285714286, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.20978772365352483, 'Valid Loss': 0.819930979013443, 'Validation Metric': {'Precision': 0.6415094339622641, 'Recall': 0.53125, 'F1': 0.5811965811965812, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.20585654726595554, 'Valid Loss': 0.8318279564380646, 'Validation Metric': {'Precision': 0.640625, 'Recall': 0.640625, 'F1': 0.640625, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19295825997313248, 'Valid Loss': 0.8406548070907592, 'Validation Metric': {'Precision': 0.640625, 'Recall': 0.640625, 'F1': 0.640625, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1707955062823388, 'Valid Loss': 0.845678129196167, 'Validation Metric': {'Precision': 0.6461538461538462, 'Recall': 0.65625, 'F1': 0.6511627906976746, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16036372082036676, 'Valid Loss': 0.8531353610754013, 'Validation Metric': {'Precision': 0.6461538461538462, 'Recall': 0.65625, 'F1': 0.6511627906976746, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1470464299821738, 'Valid Loss': 0.8556003296375274, 'Validation Metric': {'Precision': 0.6461538461538462, 'Recall': 0.65625, 'F1': 0.6511627906976746, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}; Test loss: 0.642478140592575
