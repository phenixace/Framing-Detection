Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7523663110947341, 'Valid Loss': 0.8705943155288697, 'Validation Metric': {'Precision': 0.35, 'Recall': 1.0, 'F1': 0.5185185185185185, 'Acc': 0.35}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.35, 'Recall': 1.0, 'F1': 0.5185185185185185, 'Acc': 0.35}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7526566667503185, 'Valid Loss': 0.8261387753486633, 'Validation Metric': {'Precision': 0.35, 'Recall': 1.0, 'F1': 0.5185185185185185, 'Acc': 0.35}}
Best validation metric so far: {'Precision': 0.35, 'Recall': 1.0, 'F1': 0.5185185185185185, 'Acc': 0.35}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.722893778192863, 'Valid Loss': 0.7726047658920288, 'Validation Metric': {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7041303736440251, 'Valid Loss': 0.7317592453956604, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6861748447578945, 'Valid Loss': 0.7126290488243103, 'Validation Metric': {'Precision': 0.37333333333333335, 'Recall': 0.8, 'F1': 0.5090909090909091, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6722341521402423, 'Valid Loss': 0.7076640892028808, 'Validation Metric': {'Precision': 0.3103448275862069, 'Recall': 0.5142857142857142, 'F1': 0.38709677419354843, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6470374940486436, 'Valid Loss': 0.7051566076278687, 'Validation Metric': {'Precision': 0.3018867924528302, 'Recall': 0.45714285714285713, 'F1': 0.3636363636363636, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.620327420448989, 'Valid Loss': 0.7063642764091491, 'Validation Metric': {'Precision': 0.33962264150943394, 'Recall': 0.5142857142857142, 'F1': 0.40909090909090906, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5789735344018829, 'Valid Loss': 0.7055484557151794, 'Validation Metric': {'Precision': 0.36, 'Recall': 0.5142857142857142, 'F1': 0.4235294117647058, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5326827925242735, 'Valid Loss': 0.7176755023002624, 'Validation Metric': {'Precision': 0.32558139534883723, 'Recall': 0.4, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.48342455371042314, 'Valid Loss': 0.7228445076942444, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.5142857142857142, 'F1': 0.43373493975903615, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4522045509199078, 'Valid Loss': 0.7267072546482086, 'Validation Metric': {'Precision': 0.3191489361702128, 'Recall': 0.42857142857142855, 'F1': 0.36585365853658536, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.39393776052453544, 'Valid Loss': 0.7386513006687164, 'Validation Metric': {'Precision': 0.3684210526315789, 'Recall': 0.4, 'F1': 0.3835616438356164, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3668271800440349, 'Valid Loss': 0.747969491481781, 'Validation Metric': {'Precision': 0.35, 'Recall': 0.4, 'F1': 0.3733333333333333, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.33311195470643845, 'Valid Loss': 0.7578104114532471, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4, 'F1': 0.3636363636363636, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3050989687777637, 'Valid Loss': 0.7707094550132751, 'Validation Metric': {'Precision': 0.34146341463414637, 'Recall': 0.4, 'F1': 0.368421052631579, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.29136289614305066, 'Valid Loss': 0.7771284067630768, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.42857142857142855, 'F1': 0.38961038961038963, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2691715889599886, 'Valid Loss': 0.7828138887882232, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.42857142857142855, 'F1': 0.38961038961038963, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.27396099997705287, 'Valid Loss': 0.7860514569282532, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4, 'F1': 0.37837837837837845, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2771393959776739, 'Valid Loss': 0.7867191362380982, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.42857142857142855, 'F1': 0.38961038961038963, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.35353535353535354, 'Recall': 1.0, 'F1': 0.5223880597014925, 'Acc': 0.36}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}; Test loss: 0.7306635999679565
