Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7472219046043314, 'Valid Loss': 1.0813217667432933, 'Validation Metric': {'Precision': 0.04950495049504951, 'Recall': 1.0, 'F1': 0.09433962264150944, 'Acc': 0.04950495049504951}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.04950495049504951, 'Recall': 1.0, 'F1': 0.09433962264150944, 'Acc': 0.04950495049504951}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7499588838090068, 'Valid Loss': 0.9988020131221185, 'Validation Metric': {'Precision': 0.04950495049504951, 'Recall': 1.0, 'F1': 0.09433962264150944, 'Acc': 0.04950495049504951}}
Best validation metric so far: {'Precision': 0.04950495049504951, 'Recall': 1.0, 'F1': 0.09433962264150944, 'Acc': 0.04950495049504951}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7235482872828193, 'Valid Loss': 0.9051404022253476, 'Validation Metric': {'Precision': 0.04950495049504951, 'Recall': 1.0, 'F1': 0.09433962264150944, 'Acc': 0.04950495049504951}}
Best validation metric so far: {'Precision': 0.04950495049504951, 'Recall': 1.0, 'F1': 0.09433962264150944, 'Acc': 0.04950495049504951}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6843598590812822, 'Valid Loss': 0.8556420184098757, 'Validation Metric': {'Precision': 0.05154639175257732, 'Recall': 1.0, 'F1': 0.0980392156862745, 'Acc': 0.0891089108910891}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.05154639175257732, 'Recall': 1.0, 'F1': 0.0980392156862745, 'Acc': 0.0891089108910891}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6331383093543674, 'Valid Loss': 0.8650833139052758, 'Validation Metric': {'Precision': 0.03260869565217391, 'Recall': 0.6, 'F1': 0.06185567010309278, 'Acc': 0.09900990099009901}}
Best validation metric so far: {'Precision': 0.05154639175257732, 'Recall': 1.0, 'F1': 0.0980392156862745, 'Acc': 0.0891089108910891}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5380483853860177, 'Valid Loss': 0.9188201610858624, 'Validation Metric': {'Precision': 0.03896103896103896, 'Recall': 0.6, 'F1': 0.07317073170731707, 'Acc': 0.24752475247524752}}
Best validation metric so far: {'Precision': 0.05154639175257732, 'Recall': 1.0, 'F1': 0.0980392156862745, 'Acc': 0.0891089108910891}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.42616847006307135, 'Valid Loss': 0.7829730212688446, 'Validation Metric': {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.30299806767615717, 'Valid Loss': 0.623284175992012, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.21958773334821066, 'Valid Loss': 0.5604980507722268, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6831683168316832}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.161185411007508, 'Valid Loss': 0.5325548115831155, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7326732673267327}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.11962966126916201, 'Valid Loss': 0.5137612372636795, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7425742574257426}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.0952672270545061, 'Valid Loss': 0.5055355635973123, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7623762376237624}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.07885883508277113, 'Valid Loss': 0.4863337567792489, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.07129544980716014, 'Valid Loss': 0.47281244511787707, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.06251607341286929, 'Valid Loss': 0.4633342451774157, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.05477621548039758, 'Valid Loss': 0.4600034404832583, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7920792079207921}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.04831891643234353, 'Valid Loss': 0.46489154919981956, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7920792079207921}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.044863510390986565, 'Valid Loss': 0.4649010062790834, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.045250241226260215, 'Valid Loss': 0.4623858177891144, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.801980198019802}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.041702518577053066, 'Valid Loss': 0.46353487039987856, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.801980198019802}}
Best validation metric so far: {'Precision': 0.05660377358490566, 'Recall': 0.6, 'F1': 0.10344827586206896, 'Acc': 0.48514851485148514}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.14285714285714285, 'Recall': 0.5, 'F1': 0.22222222222222224, 'Acc': 0.51}; Test loss: 0.7297813129425049
