Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7526166242889211, 'Valid Loss': 0.7265039694309234, 'Validation Metric': {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7485678859903843, 'Valid Loss': 0.7118715488910675, 'Validation Metric': {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7223258954060229, 'Valid Loss': 0.6975058913230896, 'Validation Metric': {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7020836080176921, 'Valid Loss': 0.6902451539039611, 'Validation Metric': {'Precision': 0.5353535353535354, 'Recall': 0.9814814814814815, 'F1': 0.6928104575163399, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7017508752738373, 'Valid Loss': 0.688484160900116, 'Validation Metric': {'Precision': 0.550561797752809, 'Recall': 0.9074074074074074, 'F1': 0.6853146853146853, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6911271312568761, 'Valid Loss': 0.6886207675933838, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.7777777777777778, 'F1': 0.6511627906976745, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6816863447804994, 'Valid Loss': 0.6882707691192627, 'Validation Metric': {'Precision': 0.5692307692307692, 'Recall': 0.6851851851851852, 'F1': 0.6218487394957983, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6609950329684005, 'Valid Loss': 0.6871359395980835, 'Validation Metric': {'Precision': 0.5967741935483871, 'Recall': 0.6851851851851852, 'F1': 0.6379310344827587, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6350229556047464, 'Valid Loss': 0.6880064940452576, 'Validation Metric': {'Precision': 0.576271186440678, 'Recall': 0.6296296296296297, 'F1': 0.6017699115044248, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6069915739795829, 'Valid Loss': 0.6823749780654907, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.6666666666666666, 'F1': 0.631578947368421, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.569989904572692, 'Valid Loss': 0.6897829079627991, 'Validation Metric': {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5268025296398356, 'Valid Loss': 0.6842152786254883, 'Validation Metric': {'Precision': 0.6181818181818182, 'Recall': 0.6296296296296297, 'F1': 0.6238532110091743, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4919110672383369, 'Valid Loss': 0.6895594453811645, 'Validation Metric': {'Precision': 0.6274509803921569, 'Recall': 0.5925925925925926, 'F1': 0.6095238095238096, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.45079350622394415, 'Valid Loss': 0.6898832380771637, 'Validation Metric': {'Precision': 0.5892857142857143, 'Recall': 0.6111111111111112, 'F1': 0.6, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4152234396602534, 'Valid Loss': 0.6950805413722992, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.6296296296296297, 'F1': 0.6181818181818182, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3937600502107717, 'Valid Loss': 0.696446965932846, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.6296296296296297, 'F1': 0.6181818181818182, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.38131168220616596, 'Valid Loss': 0.7007981085777283, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.6296296296296297, 'F1': 0.6296296296296297, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3567800965112976, 'Valid Loss': 0.6987794065475463, 'Validation Metric': {'Precision': 0.603448275862069, 'Recall': 0.6481481481481481, 'F1': 0.625, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3508470273470577, 'Valid Loss': 0.703304283618927, 'Validation Metric': {'Precision': 0.5964912280701754, 'Recall': 0.6296296296296297, 'F1': 0.6126126126126126, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.33340487393397317, 'Valid Loss': 0.7044428408145904, 'Validation Metric': {'Precision': 0.5964912280701754, 'Recall': 0.6296296296296297, 'F1': 0.6126126126126126, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 1.0, 'F1': 0.7012987012987013, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.43, 'Recall': 1.0, 'F1': 0.6013986013986015, 'Acc': 0.43}; Test loss: 0.7991628062725067
