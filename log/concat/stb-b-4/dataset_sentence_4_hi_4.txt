Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7453191879196702, 'Valid Loss': 0.8847658851971993, 'Validation Metric': {'Precision': 0.31683168316831684, 'Recall': 1.0, 'F1': 0.48120300751879697, 'Acc': 0.31683168316831684}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.31683168316831684, 'Recall': 1.0, 'F1': 0.48120300751879697, 'Acc': 0.31683168316831684}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7491562121382384, 'Valid Loss': 0.8363540837397943, 'Validation Metric': {'Precision': 0.31683168316831684, 'Recall': 1.0, 'F1': 0.48120300751879697, 'Acc': 0.31683168316831684}}
Best validation metric so far: {'Precision': 0.31683168316831684, 'Recall': 1.0, 'F1': 0.48120300751879697, 'Acc': 0.31683168316831684}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7309770728940161, 'Valid Loss': 0.7804531707213476, 'Validation Metric': {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32673267326732675}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32673267326732675}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.707350833393703, 'Valid Loss': 0.7418622878881601, 'Validation Metric': {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6827722475907513, 'Valid Loss': 0.7283100646275741, 'Validation Metric': {'Precision': 0.3411764705882353, 'Recall': 0.90625, 'F1': 0.4957264957264957, 'Acc': 0.4158415841584158}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.666534097673737, 'Valid Loss': 0.7357701498728532, 'Validation Metric': {'Precision': 0.325, 'Recall': 0.8125, 'F1': 0.46428571428571436, 'Acc': 0.40594059405940597}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6279824136573577, 'Valid Loss': 0.7467269897460938, 'Validation Metric': {'Precision': 0.3013698630136986, 'Recall': 0.6875, 'F1': 0.41904761904761906, 'Acc': 0.39603960396039606}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.574794223653936, 'Valid Loss': 0.7428854233943499, 'Validation Metric': {'Precision': 0.31746031746031744, 'Recall': 0.625, 'F1': 0.42105263157894735, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4994935125948113, 'Valid Loss': 0.7587030782149389, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.5, 'F1': 0.4, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.41726920231480463, 'Valid Loss': 0.7761799291922495, 'Validation Metric': {'Precision': 0.32, 'Recall': 0.5, 'F1': 0.39024390243902435, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.346088601189239, 'Valid Loss': 0.7880824070710403, 'Validation Metric': {'Precision': 0.3148148148148148, 'Recall': 0.53125, 'F1': 0.3953488372093023, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.29948967333151916, 'Valid Loss': 0.7926435974928049, 'Validation Metric': {'Precision': 0.32653061224489793, 'Recall': 0.5, 'F1': 0.39506172839506176, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.24974414476445903, 'Valid Loss': 0.8058132403171979, 'Validation Metric': {'Precision': 0.3409090909090909, 'Recall': 0.46875, 'F1': 0.39473684210526316, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.22338006290319923, 'Valid Loss': 0.8098125148278016, 'Validation Metric': {'Precision': 0.3488372093023256, 'Recall': 0.46875, 'F1': 0.4000000000000001, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.21223304065588477, 'Valid Loss': 0.8293317487606635, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.46875, 'F1': 0.40540540540540543, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1940524001544881, 'Valid Loss': 0.8369892629293295, 'Validation Metric': {'Precision': 0.34146341463414637, 'Recall': 0.4375, 'F1': 0.3835616438356165, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.16832119139416196, 'Valid Loss': 0.8266119636022128, 'Validation Metric': {'Precision': 0.32558139534883723, 'Recall': 0.4375, 'F1': 0.37333333333333335, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.16814476512720652, 'Valid Loss': 0.8319032077605908, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4375, 'F1': 0.37837837837837834, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.14791042820733286, 'Valid Loss': 0.8355085918536553, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4375, 'F1': 0.37837837837837834, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.15328125968993267, 'Valid Loss': 0.8324016504562818, 'Validation Metric': {'Precision': 0.3170731707317073, 'Recall': 0.40625, 'F1': 0.3561643835616438, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.3368421052631579, 'Recall': 1.0, 'F1': 0.5039370078740157, 'Acc': 0.37623762376237624}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3333333333333333, 'Recall': 0.9117647058823529, 'F1': 0.4881889763779527, 'Acc': 0.35}; Test loss: 0.7403533935546875
