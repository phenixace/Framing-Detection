Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7530889167235448, 'Valid Loss': 0.9139185500144958, 'Validation Metric': {'Precision': 0.28, 'Recall': 1.0, 'F1': 0.43750000000000006, 'Acc': 0.28}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.28, 'Recall': 1.0, 'F1': 0.43750000000000006, 'Acc': 0.28}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.755038742835705, 'Valid Loss': 0.859710783958435, 'Validation Metric': {'Precision': 0.28, 'Recall': 1.0, 'F1': 0.43750000000000006, 'Acc': 0.28}}
Best validation metric so far: {'Precision': 0.28, 'Recall': 1.0, 'F1': 0.43750000000000006, 'Acc': 0.28}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7391265378548548, 'Valid Loss': 0.7957669973373414, 'Validation Metric': {'Precision': 0.2828282828282828, 'Recall': 1.0, 'F1': 0.4409448818897638, 'Acc': 0.29}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2828282828282828, 'Recall': 1.0, 'F1': 0.4409448818897638, 'Acc': 0.29}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7195290946043454, 'Valid Loss': 0.7470778226852417, 'Validation Metric': {'Precision': 0.2708333333333333, 'Recall': 0.9285714285714286, 'F1': 0.41935483870967744, 'Acc': 0.28}}
Best validation metric so far: {'Precision': 0.2828282828282828, 'Recall': 1.0, 'F1': 0.4409448818897638, 'Acc': 0.29}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6946871624543116, 'Valid Loss': 0.7206228947639466, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.6785714285714286, 'F1': 0.36538461538461536, 'Acc': 0.34}}
Best validation metric so far: {'Precision': 0.2828282828282828, 'Recall': 1.0, 'F1': 0.4409448818897638, 'Acc': 0.29}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6753299981355667, 'Valid Loss': 0.7064363050460816, 'Validation Metric': {'Precision': 0.2545454545454545, 'Recall': 0.5, 'F1': 0.3373493975903614, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.2828282828282828, 'Recall': 1.0, 'F1': 0.4409448818897638, 'Acc': 0.29}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.63639994051594, 'Valid Loss': 0.7144687986373901, 'Validation Metric': {'Precision': 0.3090909090909091, 'Recall': 0.6071428571428571, 'F1': 0.40963855421686746, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.2828282828282828, 'Recall': 1.0, 'F1': 0.4409448818897638, 'Acc': 0.29}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5717318393290043, 'Valid Loss': 0.7116123270988465, 'Validation Metric': {'Precision': 0.33962264150943394, 'Recall': 0.6428571428571429, 'F1': 0.4444444444444444, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.33962264150943394, 'Recall': 0.6428571428571429, 'F1': 0.4444444444444444, 'Acc': 0.55}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4921449844080668, 'Valid Loss': 0.756244912147522, 'Validation Metric': {'Precision': 0.288135593220339, 'Recall': 0.6071428571428571, 'F1': 0.39080459770114945, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.33962264150943394, 'Recall': 0.6428571428571429, 'F1': 0.4444444444444444, 'Acc': 0.55}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.42798239178955555, 'Valid Loss': 0.7739624071121216, 'Validation Metric': {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.33962264150943394, 'Recall': 0.6428571428571429, 'F1': 0.4444444444444444, 'Acc': 0.55}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3548333216458559, 'Valid Loss': 0.7594970858097077, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3082926141527983, 'Valid Loss': 0.7527050411701203, 'Validation Metric': {'Precision': 0.34285714285714286, 'Recall': 0.42857142857142855, 'F1': 0.38095238095238093, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2519053309582747, 'Valid Loss': 0.7813689398765564, 'Validation Metric': {'Precision': 0.3157894736842105, 'Recall': 0.42857142857142855, 'F1': 0.36363636363636365, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.229320198798982, 'Valid Loss': 0.7788732862472534, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2190155560294023, 'Valid Loss': 0.7814016604423523, 'Validation Metric': {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1882613321336416, 'Valid Loss': 0.7930636763572693, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.32142857142857145, 'F1': 0.32142857142857145, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19218816665502694, 'Valid Loss': 0.7915906363725662, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.2857142857142857, 'F1': 0.29629629629629634, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.15955189228630984, 'Valid Loss': 0.8046319699287414, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.32142857142857145, 'F1': 0.32727272727272727, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1625161707186355, 'Valid Loss': 0.8123676824569702, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.32142857142857145, 'F1': 0.32727272727272727, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.15827567155401295, 'Valid Loss': 0.815787832736969, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.32142857142857145, 'F1': 0.32727272727272727, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 0.5714285714285714, 'F1': 0.45070422535211263, 'Acc': 0.61}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}; Test loss: 0.7892954063415527
