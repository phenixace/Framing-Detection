Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7517443680419371, 'Valid Loss': 0.8766928100585938, 'Validation Metric': {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7463343862730724, 'Valid Loss': 0.8298265695571899, 'Validation Metric': {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7280886201904371, 'Valid Loss': 0.7753554511070252, 'Validation Metric': {'Precision': 0.31313131313131315, 'Recall': 0.96875, 'F1': 0.4732824427480916, 'Acc': 0.31}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7088626130269124, 'Valid Loss': 0.7380376768112182, 'Validation Metric': {'Precision': 0.3229166666666667, 'Recall': 0.96875, 'F1': 0.48437500000000006, 'Acc': 0.34}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6891119829737223, 'Valid Loss': 0.7196231961250306, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.75, 'F1': 0.4285714285714285, 'Acc': 0.36}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6733847117194762, 'Valid Loss': 0.7107415056228638, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.6875, 'F1': 0.43137254901960786, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6345057135018018, 'Valid Loss': 0.7176080584526062, 'Validation Metric': {'Precision': 0.3103448275862069, 'Recall': 0.5625, 'F1': 0.4, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5719580478393115, 'Valid Loss': 0.7429673075675964, 'Validation Metric': {'Precision': 0.28846153846153844, 'Recall': 0.46875, 'F1': 0.35714285714285715, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.49513644796724504, 'Valid Loss': 0.7429757535457611, 'Validation Metric': {'Precision': 0.2978723404255319, 'Recall': 0.4375, 'F1': 0.3544303797468354, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.426697100727604, 'Valid Loss': 0.7700296974182129, 'Validation Metric': {'Precision': 0.2978723404255319, 'Recall': 0.4375, 'F1': 0.3544303797468354, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3683047184290794, 'Valid Loss': 0.7567833209037781, 'Validation Metric': {'Precision': 0.3170731707317073, 'Recall': 0.40625, 'F1': 0.3561643835616438, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3067436434615117, 'Valid Loss': 0.7701559400558472, 'Validation Metric': {'Precision': 0.32432432432432434, 'Recall': 0.375, 'F1': 0.34782608695652173, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2773395584752926, 'Valid Loss': 0.7732847619056702, 'Validation Metric': {'Precision': 0.2903225806451613, 'Recall': 0.28125, 'F1': 0.28571428571428575, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.23375553329690144, 'Valid Loss': 0.7865090608596802, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.25, 'F1': 0.27586206896551724, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2216273327716268, 'Valid Loss': 0.7801220798492432, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.25, 'F1': 0.26666666666666666, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19873000817516676, 'Valid Loss': 0.7971451258659363, 'Validation Metric': {'Precision': 0.3103448275862069, 'Recall': 0.28125, 'F1': 0.2950819672131148, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19298832920881417, 'Valid Loss': 0.7709787786006927, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.28125, 'F1': 0.3050847457627119, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.16823467139441234, 'Valid Loss': 0.7828594088554383, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.28125, 'F1': 0.3050847457627119, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16790652404037806, 'Valid Loss': 0.7931960451602936, 'Validation Metric': {'Precision': 0.3448275862068966, 'Recall': 0.3125, 'F1': 0.3278688524590164, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1580205031025868, 'Valid Loss': 0.78898641705513, 'Validation Metric': {'Precision': 0.3448275862068966, 'Recall': 0.3125, 'F1': 0.3278688524590164, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 1.0, 'F1': 0.48484848484848486, 'Acc': 0.32}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.27722772277227725, 'Recall': 1.0, 'F1': 0.434108527131783, 'Acc': 0.27722772277227725}; Test loss: 0.93366650893138
