Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7091448771953582, 'Valid Loss': 0.6526482242804307, 'Validation Metric': {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7124295675754547, 'Valid Loss': 0.6613482076388139, 'Validation Metric': {'Precision': 0.7052631578947368, 'Recall': 0.9305555555555556, 'F1': 0.8023952095808383, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7112371689081192, 'Valid Loss': 0.6741565832724938, 'Validation Metric': {'Precision': 0.7441860465116279, 'Recall': 0.8888888888888888, 'F1': 0.8101265822784809, 'Acc': 0.7029702970297029}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7073501887917518, 'Valid Loss': 0.6903163974101727, 'Validation Metric': {'Precision': 0.734375, 'Recall': 0.6527777777777778, 'F1': 0.6911764705882354, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6911623811721802, 'Valid Loss': 0.7134459775227767, 'Validation Metric': {'Precision': 0.7241379310344828, 'Recall': 0.2916666666666667, 'F1': 0.4158415841584159, 'Acc': 0.4158415841584158}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6801506108045579, 'Valid Loss': 0.7397846785875467, 'Validation Metric': {'Precision': 0.8571428571428571, 'Recall': 0.16666666666666666, 'F1': 0.27906976744186046, 'Acc': 0.38613861386138615}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6621043834090233, 'Valid Loss': 0.7532095129673297, 'Validation Metric': {'Precision': 0.9090909090909091, 'Recall': 0.1388888888888889, 'F1': 0.24096385542168675, 'Acc': 0.37623762376237624}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6247784414887428, 'Valid Loss': 0.7588350348747693, 'Validation Metric': {'Precision': 0.875, 'Recall': 0.19444444444444445, 'F1': 0.3181818181818182, 'Acc': 0.40594059405940597}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5707766050100327, 'Valid Loss': 0.8121815106043448, 'Validation Metric': {'Precision': 0.875, 'Recall': 0.19444444444444445, 'F1': 0.3181818181818182, 'Acc': 0.40594059405940597}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5397253024578095, 'Valid Loss': 0.749044404580043, 'Validation Metric': {'Precision': 0.6904761904761905, 'Recall': 0.4027777777777778, 'F1': 0.5087719298245614, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4540412595868111, 'Valid Loss': 0.7612186423861064, 'Validation Metric': {'Precision': 0.7857142857142857, 'Recall': 0.4583333333333333, 'F1': 0.5789473684210527, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.39849368125200274, 'Valid Loss': 0.7300483492704538, 'Validation Metric': {'Precision': 0.7884615384615384, 'Recall': 0.5694444444444444, 'F1': 0.661290322580645, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.37184014469385146, 'Valid Loss': 0.7055545730086473, 'Validation Metric': {'Precision': 0.7428571428571429, 'Recall': 0.7222222222222222, 'F1': 0.732394366197183, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.30833556860685346, 'Valid Loss': 0.7150004741090995, 'Validation Metric': {'Precision': 0.7352941176470589, 'Recall': 0.6944444444444444, 'F1': 0.7142857142857144, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.301127216219902, 'Valid Loss': 0.7127904158372146, 'Validation Metric': {'Precision': 0.7432432432432432, 'Recall': 0.7638888888888888, 'F1': 0.7534246575342465, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2661001969873905, 'Valid Loss': 0.7211092131642195, 'Validation Metric': {'Precision': 0.7297297297297297, 'Recall': 0.75, 'F1': 0.7397260273972601, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2449687686562538, 'Valid Loss': 0.7270493260942973, 'Validation Metric': {'Precision': 0.7297297297297297, 'Recall': 0.75, 'F1': 0.7397260273972601, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.22853479757905007, 'Valid Loss': 0.7266485375853685, 'Validation Metric': {'Precision': 0.7297297297297297, 'Recall': 0.75, 'F1': 0.7397260273972601, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2142573982477188, 'Valid Loss': 0.73342059724606, 'Validation Metric': {'Precision': 0.7297297297297297, 'Recall': 0.75, 'F1': 0.7397260273972601, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2098341877758503, 'Valid Loss': 0.7362814809267337, 'Validation Metric': {'Precision': 0.7297297297297297, 'Recall': 0.75, 'F1': 0.7397260273972601, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}; Test loss: 0.677433756681589
