Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7017514521486303, 'Valid Loss': 0.7315681219100952, 'Validation Metric': {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7025108200110747, 'Valid Loss': 0.7231547999382019, 'Validation Metric': {'Precision': 0.4175824175824176, 'Recall': 0.8837209302325582, 'F1': 0.5671641791044776, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7071606664175398, 'Valid Loss': 0.7090841794013977, 'Validation Metric': {'Precision': 0.42105263157894735, 'Recall': 0.7441860465116279, 'F1': 0.5378151260504201, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6945487649253245, 'Valid Loss': 0.6949296998977661, 'Validation Metric': {'Precision': 0.43103448275862066, 'Recall': 0.5813953488372093, 'F1': 0.49504950495049505, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6865844706471047, 'Valid Loss': 0.6755026125907898, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.5581395348837209, 'F1': 0.5052631578947369, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6590923385673695, 'Valid Loss': 0.675645387172699, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.5116279069767442, 'F1': 0.4731182795698925, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6312097240699811, 'Valid Loss': 0.6815771913528442, 'Validation Metric': {'Precision': 0.41304347826086957, 'Recall': 0.4418604651162791, 'F1': 0.4269662921348315, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5909326870119973, 'Valid Loss': 0.6922004127502441, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.46511627906976744, 'F1': 0.449438202247191, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5473448657587673, 'Valid Loss': 0.7188607478141784, 'Validation Metric': {'Precision': 0.43902439024390244, 'Recall': 0.4186046511627907, 'F1': 0.4285714285714286, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5287269702118435, 'Valid Loss': 0.7357270193099975, 'Validation Metric': {'Precision': 0.43902439024390244, 'Recall': 0.4186046511627907, 'F1': 0.4285714285714286, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.47318517626001594, 'Valid Loss': 0.7444670844078064, 'Validation Metric': {'Precision': 0.425531914893617, 'Recall': 0.46511627906976744, 'F1': 0.4444444444444445, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4407761594217815, 'Valid Loss': 0.7642413830757141, 'Validation Metric': {'Precision': 0.4222222222222222, 'Recall': 0.4418604651162791, 'F1': 0.4318181818181818, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4220064672526349, 'Valid Loss': 0.777018666267395, 'Validation Metric': {'Precision': 0.4358974358974359, 'Recall': 0.3953488372093023, 'F1': 0.41463414634146334, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3773201352424836, 'Valid Loss': 0.7899994140863419, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.46511627906976744, 'F1': 0.449438202247191, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3651240324036459, 'Valid Loss': 0.8149393212795257, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.46511627906976744, 'F1': 0.449438202247191, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3373934052298578, 'Valid Loss': 0.8271770447492599, 'Validation Metric': {'Precision': 0.4222222222222222, 'Recall': 0.4418604651162791, 'F1': 0.4318181818181818, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3222300492310792, 'Valid Loss': 0.8309298920631408, 'Validation Metric': {'Precision': 0.4146341463414634, 'Recall': 0.3953488372093023, 'F1': 0.40476190476190477, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.32502916656183395, 'Valid Loss': 0.850406460762024, 'Validation Metric': {'Precision': 0.4222222222222222, 'Recall': 0.4418604651162791, 'F1': 0.4318181818181818, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3000487109248558, 'Valid Loss': 0.8490393441915512, 'Validation Metric': {'Precision': 0.40476190476190477, 'Recall': 0.3953488372093023, 'F1': 0.4, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3069092350896825, 'Valid Loss': 0.8518725377321243, 'Validation Metric': {'Precision': 0.3953488372093023, 'Recall': 0.3953488372093023, 'F1': 0.3953488372093023, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3368421052631579, 'Recall': 0.9142857142857143, 'F1': 0.4923076923076923, 'Acc': 0.3465346534653465}; Test loss: 0.7631239019907438
