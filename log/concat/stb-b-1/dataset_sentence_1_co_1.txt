Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7082740942251335, 'Valid Loss': 0.6709865665435791, 'Validation Metric': {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.717157556015311, 'Valid Loss': 0.6755593729019165, 'Validation Metric': {'Precision': 0.6179775280898876, 'Recall': 0.859375, 'F1': 0.7189542483660131, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7122684815554943, 'Valid Loss': 0.68676593542099, 'Validation Metric': {'Precision': 0.6081081081081081, 'Recall': 0.703125, 'F1': 0.6521739130434783, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6929028485585185, 'Valid Loss': 0.7072845578193665, 'Validation Metric': {'Precision': 0.72, 'Recall': 0.5625, 'F1': 0.631578947368421, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.672771299637637, 'Valid Loss': 0.7924282228946686, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.140625, 'F1': 0.23076923076923078, 'Acc': 0.4}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7016009546599342, 'Valid Loss': 0.8106787145137787, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.109375, 'F1': 0.1842105263157895, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6917414346944939, 'Valid Loss': 0.7623350381851196, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.28125, 'F1': 0.4, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6376902391609637, 'Valid Loss': 0.7781952881813049, 'Validation Metric': {'Precision': 0.6774193548387096, 'Recall': 0.328125, 'F1': 0.4421052631578948, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5994325621614178, 'Valid Loss': 0.8081907391548157, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.28125, 'F1': 0.391304347826087, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5813299782067827, 'Valid Loss': 0.7961241412162781, 'Validation Metric': {'Precision': 0.6571428571428571, 'Recall': 0.359375, 'F1': 0.4646464646464647, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5300310705471964, 'Valid Loss': 0.785622923374176, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.46875, 'F1': 0.5405405405405406, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4745765224243831, 'Valid Loss': 0.7993427455425263, 'Validation Metric': {'Precision': 0.5869565217391305, 'Recall': 0.421875, 'F1': 0.49090909090909096, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.43650907798878197, 'Valid Loss': 0.808724753856659, 'Validation Metric': {'Precision': 0.5882352941176471, 'Recall': 0.46875, 'F1': 0.5217391304347826, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.40190054809005515, 'Valid Loss': 0.8175231397151947, 'Validation Metric': {'Precision': 0.6140350877192983, 'Recall': 0.546875, 'F1': 0.5785123966942148, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.36598352653887667, 'Valid Loss': 0.8035282838344574, 'Validation Metric': {'Precision': 0.5797101449275363, 'Recall': 0.625, 'F1': 0.6015037593984963, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3267068521490375, 'Valid Loss': 0.8130095362663269, 'Validation Metric': {'Precision': 0.5857142857142857, 'Recall': 0.640625, 'F1': 0.6119402985074627, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.30778370754232687, 'Valid Loss': 0.8279645311832428, 'Validation Metric': {'Precision': 0.5915492957746479, 'Recall': 0.65625, 'F1': 0.6222222222222222, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2968818552575065, 'Valid Loss': 0.8381763529777527, 'Validation Metric': {'Precision': 0.5915492957746479, 'Recall': 0.65625, 'F1': 0.6222222222222222, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2892102635311849, 'Valid Loss': 0.8449558424949646, 'Validation Metric': {'Precision': 0.5915492957746479, 'Recall': 0.65625, 'F1': 0.6222222222222222, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.28370990625862935, 'Valid Loss': 0.8477899038791656, 'Validation Metric': {'Precision': 0.5915492957746479, 'Recall': 0.65625, 'F1': 0.6222222222222222, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.6344086021505376, 'Recall': 0.921875, 'F1': 0.7515923566878981, 'Acc': 0.61}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}; Test loss: 0.6607205891609191
