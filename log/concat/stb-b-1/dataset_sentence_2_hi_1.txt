Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7085298285461389, 'Valid Loss': 0.7593987226486206, 'Validation Metric': {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7130184867061101, 'Valid Loss': 0.7449186682701111, 'Validation Metric': {'Precision': 0.32954545454545453, 'Recall': 0.90625, 'F1': 0.48333333333333334, 'Acc': 0.38}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32954545454545453, 'Recall': 0.90625, 'F1': 0.48333333333333334, 'Acc': 0.38}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7116922174508755, 'Valid Loss': 0.7292205142974854, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.84375, 'F1': 0.4655172413793104, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.32954545454545453, 'Recall': 0.90625, 'F1': 0.48333333333333334, 'Acc': 0.38}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6971075540551772, 'Valid Loss': 0.7240082240104675, 'Validation Metric': {'Precision': 0.32926829268292684, 'Recall': 0.84375, 'F1': 0.47368421052631576, 'Acc': 0.4}}
Best validation metric so far: {'Precision': 0.32954545454545453, 'Recall': 0.90625, 'F1': 0.48333333333333334, 'Acc': 0.38}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6889196433700048, 'Valid Loss': 0.7177129340171814, 'Validation Metric': {'Precision': 0.34177215189873417, 'Recall': 0.84375, 'F1': 0.48648648648648646, 'Acc': 0.43}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34177215189873417, 'Recall': 0.84375, 'F1': 0.48648648648648646, 'Acc': 0.43}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6681724769564775, 'Valid Loss': 0.720993721485138, 'Validation Metric': {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6382964820815966, 'Valid Loss': 0.721891450881958, 'Validation Metric': {'Precision': 0.33783783783783783, 'Recall': 0.78125, 'F1': 0.4716981132075472, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5502619164494368, 'Valid Loss': 0.8135416674613952, 'Validation Metric': {'Precision': 0.31868131868131866, 'Recall': 0.90625, 'F1': 0.47154471544715443, 'Acc': 0.35}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5246659391201459, 'Valid Loss': 0.8277505493164062, 'Validation Metric': {'Precision': 0.3291139240506329, 'Recall': 0.8125, 'F1': 0.46846846846846846, 'Acc': 0.41}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.43797711540873235, 'Valid Loss': 0.8218749368190765, 'Validation Metric': {'Precision': 0.2777777777777778, 'Recall': 0.46875, 'F1': 0.3488372093023256, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3889401297156627, 'Valid Loss': 0.8060738825798035, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.46875, 'F1': 0.38961038961038963, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.32742230207301104, 'Valid Loss': 0.7665158343315125, 'Validation Metric': {'Precision': 0.3125, 'Recall': 0.3125, 'F1': 0.3125, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.29901986941695213, 'Valid Loss': 0.7674541109800339, 'Validation Metric': {'Precision': 0.34615384615384615, 'Recall': 0.28125, 'F1': 0.3103448275862069, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2543701187779124, 'Valid Loss': 0.7886148953437805, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.28125, 'F1': 0.3050847457627119, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.24169156994097507, 'Valid Loss': 0.7896534061431885, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.28125, 'F1': 0.3333333333333333, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.23153128166897938, 'Valid Loss': 0.7843563514947891, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.3125, 'F1': 0.3703703703703703, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.21620745197511637, 'Valid Loss': 0.7907174414396286, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2058497348513741, 'Valid Loss': 0.8182691425085068, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.3125, 'F1': 0.3333333333333333, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.19289544941141054, 'Valid Loss': 0.8195812708139419, 'Validation Metric': {'Precision': 0.37037037037037035, 'Recall': 0.3125, 'F1': 0.3389830508474576, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.18979508458421782, 'Valid Loss': 0.8164435350894927, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.3125, 'F1': 0.3448275862068966, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.34615384615384615, 'Recall': 0.84375, 'F1': 0.4909090909090909, 'Acc': 0.44}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.30864197530864196, 'Recall': 0.8928571428571429, 'F1': 0.4587155963302753, 'Acc': 0.4158415841584158}; Test loss: 0.7257020817353175
