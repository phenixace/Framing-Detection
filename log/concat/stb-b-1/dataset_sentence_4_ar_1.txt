Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7201059220673202, 'Valid Loss': 0.7108910863216107, 'Validation Metric': {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.717768742666616, 'Valid Loss': 0.7081224918365479, 'Validation Metric': {'Precision': 0.5157894736842106, 'Recall': 0.9245283018867925, 'F1': 0.6621621621621622, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7113629943364627, 'Valid Loss': 0.7051731967009031, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.9056603773584906, 'F1': 0.6575342465753424, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6975827170656873, 'Valid Loss': 0.7017292792980487, 'Validation Metric': {'Precision': 0.5119047619047619, 'Recall': 0.8113207547169812, 'F1': 0.6277372262773723, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7026821521969585, 'Valid Loss': 0.6987165487729586, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.7547169811320755, 'F1': 0.6015037593984962, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6901096562286476, 'Valid Loss': 0.6964875069948343, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.7169811320754716, 'F1': 0.5891472868217055, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6788525302688797, 'Valid Loss': 0.6928803645647489, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.6037735849056604, 'F1': 0.5565217391304349, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6678210489161602, 'Valid Loss': 0.6905465767933772, 'Validation Metric': {'Precision': 0.5151515151515151, 'Recall': 0.6415094339622641, 'F1': 0.5714285714285715, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6389626071050569, 'Valid Loss': 0.6988212833037744, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.37735849056603776, 'F1': 0.43010752688172044, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6259200514911057, 'Valid Loss': 0.7061320440127299, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.41509433962264153, 'F1': 0.4631578947368421, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5863238139586016, 'Valid Loss': 0.7285427577220477, 'Validation Metric': {'Precision': 0.5526315789473685, 'Recall': 0.39622641509433965, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5822329078014795, 'Valid Loss': 0.7196525885508611, 'Validation Metric': {'Precision': 0.5396825396825397, 'Recall': 0.6415094339622641, 'F1': 0.5862068965517241, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5452411136069855, 'Valid Loss': 0.7150354316601386, 'Validation Metric': {'Precision': 0.5774647887323944, 'Recall': 0.7735849056603774, 'F1': 0.6612903225806451, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4920498492655816, 'Valid Loss': 0.7302913642846621, 'Validation Metric': {'Precision': 0.5573770491803278, 'Recall': 0.6415094339622641, 'F1': 0.5964912280701753, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4872652284510724, 'Valid Loss': 0.7356039274197358, 'Validation Metric': {'Precision': 0.578125, 'Recall': 0.6981132075471698, 'F1': 0.6324786324786325, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4578624657996289, 'Valid Loss': 0.7462791685874646, 'Validation Metric': {'Precision': 0.559322033898305, 'Recall': 0.6226415094339622, 'F1': 0.5892857142857142, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4317976060238751, 'Valid Loss': 0.7500477238343313, 'Validation Metric': {'Precision': 0.559322033898305, 'Recall': 0.6226415094339622, 'F1': 0.5892857142857142, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4085649528673717, 'Valid Loss': 0.7567766492183392, 'Validation Metric': {'Precision': 0.559322033898305, 'Recall': 0.6226415094339622, 'F1': 0.5892857142857142, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4393141708977811, 'Valid Loss': 0.7603187343248954, 'Validation Metric': {'Precision': 0.559322033898305, 'Recall': 0.6226415094339622, 'F1': 0.5892857142857142, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.40588641960125466, 'Valid Loss': 0.7619393169879913, 'Validation Metric': {'Precision': 0.559322033898305, 'Recall': 0.6226415094339622, 'F1': 0.5892857142857142, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5306122448979592, 'Recall': 0.9811320754716981, 'F1': 0.6887417218543048, 'Acc': 0.5346534653465347}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5416666666666666, 'Recall': 0.9629629629629629, 'F1': 0.6933333333333334, 'Acc': 0.54}; Test loss: 0.6851094603538513
