Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7003071330329205, 'Valid Loss': 0.7243091922539932, 'Validation Metric': {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45918367346938777, 'Recall': 0.9782608695652174, 'F1': 0.625, 'Acc': 0.46534653465346537}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7104464300135349, 'Valid Loss': 0.7150868337887984, 'Validation Metric': {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7013825824920167, 'Valid Loss': 0.7032145399313706, 'Validation Metric': {'Precision': 0.4823529411764706, 'Recall': 0.8913043478260869, 'F1': 0.6259541984732824, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.69223778425379, 'Valid Loss': 0.6962328965847309, 'Validation Metric': {'Precision': 0.5072463768115942, 'Recall': 0.7608695652173914, 'F1': 0.6086956521739131, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6798011495711955, 'Valid Loss': 0.6917291489931253, 'Validation Metric': {'Precision': 0.4918032786885246, 'Recall': 0.6521739130434783, 'F1': 0.5607476635514019, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6615494990602453, 'Valid Loss': 0.6933850118747125, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.7608695652173914, 'F1': 0.603448275862069, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6379188977657481, 'Valid Loss': 0.6854661473861108, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5869565217391305, 'F1': 0.54, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5486035020427501, 'Valid Loss': 0.7143023575727756, 'Validation Metric': {'Precision': 0.5074626865671642, 'Recall': 0.7391304347826086, 'F1': 0.6017699115044248, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.528721939059014, 'Valid Loss': 0.711719355904139, 'Validation Metric': {'Precision': 0.48214285714285715, 'Recall': 0.5869565217391305, 'F1': 0.5294117647058824, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4596827416977984, 'Valid Loss': 0.7644702058572036, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.45652173913043476, 'F1': 0.4421052631578947, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4139617339093634, 'Valid Loss': 0.7842989208606573, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.45652173913043476, 'F1': 0.44680851063829785, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3813099829440421, 'Valid Loss': 0.7853185511552371, 'Validation Metric': {'Precision': 0.4146341463414634, 'Recall': 0.3695652173913043, 'F1': 0.3908045977011494, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3271156481288849, 'Valid Loss': 0.7865567551209376, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.34782608695652173, 'F1': 0.39999999999999997, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.30668342652473046, 'Valid Loss': 0.7987976521253586, 'Validation Metric': {'Precision': 0.4838709677419355, 'Recall': 0.32608695652173914, 'F1': 0.38961038961038963, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2794328200373244, 'Valid Loss': 0.8257522966999274, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.34782608695652173, 'F1': 0.39999999999999997, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.27558329217928523, 'Valid Loss': 0.8439789506105276, 'Validation Metric': {'Precision': 0.45714285714285713, 'Recall': 0.34782608695652173, 'F1': 0.3950617283950617, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.24022765338737914, 'Valid Loss': 0.8501833092707854, 'Validation Metric': {'Precision': 0.4411764705882353, 'Recall': 0.32608695652173914, 'F1': 0.375, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.22625213671237865, 'Valid Loss': 0.8666079502839309, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.32608695652173914, 'F1': 0.37037037037037035, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.22213699739981205, 'Valid Loss': 0.8830313997773024, 'Validation Metric': {'Precision': 0.4594594594594595, 'Recall': 0.3695652173913043, 'F1': 0.4096385542168674, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2158088355146824, 'Valid Loss': 0.8825781758014972, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.34782608695652173, 'F1': 0.3902439024390244, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4639175257731959, 'Recall': 0.9782608695652174, 'F1': 0.6293706293706294, 'Acc': 0.4752475247524752}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.43333333333333335, 'Recall': 0.9069767441860465, 'F1': 0.5864661654135338, 'Acc': 0.45}; Test loss: 0.7192791771888732
