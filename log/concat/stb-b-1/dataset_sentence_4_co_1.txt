Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7066893825436583, 'Valid Loss': 0.677433756681589, 'Validation Metric': {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7103651844628966, 'Valid Loss': 0.6796223750481238, 'Validation Metric': {'Precision': 0.6021505376344086, 'Recall': 0.9032258064516129, 'F1': 0.7225806451612904, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7091850703305537, 'Valid Loss': 0.6847337759458102, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.8225806451612904, 'F1': 0.7132867132867133, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7075368584972797, 'Valid Loss': 0.6915798439429357, 'Validation Metric': {'Precision': 0.65625, 'Recall': 0.6774193548387096, 'F1': 0.6666666666666667, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6878182032320759, 'Valid Loss': 0.7059823778959421, 'Validation Metric': {'Precision': 0.6470588235294118, 'Recall': 0.3548387096774194, 'F1': 0.4583333333333333, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6775136460172068, 'Valid Loss': 0.7211370559839102, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.1935483870967742, 'F1': 0.3037974683544304, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6603717656418828, 'Valid Loss': 0.7193695765275222, 'Validation Metric': {'Precision': 0.6086956521739131, 'Recall': 0.22580645161290322, 'F1': 0.3294117647058823, 'Acc': 0.43564356435643564}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6190464210392225, 'Valid Loss': 0.7354094340251043, 'Validation Metric': {'Precision': 0.5909090909090909, 'Recall': 0.20967741935483872, 'F1': 0.30952380952380953, 'Acc': 0.42574257425742573}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5792536824056418, 'Valid Loss': 0.7508371839156518, 'Validation Metric': {'Precision': 0.5652173913043478, 'Recall': 0.20967741935483872, 'F1': 0.30588235294117644, 'Acc': 0.4158415841584158}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5122360809899793, 'Valid Loss': 0.7959020252411182, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.25806451612903225, 'F1': 0.36363636363636365, 'Acc': 0.44554455445544555}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4641339315636323, 'Valid Loss': 0.765235022856639, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.45161290322580644, 'F1': 0.5233644859813085, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3902602753426769, 'Valid Loss': 0.7789199077166044, 'Validation Metric': {'Precision': 0.6140350877192983, 'Recall': 0.5645161290322581, 'F1': 0.5882352941176471, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.35270447453649917, 'Valid Loss': 0.7625707594247965, 'Validation Metric': {'Precision': 0.65625, 'Recall': 0.6774193548387096, 'F1': 0.6666666666666667, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.32166600728979206, 'Valid Loss': 0.7890615165233612, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.7258064516129032, 'F1': 0.6818181818181818, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.28470279364892753, 'Valid Loss': 0.8089909885938351, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.7258064516129032, 'F1': 0.6818181818181818, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.26151982672733837, 'Valid Loss': 0.8221141695976257, 'Validation Metric': {'Precision': 0.6388888888888888, 'Recall': 0.7419354838709677, 'F1': 0.6865671641791045, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.24910269183392572, 'Valid Loss': 0.8269544450136331, 'Validation Metric': {'Precision': 0.6447368421052632, 'Recall': 0.7903225806451613, 'F1': 0.7101449275362319, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2275340721601307, 'Valid Loss': 0.8368380522498717, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.7903225806451613, 'F1': 0.7050359712230215, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.23189736253554277, 'Valid Loss': 0.8411427925412471, 'Validation Metric': {'Precision': 0.6447368421052632, 'Recall': 0.7903225806451613, 'F1': 0.7101449275362319, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.21288059216619717, 'Valid Loss': 0.8465164143305558, 'Validation Metric': {'Precision': 0.6447368421052632, 'Recall': 0.7903225806451613, 'F1': 0.7101449275362319, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7021276595744681, 'Recall': 0.9295774647887324, 'F1': 0.8, 'Acc': 0.67}; Test loss: 0.6444140696525573
