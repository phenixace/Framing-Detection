Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.716320860234997, 'Valid Loss': 0.7380950582027436, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7035911234119271, 'Valid Loss': 0.7304729294776916, 'Validation Metric': {'Precision': 0.4186046511627907, 'Recall': 0.8372093023255814, 'F1': 0.5581395348837209, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7110358408734768, 'Valid Loss': 0.7207889556884766, 'Validation Metric': {'Precision': 0.4025974025974026, 'Recall': 0.7209302325581395, 'F1': 0.5166666666666667, 'Acc': 0.42}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6992284587666958, 'Valid Loss': 0.7124538779258728, 'Validation Metric': {'Precision': 0.3787878787878788, 'Recall': 0.5813953488372093, 'F1': 0.4587155963302752, 'Acc': 0.41}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6944005104559886, 'Valid Loss': 0.7065638709068298, 'Validation Metric': {'Precision': 0.37254901960784315, 'Recall': 0.4418604651162791, 'F1': 0.4042553191489362, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6875947710079483, 'Valid Loss': 0.7027302455902099, 'Validation Metric': {'Precision': 0.34210526315789475, 'Recall': 0.3023255813953488, 'F1': 0.32098765432098764, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6655545845816407, 'Valid Loss': 0.6958263993263245, 'Validation Metric': {'Precision': 0.35135135135135137, 'Recall': 0.3023255813953488, 'F1': 0.32499999999999996, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6415357106848608, 'Valid Loss': 0.7040742874145508, 'Validation Metric': {'Precision': 0.3902439024390244, 'Recall': 0.37209302325581395, 'F1': 0.380952380952381, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5909726057626024, 'Valid Loss': 0.724555698633194, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.27906976744186046, 'F1': 0.3380281690140845, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5532720669915404, 'Valid Loss': 0.7307422661781311, 'Validation Metric': {'Precision': 0.4523809523809524, 'Recall': 0.4418604651162791, 'F1': 0.4470588235294118, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.534762019975276, 'Valid Loss': 0.7538632893562317, 'Validation Metric': {'Precision': 0.43548387096774194, 'Recall': 0.627906976744186, 'F1': 0.5142857142857142, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4777600908581215, 'Valid Loss': 0.7771691930294037, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.5116279069767442, 'F1': 0.4631578947368421, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4575508027514325, 'Valid Loss': 0.7920603406429291, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.46511627906976744, 'F1': 0.4301075268817204, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4137772055743616, 'Valid Loss': 0.807798912525177, 'Validation Metric': {'Precision': 0.40816326530612246, 'Recall': 0.46511627906976744, 'F1': 0.43478260869565216, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4013675960558879, 'Valid Loss': 0.8335434103012085, 'Validation Metric': {'Precision': 0.43103448275862066, 'Recall': 0.5813953488372093, 'F1': 0.49504950495049505, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.35094569397123554, 'Valid Loss': 0.8528259825706482, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.5581395348837209, 'F1': 0.48484848484848486, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3258456048331683, 'Valid Loss': 0.854294296503067, 'Validation Metric': {'Precision': 0.40425531914893614, 'Recall': 0.4418604651162791, 'F1': 0.4222222222222222, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3320011947351166, 'Valid Loss': 0.8719170594215393, 'Validation Metric': {'Precision': 0.38, 'Recall': 0.4418604651162791, 'F1': 0.40860215053763443, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.30832749831525585, 'Valid Loss': 0.879903746843338, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.46511627906976744, 'F1': 0.4210526315789474, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.30962626202197013, 'Valid Loss': 0.8819697797298431, 'Validation Metric': {'Precision': 0.37254901960784315, 'Recall': 0.4418604651162791, 'F1': 0.4042553191489362, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9069767441860465, 'F1': 0.582089552238806, 'Acc': 0.44}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5434782608695652, 'Recall': 0.9090909090909091, 'F1': 0.6802721088435375, 'Acc': 0.53}; Test loss: 0.7058412384986877
