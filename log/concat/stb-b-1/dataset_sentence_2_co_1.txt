Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7068058535306141, 'Valid Loss': 0.6607205891609191, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.712886682062438, 'Valid Loss': 0.6654572725296021, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.702095685884206, 'Valid Loss': 0.6795119261741638, 'Validation Metric': {'Precision': 0.6712328767123288, 'Recall': 0.7538461538461538, 'F1': 0.7101449275362318, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7015839550230238, 'Valid Loss': 0.696571581363678, 'Validation Metric': {'Precision': 0.66, 'Recall': 0.5076923076923077, 'F1': 0.5739130434782608, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.699573283243661, 'Valid Loss': 0.7077404284477233, 'Validation Metric': {'Precision': 0.6285714285714286, 'Recall': 0.3384615384615385, 'F1': 0.44, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6727688944700992, 'Valid Loss': 0.7420833826065063, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.1076923076923077, 'F1': 0.1842105263157895, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6605840114632038, 'Valid Loss': 0.7989738035202026, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.12307692307692308, 'F1': 0.2077922077922078, 'Acc': 0.39}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6471864821934941, 'Valid Loss': 0.8102041673660278, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.18461538461538463, 'F1': 0.28915662650602414, 'Acc': 0.41}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5972216520646606, 'Valid Loss': 0.7813173079490662, 'Validation Metric': {'Precision': 0.6857142857142857, 'Recall': 0.36923076923076925, 'F1': 0.48, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.542261806702373, 'Valid Loss': 0.8256771612167358, 'Validation Metric': {'Precision': 0.6875, 'Recall': 0.3384615384615385, 'F1': 0.45360824742268036, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5052681309406204, 'Valid Loss': 0.7674419820308686, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.5384615384615384, 'F1': 0.5833333333333334, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4353662550148338, 'Valid Loss': 0.7609401595592499, 'Validation Metric': {'Precision': 0.6481481481481481, 'Recall': 0.5384615384615384, 'F1': 0.588235294117647, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.39914335476027596, 'Valid Loss': 0.7470591354370117, 'Validation Metric': {'Precision': 0.6610169491525424, 'Recall': 0.6, 'F1': 0.6290322580645161, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3759300669636389, 'Valid Loss': 0.7738717448711395, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.6153846153846154, 'F1': 0.6201550387596899, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.347076374322477, 'Valid Loss': 0.746876677274704, 'Validation Metric': {'Precision': 0.6470588235294118, 'Recall': 0.676923076923077, 'F1': 0.6616541353383458, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.31706999151995685, 'Valid Loss': 0.7459622895717621, 'Validation Metric': {'Precision': 0.647887323943662, 'Recall': 0.7076923076923077, 'F1': 0.676470588235294, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.29343793714287303, 'Valid Loss': 0.7553044319152832, 'Validation Metric': {'Precision': 0.6438356164383562, 'Recall': 0.7230769230769231, 'F1': 0.6811594202898551, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2948154491005522, 'Valid Loss': 0.7635190278291702, 'Validation Metric': {'Precision': 0.6486486486486487, 'Recall': 0.7384615384615385, 'F1': 0.6906474820143885, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2774412544688793, 'Valid Loss': 0.7632422894239426, 'Validation Metric': {'Precision': 0.6410256410256411, 'Recall': 0.7692307692307693, 'F1': 0.6993006993006994, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2648215671681394, 'Valid Loss': 0.758590789437294, 'Validation Metric': {'Precision': 0.6419753086419753, 'Recall': 0.8, 'F1': 0.7123287671232877, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}; Test loss: 0.6526482242804307
