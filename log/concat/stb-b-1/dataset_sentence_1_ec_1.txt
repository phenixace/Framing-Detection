Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-1/', lr=2e-06, max_len=64, n_passages=1, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7055207685138403, 'Valid Loss': 0.7493854808807373, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7128717196121644, 'Valid Loss': 0.7379314589500428, 'Validation Metric': {'Precision': 0.34831460674157305, 'Recall': 0.8857142857142857, 'F1': 0.5, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7050259166888977, 'Valid Loss': 0.7210189652442932, 'Validation Metric': {'Precision': 0.3375, 'Recall': 0.7714285714285715, 'F1': 0.4695652173913044, 'Acc': 0.39}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7023232425196787, 'Valid Loss': 0.7096023821830749, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.6285714285714286, 'F1': 0.419047619047619, 'Acc': 0.39}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.683870920304502, 'Valid Loss': 0.702250497341156, 'Validation Metric': {'Precision': 0.2962962962962963, 'Recall': 0.45714285714285713, 'F1': 0.3595505617977528, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6657409105408058, 'Valid Loss': 0.6997674536705017, 'Validation Metric': {'Precision': 0.275, 'Recall': 0.3142857142857143, 'F1': 0.29333333333333333, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6222940395387371, 'Valid Loss': 0.7241501259803772, 'Validation Metric': {'Precision': 0.3220338983050847, 'Recall': 0.5428571428571428, 'F1': 0.4042553191489362, 'Acc': 0.44}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5860076268737235, 'Valid Loss': 0.7323968720436096, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4857142857142857, 'F1': 0.3953488372093023, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5237698025917739, 'Valid Loss': 0.7643872928619385, 'Validation Metric': {'Precision': 0.34545454545454546, 'Recall': 0.5428571428571428, 'F1': 0.4222222222222222, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4874878673071272, 'Valid Loss': 0.7733203911781311, 'Validation Metric': {'Precision': 0.34615384615384615, 'Recall': 0.5142857142857142, 'F1': 0.41379310344827586, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.42825774597317984, 'Valid Loss': 0.790646116733551, 'Validation Metric': {'Precision': 0.3673469387755102, 'Recall': 0.5142857142857142, 'F1': 0.42857142857142855, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.38472043563810626, 'Valid Loss': 0.8178986787796021, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.5142857142857142, 'F1': 0.41860465116279066, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.37596387642153195, 'Valid Loss': 0.8025115370750427, 'Validation Metric': {'Precision': 0.37777777777777777, 'Recall': 0.4857142857142857, 'F1': 0.425, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.32705313503072503, 'Valid Loss': 0.8435823714733124, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.5142857142857142, 'F1': 0.41860465116279066, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.29687854781579437, 'Valid Loss': 0.8316388249397277, 'Validation Metric': {'Precision': 0.38636363636363635, 'Recall': 0.4857142857142857, 'F1': 0.4303797468354431, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.26574800674165233, 'Valid Loss': 0.8463895523548126, 'Validation Metric': {'Precision': 0.3617021276595745, 'Recall': 0.4857142857142857, 'F1': 0.41463414634146345, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.24604872923888518, 'Valid Loss': 0.8855295979976654, 'Validation Metric': {'Precision': 0.37254901960784315, 'Recall': 0.5428571428571428, 'F1': 0.4418604651162791, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2428397989172614, 'Valid Loss': 0.8670854008197785, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.5142857142857142, 'F1': 0.43373493975903615, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2346778025620439, 'Valid Loss': 0.8662674856185913, 'Validation Metric': {'Precision': 0.3695652173913043, 'Recall': 0.4857142857142857, 'F1': 0.4197530864197531, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.23701648380649223, 'Valid Loss': 0.874380224943161, 'Validation Metric': {'Precision': 0.3617021276595745, 'Recall': 0.4857142857142857, 'F1': 0.41463414634146345, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.9142857142857143, 'F1': 0.5039370078740156, 'Acc': 0.37}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4329896907216495, 'Recall': 0.9767441860465116, 'F1': 0.6, 'Acc': 0.44}; Test loss: 0.7315681219100952
