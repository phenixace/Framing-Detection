Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6987209348451524, 'Valid Loss': 0.6582508754730224, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.029411764705882353, 'F1': 0.05714285714285715, 'Acc': 0.67}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.029411764705882353, 'F1': 0.05714285714285715, 'Acc': 0.67}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7111623508589608, 'Valid Loss': 0.6646891474723816, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.029411764705882353, 'F1': 0.05555555555555555, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.029411764705882353, 'F1': 0.05714285714285715, 'Acc': 0.67}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6977750931467329, 'Valid Loss': 0.675652048587799, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.14705882352941177, 'F1': 0.20408163265306123, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.14705882352941177, 'F1': 0.20408163265306123, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6873200677690052, 'Valid Loss': 0.6861843132972717, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.35294117647058826, 'F1': 0.34285714285714286, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.35294117647058826, 'F1': 0.34285714285714286, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6629311303297679, 'Valid Loss': 0.7014337968826294, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.4117647058823529, 'F1': 0.358974358974359, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3181818181818182, 'Recall': 0.4117647058823529, 'F1': 0.358974358974359, 'Acc': 0.5}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6332016524814424, 'Valid Loss': 0.7199198341369629, 'Validation Metric': {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5723220183735802, 'Valid Loss': 0.716276831626892, 'Validation Metric': {'Precision': 0.2926829268292683, 'Recall': 0.35294117647058826, 'F1': 0.32, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4866892045452481, 'Valid Loss': 0.7148079991340637, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.3235294117647059, 'F1': 0.31884057971014496, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4049821036202567, 'Valid Loss': 0.7219336175918579, 'Validation Metric': {'Precision': 0.3125, 'Recall': 0.29411764705882354, 'F1': 0.30303030303030304, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.35443001488844555, 'Valid Loss': 0.7235996115207672, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.17647058823529413, 'F1': 0.20000000000000004, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.29094567320176534, 'Valid Loss': 0.7514627802371979, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.17647058823529413, 'F1': 0.20689655172413793, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2573018015140579, 'Valid Loss': 0.7672470605373383, 'Validation Metric': {'Precision': 0.2962962962962963, 'Recall': 0.23529411764705882, 'F1': 0.2622950819672131, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2146165967697189, 'Valid Loss': 0.7770385980606079, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.2647058823529412, 'F1': 0.2903225806451613, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2030241126815478, 'Valid Loss': 0.8014446008205414, 'Validation Metric': {'Precision': 0.2962962962962963, 'Recall': 0.23529411764705882, 'F1': 0.2622950819672131, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.17813507659094674, 'Valid Loss': 0.8076392781734466, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.23529411764705882, 'F1': 0.26666666666666666, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1805799300117152, 'Valid Loss': 0.818847314119339, 'Validation Metric': {'Precision': 0.2962962962962963, 'Recall': 0.23529411764705882, 'F1': 0.2622950819672131, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.16329563068492073, 'Valid Loss': 0.8345249450206756, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.2647058823529412, 'F1': 0.2903225806451613, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.15351237239582197, 'Valid Loss': 0.8389355754852295, 'Validation Metric': {'Precision': 0.2962962962962963, 'Recall': 0.23529411764705882, 'F1': 0.2622950819672131, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.14626934556733995, 'Valid Loss': 0.8433246421813965, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.2647058823529412, 'F1': 0.2903225806451613, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.14264226875134878, 'Valid Loss': 0.8454291927814483, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.2647058823529412, 'F1': 0.2903225806451613, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.32, 'Recall': 0.47058823529411764, 'F1': 0.38095238095238104, 'Acc': 0.48}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.34146341463414637, 'Recall': 0.5, 'F1': 0.40579710144927533, 'Acc': 0.59}; Test loss: 0.6606748127937316
