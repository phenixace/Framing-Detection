Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.701092623940138, 'Valid Loss': 0.6517333502952869, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.09375, 'F1': 0.16216216216216214, 'Acc': 0.693069306930693}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.09375, 'F1': 0.16216216216216214, 'Acc': 0.693069306930693}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6994206097638496, 'Valid Loss': 0.6606900691986084, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.125, 'F1': 0.2, 'Acc': 0.6831683168316832}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.125, 'F1': 0.2, 'Acc': 0.6831683168316832}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6907584956873243, 'Valid Loss': 0.6752469402093154, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.34375, 'F1': 0.3666666666666667, 'Acc': 0.6237623762376238}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.39285714285714285, 'Recall': 0.34375, 'F1': 0.3666666666666667, 'Acc': 0.6237623762376238}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6755700660086124, 'Valid Loss': 0.7018818763586191, 'Validation Metric': {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6466313060198989, 'Valid Loss': 0.704382972075389, 'Validation Metric': {'Precision': 0.2909090909090909, 'Recall': 0.5, 'F1': 0.367816091954023, 'Acc': 0.45544554455445546}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5988260148284591, 'Valid Loss': 0.7180391687613267, 'Validation Metric': {'Precision': 0.3275862068965517, 'Recall': 0.59375, 'F1': 0.42222222222222217, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5551472509575781, 'Valid Loss': 0.702664791391446, 'Validation Metric': {'Precision': 0.3541666666666667, 'Recall': 0.53125, 'F1': 0.425, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4550347330971299, 'Valid Loss': 0.690863895874757, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4375, 'F1': 0.37837837837837834, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.3763199980570891, 'Valid Loss': 0.6756171813377967, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4375, 'F1': 0.39436619718309857, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.31601323688698707, 'Valid Loss': 0.6827454910828517, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.375, 'F1': 0.3636363636363636, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.25204505040266806, 'Valid Loss': 0.690308255644945, 'Validation Metric': {'Precision': 0.34615384615384615, 'Recall': 0.28125, 'F1': 0.3103448275862069, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.23245788971397363, 'Valid Loss': 0.6921007816608136, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.28125, 'F1': 0.3050847457627119, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2043643309691242, 'Valid Loss': 0.6644843495809115, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.25, 'F1': 0.28571428571428575, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.16905207507242667, 'Valid Loss': 0.6788646613176053, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.15894407444746694, 'Valid Loss': 0.6989791891895808, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.28125, 'F1': 0.3396226415094339, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.13013260184882958, 'Valid Loss': 0.7031842733804996, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1312002054998808, 'Valid Loss': 0.7107666621987636, 'Validation Metric': {'Precision': 0.35, 'Recall': 0.21875, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.11828369473185495, 'Valid Loss': 0.720907758634824, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.3125, 'F1': 0.36363636363636365, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1164207987696211, 'Valid Loss': 0.7263820320367813, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.28125, 'F1': 0.3333333333333333, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11725356489002148, 'Valid Loss': 0.7264812565766848, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.28125, 'F1': 0.3333333333333333, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.34545454545454546, 'Recall': 0.59375, 'F1': 0.43678160919540227, 'Acc': 0.5148514851485149}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2830188679245283, 'Recall': 0.4411764705882353, 'F1': 0.3448275862068966, 'Acc': 0.43}; Test loss: 0.6981052541732788
