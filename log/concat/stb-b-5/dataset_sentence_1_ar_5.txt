Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7026510057570059, 'Valid Loss': 0.6780456018447876, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.023255813953488372, 'F1': 0.04444444444444444, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.023255813953488372, 'F1': 0.04444444444444444, 'Acc': 0.57}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7044190930414803, 'Valid Loss': 0.6785932898521423, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.046511627906976744, 'F1': 0.08695652173913045, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.046511627906976744, 'F1': 0.08695652173913045, 'Acc': 0.58}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7012857923024818, 'Valid Loss': 0.6812563467025757, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.20930232558139536, 'F1': 0.3103448275862069, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.20930232558139536, 'F1': 0.3103448275862069, 'Acc': 0.6}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6959452048132692, 'Valid Loss': 0.6845998358726502, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6804630763923065, 'Valid Loss': 0.6889615893363953, 'Validation Metric': {'Precision': 0.45652173913043476, 'Recall': 0.4883720930232558, 'F1': 0.47191011235955055, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45652173913043476, 'Recall': 0.4883720930232558, 'F1': 0.47191011235955055, 'Acc': 0.53}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6635880628718606, 'Valid Loss': 0.7070474362373352, 'Validation Metric': {'Precision': 0.3829787234042553, 'Recall': 0.4186046511627907, 'F1': 0.4, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.45652173913043476, 'Recall': 0.4883720930232558, 'F1': 0.47191011235955055, 'Acc': 0.53}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6288733712480038, 'Valid Loss': 0.6858682632446289, 'Validation Metric': {'Precision': 0.4791666666666667, 'Recall': 0.5348837209302325, 'F1': 0.5054945054945056, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.5348837209302325, 'F1': 0.5054945054945056, 'Acc': 0.55}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5739355456979969, 'Valid Loss': 0.6976758134365082, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.5116279069767442, 'F1': 0.4835164835164835, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4791666666666667, 'Recall': 0.5348837209302325, 'F1': 0.5054945054945056, 'Acc': 0.55}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.530278945270973, 'Valid Loss': 0.696190185546875, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4824866403507281, 'Valid Loss': 0.7035587275028229, 'Validation Metric': {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4428115404104885, 'Valid Loss': 0.7095283615589142, 'Validation Metric': {'Precision': 0.475, 'Recall': 0.4418604651162791, 'F1': 0.4578313253012048, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.39844843613196024, 'Valid Loss': 0.7198696374893189, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.46511627906976744, 'F1': 0.4705882352941176, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.36968765568129625, 'Valid Loss': 0.7370764100551606, 'Validation Metric': {'Precision': 0.46511627906976744, 'Recall': 0.46511627906976744, 'F1': 0.46511627906976744, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3501709275230577, 'Valid Loss': 0.7476741731166839, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.46511627906976744, 'F1': 0.4705882352941176, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.29957772923421255, 'Valid Loss': 0.7621898794174194, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.29607242704192294, 'Valid Loss': 0.7666722559928894, 'Validation Metric': {'Precision': 0.4772727272727273, 'Recall': 0.4883720930232558, 'F1': 0.4827586206896552, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.27664253643796416, 'Valid Loss': 0.7712413334846496, 'Validation Metric': {'Precision': 0.4782608695652174, 'Recall': 0.5116279069767442, 'F1': 0.49438202247191015, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.25640322003937976, 'Valid Loss': 0.7713811230659485, 'Validation Metric': {'Precision': 0.4772727272727273, 'Recall': 0.4883720930232558, 'F1': 0.4827586206896552, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2573721591807619, 'Valid Loss': 0.7746448004245758, 'Validation Metric': {'Precision': 0.4883720930232558, 'Recall': 0.4883720930232558, 'F1': 0.4883720930232558, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.25147542923311644, 'Valid Loss': 0.7772111129760743, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5348837209302325, 'F1': 0.5168539325842696, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.5111111111111111, 'Recall': 0.5348837209302325, 'F1': 0.5227272727272726, 'Acc': 0.58}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5, 'Recall': 0.43636363636363634, 'F1': 0.46601941747572817, 'Acc': 0.45}; Test loss: 0.8014536285400391
