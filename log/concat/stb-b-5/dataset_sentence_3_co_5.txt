Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7048904830217362, 'Valid Loss': 0.7618846457738143, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.27722772277227725}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.27722772277227725}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7120457726716996, 'Valid Loss': 0.7508935401072869, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.013888888888888888, 'F1': 0.02631578947368421, 'Acc': 0.26732673267326734}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.013888888888888888, 'F1': 0.02631578947368421, 'Acc': 0.26732673267326734}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.714450860619545, 'Valid Loss': 0.7407171038480905, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.09722222222222222, 'F1': 0.17073170731707316, 'Acc': 0.32673267326732675}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7, 'Recall': 0.09722222222222222, 'F1': 0.17073170731707316, 'Acc': 0.32673267326732675}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7046415054798126, 'Valid Loss': 0.73347008228302, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.16666666666666666, 'F1': 0.26666666666666666, 'Acc': 0.3465346534653465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.16666666666666666, 'F1': 0.26666666666666666, 'Acc': 0.3465346534653465}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6814219868183136, 'Valid Loss': 0.7256723940372467, 'Validation Metric': {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6273164644837379, 'Valid Loss': 0.7651876853062556, 'Validation Metric': {'Precision': 0.5526315789473685, 'Recall': 0.2916666666666667, 'F1': 0.3818181818181819, 'Acc': 0.32673267326732675}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5456556187570095, 'Valid Loss': 0.7907542895812255, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.2916666666666667, 'F1': 0.3783783783783784, 'Acc': 0.31683168316831684}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4678069186210632, 'Valid Loss': 0.7971895921688813, 'Validation Metric': {'Precision': 0.6052631578947368, 'Recall': 0.3194444444444444, 'F1': 0.41818181818181815, 'Acc': 0.36633663366336633}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.3983421842753887, 'Valid Loss': 0.8299567521764681, 'Validation Metric': {'Precision': 0.6388888888888888, 'Recall': 0.3194444444444444, 'F1': 0.4259259259259259, 'Acc': 0.38613861386138615}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.33294747859239576, 'Valid Loss': 0.8609032298509891, 'Validation Metric': {'Precision': 0.6388888888888888, 'Recall': 0.3194444444444444, 'F1': 0.4259259259259259, 'Acc': 0.38613861386138615}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.2847079881280661, 'Valid Loss': 0.870807952605761, 'Validation Metric': {'Precision': 0.627906976744186, 'Recall': 0.375, 'F1': 0.46956521739130436, 'Acc': 0.39603960396039606}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.26162507981061933, 'Valid Loss': 0.8960430083366541, 'Validation Metric': {'Precision': 0.6097560975609756, 'Recall': 0.3472222222222222, 'F1': 0.4424778761061947, 'Acc': 0.37623762376237624}}
Best validation metric so far: {'Precision': 0.6585365853658537, 'Recall': 0.375, 'F1': 0.4778761061946902, 'Acc': 0.4158415841584158}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.23470200590789317, 'Valid Loss': 0.9001923106037654, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5, 'F1': 0.5714285714285715, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.5, 'F1': 0.5714285714285715, 'Acc': 0.46534653465346537}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.19847764294594528, 'Valid Loss': 0.9089396040026958, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5, 'F1': 0.5714285714285715, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.5, 'F1': 0.5714285714285715, 'Acc': 0.46534653465346537}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.18900729060173035, 'Valid Loss': 0.9184597816604835, 'Validation Metric': {'Precision': 0.6727272727272727, 'Recall': 0.5138888888888888, 'F1': 0.5826771653543307, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6727272727272727, 'Recall': 0.5138888888888888, 'F1': 0.5826771653543307, 'Acc': 0.4752475247524752}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.16707217022776605, 'Valid Loss': 0.9083296289810767, 'Validation Metric': {'Precision': 0.6607142857142857, 'Recall': 0.5138888888888888, 'F1': 0.578125, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.6727272727272727, 'Recall': 0.5138888888888888, 'F1': 0.5826771653543307, 'Acc': 0.4752475247524752}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.14886225000023842, 'Valid Loss': 0.9342306984158663, 'Validation Metric': {'Precision': 0.6607142857142857, 'Recall': 0.5138888888888888, 'F1': 0.578125, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.6727272727272727, 'Recall': 0.5138888888888888, 'F1': 0.5826771653543307, 'Acc': 0.4752475247524752}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.14833129730075598, 'Valid Loss': 0.9203718258784368, 'Validation Metric': {'Precision': 0.6607142857142857, 'Recall': 0.5138888888888888, 'F1': 0.578125, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.6727272727272727, 'Recall': 0.5138888888888888, 'F1': 0.5826771653543307, 'Acc': 0.4752475247524752}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.13892967473715545, 'Valid Loss': 0.9239051840626277, 'Validation Metric': {'Precision': 0.6724137931034483, 'Recall': 0.5416666666666666, 'F1': 0.6, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6724137931034483, 'Recall': 0.5416666666666666, 'F1': 0.6, 'Acc': 0.48514851485148514}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.13477681279182435, 'Valid Loss': 0.9213890834496572, 'Validation Metric': {'Precision': 0.6724137931034483, 'Recall': 0.5416666666666666, 'F1': 0.6, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.6724137931034483, 'Recall': 0.5416666666666666, 'F1': 0.6, 'Acc': 0.48514851485148514}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.603448275862069, 'Recall': 0.5645161290322581, 'F1': 0.5833333333333335, 'Acc': 0.504950495049505}; Test loss: 0.9258881784402407
