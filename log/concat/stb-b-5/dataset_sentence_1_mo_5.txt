Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7103307358652567, 'Valid Loss': 0.6007092189788819, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.85}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.85}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7121375065913303, 'Valid Loss': 0.6324069666862487, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.77}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.85}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6844839239292008, 'Valid Loss': 0.708567681312561, 'Validation Metric': {'Precision': 0.13114754098360656, 'Recall': 0.7272727272727273, 'F1': 0.22222222222222224, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13114754098360656, 'Recall': 0.7272727272727273, 'F1': 0.22222222222222224, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6248403854078526, 'Valid Loss': 0.7670927286148072, 'Validation Metric': {'Precision': 0.12857142857142856, 'Recall': 0.8181818181818182, 'F1': 0.2222222222222222, 'Acc': 0.37}}
Best validation metric so far: {'Precision': 0.13114754098360656, 'Recall': 0.7272727272727273, 'F1': 0.22222222222222224, 'Acc': 0.44}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.5131383559686674, 'Valid Loss': 0.7904121851921082, 'Validation Metric': {'Precision': 0.13333333333333333, 'Recall': 0.7272727272727273, 'F1': 0.22535211267605634, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13333333333333333, 'Recall': 0.7272727272727273, 'F1': 0.22535211267605634, 'Acc': 0.45}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.37578019746344726, 'Valid Loss': 0.8650418329238891, 'Validation Metric': {'Precision': 0.13636363636363635, 'Recall': 0.8181818181818182, 'F1': 0.23376623376623376, 'Acc': 0.41}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13636363636363635, 'Recall': 0.8181818181818182, 'F1': 0.23376623376623376, 'Acc': 0.41}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2536833464241714, 'Valid Loss': 0.9384517383575439, 'Validation Metric': {'Precision': 0.13043478260869565, 'Recall': 0.8181818181818182, 'F1': 0.225, 'Acc': 0.38}}
Best validation metric so far: {'Precision': 0.13636363636363635, 'Recall': 0.8181818181818182, 'F1': 0.23376623376623376, 'Acc': 0.41}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.20253383140448186, 'Valid Loss': 0.5805542403459549, 'Validation Metric': {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.13652941080734884, 'Valid Loss': 0.4414518427848816, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.2727272727272727, 'F1': 0.23076923076923075, 'Acc': 0.8}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.09987480900913691, 'Valid Loss': 0.4075967082381248, 'Validation Metric': {'Precision': 0.2222222222222222, 'Recall': 0.18181818181818182, 'F1': 0.19999999999999998, 'Acc': 0.84}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.0809257098828717, 'Valid Loss': 0.36217628985643385, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.09090909090909091, 'F1': 0.14285714285714288, 'Acc': 0.88}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.06114534673234113, 'Valid Loss': 0.3548836240172386, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.05051154328389562, 'Valid Loss': 0.3604310527443886, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.04504158891898265, 'Valid Loss': 0.36536461174488066, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.03869660269710229, 'Valid Loss': 0.37270622491836547, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.034983402734501755, 'Valid Loss': 0.37675593346357344, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.032062901116961195, 'Valid Loss': 0.3833584199845791, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.030176372676015757, 'Valid Loss': 0.38533892199397085, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.029438109800433942, 'Valid Loss': 0.3893254779279232, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.029662456383540047, 'Valid Loss': 0.39211009696125987, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.89}}
Best validation metric so far: {'Precision': 0.16129032258064516, 'Recall': 0.45454545454545453, 'F1': 0.23809523809523805, 'Acc': 0.68}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.045454545454545456, 'Recall': 0.1111111111111111, 'F1': 0.06451612903225805, 'Acc': 0.71}; Test loss: 0.5489000517129898
