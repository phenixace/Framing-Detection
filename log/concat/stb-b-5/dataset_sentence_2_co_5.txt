Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7061966567328481, 'Valid Loss': 0.7418240427970886, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.34}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.34}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7177958651022478, 'Valid Loss': 0.7313794660568237, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.06153846153846154, 'F1': 0.1142857142857143, 'Acc': 0.38}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.06153846153846154, 'F1': 0.1142857142857143, 'Acc': 0.38}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7166817326738377, 'Valid Loss': 0.7165915846824646, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.09230769230769231, 'F1': 0.16438356164383564, 'Acc': 0.39}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.09230769230769231, 'F1': 0.16438356164383564, 'Acc': 0.39}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6993235879474216, 'Valid Loss': 0.7072201180458069, 'Validation Metric': {'Precision': 0.8235294117647058, 'Recall': 0.2153846153846154, 'F1': 0.3414634146341464, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8235294117647058, 'Recall': 0.2153846153846154, 'F1': 0.3414634146341464, 'Acc': 0.46}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6773980404391433, 'Valid Loss': 0.7204762172698974, 'Validation Metric': {'Precision': 0.5945945945945946, 'Recall': 0.3384615384615385, 'F1': 0.43137254901960786, 'Acc': 0.42}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5945945945945946, 'Recall': 0.3384615384615385, 'F1': 0.43137254901960786, 'Acc': 0.42}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6160023709138235, 'Valid Loss': 0.7408260846138001, 'Validation Metric': {'Precision': 0.627906976744186, 'Recall': 0.4153846153846154, 'F1': 0.5, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.627906976744186, 'Recall': 0.4153846153846154, 'F1': 0.5, 'Acc': 0.46}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5490358998679151, 'Valid Loss': 0.7614921081066132, 'Validation Metric': {'Precision': 0.6052631578947368, 'Recall': 0.35384615384615387, 'F1': 0.44660194174757284, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.627906976744186, 'Recall': 0.4153846153846154, 'F1': 0.5, 'Acc': 0.46}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4855869939230909, 'Valid Loss': 0.7589724946022034, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.4153846153846154, 'F1': 0.5192307692307692, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.4153846153846154, 'F1': 0.5192307692307692, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.40974972449769875, 'Valid Loss': 0.7631389391422272, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.47692307692307695, 'F1': 0.5486725663716815, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6458333333333334, 'Recall': 0.47692307692307695, 'F1': 0.5486725663716815, 'Acc': 0.49}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.3554667431597758, 'Valid Loss': 0.7762615215778351, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.46153846153846156, 'F1': 0.5357142857142858, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.6458333333333334, 'Recall': 0.47692307692307695, 'F1': 0.5486725663716815, 'Acc': 0.49}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.28493368798735164, 'Valid Loss': 0.7771660721302033, 'Validation Metric': {'Precision': 0.68, 'Recall': 0.5230769230769231, 'F1': 0.591304347826087, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.68, 'Recall': 0.5230769230769231, 'F1': 0.591304347826087, 'Acc': 0.53}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2614334368645543, 'Valid Loss': 0.7944688069820404, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.5230769230769231, 'F1': 0.5714285714285714, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.68, 'Recall': 0.5230769230769231, 'F1': 0.591304347826087, 'Acc': 0.53}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.23893673793234008, 'Valid Loss': 0.7981400847434997, 'Validation Metric': {'Precision': 0.6379310344827587, 'Recall': 0.5692307692307692, 'F1': 0.6016260162601627, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6379310344827587, 'Recall': 0.5692307692307692, 'F1': 0.6016260162601627, 'Acc': 0.51}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.20126198224648081, 'Valid Loss': 0.8074279379844665, 'Validation Metric': {'Precision': 0.639344262295082, 'Recall': 0.6, 'F1': 0.619047619047619, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.639344262295082, 'Recall': 0.6, 'F1': 0.619047619047619, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.20088262359301248, 'Valid Loss': 0.8233802485466003, 'Validation Metric': {'Precision': 0.639344262295082, 'Recall': 0.6, 'F1': 0.619047619047619, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.639344262295082, 'Recall': 0.6, 'F1': 0.619047619047619, 'Acc': 0.52}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.16754906511668002, 'Valid Loss': 0.8337719929218292, 'Validation Metric': {'Precision': 0.6507936507936508, 'Recall': 0.6307692307692307, 'F1': 0.640625, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6507936507936508, 'Recall': 0.6307692307692307, 'F1': 0.640625, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.16587511657012832, 'Valid Loss': 0.8314931547641754, 'Validation Metric': {'Precision': 0.6461538461538462, 'Recall': 0.6461538461538462, 'F1': 0.6461538461538462, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6461538461538462, 'Recall': 0.6461538461538462, 'F1': 0.6461538461538462, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.14976568113673816, 'Valid Loss': 0.8404766535758972, 'Validation Metric': {'Precision': 0.6721311475409836, 'Recall': 0.6307692307692307, 'F1': 0.6507936507936507, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6721311475409836, 'Recall': 0.6307692307692307, 'F1': 0.6507936507936507, 'Acc': 0.56}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.14991577853909646, 'Valid Loss': 0.8465052890777588, 'Validation Metric': {'Precision': 0.6612903225806451, 'Recall': 0.6307692307692307, 'F1': 0.6456692913385826, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6721311475409836, 'Recall': 0.6307692307692307, 'F1': 0.6507936507936507, 'Acc': 0.56}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.14180029646465273, 'Valid Loss': 0.8474823260307311, 'Validation Metric': {'Precision': 0.640625, 'Recall': 0.6307692307692307, 'F1': 0.6356589147286822, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6721311475409836, 'Recall': 0.6307692307692307, 'F1': 0.6507936507936507, 'Acc': 0.56}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.676923076923077, 'Recall': 0.6111111111111112, 'F1': 0.6423357664233577, 'Acc': 0.5148514851485149}; Test loss: 0.8334851024242548
