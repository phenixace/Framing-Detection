Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.699291170911586, 'Valid Loss': 0.6835551376526172, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.06521739130434782, 'F1': 0.11538461538461539, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.06521739130434782, 'F1': 0.11538461538461539, 'Acc': 0.5445544554455446}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6945270325275178, 'Valid Loss': 0.6835264403086442, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.15217391304347827, 'F1': 0.25, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7, 'Recall': 0.15217391304347827, 'F1': 0.25, 'Acc': 0.5841584158415841}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6890228955035514, 'Valid Loss': 0.6850775526120112, 'Validation Metric': {'Precision': 0.65, 'Recall': 0.2826086956521739, 'F1': 0.3939393939393939, 'Acc': 0.6039603960396039}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.2826086956521739, 'F1': 0.3939393939393939, 'Acc': 0.6039603960396039}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6801066956621535, 'Valid Loss': 0.6852948528069717, 'Validation Metric': {'Precision': 0.5357142857142857, 'Recall': 0.32608695652173914, 'F1': 0.40540540540540543, 'Acc': 0.5643564356435643}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5357142857142857, 'Recall': 0.32608695652173914, 'F1': 0.40540540540540543, 'Acc': 0.5643564356435643}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6570905694302093, 'Valid Loss': 0.687384905723425, 'Validation Metric': {'Precision': 0.5348837209302325, 'Recall': 0.5, 'F1': 0.5168539325842696, 'Acc': 0.5742574257425742}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5348837209302325, 'Recall': 0.5, 'F1': 0.5168539325842696, 'Acc': 0.5742574257425742}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6222280891651802, 'Valid Loss': 0.6911174609110906, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5786930715784113, 'Valid Loss': 0.6975023035819714, 'Validation Metric': {'Precision': 0.48936170212765956, 'Recall': 0.5, 'F1': 0.4946236559139785, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5175194629329316, 'Valid Loss': 0.6989318430423737, 'Validation Metric': {'Precision': 0.5277777777777778, 'Recall': 0.41304347826086957, 'F1': 0.4634146341463415, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4598385919915869, 'Valid Loss': 0.7218490586831019, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.391304347826087, 'F1': 0.4390243902439025, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4069235407291575, 'Valid Loss': 0.7236004769802094, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.34782608695652173, 'F1': 0.4155844155844156, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.35219294371757104, 'Valid Loss': 0.7445946702590356, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.30434782608695654, 'F1': 0.3783783783783784, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3300751102097491, 'Valid Loss': 0.7574422646027344, 'Validation Metric': {'Precision': 0.4827586206896552, 'Recall': 0.30434782608695654, 'F1': 0.3733333333333333, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2861989099294581, 'Valid Loss': 0.7702984798413056, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.30434782608695654, 'F1': 0.3888888888888889, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.25673453208613906, 'Valid Loss': 0.7951351427114927, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.34782608695652173, 'F1': 0.41025641025641024, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.24179537451647698, 'Valid Loss': 0.7967832558430158, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2608695652173913, 'F1': 0.3428571428571428, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.22758958258844436, 'Valid Loss': 0.8092930041826688, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2826086956521739, 'F1': 0.3611111111111111, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.20383095289481448, 'Valid Loss': 0.8185775108062304, 'Validation Metric': {'Precision': 0.5357142857142857, 'Recall': 0.32608695652173914, 'F1': 0.40540540540540543, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.19591047686148197, 'Valid Loss': 0.8367906453517767, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32608695652173914, 'F1': 0.39473684210526316, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1864359847250137, 'Valid Loss': 0.8458403738645407, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32608695652173914, 'F1': 0.39473684210526316, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19086111218054244, 'Valid Loss': 0.8427893496476687, 'Validation Metric': {'Precision': 0.5333333333333333, 'Recall': 0.34782608695652173, 'F1': 0.4210526315789474, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5652173913043478, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4888888888888889, 'Recall': 0.5116279069767442, 'F1': 0.5, 'Acc': 0.56}; Test loss: 0.6868012237548828
