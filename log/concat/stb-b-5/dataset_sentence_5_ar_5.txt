Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7101414565798603, 'Valid Loss': 0.708968014717102, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.018518518518518517, 'F1': 0.03571428571428571, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.018518518518518517, 'F1': 0.03571428571428571, 'Acc': 0.46}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.713070537470564, 'Valid Loss': 0.7042828559875488, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.037037037037037035, 'F1': 0.07017543859649122, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.037037037037037035, 'F1': 0.07017543859649122, 'Acc': 0.47}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7083447764191446, 'Valid Loss': 0.6985100364685058, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.07407407407407407, 'F1': 0.13114754098360656, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.07407407407407407, 'F1': 0.13114754098360656, 'Acc': 0.47}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.700033032441441, 'Valid Loss': 0.6945556211471557, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.14814814814814814, 'F1': 0.22535211267605632, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47058823529411764, 'Recall': 0.14814814814814814, 'F1': 0.22535211267605632, 'Acc': 0.45}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.696944651724417, 'Valid Loss': 0.6933587431907654, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.2962962962962963, 'F1': 0.3902439024390244, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.2962962962962963, 'F1': 0.3902439024390244, 'Acc': 0.5}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.686043658588506, 'Valid Loss': 0.692728180885315, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.3888888888888889, 'F1': 0.47191011235955055, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.3888888888888889, 'F1': 0.47191011235955055, 'Acc': 0.53}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6601735874067379, 'Valid Loss': 0.6814280271530151, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6413688554039484, 'Valid Loss': 0.6832820773124695, 'Validation Metric': {'Precision': 0.6226415094339622, 'Recall': 0.6111111111111112, 'F1': 0.616822429906542, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6072700423530385, 'Valid Loss': 0.6901393723487854, 'Validation Metric': {'Precision': 0.6136363636363636, 'Recall': 0.5, 'F1': 0.5510204081632653, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5743680807608592, 'Valid Loss': 0.6896747422218322, 'Validation Metric': {'Precision': 0.5897435897435898, 'Recall': 0.42592592592592593, 'F1': 0.49462365591397855, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5384802403329294, 'Valid Loss': 0.690969660282135, 'Validation Metric': {'Precision': 0.574468085106383, 'Recall': 0.5, 'F1': 0.5346534653465347, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.490060412431065, 'Valid Loss': 0.7060133361816406, 'Validation Metric': {'Precision': 0.5813953488372093, 'Recall': 0.46296296296296297, 'F1': 0.5154639175257731, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.48205978772308256, 'Valid Loss': 0.714482147693634, 'Validation Metric': {'Precision': 0.5769230769230769, 'Recall': 0.5555555555555556, 'F1': 0.5660377358490566, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4335436453170414, 'Valid Loss': 0.7165799367427826, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.5185185185185185, 'F1': 0.5436893203883496, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.40021633837796466, 'Valid Loss': 0.7243472981452942, 'Validation Metric': {'Precision': 0.5882352941176471, 'Recall': 0.5555555555555556, 'F1': 0.5714285714285715, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.36869165565394146, 'Valid Loss': 0.7427471876144409, 'Validation Metric': {'Precision': 0.5535714285714286, 'Recall': 0.5740740740740741, 'F1': 0.5636363636363636, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.34827252656598634, 'Valid Loss': 0.7482903492450714, 'Validation Metric': {'Precision': 0.5892857142857143, 'Recall': 0.6111111111111112, 'F1': 0.6, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.34841813712934905, 'Valid Loss': 0.7559075963497162, 'Validation Metric': {'Precision': 0.5535714285714286, 'Recall': 0.5740740740740741, 'F1': 0.5636363636363636, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.33240331218966956, 'Valid Loss': 0.7563646447658539, 'Validation Metric': {'Precision': 0.5471698113207547, 'Recall': 0.5370370370370371, 'F1': 0.5420560747663552, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3188475261006174, 'Valid Loss': 0.7599249494075775, 'Validation Metric': {'Precision': 0.5370370370370371, 'Recall': 0.5370370370370371, 'F1': 0.5370370370370371, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.6666666666666666, 'F1': 0.6792452830188679, 'Acc': 0.66}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4444444444444444, 'Recall': 0.46511627906976744, 'F1': 0.4545454545454546, 'Acc': 0.52}; Test loss: 0.6896634411811828
