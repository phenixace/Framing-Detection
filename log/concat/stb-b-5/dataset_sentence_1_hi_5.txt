Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7007717662132703, 'Valid Loss': 0.6390550851821899, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7071121403804193, 'Valid Loss': 0.6460659217834472, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7068876618376145, 'Valid Loss': 0.6567965388298035, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.68}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6905622098308343, 'Valid Loss': 0.6694990038871765, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6736749364779546, 'Valid Loss': 0.6713310933113098, 'Validation Metric': {'Precision': 0.37142857142857144, 'Recall': 0.4642857142857143, 'F1': 0.41269841269841273, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37142857142857144, 'Recall': 0.4642857142857143, 'F1': 0.41269841269841273, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6377392998681619, 'Valid Loss': 0.6644203460216522, 'Validation Metric': {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5620097242868863, 'Valid Loss': 0.6711126160621643, 'Validation Metric': {'Precision': 0.3902439024390244, 'Recall': 0.5714285714285714, 'F1': 0.463768115942029, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.46243245899677277, 'Valid Loss': 0.6699562084674835, 'Validation Metric': {'Precision': 0.37142857142857144, 'Recall': 0.4642857142857143, 'F1': 0.41269841269841273, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.39193516625807834, 'Valid Loss': 0.6797504770755768, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.35714285714285715, 'F1': 0.35714285714285715, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.3265549795558819, 'Valid Loss': 0.6791004657745361, 'Validation Metric': {'Precision': 0.37037037037037035, 'Recall': 0.35714285714285715, 'F1': 0.36363636363636365, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.2647634684466399, 'Valid Loss': 0.6875575721263886, 'Validation Metric': {'Precision': 0.35, 'Recall': 0.25, 'F1': 0.2916666666666667, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2362685207134256, 'Valid Loss': 0.6974937903881073, 'Validation Metric': {'Precision': 0.36, 'Recall': 0.32142857142857145, 'F1': 0.33962264150943394, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.21502943050402862, 'Valid Loss': 0.7146017950773239, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.2857142857142857, 'F1': 0.32, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1816949711109583, 'Valid Loss': 0.7243344831466675, 'Validation Metric': {'Precision': 0.32, 'Recall': 0.2857142857142857, 'F1': 0.30188679245283023, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1741859159217431, 'Valid Loss': 0.7413223767280579, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.2857142857142857, 'F1': 0.29629629629629634, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1557982268098455, 'Valid Loss': 0.7461200910806656, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.14495848405819672, 'Valid Loss': 0.7504797267913819, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.13005882343993738, 'Valid Loss': 0.7571966910362243, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.12462739972397685, 'Valid Loss': 0.7580644100904464, 'Validation Metric': {'Precision': 0.32, 'Recall': 0.2857142857142857, 'F1': 0.30188679245283023, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11326968523028952, 'Valid Loss': 0.7594147491455078, 'Validation Metric': {'Precision': 0.32, 'Recall': 0.2857142857142857, 'F1': 0.30188679245283023, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.425, 'Recall': 0.6071428571428571, 'F1': 0.5, 'Acc': 0.66}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2916666666666667, 'Recall': 0.4375, 'F1': 0.35000000000000003, 'Acc': 0.48}; Test loss: 0.7109990406036377
