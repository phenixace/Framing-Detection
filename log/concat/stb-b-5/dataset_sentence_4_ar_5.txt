Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7050131056215856, 'Valid Loss': 0.7053584364744333, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.05660377358490566, 'F1': 0.10526315789473685, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.05660377358490566, 'F1': 0.10526315789473685, 'Acc': 0.49504950495049505}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7041448076050003, 'Valid Loss': 0.702429670553941, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.05660377358490566, 'F1': 0.1016949152542373, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.05660377358490566, 'F1': 0.10526315789473685, 'Acc': 0.49504950495049505}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7019951784765566, 'Valid Loss': 0.6986319308097546, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.16981132075471697, 'F1': 0.2571428571428572, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5294117647058824, 'Recall': 0.16981132075471697, 'F1': 0.2571428571428572, 'Acc': 0.48514851485148514}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6964362194011737, 'Valid Loss': 0.6976458934637216, 'Validation Metric': {'Precision': 0.4838709677419355, 'Recall': 0.2830188679245283, 'F1': 0.3571428571428572, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4838709677419355, 'Recall': 0.2830188679245283, 'F1': 0.3571428571428572, 'Acc': 0.46534653465346537}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6843932898013623, 'Valid Loss': 0.6955970181868627, 'Validation Metric': {'Precision': 0.5121951219512195, 'Recall': 0.39622641509433965, 'F1': 0.44680851063829785, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.39622641509433965, 'F1': 0.44680851063829785, 'Acc': 0.48514851485148514}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6772032720702035, 'Valid Loss': 0.6950026360841898, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.41509433962264153, 'F1': 0.4731182795698925, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.55, 'Recall': 0.41509433962264153, 'F1': 0.4731182795698925, 'Acc': 0.5148514851485149}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6525781166243863, 'Valid Loss': 0.6925787467222947, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.5094339622641509, 'F1': 0.5346534653465346, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5625, 'Recall': 0.5094339622641509, 'F1': 0.5346534653465346, 'Acc': 0.5346534653465347}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.620498606136867, 'Valid Loss': 0.6947589081067306, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5858628548584975, 'Valid Loss': 0.7000811191705557, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.33962264150943394, 'F1': 0.41379310344827586, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5349317150456565, 'Valid Loss': 0.704597145318985, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.3018867924528302, 'F1': 0.380952380952381, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5108183123074569, 'Valid Loss': 0.6983045901243503, 'Validation Metric': {'Precision': 0.5945945945945946, 'Recall': 0.41509433962264153, 'F1': 0.48888888888888893, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4768079484437967, 'Valid Loss': 0.7047191686355151, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.4339622641509434, 'F1': 0.48421052631578954, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4372970318639433, 'Valid Loss': 0.7097630592492911, 'Validation Metric': {'Precision': 0.525, 'Recall': 0.39622641509433965, 'F1': 0.45161290322580644, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.41808989876276487, 'Valid Loss': 0.7159970242243546, 'Validation Metric': {'Precision': 0.5609756097560976, 'Recall': 0.4339622641509434, 'F1': 0.4893617021276596, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.38572530700014784, 'Valid Loss': 0.7236683781330402, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.41509433962264153, 'F1': 0.4731182795698925, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.36979744476931437, 'Valid Loss': 0.7393794094140713, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.41509433962264153, 'F1': 0.4631578947368421, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3528475252451835, 'Valid Loss': 0.7401761825268085, 'Validation Metric': {'Precision': 0.5641025641025641, 'Recall': 0.41509433962264153, 'F1': 0.4782608695652174, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.34075544348784853, 'Valid Loss': 0.7427010994691116, 'Validation Metric': {'Precision': 0.5609756097560976, 'Recall': 0.4339622641509434, 'F1': 0.4893617021276596, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.32261097392478544, 'Valid Loss': 0.7472314903369317, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.4339622641509434, 'F1': 0.48421052631578954, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.31832099396300007, 'Valid Loss': 0.7469247579574585, 'Validation Metric': {'Precision': 0.5609756097560976, 'Recall': 0.4339622641509434, 'F1': 0.4893617021276596, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.5283018867924528, 'F1': 0.5490196078431372, 'Acc': 0.5445544554455446}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5652173913043478, 'Recall': 0.48148148148148145, 'F1': 0.52, 'Acc': 0.52}; Test loss: 0.6984545350074768
