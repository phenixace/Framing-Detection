Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7005016740698081, 'Valid Loss': 0.6529531502723693, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03125, 'F1': 0.05714285714285714, 'Acc': 0.67}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03125, 'F1': 0.05714285714285714, 'Acc': 0.67}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7007399780245928, 'Valid Loss': 0.6610860848426818, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.09375, 'F1': 0.15384615384615383, 'Acc': 0.67}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.09375, 'F1': 0.15384615384615383, 'Acc': 0.67}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6924222254982362, 'Valid Loss': 0.6753459167480469, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.28125, 'F1': 0.3272727272727273, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.28125, 'F1': 0.3272727272727273, 'Acc': 0.63}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6768593535973475, 'Valid Loss': 0.6956760716438294, 'Validation Metric': {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.649868425554954, 'Valid Loss': 0.7069767069816589, 'Validation Metric': {'Precision': 0.3269230769230769, 'Recall': 0.53125, 'F1': 0.40476190476190477, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5991810422677261, 'Valid Loss': 0.7124577736854554, 'Validation Metric': {'Precision': 0.3111111111111111, 'Recall': 0.4375, 'F1': 0.3636363636363637, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5283051359538848, 'Valid Loss': 0.7372662258148194, 'Validation Metric': {'Precision': 0.2826086956521739, 'Recall': 0.40625, 'F1': 0.33333333333333337, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.44093068674779856, 'Valid Loss': 0.7403650379180908, 'Validation Metric': {'Precision': 0.3023255813953488, 'Recall': 0.40625, 'F1': 0.3466666666666667, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.37342212062615615, 'Valid Loss': 0.7561619067192078, 'Validation Metric': {'Precision': 0.3157894736842105, 'Recall': 0.375, 'F1': 0.34285714285714286, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2987464780990894, 'Valid Loss': 0.7450814151763916, 'Validation Metric': {'Precision': 0.32432432432432434, 'Recall': 0.375, 'F1': 0.34782608695652173, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.2504027918554269, 'Valid Loss': 0.7797226440906525, 'Validation Metric': {'Precision': 0.3055555555555556, 'Recall': 0.34375, 'F1': 0.3235294117647059, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.22759006509127525, 'Valid Loss': 0.7793487238883973, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.375, 'F1': 0.35294117647058826, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.20610467810183764, 'Valid Loss': 0.787497164607048, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.34375, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18343481013121513, 'Valid Loss': 0.8020067512989044, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.34375, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.16317997285379812, 'Valid Loss': 0.8066336327791214, 'Validation Metric': {'Precision': 0.3235294117647059, 'Recall': 0.34375, 'F1': 0.33333333333333337, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1488596646186824, 'Valid Loss': 0.8073168444633484, 'Validation Metric': {'Precision': 0.3235294117647059, 'Recall': 0.34375, 'F1': 0.33333333333333337, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.14283969045545047, 'Valid Loss': 0.8241276717185975, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.34375, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.13742274762346193, 'Valid Loss': 0.816902049779892, 'Validation Metric': {'Precision': 0.34285714285714286, 'Recall': 0.375, 'F1': 0.3582089552238806, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.14033476571337536, 'Valid Loss': 0.8318953680992126, 'Validation Metric': {'Precision': 0.3142857142857143, 'Recall': 0.34375, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.12610922789630982, 'Valid Loss': 0.8312394404411316, 'Validation Metric': {'Precision': 0.3235294117647059, 'Recall': 0.34375, 'F1': 0.33333333333333337, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34782608695652173, 'Recall': 0.5, 'F1': 0.41025641025641024, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.23076923076923078, 'Recall': 0.32142857142857145, 'F1': 0.2686567164179105, 'Acc': 0.5148514851485149}; Test loss: 0.7052173637426816
