Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6943748867913578, 'Valid Loss': 0.6811316037178039, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6939920501762562, 'Valid Loss': 0.6814482092857361, 'Validation Metric': {'Precision': 0.875, 'Recall': 0.16279069767441862, 'F1': 0.2745098039215686, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.875, 'Recall': 0.16279069767441862, 'F1': 0.2745098039215686, 'Acc': 0.63}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6904497561829813, 'Valid Loss': 0.6834807634353638, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.18604651162790697, 'F1': 0.2857142857142857, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6153846153846154, 'Recall': 0.18604651162790697, 'F1': 0.2857142857142857, 'Acc': 0.6}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6820933363410864, 'Valid Loss': 0.686541850566864, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.32558139534883723, 'F1': 0.4057971014492754, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.32558139534883723, 'F1': 0.4057971014492754, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6651625077376205, 'Valid Loss': 0.6883101153373719, 'Validation Metric': {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.628534279847413, 'Valid Loss': 0.6826273798942566, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2558139534883721, 'F1': 0.3384615384615385, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6001551201504268, 'Valid Loss': 0.6889985418319702, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.3023255813953488, 'F1': 0.38235294117647056, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5319143426552247, 'Valid Loss': 0.7045298707485199, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.37209302325581395, 'F1': 0.4324324324324324, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4781128251820468, 'Valid Loss': 0.7106480646133423, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32558139534883723, 'F1': 0.3943661971830986, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.44036773667576606, 'Valid Loss': 0.735938105583191, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.3023255813953488, 'F1': 0.37681159420289856, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3808367744590459, 'Valid Loss': 0.7352976775169373, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.3023255813953488, 'F1': 0.38235294117647056, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.34744698294762816, 'Valid Loss': 0.7454740846157074, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.3023255813953488, 'F1': 0.38235294117647056, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3162455609005489, 'Valid Loss': 0.7525056779384613, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.3023255813953488, 'F1': 0.38235294117647056, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.28705796716588267, 'Valid Loss': 0.7669637680053711, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.2558139534883721, 'F1': 0.3235294117647059, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2679028309295686, 'Valid Loss': 0.7866088104248047, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.3023255813953488, 'F1': 0.35616438356164387, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2438862765772959, 'Valid Loss': 0.7911111295223237, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.2558139534883721, 'F1': 0.3098591549295775, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.23421764072407497, 'Valid Loss': 0.7978330731391907, 'Validation Metric': {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.23632990652590655, 'Valid Loss': 0.8071297860145569, 'Validation Metric': {'Precision': 0.4482758620689655, 'Recall': 0.3023255813953488, 'F1': 0.36111111111111105, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.228692139132639, 'Valid Loss': 0.8076359140872955, 'Validation Metric': {'Precision': 0.4482758620689655, 'Recall': 0.3023255813953488, 'F1': 0.36111111111111105, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.20752839266919018, 'Valid Loss': 0.8105268335342407, 'Validation Metric': {'Precision': 0.4482758620689655, 'Recall': 0.3023255813953488, 'F1': 0.36111111111111105, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5151515151515151, 'Recall': 0.3953488372093023, 'F1': 0.4473684210526315, 'Acc': 0.58}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.19444444444444445, 'Recall': 0.2, 'F1': 0.19718309859154928, 'Acc': 0.43564356435643564}; Test loss: 0.707484089411222
