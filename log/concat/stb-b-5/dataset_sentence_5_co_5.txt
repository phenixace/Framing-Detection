Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7079612839221955, 'Valid Loss': 0.7688814640045166, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.04225352112676056, 'F1': 0.08, 'Acc': 0.31}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.04225352112676056, 'F1': 0.08, 'Acc': 0.31}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7132914513349533, 'Valid Loss': 0.7585002088546753, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.056338028169014086, 'F1': 0.10526315789473684, 'Acc': 0.32}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.056338028169014086, 'F1': 0.10526315789473684, 'Acc': 0.32}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7150407153367996, 'Valid Loss': 0.7450377058982849, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.11267605633802817, 'F1': 0.19753086419753088, 'Acc': 0.35}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.11267605633802817, 'F1': 0.19753086419753088, 'Acc': 0.35}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7080633389949799, 'Valid Loss': 0.7319915747642517, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.22535211267605634, 'F1': 0.3516483516483517, 'Acc': 0.41}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.22535211267605634, 'F1': 0.3516483516483517, 'Acc': 0.41}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6893663883209229, 'Valid Loss': 0.7300177788734437, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.2535211267605634, 'F1': 0.37113402061855666, 'Acc': 0.39}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.2535211267605634, 'F1': 0.37113402061855666, 'Acc': 0.39}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6475343078374862, 'Valid Loss': 0.7195832848548889, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.5070422535211268, 'F1': 0.6206896551724138, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.5070422535211268, 'F1': 0.6206896551724138, 'Acc': 0.56}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.585460649728775, 'Valid Loss': 0.7225740015506744, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.5070422535211268, 'F1': 0.5901639344262296, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.5070422535211268, 'F1': 0.6206896551724138, 'Acc': 0.56}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.48444865852594376, 'Valid Loss': 0.7187623345851898, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4110669259727001, 'Valid Loss': 0.7375571763515473, 'Validation Metric': {'Precision': 0.6935483870967742, 'Recall': 0.6056338028169014, 'F1': 0.6466165413533835, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.36111149087548255, 'Valid Loss': 0.7352244234085084, 'Validation Metric': {'Precision': 0.676923076923077, 'Recall': 0.6197183098591549, 'F1': 0.6470588235294118, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.31231665313243867, 'Valid Loss': 0.7548624283075333, 'Validation Metric': {'Precision': 0.6567164179104478, 'Recall': 0.6197183098591549, 'F1': 0.6376811594202898, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2700254288315773, 'Valid Loss': 0.7575667953491211, 'Validation Metric': {'Precision': 0.6521739130434783, 'Recall': 0.6338028169014085, 'F1': 0.6428571428571428, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2321308983117342, 'Valid Loss': 0.7661971622705459, 'Validation Metric': {'Precision': 0.6521739130434783, 'Recall': 0.6338028169014085, 'F1': 0.6428571428571428, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2168101156502962, 'Valid Loss': 0.7785525405406952, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.647887323943662, 'F1': 0.6571428571428573, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19064987383782864, 'Valid Loss': 0.7935103839635849, 'Validation Metric': {'Precision': 0.6617647058823529, 'Recall': 0.6338028169014085, 'F1': 0.6474820143884893, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18404333364218473, 'Valid Loss': 0.7916078400611878, 'Validation Metric': {'Precision': 0.6764705882352942, 'Recall': 0.647887323943662, 'F1': 0.6618705035971224, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.15940997887402772, 'Valid Loss': 0.7977388203144073, 'Validation Metric': {'Precision': 0.6764705882352942, 'Recall': 0.647887323943662, 'F1': 0.6618705035971224, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.15258314371109008, 'Valid Loss': 0.8012674158811569, 'Validation Metric': {'Precision': 0.6764705882352942, 'Recall': 0.647887323943662, 'F1': 0.6618705035971224, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.14720637686550617, 'Valid Loss': 0.8029396152496338, 'Validation Metric': {'Precision': 0.6764705882352942, 'Recall': 0.647887323943662, 'F1': 0.6618705035971224, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1520043717324734, 'Valid Loss': 0.8016752567887306, 'Validation Metric': {'Precision': 0.6764705882352942, 'Recall': 0.647887323943662, 'F1': 0.6618705035971224, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.6338028169014085, 'F1': 0.6716417910447761, 'Acc': 0.56}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.631578947368421, 'Recall': 0.5625, 'F1': 0.5950413223140496, 'Acc': 0.51}; Test loss: 0.7267182695865632
