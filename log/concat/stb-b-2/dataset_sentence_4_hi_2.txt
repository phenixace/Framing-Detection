Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7095241206828679, 'Valid Loss': 0.6556365627508897, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.125, 'F1': 0.17777777777777778, 'Acc': 0.6336633663366337}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3076923076923077, 'Recall': 0.125, 'F1': 0.17777777777777778, 'Acc': 0.6336633663366337}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.70703999127183, 'Valid Loss': 0.663204509478349, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.6435643564356436}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.6435643564356436}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7037508303874007, 'Valid Loss': 0.6770736437577468, 'Validation Metric': {'Precision': 0.37777777777777777, 'Recall': 0.53125, 'F1': 0.4415584415584416, 'Acc': 0.5742574257425742}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37777777777777777, 'Recall': 0.53125, 'F1': 0.4415584415584416, 'Acc': 0.5742574257425742}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6867316738467351, 'Valid Loss': 0.6870791109708639, 'Validation Metric': {'Precision': 0.33962264150943394, 'Recall': 0.5625, 'F1': 0.4235294117647059, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.37777777777777777, 'Recall': 0.53125, 'F1': 0.4415584415584416, 'Acc': 0.5742574257425742}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6600689776589937, 'Valid Loss': 0.6889839378687052, 'Validation Metric': {'Precision': 0.37254901960784315, 'Recall': 0.59375, 'F1': 0.4578313253012048, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37254901960784315, 'Recall': 0.59375, 'F1': 0.4578313253012048, 'Acc': 0.5544554455445545}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.5875048528764849, 'Valid Loss': 0.7169258227715125, 'Validation Metric': {'Precision': 0.3582089552238806, 'Recall': 0.75, 'F1': 0.48484848484848486, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3582089552238806, 'Recall': 0.75, 'F1': 0.48484848484848486, 'Acc': 0.49504950495049505}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5324168082709625, 'Valid Loss': 0.7447010909135525, 'Validation Metric': {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4464813954083719, 'Valid Loss': 0.7333789444886721, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.5625, 'F1': 0.45, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.37178873667650136, 'Valid Loss': 0.7283972134956946, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.31479901869163335, 'Valid Loss': 0.7348021543942965, 'Validation Metric': {'Precision': 0.3488372093023256, 'Recall': 0.46875, 'F1': 0.4000000000000001, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.24667116491315522, 'Valid Loss': 0.7690461977170064, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.40625, 'F1': 0.36619718309859156, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.22896434178697728, 'Valid Loss': 0.7824531209010345, 'Validation Metric': {'Precision': 0.3684210526315789, 'Recall': 0.4375, 'F1': 0.39999999999999997, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19291600692912797, 'Valid Loss': 0.8058613057319934, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4375, 'F1': 0.39436619718309857, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.16415426424034288, 'Valid Loss': 0.8028877904781928, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.4375, 'F1': 0.41791044776119407, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.16334965045207014, 'Valid Loss': 0.7978346834962184, 'Validation Metric': {'Precision': 0.34375, 'Recall': 0.34375, 'F1': 0.34375, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.15933986854191137, 'Valid Loss': 0.8112140188996608, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.375, 'F1': 0.375, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1426580080362124, 'Valid Loss': 0.8229243319768172, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.375, 'F1': 0.3692307692307692, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1311724758315309, 'Valid Loss': 0.8267886885083638, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.3125, 'F1': 0.3225806451612903, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.11983196691514175, 'Valid Loss': 0.834134035385572, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.375, 'F1': 0.3636363636363636, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11972956178344299, 'Valid Loss': 0.8362328306986735, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.375, 'F1': 0.3636363636363636, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.38235294117647056, 'Recall': 0.8125, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.35714285714285715, 'Recall': 0.7352941176470589, 'F1': 0.4807692307692307, 'Acc': 0.46}; Test loss: 0.7664727902412415
