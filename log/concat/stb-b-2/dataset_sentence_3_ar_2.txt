Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7063423826506263, 'Valid Loss': 0.6970660067521609, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.18, 'F1': 0.2647058823529412, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.18, 'F1': 0.2647058823529412, 'Acc': 0.504950495049505}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7134088701323459, 'Valid Loss': 0.6959941112078153, 'Validation Metric': {'Precision': 0.5185185185185185, 'Recall': 0.28, 'F1': 0.36363636363636365, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5185185185185185, 'Recall': 0.28, 'F1': 0.36363636363636365, 'Acc': 0.5148514851485149}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.70468848786856, 'Valid Loss': 0.6958818710767306, 'Validation Metric': {'Precision': 0.5128205128205128, 'Recall': 0.4, 'F1': 0.449438202247191, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5128205128205128, 'Recall': 0.4, 'F1': 0.449438202247191, 'Acc': 0.5148514851485149}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6964821180230693, 'Valid Loss': 0.6965565200035388, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6884857463209253, 'Valid Loss': 0.6983548907133249, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5, 'F1': 0.5, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6748591316373724, 'Valid Loss': 0.7015623243955466, 'Validation Metric': {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.649639619808448, 'Valid Loss': 0.7047328467552478, 'Validation Metric': {'Precision': 0.5102040816326531, 'Recall': 0.5, 'F1': 0.5050505050505051, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6162292937699118, 'Valid Loss': 0.7121568070008204, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.56, 'F1': 0.5283018867924528, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5614766423639498, 'Valid Loss': 0.7261593353289825, 'Validation Metric': {'Precision': 0.48, 'Recall': 0.48, 'F1': 0.48, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5078240636932222, 'Valid Loss': 0.735553570664846, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.52, 'F1': 0.5098039215686274, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.46172711488447693, 'Valid Loss': 0.7448631731363443, 'Validation Metric': {'Precision': 0.5102040816326531, 'Recall': 0.5, 'F1': 0.5050505050505051, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.52, 'F1': 0.5306122448979592, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.40408556849548694, 'Valid Loss': 0.7622608553904754, 'Validation Metric': {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3793997341080716, 'Valid Loss': 0.7555955109687952, 'Validation Metric': {'Precision': 0.5102040816326531, 'Recall': 0.5, 'F1': 0.5050505050505051, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3457308668447168, 'Valid Loss': 0.7795943491733991, 'Validation Metric': {'Precision': 0.5098039215686274, 'Recall': 0.52, 'F1': 0.5148514851485149, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.32703519926259395, 'Valid Loss': 0.7808475196361542, 'Validation Metric': {'Precision': 0.5283018867924528, 'Recall': 0.56, 'F1': 0.5436893203883495, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.30457261616462156, 'Valid Loss': 0.7731567403444877, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.26803635884272425, 'Valid Loss': 0.7831615622227008, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.26877548280907304, 'Valid Loss': 0.7955654366658285, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.54, 'F1': 0.5346534653465347, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2679094491820586, 'Valid Loss': 0.7999822520292722, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.25550828178070095, 'Valid Loss': 0.7979951214331847, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.58, 'F1': 0.5523809523809523, 'Acc': 0.5346534653465347}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.543859649122807, 'Recall': 0.5849056603773585, 'F1': 0.5636363636363636, 'Acc': 0.5247524752475248}; Test loss: 0.7229392666083115
