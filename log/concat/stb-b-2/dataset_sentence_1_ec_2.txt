Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6992355745829893, 'Valid Loss': 0.6730870175361633, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6997207704554783, 'Valid Loss': 0.6764584231376648, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.17142857142857143, 'F1': 0.23076923076923078, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 0.17142857142857143, 'F1': 0.23076923076923078, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6912917873162902, 'Valid Loss': 0.6812479948997497, 'Validation Metric': {'Precision': 0.3793103448275862, 'Recall': 0.3142857142857143, 'F1': 0.34375, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3793103448275862, 'Recall': 0.3142857142857143, 'F1': 0.34375, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6816528044389875, 'Valid Loss': 0.6843572473526001, 'Validation Metric': {'Precision': 0.4523809523809524, 'Recall': 0.5428571428571428, 'F1': 0.49350649350649345, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4523809523809524, 'Recall': 0.5428571428571428, 'F1': 0.49350649350649345, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6630837528893118, 'Valid Loss': 0.6861680960655212, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6286818602781618, 'Valid Loss': 0.6848445427417755, 'Validation Metric': {'Precision': 0.3953488372093023, 'Recall': 0.4857142857142857, 'F1': 0.43589743589743585, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5747126541780622, 'Valid Loss': 0.6995360839366913, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.42857142857142855, 'F1': 0.38961038961038963, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5009476405181242, 'Valid Loss': 0.7145223999023438, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.42857142857142855, 'F1': 0.38961038961038963, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4372012729055426, 'Valid Loss': 0.7398895180225372, 'Validation Metric': {'Precision': 0.32558139534883723, 'Recall': 0.4, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.3839461686236135, 'Valid Loss': 0.7582192885875702, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4, 'F1': 0.3636363636363636, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.34413610499226643, 'Valid Loss': 0.7852970933914185, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.4, 'F1': 0.3636363636363636, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.29602431129203755, 'Valid Loss': 0.8017710888385773, 'Validation Metric': {'Precision': 0.32558139534883723, 'Recall': 0.4, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.27499710065260363, 'Valid Loss': 0.8193345737457275, 'Validation Metric': {'Precision': 0.34146341463414637, 'Recall': 0.4, 'F1': 0.368421052631579, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2575176211722781, 'Valid Loss': 0.8458480930328369, 'Validation Metric': {'Precision': 0.36585365853658536, 'Recall': 0.42857142857142855, 'F1': 0.39473684210526316, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.21811164505361172, 'Valid Loss': 0.8591978585720063, 'Validation Metric': {'Precision': 0.35, 'Recall': 0.4, 'F1': 0.3733333333333333, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.20337564464700356, 'Valid Loss': 0.8767920589447021, 'Validation Metric': {'Precision': 0.3488372093023256, 'Recall': 0.42857142857142855, 'F1': 0.38461538461538464, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19832058543904443, 'Valid Loss': 0.8808319187164306, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4, 'F1': 0.37837837837837845, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.19208923999345703, 'Valid Loss': 0.884082225561142, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4, 'F1': 0.37837837837837845, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17324377763807103, 'Valid Loss': 0.8878557074069977, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4, 'F1': 0.37837837837837845, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17873645234811172, 'Valid Loss': 0.8904319310188293, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.4, 'F1': 0.37837837837837845, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.5714285714285714, 'F1': 0.5063291139240506, 'Acc': 0.61}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.48717948717948717, 'Recall': 0.4418604651162791, 'F1': 0.46341463414634154, 'Acc': 0.56}; Test loss: 0.6948440837860107
