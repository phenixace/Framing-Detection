Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6955915586392682, 'Valid Loss': 0.6351469915646774, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6916454907198598, 'Valid Loss': 0.674737600179819, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6681229447511802, 'Valid Loss': 0.7363862762084374, 'Validation Metric': {'Precision': 0.01639344262295082, 'Recall': 0.2, 'F1': 0.030303030303030307, 'Acc': 0.36633663366336633}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.01639344262295082, 'Recall': 0.2, 'F1': 0.030303030303030307, 'Acc': 0.36633663366336633}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6020456902066568, 'Valid Loss': 0.793481707572937, 'Validation Metric': {'Precision': 0.015873015873015872, 'Recall': 0.2, 'F1': 0.029411764705882353, 'Acc': 0.3465346534653465}}
Best validation metric so far: {'Precision': 0.01639344262295082, 'Recall': 0.2, 'F1': 0.030303030303030307, 'Acc': 0.36633663366336633}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.46453620045256794, 'Valid Loss': 0.7894614189863205, 'Validation Metric': {'Precision': 0.02040816326530612, 'Recall': 0.2, 'F1': 0.03703703703703703, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.02040816326530612, 'Recall': 0.2, 'F1': 0.03703703703703703, 'Acc': 0.48514851485148514}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.32262412565095083, 'Valid Loss': 0.7322493275770774, 'Validation Metric': {'Precision': 0.02631578947368421, 'Recall': 0.2, 'F1': 0.046511627906976744, 'Acc': 0.594059405940594}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.02631578947368421, 'Recall': 0.2, 'F1': 0.046511627906976744, 'Acc': 0.594059405940594}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.24256593448327, 'Valid Loss': 0.721786128786894, 'Validation Metric': {'Precision': 0.025, 'Recall': 0.2, 'F1': 0.04444444444444445, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.02631578947368421, 'Recall': 0.2, 'F1': 0.046511627906976744, 'Acc': 0.594059405940594}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.17681425025588587, 'Valid Loss': 0.6242039192181367, 'Validation Metric': {'Precision': 0.03225806451612903, 'Recall': 0.2, 'F1': 0.05555555555555555, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.03225806451612903, 'Recall': 0.2, 'F1': 0.05555555555555555, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.13047324294658533, 'Valid Loss': 0.5794160770109067, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7227722772277227}}
Best validation metric so far: {'Precision': 0.03225806451612903, 'Recall': 0.2, 'F1': 0.05555555555555555, 'Acc': 0.6633663366336634}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.12228896382047717, 'Valid Loss': 0.5550018173570817, 'Validation Metric': {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.09580489040765547, 'Valid Loss': 0.4623859513264436, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7920792079207921}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.08185901557256405, 'Valid Loss': 0.5418322701007128, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7425742574257426}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.07136162992258717, 'Valid Loss': 0.5024374386725518, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7722772277227723}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.0736720680602287, 'Valid Loss': 0.493989652595841, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7920792079207921}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.06195160584118133, 'Valid Loss': 0.4825692552213485, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.054975821433546845, 'Valid Loss': 0.4979780495453339, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7722772277227723}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.053270415613021614, 'Valid Loss': 0.5030203736745394, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7722772277227723}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.05345097332632631, 'Valid Loss': 0.5080914839815635, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7722772277227723}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.04900076822902923, 'Valid Loss': 0.5036590533474317, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.04606845507160165, 'Valid Loss': 0.5040660470437545, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7821782178217822}}
Best validation metric so far: {'Precision': 0.047619047619047616, 'Recall': 0.2, 'F1': 0.07692307692307693, 'Acc': 0.7623762376237624}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7326732673267327}; Test loss: 0.5588031201981581
