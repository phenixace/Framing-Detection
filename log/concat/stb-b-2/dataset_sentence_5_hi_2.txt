Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7051742775099618, 'Valid Loss': 0.6698784756660462, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.11764705882352941, 'F1': 0.1739130434782609, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.11764705882352941, 'F1': 0.1739130434782609, 'Acc': 0.62}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7102618751071749, 'Valid Loss': 0.6758176517486573, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.17647058823529413, 'F1': 0.23076923076923078, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.17647058823529413, 'F1': 0.23076923076923078, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7002250728153047, 'Valid Loss': 0.686076774597168, 'Validation Metric': {'Precision': 0.30303030303030304, 'Recall': 0.29411764705882354, 'F1': 0.29850746268656714, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.30303030303030304, 'Recall': 0.29411764705882354, 'F1': 0.29850746268656714, 'Acc': 0.53}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6904645374843053, 'Valid Loss': 0.6956891083717346, 'Validation Metric': {'Precision': 0.32608695652173914, 'Recall': 0.4411764705882353, 'F1': 0.375, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32608695652173914, 'Recall': 0.4411764705882353, 'F1': 0.375, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6617780750706083, 'Valid Loss': 0.6939232182502747, 'Validation Metric': {'Precision': 0.3541666666666667, 'Recall': 0.5, 'F1': 0.4146341463414634, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3541666666666667, 'Recall': 0.5, 'F1': 0.4146341463414634, 'Acc': 0.52}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.594717181012744, 'Valid Loss': 0.7010545682907104, 'Validation Metric': {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5046495599406106, 'Valid Loss': 0.7389111804962158, 'Validation Metric': {'Precision': 0.35185185185185186, 'Recall': 0.5588235294117647, 'F1': 0.4318181818181818, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4098080812465577, 'Valid Loss': 0.7640859985351562, 'Validation Metric': {'Precision': 0.3541666666666667, 'Recall': 0.5, 'F1': 0.4146341463414634, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.339992323801631, 'Valid Loss': 0.7807629334926606, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 0.4117647058823529, 'F1': 0.39999999999999997, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.29683921904790966, 'Valid Loss': 0.8072541928291321, 'Validation Metric': {'Precision': 0.3548387096774194, 'Recall': 0.3235294117647059, 'F1': 0.3384615384615384, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.241505423613957, 'Valid Loss': 0.8171845650672913, 'Validation Metric': {'Precision': 0.3939393939393939, 'Recall': 0.38235294117647056, 'F1': 0.38805970149253727, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2061731368303299, 'Valid Loss': 0.8436032921075821, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.35294117647058826, 'F1': 0.37500000000000006, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1896872401947067, 'Valid Loss': 0.8811640655994415, 'Validation Metric': {'Precision': 0.36666666666666664, 'Recall': 0.3235294117647059, 'F1': 0.34375, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.15712125996748608, 'Valid Loss': 0.8804645293951034, 'Validation Metric': {'Precision': 0.37037037037037035, 'Recall': 0.29411764705882354, 'F1': 0.3278688524590164, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1510754324141003, 'Valid Loss': 0.8967483472824097, 'Validation Metric': {'Precision': 0.4074074074074074, 'Recall': 0.3235294117647059, 'F1': 0.36065573770491804, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.13252197504043578, 'Valid Loss': 0.9060932689905167, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.3235294117647059, 'F1': 0.3728813559322034, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.12812192507442974, 'Valid Loss': 0.9187075561285019, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.3235294117647059, 'F1': 0.3728813559322034, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.12503266873813812, 'Valid Loss': 0.9172983407974243, 'Validation Metric': {'Precision': 0.4074074074074074, 'Recall': 0.3235294117647059, 'F1': 0.36065573770491804, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.12043538375624589, 'Valid Loss': 0.9283534222841263, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.3235294117647059, 'F1': 0.3666666666666667, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11717763030458064, 'Valid Loss': 0.9306341135501861, 'Validation Metric': {'Precision': 0.4074074074074074, 'Recall': 0.3235294117647059, 'F1': 0.36065573770491804, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.6176470588235294, 'F1': 0.4516129032258065, 'Acc': 0.49}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2727272727272727, 'Recall': 0.5357142857142857, 'F1': 0.3614457831325301, 'Acc': 0.47}; Test loss: 0.7216512811183929
