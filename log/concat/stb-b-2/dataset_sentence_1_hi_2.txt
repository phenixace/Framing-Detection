Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7078096052775016, 'Valid Loss': 0.6693969655036927, 'Validation Metric': {'Precision': 0.08333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.05, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.08333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.05, 'Acc': 0.62}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.717879430605815, 'Valid Loss': 0.677225968837738, 'Validation Metric': {'Precision': 0.125, 'Recall': 0.07142857142857142, 'F1': 0.09090909090909091, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.07142857142857142, 'F1': 0.09090909090909091, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7090758732878245, 'Valid Loss': 0.6867736148834228, 'Validation Metric': {'Precision': 0.23333333333333334, 'Recall': 0.25, 'F1': 0.2413793103448276, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.23333333333333334, 'Recall': 0.25, 'F1': 0.2413793103448276, 'Acc': 0.56}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6991928592324257, 'Valid Loss': 0.6945658826828003, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.2857142857142857, 'F1': 0.23529411764705882, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.23333333333333334, 'Recall': 0.25, 'F1': 0.2413793103448276, 'Acc': 0.56}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6788518311312566, 'Valid Loss': 0.6989324307441711, 'Validation Metric': {'Precision': 0.24, 'Recall': 0.42857142857142855, 'F1': 0.30769230769230765, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.24, 'Recall': 0.42857142857142855, 'F1': 0.30769230769230765, 'Acc': 0.46}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.628719148441003, 'Valid Loss': 0.6986563670635223, 'Validation Metric': {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5305543613548462, 'Valid Loss': 0.7083902001380921, 'Validation Metric': {'Precision': 0.32, 'Recall': 0.5714285714285714, 'F1': 0.41025641025641024, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.45128381338257056, 'Valid Loss': 0.770076937675476, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.5357142857142857, 'F1': 0.41095890410958896, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.331723027361127, 'Valid Loss': 0.8004639363288879, 'Validation Metric': {'Precision': 0.2978723404255319, 'Recall': 0.5, 'F1': 0.3733333333333333, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2930054519182214, 'Valid Loss': 0.8298424279689789, 'Validation Metric': {'Precision': 0.3191489361702128, 'Recall': 0.5357142857142857, 'F1': 0.4, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.24298550346149847, 'Valid Loss': 0.8643139803409576, 'Validation Metric': {'Precision': 0.325, 'Recall': 0.4642857142857143, 'F1': 0.3823529411764706, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.18287282000080898, 'Valid Loss': 0.8726389837265015, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.4642857142857143, 'F1': 0.40625000000000006, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1839478529559878, 'Valid Loss': 0.8873636364936829, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.4642857142857143, 'F1': 0.40625000000000006, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.15507038055847472, 'Valid Loss': 0.907659330368042, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.42857142857142855, 'F1': 0.3870967741935484, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1405577937570902, 'Valid Loss': 0.9243636178970337, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.42857142857142855, 'F1': 0.3870967741935484, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.12192474710396849, 'Valid Loss': 0.9243531644344329, 'Validation Metric': {'Precision': 0.34285714285714286, 'Recall': 0.42857142857142855, 'F1': 0.38095238095238093, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.10762633952813652, 'Valid Loss': 0.9457194894552231, 'Validation Metric': {'Precision': 0.34285714285714286, 'Recall': 0.42857142857142855, 'F1': 0.38095238095238093, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.11463032684360559, 'Valid Loss': 0.9584447813034057, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.42857142857142855, 'F1': 0.3870967741935484, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.11491145734460308, 'Valid Loss': 0.9617222654819488, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.4642857142857143, 'F1': 0.40625000000000006, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11262186487706807, 'Valid Loss': 0.9664238685369492, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.4642857142857143, 'F1': 0.40625000000000006, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3148148148148148, 'Recall': 0.6071428571428571, 'F1': 0.41463414634146345, 'Acc': 0.52}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2807017543859649, 'Recall': 0.5, 'F1': 0.3595505617977528, 'Acc': 0.43}; Test loss: 0.7126842761039733
