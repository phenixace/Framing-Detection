Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7020505298389478, 'Valid Loss': 0.6822139978408813, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7085969602124075, 'Valid Loss': 0.6826847004890442, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.20930232558139536, 'F1': 0.3103448275862069, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.20930232558139536, 'F1': 0.3103448275862069, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6967491320009982, 'Valid Loss': 0.6828612303733825, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.23255813953488372, 'F1': 0.31746031746031744, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.23255813953488372, 'F1': 0.31746031746031744, 'Acc': 0.57}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6794742667273189, 'Valid Loss': 0.6827552342414855, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32558139534883723, 'F1': 0.3943661971830986, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.32558139534883723, 'F1': 0.3943661971830986, 'Acc': 0.57}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6701416848750597, 'Valid Loss': 0.6944411301612854, 'Validation Metric': {'Precision': 0.4857142857142857, 'Recall': 0.3953488372093023, 'F1': 0.43589743589743585, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4857142857142857, 'Recall': 0.3953488372093023, 'F1': 0.43589743589743585, 'Acc': 0.56}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6193998958287614, 'Valid Loss': 0.7096429371833801, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.4186046511627907, 'F1': 0.42352941176470593, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4857142857142857, 'Recall': 0.3953488372093023, 'F1': 0.43589743589743585, 'Acc': 0.56}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5642407603478163, 'Valid Loss': 0.7243519473075867, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.49822145834397735, 'Valid Loss': 0.7783517980575562, 'Validation Metric': {'Precision': 0.4146341463414634, 'Recall': 0.3953488372093023, 'F1': 0.40476190476190477, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4408689158016376, 'Valid Loss': 0.7898902380466462, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.4186046511627907, 'F1': 0.4137931034482759, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4100872978065791, 'Valid Loss': 0.8115682029724121, 'Validation Metric': {'Precision': 0.40476190476190477, 'Recall': 0.3953488372093023, 'F1': 0.4, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3655972246373637, 'Valid Loss': 0.8388598394393921, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.3023255813953488, 'F1': 0.32911392405063294, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3216088852018453, 'Valid Loss': 0.855243388414383, 'Validation Metric': {'Precision': 0.40540540540540543, 'Recall': 0.3488372093023256, 'F1': 0.375, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2986735969447018, 'Valid Loss': 0.8840780830383301, 'Validation Metric': {'Precision': 0.3548387096774194, 'Recall': 0.2558139534883721, 'F1': 0.2972972972972973, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2827185833554589, 'Valid Loss': 0.8949931889772416, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.27906976744186046, 'F1': 0.31999999999999995, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.24063609029804722, 'Valid Loss': 0.8811766076087951, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 0.32558139534883723, 'F1': 0.35443037974683544, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2284495915924565, 'Valid Loss': 0.8988617789745331, 'Validation Metric': {'Precision': 0.45714285714285713, 'Recall': 0.37209302325581395, 'F1': 0.41025641025641024, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2330136742819561, 'Valid Loss': 0.9167768371105194, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 0.32558139534883723, 'F1': 0.35443037974683544, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2306606424658486, 'Valid Loss': 0.9290718758106231, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.32558139534883723, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1939094185494305, 'Valid Loss': 0.9362699377536774, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.32558139534883723, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19480939042032436, 'Valid Loss': 0.9378559118509293, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.32558139534883723, 'F1': 0.35897435897435903, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.46511627906976744, 'F1': 0.45977011494252873, 'Acc': 0.53}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3695652173913043, 'Recall': 0.4857142857142857, 'F1': 0.4197530864197531, 'Acc': 0.5346534653465347}; Test loss: 0.7034866523284179
