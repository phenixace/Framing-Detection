Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.706107164951081, 'Valid Loss': 0.6895824074745178, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.10869565217391304, 'F1': 0.1694915254237288, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.10869565217391304, 'F1': 0.1694915254237288, 'Acc': 0.5148514851485149}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7065054026055844, 'Valid Loss': 0.6902220386725205, 'Validation Metric': {'Precision': 0.4782608695652174, 'Recall': 0.2391304347826087, 'F1': 0.3188405797101449, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4782608695652174, 'Recall': 0.2391304347826087, 'F1': 0.3188405797101449, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6945167247285234, 'Valid Loss': 0.6914755656169012, 'Validation Metric': {'Precision': 0.5135135135135135, 'Recall': 0.41304347826086957, 'F1': 0.4578313253012048, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.41304347826086957, 'F1': 0.4578313253012048, 'Acc': 0.5544554455445545}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6814802720191631, 'Valid Loss': 0.691679454766787, 'Validation Metric': {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6639877998448432, 'Valid Loss': 0.6851887932190528, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.43478260869565216, 'F1': 0.4444444444444445, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6171558388370149, 'Valid Loss': 0.6897384501420535, 'Validation Metric': {'Precision': 0.46938775510204084, 'Recall': 0.5, 'F1': 0.4842105263157895, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5284128135189097, 'Valid Loss': 0.7321514601890857, 'Validation Metric': {'Precision': 0.4883720930232558, 'Recall': 0.45652173913043476, 'F1': 0.47191011235955055, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4842106043658358, 'Valid Loss': 0.7614059368005166, 'Validation Metric': {'Precision': 0.4523809523809524, 'Recall': 0.41304347826086957, 'F1': 0.4318181818181818, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4262901544570923, 'Valid Loss': 0.760208853162252, 'Validation Metric': {'Precision': 0.4878048780487805, 'Recall': 0.43478260869565216, 'F1': 0.45977011494252873, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.3552105407765571, 'Valid Loss': 0.7787557416237317, 'Validation Metric': {'Precision': 0.47368421052631576, 'Recall': 0.391304347826087, 'F1': 0.42857142857142855, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.303472675383091, 'Valid Loss': 0.8076607516178718, 'Validation Metric': {'Precision': 0.5151515151515151, 'Recall': 0.3695652173913043, 'F1': 0.43037974683544306, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.279530165677375, 'Valid Loss': 0.847102566407277, 'Validation Metric': {'Precision': 0.4473684210526316, 'Recall': 0.3695652173913043, 'F1': 0.40476190476190477, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2506239557678395, 'Valid Loss': 0.8633890690711828, 'Validation Metric': {'Precision': 0.4473684210526316, 'Recall': 0.3695652173913043, 'F1': 0.40476190476190477, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.22634010555896353, 'Valid Loss': 0.8816322386264801, 'Validation Metric': {'Precision': 0.4594594594594595, 'Recall': 0.3695652173913043, 'F1': 0.4096385542168674, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.22444930950060804, 'Valid Loss': 0.9035828881538831, 'Validation Metric': {'Precision': 0.45, 'Recall': 0.391304347826087, 'F1': 0.4186046511627907, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1920317813278513, 'Valid Loss': 0.9198286178020331, 'Validation Metric': {'Precision': 0.4358974358974359, 'Recall': 0.3695652173913043, 'F1': 0.39999999999999997, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18527880402162988, 'Valid Loss': 0.9283312971775348, 'Validation Metric': {'Precision': 0.4594594594594595, 'Recall': 0.3695652173913043, 'F1': 0.4096385542168674, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.17807116121687788, 'Valid Loss': 0.9338386150506827, 'Validation Metric': {'Precision': 0.4473684210526316, 'Recall': 0.3695652173913043, 'F1': 0.40476190476190477, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17055936510417055, 'Valid Loss': 0.9392607120367197, 'Validation Metric': {'Precision': 0.4594594594594595, 'Recall': 0.3695652173913043, 'F1': 0.4096385542168674, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.16192641778987774, 'Valid Loss': 0.9420831214923125, 'Validation Metric': {'Precision': 0.4594594594594595, 'Recall': 0.3695652173913043, 'F1': 0.4096385542168674, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.54, 'Recall': 0.5869565217391305, 'F1': 0.5625000000000001, 'Acc': 0.5841584158415841}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.47058823529411764, 'Recall': 0.5581395348837209, 'F1': 0.5106382978723404, 'Acc': 0.54}; Test loss: 0.6817081952095032
