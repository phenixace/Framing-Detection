Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7160697209024892, 'Valid Loss': 0.6799629605733432, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.14285714285714285, 'F1': 0.16666666666666666, 'Acc': 0.6039603960396039}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.14285714285714285, 'F1': 0.16666666666666666, 'Acc': 0.6039603960396039}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7123369487743934, 'Valid Loss': 0.6883213107402508, 'Validation Metric': {'Precision': 0.15384615384615385, 'Recall': 0.14285714285714285, 'F1': 0.14814814814814817, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.14285714285714285, 'F1': 0.16666666666666666, 'Acc': 0.6039603960396039}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6988578230431937, 'Valid Loss': 0.7025807408186105, 'Validation Metric': {'Precision': 0.20512820512820512, 'Recall': 0.2857142857142857, 'F1': 0.23880597014925373, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.20512820512820512, 'Recall': 0.2857142857142857, 'F1': 0.23880597014925373, 'Acc': 0.49504950495049505}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6858584336864139, 'Valid Loss': 0.7108369584266956, 'Validation Metric': {'Precision': 0.24489795918367346, 'Recall': 0.42857142857142855, 'F1': 0.3116883116883117, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.24489795918367346, 'Recall': 0.42857142857142855, 'F1': 0.3116883116883117, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6612997798665056, 'Valid Loss': 0.7107191246289474, 'Validation Metric': {'Precision': 0.2777777777777778, 'Recall': 0.5357142857142857, 'F1': 0.36585365853658536, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2777777777777778, 'Recall': 0.5357142857142857, 'F1': 0.36585365853658536, 'Acc': 0.48514851485148514}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6051626422451538, 'Valid Loss': 0.7175509081437037, 'Validation Metric': {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5348914514467554, 'Valid Loss': 0.7076992621788611, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.5357142857142857, 'F1': 0.38461538461538464, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.43832026132680835, 'Valid Loss': 0.7307763455005792, 'Validation Metric': {'Precision': 0.28846153846153844, 'Recall': 0.5357142857142857, 'F1': 0.37499999999999994, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.3559403813724379, 'Valid Loss': 0.7706658920416465, 'Validation Metric': {'Precision': 0.2553191489361702, 'Recall': 0.42857142857142855, 'F1': 0.32, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2764398794151047, 'Valid Loss': 0.7898198022292211, 'Validation Metric': {'Precision': 0.22727272727272727, 'Recall': 0.35714285714285715, 'F1': 0.2777777777777778, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.24494517637977323, 'Valid Loss': 0.8154441920610574, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.32142857142857145, 'F1': 0.2686567164179105, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.20089787700511877, 'Valid Loss': 0.8463920882114997, 'Validation Metric': {'Precision': 0.21428571428571427, 'Recall': 0.32142857142857145, 'F1': 0.2571428571428572, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1716513066977552, 'Valid Loss': 0.8554513110564306, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.32142857142857145, 'F1': 0.2686567164179105, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1648258854029248, 'Valid Loss': 0.8611922722596389, 'Validation Metric': {'Precision': 0.23684210526315788, 'Recall': 0.32142857142857145, 'F1': 0.2727272727272727, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1342712161176413, 'Valid Loss': 0.8752109694939393, 'Validation Metric': {'Precision': 0.23684210526315788, 'Recall': 0.32142857142857145, 'F1': 0.2727272727272727, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.13510163262197114, 'Valid Loss': 0.8791128557461959, 'Validation Metric': {'Precision': 0.24324324324324326, 'Recall': 0.32142857142857145, 'F1': 0.27692307692307694, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.10862996624511423, 'Valid Loss': 0.89742228274162, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.32142857142857145, 'F1': 0.28125000000000006, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.10748088251329163, 'Valid Loss': 0.90097476541996, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.32142857142857145, 'F1': 0.28125000000000006, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.10108397246419805, 'Valid Loss': 0.9055074877463855, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.32142857142857145, 'F1': 0.28125000000000006, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.10617236637519402, 'Valid Loss': 0.9068947640749124, 'Validation Metric': {'Precision': 0.24324324324324326, 'Recall': 0.32142857142857145, 'F1': 0.27692307692307694, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.29508196721311475, 'Recall': 0.6428571428571429, 'F1': 0.40449438202247195, 'Acc': 0.4752475247524752}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4230769230769231, 'Recall': 0.6875, 'F1': 0.5238095238095238, 'Acc': 0.6039603960396039}; Test loss: 0.6804311951765647
