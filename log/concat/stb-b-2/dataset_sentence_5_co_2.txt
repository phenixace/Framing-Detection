Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7061339646577836, 'Valid Loss': 0.7393667984008789, 'Validation Metric': {'Precision': 0.6842105263157895, 'Recall': 0.18309859154929578, 'F1': 0.2888888888888889, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6842105263157895, 'Recall': 0.18309859154929578, 'F1': 0.2888888888888889, 'Acc': 0.36}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7069626092910767, 'Valid Loss': 0.730585572719574, 'Validation Metric': {'Precision': 0.6956521739130435, 'Recall': 0.22535211267605634, 'F1': 0.3404255319148936, 'Acc': 0.38}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6956521739130435, 'Recall': 0.22535211267605634, 'F1': 0.3404255319148936, 'Acc': 0.38}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7085875314474106, 'Valid Loss': 0.7230009365081788, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.2535211267605634, 'F1': 0.37113402061855666, 'Acc': 0.39}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.2535211267605634, 'F1': 0.37113402061855666, 'Acc': 0.39}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6974270302057266, 'Valid Loss': 0.7220020985603333, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.2676056338028169, 'F1': 0.3838383838383838, 'Acc': 0.39}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6785714285714286, 'Recall': 0.2676056338028169, 'F1': 0.3838383838383838, 'Acc': 0.39}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6875427949428559, 'Valid Loss': 0.7202153062820434, 'Validation Metric': {'Precision': 0.7407407407407407, 'Recall': 0.28169014084507044, 'F1': 0.4081632653061224, 'Acc': 0.42}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7407407407407407, 'Recall': 0.28169014084507044, 'F1': 0.4081632653061224, 'Acc': 0.42}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6611938518285752, 'Valid Loss': 0.7212791681289673, 'Validation Metric': {'Precision': 0.6571428571428571, 'Recall': 0.323943661971831, 'F1': 0.4339622641509434, 'Acc': 0.4}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.323943661971831, 'F1': 0.4339622641509434, 'Acc': 0.4}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6067156276106834, 'Valid Loss': 0.7123421776294708, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.38028169014084506, 'F1': 0.47787610619469023, 'Acc': 0.41}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.38028169014084506, 'F1': 0.47787610619469023, 'Acc': 0.41}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5489243912696838, 'Valid Loss': 0.6982164943218231, 'Validation Metric': {'Precision': 0.7169811320754716, 'Recall': 0.5352112676056338, 'F1': 0.6129032258064515, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7169811320754716, 'Recall': 0.5352112676056338, 'F1': 0.6129032258064515, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4552842724323273, 'Valid Loss': 0.7130887007713318, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.5633802816901409, 'F1': 0.634920634920635, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7272727272727273, 'Recall': 0.5633802816901409, 'F1': 0.634920634920635, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.37755638048052786, 'Valid Loss': 0.7052759259939194, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.5915492957746479, 'F1': 0.6614173228346456, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.5915492957746479, 'F1': 0.6614173228346456, 'Acc': 0.57}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3136788903921843, 'Valid Loss': 0.7028435206413269, 'Validation Metric': {'Precision': 0.734375, 'Recall': 0.6619718309859155, 'F1': 0.6962962962962963, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.734375, 'Recall': 0.6619718309859155, 'F1': 0.6962962962962963, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.28232128188014033, 'Valid Loss': 0.7149261868000031, 'Validation Metric': {'Precision': 0.7258064516129032, 'Recall': 0.6338028169014085, 'F1': 0.6766917293233083, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.734375, 'Recall': 0.6619718309859155, 'F1': 0.6962962962962963, 'Acc': 0.59}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.23216594733297824, 'Valid Loss': 0.7283776021003723, 'Validation Metric': {'Precision': 0.71875, 'Recall': 0.647887323943662, 'F1': 0.6814814814814815, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.734375, 'Recall': 0.6619718309859155, 'F1': 0.6962962962962963, 'Acc': 0.59}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.21060547932982446, 'Valid Loss': 0.739205601811409, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.676056338028169, 'F1': 0.7007299270072992, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7272727272727273, 'Recall': 0.676056338028169, 'F1': 0.7007299270072992, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1958441260457039, 'Valid Loss': 0.7508531653881073, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.676056338028169, 'F1': 0.7111111111111111, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.676056338028169, 'F1': 0.7111111111111111, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18127817563712598, 'Valid Loss': 0.747825807929039, 'Validation Metric': {'Precision': 0.7391304347826086, 'Recall': 0.7183098591549296, 'F1': 0.7285714285714284, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7391304347826086, 'Recall': 0.7183098591549296, 'F1': 0.7285714285714284, 'Acc': 0.62}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.17198500361293553, 'Valid Loss': 0.7542886385321617, 'Validation Metric': {'Precision': 0.7183098591549296, 'Recall': 0.7183098591549296, 'F1': 0.7183098591549296, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.7391304347826086, 'Recall': 0.7183098591549296, 'F1': 0.7285714285714284, 'Acc': 0.62}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.15849652126431465, 'Valid Loss': 0.7592606821656227, 'Validation Metric': {'Precision': 0.7285714285714285, 'Recall': 0.7183098591549296, 'F1': 0.7234042553191489, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7391304347826086, 'Recall': 0.7183098591549296, 'F1': 0.7285714285714284, 'Acc': 0.62}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.15660588841885328, 'Valid Loss': 0.7604947301745415, 'Validation Metric': {'Precision': 0.7183098591549296, 'Recall': 0.7183098591549296, 'F1': 0.7183098591549296, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.7391304347826086, 'Recall': 0.7183098591549296, 'F1': 0.7285714285714284, 'Acc': 0.62}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.15312092129141092, 'Valid Loss': 0.7661183696985244, 'Validation Metric': {'Precision': 0.7285714285714285, 'Recall': 0.7183098591549296, 'F1': 0.7234042553191489, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7391304347826086, 'Recall': 0.7183098591549296, 'F1': 0.7285714285714284, 'Acc': 0.62}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6571428571428571, 'Recall': 0.71875, 'F1': 0.6865671641791045, 'Acc': 0.58}; Test loss: 0.8259199053049088
