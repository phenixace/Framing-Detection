Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7080903984967944, 'Valid Loss': 0.7328389382362366, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.078125, 'F1': 0.13513513513513514, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.078125, 'F1': 0.13513513513513514, 'Acc': 0.36}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7192498176421934, 'Valid Loss': 0.7285478353500366, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.109375, 'F1': 0.1794871794871795, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.109375, 'F1': 0.1794871794871795, 'Acc': 0.36}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7071167982897713, 'Valid Loss': 0.7263525176048279, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.140625, 'F1': 0.2222222222222222, 'Acc': 0.37}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5294117647058824, 'Recall': 0.140625, 'F1': 0.2222222222222222, 'Acc': 0.37}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7056021725089805, 'Valid Loss': 0.7296892523765564, 'Validation Metric': {'Precision': 0.5882352941176471, 'Recall': 0.15625, 'F1': 0.2469135802469136, 'Acc': 0.39}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.15625, 'F1': 0.2469135802469136, 'Acc': 0.39}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6713041868603346, 'Valid Loss': 0.7541491723060608, 'Validation Metric': {'Precision': 0.71875, 'Recall': 0.359375, 'F1': 0.4791666666666667, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.71875, 'Recall': 0.359375, 'F1': 0.4791666666666667, 'Acc': 0.5}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6165457709321698, 'Valid Loss': 0.7917164325714111, 'Validation Metric': {'Precision': 0.5897435897435898, 'Recall': 0.359375, 'F1': 0.4466019417475728, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.71875, 'Recall': 0.359375, 'F1': 0.4791666666666667, 'Acc': 0.5}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5504874132790611, 'Valid Loss': 0.8005310940742493, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.46875, 'F1': 0.5405405405405406, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6382978723404256, 'Recall': 0.46875, 'F1': 0.5405405405405406, 'Acc': 0.49}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.42049266470288765, 'Valid Loss': 0.8040977418422699, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.484375, 'F1': 0.5535714285714286, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6458333333333334, 'Recall': 0.484375, 'F1': 0.5535714285714286, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.37293217461375355, 'Valid Loss': 0.8469522452354431, 'Validation Metric': {'Precision': 0.6538461538461539, 'Recall': 0.53125, 'F1': 0.5862068965517242, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6538461538461539, 'Recall': 0.53125, 'F1': 0.5862068965517242, 'Acc': 0.52}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2867960770731991, 'Valid Loss': 0.8598521232604981, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.59375, 'F1': 0.628099173553719, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.59375, 'F1': 0.628099173553719, 'Acc': 0.55}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.25496788424195593, 'Valid Loss': 0.8576532292366028, 'Validation Metric': {'Precision': 0.6825396825396826, 'Recall': 0.671875, 'F1': 0.6771653543307087, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6825396825396826, 'Recall': 0.671875, 'F1': 0.6771653543307087, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.22688131707096562, 'Valid Loss': 0.8690267837047577, 'Validation Metric': {'Precision': 0.6617647058823529, 'Recall': 0.703125, 'F1': 0.6818181818181819, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6617647058823529, 'Recall': 0.703125, 'F1': 0.6818181818181819, 'Acc': 0.58}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19578431872198881, 'Valid Loss': 0.875905328989029, 'Validation Metric': {'Precision': 0.6571428571428571, 'Recall': 0.71875, 'F1': 0.6865671641791045, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.71875, 'F1': 0.6865671641791045, 'Acc': 0.58}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.16908921196478086, 'Valid Loss': 0.8950748032331467, 'Validation Metric': {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.15476129902074637, 'Valid Loss': 0.8786446523666381, 'Validation Metric': {'Precision': 0.647887323943662, 'Recall': 0.71875, 'F1': 0.6814814814814815, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.14401566132324414, 'Valid Loss': 0.9251490640640259, 'Validation Metric': {'Precision': 0.647887323943662, 'Recall': 0.71875, 'F1': 0.6814814814814815, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.13040713361889414, 'Valid Loss': 0.9410192143917083, 'Validation Metric': {'Precision': 0.6619718309859155, 'Recall': 0.734375, 'F1': 0.6962962962962963, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.12931785942281335, 'Valid Loss': 0.9531364369392396, 'Validation Metric': {'Precision': 0.647887323943662, 'Recall': 0.71875, 'F1': 0.6814814814814815, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1224966679961936, 'Valid Loss': 0.9593954932689667, 'Validation Metric': {'Precision': 0.6619718309859155, 'Recall': 0.734375, 'F1': 0.6962962962962963, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11110485829774616, 'Valid Loss': 0.9650226271152497, 'Validation Metric': {'Precision': 0.6521739130434783, 'Recall': 0.703125, 'F1': 0.6766917293233083, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6764705882352942, 'Recall': 0.71875, 'F1': 0.696969696969697, 'Acc': 0.6}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6461538461538462, 'Recall': 0.6461538461538462, 'F1': 0.6461538461538462, 'Acc': 0.54}; Test loss: 0.8321168571710587
