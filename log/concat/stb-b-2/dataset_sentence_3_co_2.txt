Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/stb-b-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.70874652415514, 'Valid Loss': 0.7474878430366516, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.1388888888888889, 'F1': 0.23255813953488372, 'Acc': 0.3465346534653465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.1388888888888889, 'F1': 0.23255813953488372, 'Acc': 0.3465346534653465}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7126901280879975, 'Valid Loss': 0.7416679286039792, 'Validation Metric': {'Precision': 0.6470588235294118, 'Recall': 0.1527777777777778, 'F1': 0.24719101123595508, 'Acc': 0.33663366336633666}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6470588235294118, 'Recall': 0.1527777777777778, 'F1': 0.24719101123595508, 'Acc': 0.33663366336633666}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7068744140863419, 'Valid Loss': 0.7359361465160663, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.19444444444444445, 'F1': 0.30434782608695654, 'Acc': 0.36633663366336633}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7, 'Recall': 0.19444444444444445, 'F1': 0.30434782608695654, 'Acc': 0.36633663366336633}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6975293245911598, 'Valid Loss': 0.740910122027764, 'Validation Metric': {'Precision': 0.6818181818181818, 'Recall': 0.20833333333333334, 'F1': 0.3191489361702127, 'Acc': 0.36633663366336633}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6818181818181818, 'Recall': 0.20833333333333334, 'F1': 0.3191489361702127, 'Acc': 0.36633663366336633}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6629224136471749, 'Valid Loss': 0.7432182499995599, 'Validation Metric': {'Precision': 0.7352941176470589, 'Recall': 0.3472222222222222, 'F1': 0.4716981132075472, 'Acc': 0.44554455445544555}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7352941176470589, 'Recall': 0.3472222222222222, 'F1': 0.4716981132075472, 'Acc': 0.44554455445544555}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6195003136992454, 'Valid Loss': 0.7874837746986976, 'Validation Metric': {'Precision': 0.782608695652174, 'Recall': 0.25, 'F1': 0.3789473684210527, 'Acc': 0.4158415841584158}}
Best validation metric so far: {'Precision': 0.7352941176470589, 'Recall': 0.3472222222222222, 'F1': 0.4716981132075472, 'Acc': 0.44554455445544555}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5353144705295563, 'Valid Loss': 0.7610955719764416, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.3888888888888889, 'F1': 0.5233644859813085, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.3888888888888889, 'F1': 0.5233644859813085, 'Acc': 0.49504950495049505}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.4439461900293827, 'Valid Loss': 0.7494443368453246, 'Validation Metric': {'Precision': 0.8043478260869565, 'Recall': 0.5138888888888888, 'F1': 0.6271186440677965, 'Acc': 0.5643564356435643}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8043478260869565, 'Recall': 0.5138888888888888, 'F1': 0.6271186440677965, 'Acc': 0.5643564356435643}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.39246180444955825, 'Valid Loss': 0.7601889463571402, 'Validation Metric': {'Precision': 0.7636363636363637, 'Recall': 0.5833333333333334, 'F1': 0.6614173228346456, 'Acc': 0.5742574257425742}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7636363636363637, 'Recall': 0.5833333333333334, 'F1': 0.6614173228346456, 'Acc': 0.5742574257425742}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.3216718545556068, 'Valid Loss': 0.7525108983883491, 'Validation Metric': {'Precision': 0.7586206896551724, 'Recall': 0.6111111111111112, 'F1': 0.676923076923077, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7586206896551724, 'Recall': 0.6111111111111112, 'F1': 0.676923076923077, 'Acc': 0.5841584158415841}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.2639950427412987, 'Valid Loss': 0.7472073951592813, 'Validation Metric': {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.23106394477188588, 'Valid Loss': 0.7777547916540732, 'Validation Metric': {'Precision': 0.7384615384615385, 'Recall': 0.6666666666666666, 'F1': 0.7007299270072994, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19514153502881526, 'Valid Loss': 0.7877857186473333, 'Validation Metric': {'Precision': 0.746268656716418, 'Recall': 0.6944444444444444, 'F1': 0.7194244604316546, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1789716003835201, 'Valid Loss': 0.7929458343065702, 'Validation Metric': {'Precision': 0.7538461538461538, 'Recall': 0.6805555555555556, 'F1': 0.7153284671532848, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.14066131338477134, 'Valid Loss': 0.8039027435275224, 'Validation Metric': {'Precision': 0.7424242424242424, 'Recall': 0.6805555555555556, 'F1': 0.7101449275362319, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.14556807432323693, 'Valid Loss': 0.8193986822779362, 'Validation Metric': {'Precision': 0.7384615384615385, 'Recall': 0.6666666666666666, 'F1': 0.7007299270072994, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.14312124241143465, 'Valid Loss': 0.8183950311862506, 'Validation Metric': {'Precision': 0.746268656716418, 'Recall': 0.6944444444444444, 'F1': 0.7194244604316546, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1315642658621073, 'Valid Loss': 0.8189427331089973, 'Validation Metric': {'Precision': 0.746268656716418, 'Recall': 0.6944444444444444, 'F1': 0.7194244604316546, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.12488928899168968, 'Valid Loss': 0.8292811839626386, 'Validation Metric': {'Precision': 0.746268656716418, 'Recall': 0.6944444444444444, 'F1': 0.7194244604316546, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.11531553223729134, 'Valid Loss': 0.8332396539357992, 'Validation Metric': {'Precision': 0.746268656716418, 'Recall': 0.6944444444444444, 'F1': 0.7194244604316546, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7323943661971831, 'Recall': 0.7222222222222222, 'F1': 0.7272727272727272, 'Acc': 0.6138613861386139}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6666666666666666, 'Recall': 0.7419354838709677, 'F1': 0.7022900763358778, 'Acc': 0.6138613861386139}; Test loss: 0.6963286388378876
