Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6819412088707874, 'Valid Loss': 0.6650330662727356, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6810019431929839, 'Valid Loss': 0.6617984318733215, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.02857142857142857, 'F1': 0.049999999999999996, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.677078302753599, 'Valid Loss': 0.6578993582725525, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6732411408110669, 'Valid Loss': 0.655607271194458, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6702971654502969, 'Valid Loss': 0.6538182580471039, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6664772461119451, 'Valid Loss': 0.6535438001155853, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6515986754706031, 'Valid Loss': 0.6539814066886902, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.630182571709156, 'Valid Loss': 0.6542107653617859, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.02857142857142857, 'F1': 0.05128205128205128, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6164690201219759, 'Valid Loss': 0.659211449623108, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5843012383893916, 'Valid Loss': 0.666096351146698, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5614217978559042, 'Valid Loss': 0.6694980335235595, 'Validation Metric': {'Precision': 0.18181818181818182, 'Recall': 0.05714285714285714, 'F1': 0.08695652173913043, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5200896078818723, 'Valid Loss': 0.6757700371742249, 'Validation Metric': {'Precision': 0.17647058823529413, 'Recall': 0.08571428571428572, 'F1': 0.11538461538461539, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4949462194191782, 'Valid Loss': 0.6832712483406067, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.11428571428571428, 'F1': 0.14545454545454545, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.11428571428571428, 'F1': 0.14545454545454545, 'Acc': 0.53}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4579040137560744, 'Valid Loss': 0.6902530407905578, 'Validation Metric': {'Precision': 0.24, 'Recall': 0.17142857142857143, 'F1': 0.19999999999999998, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.24, 'Recall': 0.17142857142857143, 'F1': 0.19999999999999998, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.44713945020186274, 'Valid Loss': 0.6974252963066101, 'Validation Metric': {'Precision': 0.24, 'Recall': 0.17142857142857143, 'F1': 0.19999999999999998, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.24, 'Recall': 0.17142857142857143, 'F1': 0.19999999999999998, 'Acc': 0.52}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.42312374201260117, 'Valid Loss': 0.7035910224914551, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.2857142857142857, 'F1': 0.30769230769230765, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.2857142857142857, 'F1': 0.30769230769230765, 'Acc': 0.55}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.396878145635128, 'Valid Loss': 0.7020265746116638, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.2571428571428571, 'F1': 0.2857142857142857, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.2857142857142857, 'F1': 0.30769230769230765, 'Acc': 0.55}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3843569749672162, 'Valid Loss': 0.7046919310092926, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.2571428571428571, 'F1': 0.2857142857142857, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.2857142857142857, 'F1': 0.30769230769230765, 'Acc': 0.55}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.37601207510421153, 'Valid Loss': 0.7056528532505035, 'Validation Metric': {'Precision': 0.3103448275862069, 'Recall': 0.2571428571428571, 'F1': 0.28125, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.2857142857142857, 'F1': 0.30769230769230765, 'Acc': 0.55}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3726588618990622, 'Valid Loss': 0.706111501455307, 'Validation Metric': {'Precision': 0.3448275862068966, 'Recall': 0.2857142857142857, 'F1': 0.3125, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.2857142857142857, 'F1': 0.3125, 'Acc': 0.56}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5172413793103449, 'Recall': 0.3488372093023256, 'F1': 0.41666666666666663, 'Acc': 0.58}; Test loss: 0.6794720959663391
