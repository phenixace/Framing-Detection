Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7388727484565032, 'Valid Loss': 0.7235549569129944, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.1076923076923077, 'F1': 0.18918918918918923, 'Acc': 0.4}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 0.1076923076923077, 'F1': 0.18918918918918923, 'Acc': 0.4}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7371683740302136, 'Valid Loss': 0.6924125599861145, 'Validation Metric': {'Precision': 0.7105263157894737, 'Recall': 0.4153846153846154, 'F1': 0.5242718446601942, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7105263157894737, 'Recall': 0.4153846153846154, 'F1': 0.5242718446601942, 'Acc': 0.51}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7086214282010731, 'Valid Loss': 0.6591335082054138, 'Validation Metric': {'Precision': 0.6629213483146067, 'Recall': 0.9076923076923077, 'F1': 0.7662337662337663, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6629213483146067, 'Recall': 0.9076923076923077, 'F1': 0.7662337662337663, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6846647215516943, 'Valid Loss': 0.6475204348564148, 'Validation Metric': {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6637866175488422, 'Valid Loss': 0.6607980573177338, 'Validation Metric': {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6565656565656566, 'Recall': 1.0, 'F1': 0.7926829268292683, 'Acc': 0.66}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6476716038427854, 'Valid Loss': 0.6524441683292389, 'Validation Metric': {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6186651450238729, 'Valid Loss': 0.6508331608772278, 'Validation Metric': {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5991827939686022, 'Valid Loss': 0.6535848152637481, 'Validation Metric': {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5773965720283357, 'Valid Loss': 0.648431979417801, 'Validation Metric': {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5702745965436885, 'Valid Loss': 0.6578025603294373, 'Validation Metric': {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5387088628975969, 'Valid Loss': 0.6622321343421936, 'Validation Metric': {'Precision': 0.6597938144329897, 'Recall': 0.9846153846153847, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5167081097238942, 'Valid Loss': 0.6537585628032684, 'Validation Metric': {'Precision': 0.65625, 'Recall': 0.9692307692307692, 'F1': 0.7826086956521738, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5074811017042712, 'Valid Loss': 0.6608809876441956, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.48657923623135213, 'Valid Loss': 0.6747499597072601, 'Validation Metric': {'Precision': 0.6590909090909091, 'Recall': 0.8923076923076924, 'F1': 0.7581699346405228, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4581853376799508, 'Valid Loss': 0.6718574631214141, 'Validation Metric': {'Precision': 0.6555555555555556, 'Recall': 0.9076923076923077, 'F1': 0.7612903225806452, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4518250938701002, 'Valid Loss': 0.6782691490650177, 'Validation Metric': {'Precision': 0.6511627906976745, 'Recall': 0.8615384615384616, 'F1': 0.7417218543046358, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4214232805136003, 'Valid Loss': 0.6794796299934387, 'Validation Metric': {'Precision': 0.6506024096385542, 'Recall': 0.8307692307692308, 'F1': 0.7297297297297298, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.42637121285262863, 'Valid Loss': 0.682205206155777, 'Validation Metric': {'Precision': 0.6506024096385542, 'Recall': 0.8307692307692308, 'F1': 0.7297297297297298, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4236185658527048, 'Valid Loss': 0.684768934249878, 'Validation Metric': {'Precision': 0.6463414634146342, 'Recall': 0.8153846153846154, 'F1': 0.7210884353741497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.41725575100434453, 'Valid Loss': 0.6844304895401001, 'Validation Metric': {'Precision': 0.6463414634146342, 'Recall': 0.8153846153846154, 'F1': 0.7210884353741497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6632653061224489, 'Recall': 1.0, 'F1': 0.7975460122699386, 'Acc': 0.67}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}; Test loss: 0.6360630897375253
