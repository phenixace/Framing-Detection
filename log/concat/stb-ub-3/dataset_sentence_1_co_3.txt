Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7383171712097368, 'Valid Loss': 0.7274529075622559, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.046875, 'F1': 0.08695652173913043, 'Acc': 0.37}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7448067610201082, 'Valid Loss': 0.6977826571464538, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.46875, 'F1': 0.5660377358490566, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.46875, 'F1': 0.5660377358490566, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7070566705967251, 'Valid Loss': 0.661340594291687, 'Validation Metric': {'Precision': 0.6304347826086957, 'Recall': 0.90625, 'F1': 0.7435897435897436, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6304347826086957, 'Recall': 0.90625, 'F1': 0.7435897435897436, 'Acc': 0.6}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6831006866536642, 'Valid Loss': 0.6564756989479065, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6532511585637143, 'Valid Loss': 0.6577882194519042, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6368143801626406, 'Valid Loss': 0.6584209454059601, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6203067483086335, 'Valid Loss': 0.6548408043384552, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5981749531469847, 'Valid Loss': 0.6488331258296967, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5753171863524538, 'Valid Loss': 0.669473135471344, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5446194518161448, 'Valid Loss': 0.6752199721336365, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5308852987854105, 'Valid Loss': 0.6795688211917877, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4979444581427072, 'Valid Loss': 0.6888165807723999, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.984375, 'F1': 0.7777777777777778, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4838632286379212, 'Valid Loss': 0.6936239373683929, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.96875, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4585088444383521, 'Valid Loss': 0.6946783280372619, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.96875, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.44690896002085584, 'Valid Loss': 0.69533087849617, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.96875, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.42167134132040174, 'Valid Loss': 0.7006647849082946, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.96875, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4210544695195399, 'Valid Loss': 0.6990406584739685, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.9375, 'F1': 0.759493670886076, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.41472785665016426, 'Valid Loss': 0.7019890773296357, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.9375, 'F1': 0.759493670886076, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.40641053432696744, 'Valid Loss': 0.7049456596374511, 'Validation Metric': {'Precision': 0.6382978723404256, 'Recall': 0.9375, 'F1': 0.759493670886076, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3913777613718259, 'Valid Loss': 0.7038563513755798, 'Validation Metric': {'Precision': 0.6451612903225806, 'Recall': 0.9375, 'F1': 0.7643312101910829, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}; Test loss: 0.648183913230896
