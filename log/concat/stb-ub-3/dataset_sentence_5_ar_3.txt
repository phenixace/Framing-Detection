Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7057091444730759, 'Valid Loss': 0.702485420703888, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.05555555555555555, 'F1': 0.10169491525423728, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.05555555555555555, 'F1': 0.10169491525423728, 'Acc': 0.47}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7076157119713331, 'Valid Loss': 0.6981503295898438, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.2037037037037037, 'F1': 0.3055555555555555, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.2037037037037037, 'F1': 0.3055555555555555, 'Acc': 0.5}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7016937732696533, 'Valid Loss': 0.694625723361969, 'Validation Metric': {'Precision': 0.59375, 'Recall': 0.35185185185185186, 'F1': 0.4418604651162791, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.59375, 'Recall': 0.35185185185185186, 'F1': 0.4418604651162791, 'Acc': 0.52}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7013277380090011, 'Valid Loss': 0.6921328854560852, 'Validation Metric': {'Precision': 0.5370370370370371, 'Recall': 0.5370370370370371, 'F1': 0.5370370370370371, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5370370370370371, 'Recall': 0.5370370370370371, 'F1': 0.5370370370370371, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6950587198922509, 'Valid Loss': 0.6919997882843018, 'Validation Metric': {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6853617468946859, 'Valid Loss': 0.6923164081573486, 'Validation Metric': {'Precision': 0.5507246376811594, 'Recall': 0.7037037037037037, 'F1': 0.6178861788617886, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6719117031285637, 'Valid Loss': 0.693812346458435, 'Validation Metric': {'Precision': 0.5223880597014925, 'Recall': 0.6481481481481481, 'F1': 0.5785123966942148, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6530453562736511, 'Valid Loss': 0.6899009466171264, 'Validation Metric': {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.635378330161697, 'Valid Loss': 0.6978887271881103, 'Validation Metric': {'Precision': 0.5166666666666667, 'Recall': 0.5740740740740741, 'F1': 0.543859649122807, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6192200030935439, 'Valid Loss': 0.6947548365592957, 'Validation Metric': {'Precision': 0.5441176470588235, 'Recall': 0.6851851851851852, 'F1': 0.6065573770491803, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5981587877399043, 'Valid Loss': 0.7044738841056823, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.5555555555555556, 'F1': 0.5504587155963303, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5777112806313917, 'Valid Loss': 0.7085273456573487, 'Validation Metric': {'Precision': 0.5370370370370371, 'Recall': 0.5370370370370371, 'F1': 0.5370370370370371, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5545681965978522, 'Valid Loss': 0.7090931987762451, 'Validation Metric': {'Precision': 0.5686274509803921, 'Recall': 0.5370370370370371, 'F1': 0.5523809523809524, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5424404116837602, 'Valid Loss': 0.7062308442592621, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5555555555555556, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5192574050865675, 'Valid Loss': 0.7187098455429077, 'Validation Metric': {'Precision': 0.5510204081632653, 'Recall': 0.5, 'F1': 0.5242718446601942, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5076861969734493, 'Valid Loss': 0.7269605088233948, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.46296296296296297, 'F1': 0.505050505050505, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4947853009951742, 'Valid Loss': 0.7271692371368408, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.5, 'F1': 0.5294117647058824, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.48040561966205897, 'Valid Loss': 0.7282989549636841, 'Validation Metric': {'Precision': 0.5531914893617021, 'Recall': 0.48148148148148145, 'F1': 0.5148514851485149, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.47296034583919927, 'Valid Loss': 0.7261310482025146, 'Validation Metric': {'Precision': 0.5510204081632653, 'Recall': 0.5, 'F1': 0.5242718446601942, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.47277945750638056, 'Valid Loss': 0.7228084206581116, 'Validation Metric': {'Precision': 0.54, 'Recall': 0.5, 'F1': 0.5192307692307693, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.7037037037037037, 'F1': 0.6229508196721312, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.44285714285714284, 'Recall': 0.7209302325581395, 'F1': 0.5486725663716814, 'Acc': 0.49}; Test loss: 0.6996346282958984
