Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6789801971117655, 'Valid Loss': 0.6634779755885785, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.11428571428571428, 'F1': 0.18604651162790695, 'Acc': 0.6534653465346535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.11428571428571428, 'F1': 0.18604651162790695, 'Acc': 0.6534653465346535}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6744866665204367, 'Valid Loss': 0.6591420081945566, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6733908335367839, 'Valid Loss': 0.6521748418991382, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6691177670160929, 'Valid Loss': 0.6484007078867692, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.663799200852712, 'Valid Loss': 0.6458182013951815, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6562633236249288, 'Valid Loss': 0.6445410240155, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6320770943164825, 'Valid Loss': 0.6425160834422479, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.615541787147522, 'Valid Loss': 0.6490570581876315, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5822471586863199, 'Valid Loss': 0.6518157456929867, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.02857142857142857, 'F1': 0.049999999999999996, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5472286625703175, 'Valid Loss': 0.6605714651254507, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.08571428571428572, 'F1': 0.13636363636363638, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5041537050406139, 'Valid Loss': 0.6548824310302734, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.05714285714285714, 'F1': 0.09523809523809522, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.11428571428571428, 'F1': 0.19047619047619044, 'Acc': 0.6633663366336634}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4714149407545726, 'Valid Loss': 0.6649192560177583, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.14285714285714285, 'F1': 0.20833333333333331, 'Acc': 0.6237623762376238}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.14285714285714285, 'F1': 0.20833333333333331, 'Acc': 0.6237623762376238}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4404003071784973, 'Valid Loss': 0.6679022976985345, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.14285714285714285, 'F1': 0.21276595744680848, 'Acc': 0.6336633663366337}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.14285714285714285, 'F1': 0.21276595744680848, 'Acc': 0.6336633663366337}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.40786501407623293, 'Valid Loss': 0.6705105304718018, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.11428571428571428, 'F1': 0.1702127659574468, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.14285714285714285, 'F1': 0.21276595744680848, 'Acc': 0.6336633663366337}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3918002756436666, 'Valid Loss': 0.6741997909087402, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.14285714285714285, 'F1': 0.20408163265306123, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.14285714285714285, 'F1': 0.21276595744680848, 'Acc': 0.6336633663366337}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3630904763936996, 'Valid Loss': 0.6797117132406968, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.17142857142857143, 'F1': 0.24489795918367346, 'Acc': 0.6336633663366337}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.17142857142857143, 'F1': 0.24489795918367346, 'Acc': 0.6336633663366337}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.339035293062528, 'Valid Loss': 0.6843777906436187, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.2, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4117647058823529, 'Recall': 0.2, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3287229756514231, 'Valid Loss': 0.6862383003418262, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.14285714285714285, 'F1': 0.20408163265306123, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4117647058823529, 'Recall': 0.2, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.30937190433343253, 'Valid Loss': 0.6879212638506522, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.17142857142857143, 'F1': 0.23529411764705876, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4117647058823529, 'Recall': 0.2, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.29630710184574127, 'Valid Loss': 0.6890271701491796, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.14285714285714285, 'F1': 0.20408163265306123, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4117647058823529, 'Recall': 0.2, 'F1': 0.2692307692307692, 'Acc': 0.6237623762376238}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5217391304347826, 'Recall': 0.2608695652173913, 'F1': 0.3478260869565218, 'Acc': 0.5544554455445545}; Test loss: 0.792591834297547
