Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6712857382862192, 'Valid Loss': 0.6920496775553777, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6671312106283087, 'Valid Loss': 0.6909355475352361, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.043478260869565216, 'F1': 0.08, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6604327453594458, 'Valid Loss': 0.6920586228370667, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6549923580728079, 'Valid Loss': 0.6932509942696645, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6501756255563936, 'Valid Loss': 0.6938695804430888, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6452276840021736, 'Valid Loss': 0.6981826642384896, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6288949153140971, 'Valid Loss': 0.6994291704434615, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.608805324686201, 'Valid Loss': 0.7004689986889179, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.043478260869565216, 'F1': 0.08, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5893123479265916, 'Valid Loss': 0.7045727119995997, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.06521739130434782, 'F1': 0.11764705882352941, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5593605747348384, 'Valid Loss': 0.7149583330521216, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.10869565217391304, 'F1': 0.1818181818181818, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.10869565217391304, 'F1': 0.1818181818181818, 'Acc': 0.5544554455445545}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.530823835416844, 'Valid Loss': 0.7177125100906079, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.10869565217391304, 'F1': 0.17857142857142855, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.10869565217391304, 'F1': 0.1818181818181818, 'Acc': 0.5544554455445545}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4916716759142123, 'Valid Loss': 0.7242451654030726, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.15217391304347827, 'F1': 0.23333333333333334, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.15217391304347827, 'F1': 0.23333333333333334, 'Acc': 0.5445544554455446}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.47983186633179065, 'Valid Loss': 0.7323093712329865, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.15217391304347827, 'F1': 0.23333333333333334, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.15217391304347827, 'F1': 0.23333333333333334, 'Acc': 0.5445544554455446}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4388695000425765, 'Valid Loss': 0.7326684823402991, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.15217391304347827, 'F1': 0.22580645161290325, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.15217391304347827, 'F1': 0.23333333333333334, 'Acc': 0.5445544554455446}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4205339180403634, 'Valid Loss': 0.7386666650955493, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.15217391304347827, 'F1': 0.22580645161290325, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.15217391304347827, 'F1': 0.23333333333333334, 'Acc': 0.5445544554455446}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4014771698336852, 'Valid Loss': 0.7460000228423339, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.17391304347826086, 'F1': 0.25396825396825395, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47058823529411764, 'Recall': 0.17391304347826086, 'F1': 0.25396825396825395, 'Acc': 0.5346534653465347}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.37958527160318273, 'Valid Loss': 0.7525468445741214, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.36437792468227836, 'Valid Loss': 0.7556559007901412, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.17391304347826086, 'F1': 0.25396825396825395, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.352311909198761, 'Valid Loss': 0.7540342658758163, 'Validation Metric': {'Precision': 0.47368421052631576, 'Recall': 0.1956521739130435, 'F1': 0.2769230769230769, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47368421052631576, 'Recall': 0.1956521739130435, 'F1': 0.2769230769230769, 'Acc': 0.5346534653465347}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3395814505454741, 'Valid Loss': 0.7570153463345307, 'Validation Metric': {'Precision': 0.47368421052631576, 'Recall': 0.1956521739130435, 'F1': 0.2769230769230769, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.47368421052631576, 'Recall': 0.1956521739130435, 'F1': 0.2769230769230769, 'Acc': 0.5346534653465347}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.47368421052631576, 'Recall': 0.20930232558139536, 'F1': 0.2903225806451613, 'Acc': 0.56}; Test loss: 0.6898946499824524
