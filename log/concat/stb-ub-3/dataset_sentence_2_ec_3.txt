Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6820676138526515, 'Valid Loss': 0.6767863202095031, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6798332490419087, 'Valid Loss': 0.6765838098526001, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.046511627906976744, 'F1': 0.08695652173913045, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6782648218305487, 'Valid Loss': 0.6761870908737183, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6735437057520214, 'Valid Loss': 0.6757058453559875, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6693779065420753, 'Valid Loss': 0.6732088375091553, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6595477104971283, 'Valid Loss': 0.670179888010025, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6472918336328707, 'Valid Loss': 0.667059781551361, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.06976744186046512, 'F1': 0.13043478260869565, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.09302325581395349, 'F1': 0.16326530612244897, 'Acc': 0.59}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6308372059935018, 'Valid Loss': 0.6628736114501953, 'Validation Metric': {'Precision': 0.8333333333333334, 'Recall': 0.11627906976744186, 'F1': 0.20408163265306123, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8333333333333334, 'Recall': 0.11627906976744186, 'F1': 0.20408163265306123, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6083795679242987, 'Valid Loss': 0.6590306615829468, 'Validation Metric': {'Precision': 0.8571428571428571, 'Recall': 0.13953488372093023, 'F1': 0.24, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8571428571428571, 'Recall': 0.13953488372093023, 'F1': 0.24, 'Acc': 0.62}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5875372894500431, 'Valid Loss': 0.6593754804134369, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.20930232558139536, 'F1': 0.32142857142857145, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.20930232558139536, 'F1': 0.32142857142857145, 'Acc': 0.62}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5594155564904213, 'Valid Loss': 0.6594177401065826, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.20930232558139536, 'F1': 0.32142857142857145, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.20930232558139536, 'F1': 0.32142857142857145, 'Acc': 0.62}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5387733947289618, 'Valid Loss': 0.6595830690860748, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.27906976744186046, 'F1': 0.4, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7058823529411765, 'Recall': 0.27906976744186046, 'F1': 0.4, 'Acc': 0.64}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5073750328860784, 'Valid Loss': 0.6596381402015686, 'Validation Metric': {'Precision': 0.7333333333333333, 'Recall': 0.2558139534883721, 'F1': 0.3793103448275862, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7058823529411765, 'Recall': 0.27906976744186046, 'F1': 0.4, 'Acc': 0.64}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.47657518265278714, 'Valid Loss': 0.6580443131923676, 'Validation Metric': {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.45021032463563115, 'Valid Loss': 0.6653693866729736, 'Validation Metric': {'Precision': 0.65, 'Recall': 0.3023255813953488, 'F1': 0.4126984126984127, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.42384155408332225, 'Valid Loss': 0.6651628959178925, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.27906976744186046, 'F1': 0.380952380952381, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.41323056209244224, 'Valid Loss': 0.6619662725925446, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.27906976744186046, 'F1': 0.3934426229508197, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.38909717413939926, 'Valid Loss': 0.6608606052398681, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.27906976744186046, 'F1': 0.3934426229508197, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.38752786481851026, 'Valid Loss': 0.6622995483875275, 'Validation Metric': {'Precision': 0.631578947368421, 'Recall': 0.27906976744186046, 'F1': 0.3870967741935483, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.38416247481578275, 'Valid Loss': 0.6638326787948609, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.27906976744186046, 'F1': 0.380952380952381, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.3023255813953488, 'F1': 0.4262295081967213, 'Acc': 0.65}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2857142857142857, 'Recall': 0.11428571428571428, 'F1': 0.16326530612244897, 'Acc': 0.594059405940594}; Test loss: 0.669587913614053
