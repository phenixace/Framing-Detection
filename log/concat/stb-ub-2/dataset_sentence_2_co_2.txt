Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7352822924915113, 'Valid Loss': 0.7186532163619995, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.09230769230769231, 'F1': 0.16438356164383564, 'Acc': 0.39}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.09230769230769231, 'F1': 0.16438356164383564, 'Acc': 0.39}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.74061392796667, 'Valid Loss': 0.6955457592010498, 'Validation Metric': {'Precision': 0.7931034482758621, 'Recall': 0.35384615384615387, 'F1': 0.48936170212765956, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7931034482758621, 'Recall': 0.35384615384615387, 'F1': 0.48936170212765956, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7116681486368179, 'Valid Loss': 0.6644001293182373, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.8615384615384616, 'F1': 0.7516778523489933, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.8615384615384616, 'F1': 0.7516778523489933, 'Acc': 0.63}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6800266500366362, 'Valid Loss': 0.648198549747467, 'Validation Metric': {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.666530988718334, 'Valid Loss': 0.6482977116107941, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.9692307692307692, 'F1': 0.7730061349693251, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6384936053501932, 'Valid Loss': 0.6488326919078827, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.9538461538461539, 'F1': 0.7701863354037267, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5921546691342404, 'Valid Loss': 0.6577899253368378, 'Validation Metric': {'Precision': 0.651685393258427, 'Recall': 0.8923076923076924, 'F1': 0.7532467532467532, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5664773046186096, 'Valid Loss': 0.6619810533523559, 'Validation Metric': {'Precision': 0.6444444444444445, 'Recall': 0.8923076923076924, 'F1': 0.7483870967741936, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5299486717895457, 'Valid Loss': 0.6661454260349273, 'Validation Metric': {'Precision': 0.6555555555555556, 'Recall': 0.9076923076923077, 'F1': 0.7612903225806452, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.49435646381033094, 'Valid Loss': 0.6830366015434265, 'Validation Metric': {'Precision': 0.6477272727272727, 'Recall': 0.8769230769230769, 'F1': 0.7450980392156863, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4514102275042157, 'Valid Loss': 0.6966586029529571, 'Validation Metric': {'Precision': 0.632183908045977, 'Recall': 0.8461538461538461, 'F1': 0.7236842105263158, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.41464711608071075, 'Valid Loss': 0.7003022462129593, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.8461538461538461, 'F1': 0.7189542483660131, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.40151313202161537, 'Valid Loss': 0.6989368498325348, 'Validation Metric': {'Precision': 0.6206896551724138, 'Recall': 0.8307692307692308, 'F1': 0.7105263157894737, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.36358603580217613, 'Valid Loss': 0.7082669264078141, 'Validation Metric': {'Precision': 0.6206896551724138, 'Recall': 0.8307692307692308, 'F1': 0.7105263157894737, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.34315509780457143, 'Valid Loss': 0.7107146233320236, 'Validation Metric': {'Precision': 0.6235294117647059, 'Recall': 0.8153846153846154, 'F1': 0.7066666666666667, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3223668829979081, 'Valid Loss': 0.7179296457767487, 'Validation Metric': {'Precision': 0.6206896551724138, 'Recall': 0.8307692307692308, 'F1': 0.7105263157894737, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3053676405627477, 'Valid Loss': 0.7228046262264252, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.8307692307692308, 'F1': 0.7248322147651007, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3092674572805041, 'Valid Loss': 0.7219072806835175, 'Validation Metric': {'Precision': 0.6352941176470588, 'Recall': 0.8307692307692308, 'F1': 0.7199999999999999, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.27868026455766276, 'Valid Loss': 0.7203138691186904, 'Validation Metric': {'Precision': 0.6352941176470588, 'Recall': 0.8307692307692308, 'F1': 0.7199999999999999, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2871488286672454, 'Valid Loss': 0.721958646774292, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.8307692307692308, 'F1': 0.7248322147651007, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6464646464646465, 'Recall': 0.9846153846153847, 'F1': 0.7804878048780488, 'Acc': 0.64}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7083333333333334, 'Recall': 0.9444444444444444, 'F1': 0.8095238095238096, 'Acc': 0.6831683168316832}; Test loss: 0.6595349541077247
