Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6816855065132442, 'Valid Loss': 0.6822139978408813, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6782737884082293, 'Valid Loss': 0.6819265532493591, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.13953488372093023, 'F1': 0.22222222222222218, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6710359258087057, 'Valid Loss': 0.6817157220840454, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.13953488372093023, 'F1': 0.22641509433962265, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6695842495874355, 'Valid Loss': 0.679597362279892, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.13953488372093023, 'F1': 0.2352941176470588, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.647943800217227, 'Valid Loss': 0.6767375183105468, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.11627906976744186, 'F1': 0.19607843137254904, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6330221558087751, 'Valid Loss': 0.67485808968544, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.16279069767441862, 'F1': 0.2692307692307693, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.18604651162790697, 'F1': 0.2807017543859649, 'Acc': 0.59}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5762928626254985, 'Valid Loss': 0.6871639442443848, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.18604651162790697, 'F1': 0.2857142857142857, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6153846153846154, 'Recall': 0.18604651162790697, 'F1': 0.2857142857142857, 'Acc': 0.6}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5255229978969223, 'Valid Loss': 0.7060441589355468, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.18604651162790697, 'F1': 0.26666666666666666, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6153846153846154, 'Recall': 0.18604651162790697, 'F1': 0.2857142857142857, 'Acc': 0.6}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.48212326925836113, 'Valid Loss': 0.7501683104038238, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.2558139534883721, 'F1': 0.34375, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.2558139534883721, 'F1': 0.34375, 'Acc': 0.58}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4551791112477842, 'Valid Loss': 0.735971519947052, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.3922329337189072, 'Valid Loss': 0.8107094019651413, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.2558139534883721, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3665763051494172, 'Valid Loss': 0.817053598165512, 'Validation Metric': {'Precision': 0.48, 'Recall': 0.27906976744186046, 'F1': 0.35294117647058815, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.33094858897751883, 'Valid Loss': 0.8554391157627106, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.27906976744186046, 'F1': 0.3380281690140845, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3012666425814754, 'Valid Loss': 0.8585783565044403, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.27906976744186046, 'F1': 0.3380281690140845, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.29672802509249824, 'Valid Loss': 0.8460174989700318, 'Validation Metric': {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.26885227040436704, 'Valid Loss': 0.9045751702785492, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.23255813953488372, 'F1': 0.29850746268656714, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.26295765773638297, 'Valid Loss': 0.9150926971435547, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.2558139534883721, 'F1': 0.3188405797101449, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.26397678550136716, 'Valid Loss': 0.8965467357635498, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.2558139534883721, 'F1': 0.3098591549295775, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.24752425819047189, 'Valid Loss': 0.916445198059082, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.2558139534883721, 'F1': 0.3188405797101449, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.22273060429449143, 'Valid Loss': 0.9245698148012161, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.2558139534883721, 'F1': 0.3188405797101449, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.27906976744186046, 'F1': 0.36923076923076914, 'Acc': 0.59}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.36585365853658536, 'Recall': 0.42857142857142855, 'F1': 0.39473684210526316, 'Acc': 0.5445544554455446}; Test loss: 0.7027212324050757
