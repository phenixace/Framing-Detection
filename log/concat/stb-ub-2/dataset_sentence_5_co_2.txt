Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7446805207352889, 'Valid Loss': 0.7393667984008789, 'Validation Metric': {'Precision': 0.6842105263157895, 'Recall': 0.18309859154929578, 'F1': 0.2888888888888889, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6842105263157895, 'Recall': 0.18309859154929578, 'F1': 0.2888888888888889, 'Acc': 0.36}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7395897209644318, 'Valid Loss': 0.7095328068733215, 'Validation Metric': {'Precision': 0.675, 'Recall': 0.38028169014084506, 'F1': 0.48648648648648646, 'Acc': 0.43}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.675, 'Recall': 0.38028169014084506, 'F1': 0.48648648648648646, 'Acc': 0.43}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7120370268821716, 'Valid Loss': 0.6681739377975464, 'Validation Metric': {'Precision': 0.686046511627907, 'Recall': 0.8309859154929577, 'F1': 0.751592356687898, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.686046511627907, 'Recall': 0.8309859154929577, 'F1': 0.751592356687898, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6764511815027187, 'Valid Loss': 0.639002628326416, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.654564262220734, 'Valid Loss': 0.6245416319370269, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.629789203797516, 'Valid Loss': 0.6206863093376159, 'Validation Metric': {'Precision': 0.711340206185567, 'Recall': 0.971830985915493, 'F1': 0.8214285714285714, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5872782453110343, 'Valid Loss': 0.617562403678894, 'Validation Metric': {'Precision': 0.7096774193548387, 'Recall': 0.9295774647887324, 'F1': 0.804878048780488, 'Acc': 0.68}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5542775917994348, 'Valid Loss': 0.6167841935157776, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.9577464788732394, 'F1': 0.8143712574850299, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5200000487660107, 'Valid Loss': 0.6405170059204102, 'Validation Metric': {'Precision': 0.7093023255813954, 'Recall': 0.8591549295774648, 'F1': 0.7770700636942676, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.477070597245505, 'Valid Loss': 0.6366112703084945, 'Validation Metric': {'Precision': 0.7159090909090909, 'Recall': 0.8873239436619719, 'F1': 0.7924528301886792, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4319932100019957, 'Valid Loss': 0.6378346085548401, 'Validation Metric': {'Precision': 0.7126436781609196, 'Recall': 0.8732394366197183, 'F1': 0.7848101265822784, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.41006819472501155, 'Valid Loss': 0.6350094699859619, 'Validation Metric': {'Precision': 0.7126436781609196, 'Recall': 0.8732394366197183, 'F1': 0.7848101265822784, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3730386511275643, 'Valid Loss': 0.6404053473472595, 'Validation Metric': {'Precision': 0.7159090909090909, 'Recall': 0.8873239436619719, 'F1': 0.7924528301886792, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.34793556226711525, 'Valid Loss': 0.6373231828212738, 'Validation Metric': {'Precision': 0.7325581395348837, 'Recall': 0.8873239436619719, 'F1': 0.8025477707006369, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.33883554664881604, 'Valid Loss': 0.6563116997480393, 'Validation Metric': {'Precision': 0.725, 'Recall': 0.8169014084507042, 'F1': 0.7682119205298014, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3412856159633712, 'Valid Loss': 0.6422633314132691, 'Validation Metric': {'Precision': 0.7261904761904762, 'Recall': 0.8591549295774648, 'F1': 0.7870967741935485, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.27967501970890324, 'Valid Loss': 0.6567470604181289, 'Validation Metric': {'Precision': 0.7294117647058823, 'Recall': 0.8732394366197183, 'F1': 0.7948717948717949, 'Acc': 0.68}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.280814510917193, 'Valid Loss': 0.6548118370771409, 'Validation Metric': {'Precision': 0.7349397590361446, 'Recall': 0.8591549295774648, 'F1': 0.7922077922077921, 'Acc': 0.68}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2881080965070348, 'Valid Loss': 0.6614626270532608, 'Validation Metric': {'Precision': 0.7317073170731707, 'Recall': 0.8450704225352113, 'F1': 0.7843137254901961, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.26746826050312894, 'Valid Loss': 0.6634835058450699, 'Validation Metric': {'Precision': 0.7317073170731707, 'Recall': 0.8450704225352113, 'F1': 0.7843137254901961, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.625, 'Recall': 0.9375, 'F1': 0.75, 'Acc': 0.6}; Test loss: 0.6701310765743256
