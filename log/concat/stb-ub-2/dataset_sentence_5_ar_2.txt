Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7081124539438047, 'Valid Loss': 0.7038954210281372, 'Validation Metric': {'Precision': 0.5333333333333333, 'Recall': 0.14814814814814814, 'F1': 0.2318840579710145, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5333333333333333, 'Recall': 0.14814814814814814, 'F1': 0.2318840579710145, 'Acc': 0.47}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7137360533601359, 'Valid Loss': 0.7001065850257874, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.2962962962962963, 'F1': 0.4, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6153846153846154, 'Recall': 0.2962962962962963, 'F1': 0.4, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7121904955098504, 'Valid Loss': 0.6948721027374267, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.46296296296296297, 'F1': 0.505050505050505, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.46296296296296297, 'F1': 0.505050505050505, 'Acc': 0.51}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7024586161500529, 'Valid Loss': 0.6935841321945191, 'Validation Metric': {'Precision': 0.5223880597014925, 'Recall': 0.6481481481481481, 'F1': 0.5785123966942148, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5223880597014925, 'Recall': 0.6481481481481481, 'F1': 0.5785123966942148, 'Acc': 0.49}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6833905201209219, 'Valid Loss': 0.6938042306900024, 'Validation Metric': {'Precision': 0.5416666666666666, 'Recall': 0.7222222222222222, 'F1': 0.619047619047619, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7222222222222222, 'F1': 0.619047619047619, 'Acc': 0.52}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6791633014616213, 'Valid Loss': 0.6966069436073303, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.6666666666666666, 'F1': 0.5901639344262295, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7222222222222222, 'F1': 0.619047619047619, 'Acc': 0.52}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6422021608603629, 'Valid Loss': 0.7040178394317627, 'Validation Metric': {'Precision': 0.53125, 'Recall': 0.6296296296296297, 'F1': 0.5762711864406779, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7222222222222222, 'F1': 0.619047619047619, 'Acc': 0.52}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6098874936762609, 'Valid Loss': 0.7023163485527039, 'Validation Metric': {'Precision': 0.5396825396825397, 'Recall': 0.6296296296296297, 'F1': 0.5811965811965812, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7222222222222222, 'F1': 0.619047619047619, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.542481883183906, 'Valid Loss': 0.7149463725090027, 'Validation Metric': {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.512614143914298, 'Valid Loss': 0.7145344376564026, 'Validation Metric': {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4526059796151362, 'Valid Loss': 0.7486640465259552, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.6111111111111112, 'F1': 0.6111111111111112, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4308837705144757, 'Valid Loss': 0.749825531244278, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.6111111111111112, 'F1': 0.6055045871559633, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.36223719072969335, 'Valid Loss': 0.7906847667694091, 'Validation Metric': {'Precision': 0.5789473684210527, 'Recall': 0.6111111111111112, 'F1': 0.5945945945945946, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3234197032686911, 'Valid Loss': 0.7956496238708496, 'Validation Metric': {'Precision': 0.5636363636363636, 'Recall': 0.5740740740740741, 'F1': 0.5688073394495413, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.31178328473316996, 'Valid Loss': 0.8273725485801697, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5555555555555556, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.28542678813008887, 'Valid Loss': 0.8488116633892059, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5555555555555556, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2661415620854026, 'Valid Loss': 0.8533808875083924, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5555555555555556, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2660394694263998, 'Valid Loss': 0.8647007316350936, 'Validation Metric': {'Precision': 0.5471698113207547, 'Recall': 0.5370370370370371, 'F1': 0.5420560747663552, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2691004074325687, 'Valid Loss': 0.8641588240861893, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5555555555555556, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.22858993130687036, 'Valid Loss': 0.8657642984390259, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5555555555555556, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.6481481481481481, 'Recall': 0.6481481481481481, 'F1': 0.6481481481481481, 'Acc': 0.62}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3877551020408163, 'Recall': 0.4418604651162791, 'F1': 0.4130434782608695, 'Acc': 0.46}; Test loss: 0.7513661408424377
