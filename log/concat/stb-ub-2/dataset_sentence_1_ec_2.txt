Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.679538853074375, 'Valid Loss': 0.6730870175361633, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6869509855383321, 'Valid Loss': 0.6701992392539978, 'Validation Metric': {'Precision': 0.125, 'Recall': 0.02857142857142857, 'F1': 0.04651162790697674, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6798598903574442, 'Valid Loss': 0.66659663438797, 'Validation Metric': {'Precision': 0.14285714285714285, 'Recall': 0.02857142857142857, 'F1': 0.04761904761904761, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6725064531752938, 'Valid Loss': 0.6647809040546417, 'Validation Metric': {'Precision': 0.14285714285714285, 'Recall': 0.02857142857142857, 'F1': 0.04761904761904761, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.663608948651113, 'Valid Loss': 0.6636287248134614, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.05714285714285714, 'F1': 0.09302325581395347, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.08571428571428572, 'F1': 0.12500000000000003, 'Acc': 0.58}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6439465617662982, 'Valid Loss': 0.6630660974979401, 'Validation Metric': {'Precision': 0.2727272727272727, 'Recall': 0.08571428571428572, 'F1': 0.13043478260869562, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2727272727272727, 'Recall': 0.08571428571428572, 'F1': 0.13043478260869562, 'Acc': 0.6}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6183230112257757, 'Valid Loss': 0.6647447097301483, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.08571428571428572, 'F1': 0.13333333333333333, 'Acc': 0.61}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5548710501507709, 'Valid Loss': 0.6748392176628113, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5132738336136466, 'Valid Loss': 0.695832644701004, 'Validation Metric': {'Precision': 0.4642857142857143, 'Recall': 0.37142857142857144, 'F1': 0.41269841269841273, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4642857142857143, 'Recall': 0.37142857142857144, 'F1': 0.41269841269841273, 'Acc': 0.63}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4537743643710488, 'Valid Loss': 0.7123001039028167, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.40276980743204294, 'Valid Loss': 0.7494635581970215, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.4, 'F1': 0.4000000000000001, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3637790405436566, 'Valid Loss': 0.7549275100231171, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 0.4, 'F1': 0.39436619718309857, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3181659105773035, 'Valid Loss': 0.7735994279384613, 'Validation Metric': {'Precision': 0.42424242424242425, 'Recall': 0.4, 'F1': 0.411764705882353, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.29308502503523703, 'Valid Loss': 0.777293781042099, 'Validation Metric': {'Precision': 0.38235294117647056, 'Recall': 0.37142857142857144, 'F1': 0.37681159420289856, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2704611721595651, 'Valid Loss': 0.7796865355968475, 'Validation Metric': {'Precision': 0.35135135135135137, 'Recall': 0.37142857142857144, 'F1': 0.36111111111111116, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2717185257688949, 'Valid Loss': 0.781993854045868, 'Validation Metric': {'Precision': 0.3783783783783784, 'Recall': 0.4, 'F1': 0.3888888888888889, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2568641862292823, 'Valid Loss': 0.7936081326007843, 'Validation Metric': {'Precision': 0.3611111111111111, 'Recall': 0.37142857142857144, 'F1': 0.3661971830985915, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2523281386024074, 'Valid Loss': 0.7954502248764038, 'Validation Metric': {'Precision': 0.35135135135135137, 'Recall': 0.37142857142857144, 'F1': 0.36111111111111116, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.23326270517550016, 'Valid Loss': 0.8040161263942719, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.37142857142857144, 'F1': 0.35135135135135137, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.22196815368768416, 'Valid Loss': 0.8038053381443023, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.37142857142857144, 'F1': 0.35135135135135137, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.43333333333333335, 'Recall': 0.3023255813953488, 'F1': 0.35616438356164387, 'Acc': 0.53}; Test loss: 0.7678220677375793
