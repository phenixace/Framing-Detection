Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6806987767156801, 'Valid Loss': 0.68060307264328, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6873701630454314, 'Valid Loss': 0.6793777084350586, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.13953488372093023, 'F1': 0.2, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6830251785485368, 'Valid Loss': 0.677844054698944, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.09302325581395349, 'F1': 0.14545454545454545, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6728879981919339, 'Valid Loss': 0.6763685894012451, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.023255813953488372, 'F1': 0.041666666666666664, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6658123457118085, 'Valid Loss': 0.6755639004707337, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.023255813953488372, 'F1': 0.04081632653061224, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6428580033151727, 'Valid Loss': 0.6677687740325928, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.18604651162790697, 'F1': 0.26666666666666666, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.391304347826087, 'Recall': 0.20930232558139536, 'F1': 0.2727272727272727, 'Acc': 0.52}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6131564719896567, 'Valid Loss': 0.6868268191814423, 'Validation Metric': {'Precision': 0.41935483870967744, 'Recall': 0.3023255813953488, 'F1': 0.3513513513513513, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41935483870967744, 'Recall': 0.3023255813953488, 'F1': 0.3513513513513513, 'Acc': 0.52}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.56344793423226, 'Valid Loss': 0.6762696897983551, 'Validation Metric': {'Precision': 0.46875, 'Recall': 0.3488372093023256, 'F1': 0.4000000000000001, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.46875, 'Recall': 0.3488372093023256, 'F1': 0.4000000000000001, 'Acc': 0.55}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5001738940022493, 'Valid Loss': 0.6892153942584991, 'Validation Metric': {'Precision': 0.5142857142857142, 'Recall': 0.4186046511627907, 'F1': 0.4615384615384615, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5142857142857142, 'Recall': 0.4186046511627907, 'F1': 0.4615384615384615, 'Acc': 0.58}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.46278674057439756, 'Valid Loss': 0.6994312810897827, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.4186046511627907, 'F1': 0.45569620253164556, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.5142857142857142, 'Recall': 0.4186046511627907, 'F1': 0.4615384615384615, 'Acc': 0.58}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4087280354609615, 'Valid Loss': 0.7322873830795288, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.46511627906976744, 'F1': 0.4705882352941176, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47619047619047616, 'Recall': 0.46511627906976744, 'F1': 0.4705882352941176, 'Acc': 0.55}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.366990457043836, 'Valid Loss': 0.7539948546886444, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.317046852096131, 'Valid Loss': 0.7743825590610505, 'Validation Metric': {'Precision': 0.4634146341463415, 'Recall': 0.4418604651162791, 'F1': 0.45238095238095233, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2983325327697553, 'Valid Loss': 0.7883351385593415, 'Validation Metric': {'Precision': 0.4634146341463415, 'Recall': 0.4418604651162791, 'F1': 0.45238095238095233, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2879684247860783, 'Valid Loss': 0.7937250065803528, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.46511627906976744, 'F1': 0.4545454545454546, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.26577516135416535, 'Valid Loss': 0.7981927537918091, 'Validation Metric': {'Precision': 0.4878048780487805, 'Recall': 0.46511627906976744, 'F1': 0.4761904761904762, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2537664181895946, 'Valid Loss': 0.8066841864585876, 'Validation Metric': {'Precision': 0.4883720930232558, 'Recall': 0.4883720930232558, 'F1': 0.4883720930232558, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2456271809182669, 'Valid Loss': 0.8134867680072785, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.46511627906976744, 'F1': 0.4705882352941176, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2316661089854805, 'Valid Loss': 0.8158728206157684, 'Validation Metric': {'Precision': 0.46511627906976744, 'Recall': 0.46511627906976744, 'F1': 0.46511627906976744, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.23245139714134366, 'Valid Loss': 0.8179452562332153, 'Validation Metric': {'Precision': 0.46511627906976744, 'Recall': 0.46511627906976744, 'F1': 0.46511627906976744, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5116279069767442, 'F1': 0.5057471264367817, 'Acc': 0.57}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3333333333333333, 'Recall': 0.3142857142857143, 'F1': 0.3235294117647059, 'Acc': 0.54}; Test loss: 0.7649309003353119
