Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='mo')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6188330673857739, 'Valid Loss': 0.6292897319793701, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.569436810518566, 'Valid Loss': 0.561858457326889, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.4734143285374892, 'Valid Loss': 0.4844143879413605, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.37056426409828036, 'Valid Loss': 0.4295581704378128, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.29407597646901484, 'Valid Loss': 0.4076015931367874, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.24893342576136715, 'Valid Loss': 0.41242431849241257, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22657529274491886, 'Valid Loss': 0.41698417395353315, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21142705245629737, 'Valid Loss': 0.4252180576324463, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.1997805827934491, 'Valid Loss': 0.4306067183613777, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.18006918113678694, 'Valid Loss': 0.4313602893054485, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.16680532644845938, 'Valid Loss': 0.44156563267111776, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.14426964570425058, 'Valid Loss': 0.4363550047576428, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1325932848512342, 'Valid Loss': 0.4454821407794952, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1240865571522399, 'Valid Loss': 0.4494696719944477, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.11346556084524644, 'Valid Loss': 0.45569839611649515, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.10337641072998706, 'Valid Loss': 0.45938822731375695, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.09820746632881071, 'Valid Loss': 0.46385613903403283, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.09381991936089962, 'Valid Loss': 0.4624945428967476, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.09321618849705708, 'Valid Loss': 0.46374923855066297, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.09216109155922343, 'Valid Loss': 0.4642567609250545, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.86}}
Best validation metric so far: {'Precision': 0.16666666666666666, 'Recall': 0.14285714285714285, 'F1': 0.15384615384615383, 'Acc': 0.78}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.07692307692307693, 'Recall': 0.09090909090909091, 'F1': 0.08333333333333334, 'Acc': 0.78}; Test loss: 0.6289447236061096
