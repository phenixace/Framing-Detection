Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7076513409614563, 'Valid Loss': 0.6970660067521609, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.18, 'F1': 0.2647058823529412, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.18, 'F1': 0.2647058823529412, 'Acc': 0.504950495049505}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7116209308306376, 'Valid Loss': 0.6958996676481687, 'Validation Metric': {'Precision': 0.5357142857142857, 'Recall': 0.3, 'F1': 0.38461538461538464, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5357142857142857, 'Recall': 0.3, 'F1': 0.38461538461538464, 'Acc': 0.5247524752475248}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7106958436965942, 'Valid Loss': 0.6948410868644714, 'Validation Metric': {'Precision': 0.48717948717948717, 'Recall': 0.38, 'F1': 0.4269662921348315, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.48717948717948717, 'Recall': 0.38, 'F1': 0.4269662921348315, 'Acc': 0.49504950495049505}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7020635549227396, 'Valid Loss': 0.6951835912007552, 'Validation Metric': {'Precision': 0.5192307692307693, 'Recall': 0.54, 'F1': 0.5294117647058824, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5192307692307693, 'Recall': 0.54, 'F1': 0.5294117647058824, 'Acc': 0.5247524752475248}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.692786119778951, 'Valid Loss': 0.6953046894990481, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6753363291422526, 'Valid Loss': 0.7021522499047793, 'Validation Metric': {'Precision': 0.4909090909090909, 'Recall': 0.54, 'F1': 0.5142857142857142, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6444513940811157, 'Valid Loss': 0.725336471429238, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.58, 'F1': 0.537037037037037, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6184991876284281, 'Valid Loss': 0.7370931322758014, 'Validation Metric': {'Precision': 0.4745762711864407, 'Recall': 0.56, 'F1': 0.5137614678899083, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5484839983781179, 'Valid Loss': 0.7437981023238256, 'Validation Metric': {'Precision': 0.49122807017543857, 'Recall': 0.56, 'F1': 0.5233644859813084, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5160123026371002, 'Valid Loss': 0.7491889825234046, 'Validation Metric': {'Precision': 0.5084745762711864, 'Recall': 0.6, 'F1': 0.5504587155963302, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5084745762711864, 'Recall': 0.6, 'F1': 0.5504587155963302, 'Acc': 0.5148514851485149}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.462683668533961, 'Valid Loss': 0.7521281299682764, 'Validation Metric': {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.43990257958571116, 'Valid Loss': 0.7676785611189328, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.6, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4010485319296519, 'Valid Loss': 0.7831850625001467, 'Validation Metric': {'Precision': 0.5283018867924528, 'Recall': 0.56, 'F1': 0.5436893203883495, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3397510153055191, 'Valid Loss': 0.7992740422487259, 'Validation Metric': {'Precision': 0.5660377358490566, 'Recall': 0.6, 'F1': 0.5825242718446602, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.33268803417682646, 'Valid Loss': 0.8114293572994379, 'Validation Metric': {'Precision': 0.5490196078431373, 'Recall': 0.56, 'F1': 0.5544554455445545, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.29926283737023673, 'Valid Loss': 0.8192316706363971, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.56, 'F1': 0.5490196078431373, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2783009412884712, 'Valid Loss': 0.8176902154317269, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.54, 'F1': 0.5346534653465347, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.26824173659086226, 'Valid Loss': 0.8292927317894422, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.52, 'F1': 0.5098039215686274, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.27674905598163607, 'Valid Loss': 0.8349205175271401, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.54, 'F1': 0.5346534653465347, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2591681386033694, 'Valid Loss': 0.8374243825674057, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.52, 'F1': 0.52, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5535714285714286, 'Recall': 0.62, 'F1': 0.5849056603773586, 'Acc': 0.5643564356435643}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5555555555555556, 'Recall': 0.5660377358490566, 'F1': 0.5607476635514018, 'Acc': 0.5346534653465347}; Test loss: 0.7009782722363105
