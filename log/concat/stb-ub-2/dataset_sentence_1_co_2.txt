Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7460753933379525, 'Valid Loss': 0.7328389382362366, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.078125, 'F1': 0.13513513513513514, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.078125, 'F1': 0.13513513513513514, 'Acc': 0.36}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7432839533216075, 'Valid Loss': 0.7101044869422912, 'Validation Metric': {'Precision': 0.6829268292682927, 'Recall': 0.4375, 'F1': 0.5333333333333333, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6829268292682927, 'Recall': 0.4375, 'F1': 0.5333333333333333, 'Acc': 0.51}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7164453232758924, 'Valid Loss': 0.6822973990440369, 'Validation Metric': {'Precision': 0.627906976744186, 'Recall': 0.84375, 'F1': 0.72, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.627906976744186, 'Recall': 0.84375, 'F1': 0.72, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6740974262356758, 'Valid Loss': 0.6727503490447998, 'Validation Metric': {'Precision': 0.6210526315789474, 'Recall': 0.921875, 'F1': 0.7421383647798742, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6210526315789474, 'Recall': 0.921875, 'F1': 0.7421383647798742, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6427122985846118, 'Valid Loss': 0.6799270462989807, 'Validation Metric': {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6195654829866007, 'Valid Loss': 0.6748565173149109, 'Validation Metric': {'Precision': 0.6436781609195402, 'Recall': 0.875, 'F1': 0.7417218543046357, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5754250456628046, 'Valid Loss': 0.6978783810138702, 'Validation Metric': {'Precision': 0.6309523809523809, 'Recall': 0.828125, 'F1': 0.7162162162162162, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5249394919527205, 'Valid Loss': 0.7430194008350373, 'Validation Metric': {'Precision': 0.6266666666666667, 'Recall': 0.734375, 'F1': 0.6762589928057554, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5034144656046441, 'Valid Loss': 0.7123614430427552, 'Validation Metric': {'Precision': 0.6352941176470588, 'Recall': 0.84375, 'F1': 0.7248322147651006, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.443576428843172, 'Valid Loss': 0.7576509559154511, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.78125, 'F1': 0.6944444444444444, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4037156863824317, 'Valid Loss': 0.7575913381576538, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.796875, 'F1': 0.7034482758620689, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3944705981565149, 'Valid Loss': 0.7694572114944458, 'Validation Metric': {'Precision': 0.620253164556962, 'Recall': 0.765625, 'F1': 0.6853146853146853, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.34351181082035365, 'Valid Loss': 0.7778199744224549, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.78125, 'F1': 0.6944444444444444, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3115120116425188, 'Valid Loss': 0.7867027717828751, 'Validation Metric': {'Precision': 0.6219512195121951, 'Recall': 0.796875, 'F1': 0.6986301369863013, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.32078986801207066, 'Valid Loss': 0.79743048787117, 'Validation Metric': {'Precision': 0.6219512195121951, 'Recall': 0.796875, 'F1': 0.6986301369863013, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2988077864835137, 'Valid Loss': 0.8047366607189178, 'Validation Metric': {'Precision': 0.6172839506172839, 'Recall': 0.78125, 'F1': 0.689655172413793, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2632828434243014, 'Valid Loss': 0.8233480733633042, 'Validation Metric': {'Precision': 0.6075949367088608, 'Recall': 0.75, 'F1': 0.6713286713286712, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2622980438172817, 'Valid Loss': 0.8212134516239167, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.75, 'F1': 0.676056338028169, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2616702480927894, 'Valid Loss': 0.8235977107286453, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.75, 'F1': 0.676056338028169, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.24612250737845898, 'Valid Loss': 0.8260985380411148, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.75, 'F1': 0.676056338028169, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6413043478260869, 'Recall': 0.921875, 'F1': 0.7564102564102563, 'Acc': 0.62}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6494845360824743, 'Recall': 0.9692307692307692, 'F1': 0.7777777777777778, 'Acc': 0.64}; Test loss: 0.6456374549865722
