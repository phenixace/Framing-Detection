Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6786233680812936, 'Valid Loss': 0.6609084296226502, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6784847943406356, 'Valid Loss': 0.6589313125610352, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.05714285714285714, 'F1': 0.10256410256410256, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6794921614621815, 'Valid Loss': 0.6560959362983704, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.02857142857142857, 'F1': 0.05263157894736842, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6692933244140524, 'Valid Loss': 0.6543375563621521, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.02857142857142857, 'F1': 0.05263157894736842, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6656915670947025, 'Valid Loss': 0.6538980209827423, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.02857142857142857, 'F1': 0.05128205128205128, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6485463827848434, 'Valid Loss': 0.6563303089141845, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.02857142857142857, 'F1': 0.048780487804878044, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.636309467648205, 'Valid Loss': 0.6581728911399841, 'Validation Metric': {'Precision': 0.18181818181818182, 'Recall': 0.05714285714285714, 'F1': 0.08695652173913043, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.08571428571428572, 'F1': 0.15, 'Acc': 0.66}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5873370731347486, 'Valid Loss': 0.6567998504638672, 'Validation Metric': {'Precision': 0.35, 'Recall': 0.2, 'F1': 0.2545454545454545, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.35, 'Recall': 0.2, 'F1': 0.2545454545454545, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5606966638251355, 'Valid Loss': 0.660538375377655, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5185486619409762, 'Valid Loss': 0.6666455292701721, 'Validation Metric': {'Precision': 0.37037037037037035, 'Recall': 0.2857142857142857, 'F1': 0.3225806451612903, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.479097061643475, 'Valid Loss': 0.6682315981388092, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.2857142857142857, 'F1': 0.3389830508474576, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.2857142857142857, 'F1': 0.3389830508474576, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.445261934478032, 'Valid Loss': 0.6761168515682221, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2857142857142857, 'F1': 0.3333333333333333, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.2857142857142857, 'F1': 0.3389830508474576, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.42691189717305333, 'Valid Loss': 0.6868764281272888, 'Validation Metric': {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3908448158518264, 'Valid Loss': 0.6961005866527558, 'Validation Metric': {'Precision': 0.39285714285714285, 'Recall': 0.3142857142857143, 'F1': 0.34920634920634924, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.36148834601044655, 'Valid Loss': 0.7041254806518554, 'Validation Metric': {'Precision': 0.42424242424242425, 'Recall': 0.4, 'F1': 0.411764705882353, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.34936758170002385, 'Valid Loss': 0.7045339822769165, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.32842106960321726, 'Valid Loss': 0.705879625082016, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.30956906315527466, 'Valid Loss': 0.7128598320484162, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.4, 'F1': 0.41791044776119407, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3021558138884996, 'Valid Loss': 0.7114381039142609, 'Validation Metric': {'Precision': 0.41935483870967744, 'Recall': 0.37142857142857144, 'F1': 0.393939393939394, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3000748516305497, 'Valid Loss': 0.710532830953598, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.34285714285714286, 'F1': 0.3870967741935484, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.4411764705882353, 'Recall': 0.42857142857142855, 'F1': 0.43478260869565216, 'Acc': 0.61}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.375, 'Recall': 0.20930232558139536, 'F1': 0.26865671641791045, 'Acc': 0.51}; Test loss: 0.7639515244960785
