Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7136842749620739, 'Valid Loss': 0.708968014717102, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.018518518518518517, 'F1': 0.03571428571428571, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.018518518518518517, 'F1': 0.03571428571428571, 'Acc': 0.46}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7183019730605578, 'Valid Loss': 0.7023306727409363, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.037037037037037035, 'F1': 0.07017543859649122, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.037037037037037035, 'F1': 0.07017543859649122, 'Acc': 0.47}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7091901200382333, 'Valid Loss': 0.6947664189338684, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.2037037037037037, 'F1': 0.3055555555555555, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.2037037037037037, 'F1': 0.3055555555555555, 'Acc': 0.5}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7043571142773879, 'Valid Loss': 0.6902740740776062, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.5185185185185185, 'F1': 0.5656565656565656, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6222222222222222, 'Recall': 0.5185185185185185, 'F1': 0.5656565656565656, 'Acc': 0.57}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6914811071596647, 'Valid Loss': 0.6891247105598449, 'Validation Metric': {'Precision': 0.6470588235294118, 'Recall': 0.6111111111111112, 'F1': 0.6285714285714287, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6470588235294118, 'Recall': 0.6111111111111112, 'F1': 0.6285714285714287, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6858479866856023, 'Valid Loss': 0.6877433037757874, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.7407407407407407, 'F1': 0.6666666666666666, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.7407407407407407, 'F1': 0.6666666666666666, 'Acc': 0.6}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6632694453001022, 'Valid Loss': 0.6828300404548645, 'Validation Metric': {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6359715430360091, 'Valid Loss': 0.6826550674438476, 'Validation Metric': {'Precision': 0.5692307692307692, 'Recall': 0.6851851851851852, 'F1': 0.6218487394957983, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6061491444706917, 'Valid Loss': 0.6829185700416565, 'Validation Metric': {'Precision': 0.5483870967741935, 'Recall': 0.6296296296296297, 'F1': 0.5862068965517241, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5598437574348951, 'Valid Loss': 0.693779649734497, 'Validation Metric': {'Precision': 0.509090909090909, 'Recall': 0.5185185185185185, 'F1': 0.5137614678899083, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.531990327725285, 'Valid Loss': 0.7110406374931335, 'Validation Metric': {'Precision': 0.5319148936170213, 'Recall': 0.46296296296296297, 'F1': 0.495049504950495, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4938125171159443, 'Valid Loss': 0.7085170495510101, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.5, 'F1': 0.5142857142857143, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.46071374690846395, 'Valid Loss': 0.7089660334587097, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.5185185185185185, 'F1': 0.5283018867924528, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4379289124749209, 'Valid Loss': 0.7202986586093902, 'Validation Metric': {'Precision': 0.5517241379310345, 'Recall': 0.5925925925925926, 'F1': 0.5714285714285714, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4113675402967553, 'Valid Loss': 0.7290138971805572, 'Validation Metric': {'Precision': 0.54, 'Recall': 0.5, 'F1': 0.5192307692307693, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.38539050970422595, 'Valid Loss': 0.7360282695293426, 'Validation Metric': {'Precision': 0.5490196078431373, 'Recall': 0.5185185185185185, 'F1': 0.5333333333333333, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.37666109733675657, 'Valid Loss': 0.7416114985942841, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.5185185185185185, 'F1': 0.5384615384615384, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3479962307763727, 'Valid Loss': 0.7470473420619964, 'Validation Metric': {'Precision': 0.5490196078431373, 'Recall': 0.5185185185185185, 'F1': 0.5333333333333333, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.34749408811330795, 'Valid Loss': 0.7502450144290924, 'Validation Metric': {'Precision': 0.5490196078431373, 'Recall': 0.5185185185185185, 'F1': 0.5333333333333333, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.32065178002966077, 'Valid Loss': 0.7538721072673797, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.5185185185185185, 'F1': 0.5384615384615384, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5915492957746479, 'Recall': 0.7777777777777778, 'F1': 0.6719999999999999, 'Acc': 0.59}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.41935483870967744, 'Recall': 0.6046511627906976, 'F1': 0.49523809523809514, 'Acc': 0.47}; Test loss: 0.6975371789932251
