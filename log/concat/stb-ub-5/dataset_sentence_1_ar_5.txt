Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7073395746318918, 'Valid Loss': 0.6780456018447876, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.023255813953488372, 'F1': 0.04444444444444444, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.023255813953488372, 'F1': 0.04444444444444444, 'Acc': 0.57}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7096012258215955, 'Valid Loss': 0.6789533615112304, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7072246294272574, 'Valid Loss': 0.6817440176010132, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.2558139534883721, 'F1': 0.36065573770491804, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.2558139534883721, 'F1': 0.36065573770491804, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6980468356295636, 'Valid Loss': 0.6870572185516357, 'Validation Metric': {'Precision': 0.475, 'Recall': 0.4418604651162791, 'F1': 0.4578313253012048, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.475, 'Recall': 0.4418604651162791, 'F1': 0.4578313253012048, 'Acc': 0.55}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6805903872376994, 'Valid Loss': 0.6948000288009644, 'Validation Metric': {'Precision': 0.4406779661016949, 'Recall': 0.6046511627906976, 'F1': 0.5098039215686275, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4406779661016949, 'Recall': 0.6046511627906976, 'F1': 0.5098039215686275, 'Acc': 0.5}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6594950305788141, 'Valid Loss': 0.6847447848320007, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5348837209302325, 'F1': 0.5168539325842696, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5348837209302325, 'F1': 0.5168539325842696, 'Acc': 0.57}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6279222384879464, 'Valid Loss': 0.7100411462783813, 'Validation Metric': {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5959875320917681, 'Valid Loss': 0.7154759192466735, 'Validation Metric': {'Precision': 0.43548387096774194, 'Recall': 0.627906976744186, 'F1': 0.5142857142857142, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5478218586037034, 'Valid Loss': 0.7120438718795776, 'Validation Metric': {'Precision': 0.47368421052631576, 'Recall': 0.627906976744186, 'F1': 0.5399999999999999, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.49520453261701686, 'Valid Loss': 0.7210482800006867, 'Validation Metric': {'Precision': 0.44642857142857145, 'Recall': 0.5813953488372093, 'F1': 0.5050505050505051, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.47261196708208636, 'Valid Loss': 0.7034776282310485, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.5581395348837209, 'F1': 0.5052631578947369, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4166952112787648, 'Valid Loss': 0.7181183969974518, 'Validation Metric': {'Precision': 0.4528301886792453, 'Recall': 0.5581395348837209, 'F1': 0.5, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.37975048528690086, 'Valid Loss': 0.7238859486579895, 'Validation Metric': {'Precision': 0.46, 'Recall': 0.5348837209302325, 'F1': 0.4946236559139785, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3539423266131627, 'Valid Loss': 0.7365158069133758, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.5581395348837209, 'F1': 0.5052631578947369, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.348745696246624, 'Valid Loss': 0.7338282358646393, 'Validation Metric': {'Precision': 0.46808510638297873, 'Recall': 0.5116279069767442, 'F1': 0.4888888888888889, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3056065432335201, 'Valid Loss': 0.7554246854782104, 'Validation Metric': {'Precision': 0.4807692307692308, 'Recall': 0.5813953488372093, 'F1': 0.5263157894736843, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3041137600023496, 'Valid Loss': 0.7635735607147217, 'Validation Metric': {'Precision': 0.4716981132075472, 'Recall': 0.5813953488372093, 'F1': 0.5208333333333334, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.300877696001216, 'Valid Loss': 0.7636446130275726, 'Validation Metric': {'Precision': 0.46, 'Recall': 0.5348837209302325, 'F1': 0.4946236559139785, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.27420304382317945, 'Valid Loss': 0.7688951706886291, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.5116279069767442, 'F1': 0.4731182795698925, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2644610854944116, 'Valid Loss': 0.7716204035282135, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.5116279069767442, 'F1': 0.4731182795698925, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.453125, 'Recall': 0.6744186046511628, 'F1': 0.5420560747663552, 'Acc': 0.51}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5245901639344263, 'Recall': 0.5818181818181818, 'F1': 0.5517241379310346, 'Acc': 0.48}; Test loss: 0.7319403338432312
