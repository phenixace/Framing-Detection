Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7412045143152538, 'Valid Loss': 0.7431756143386548, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.37623762376237624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.37623762376237624}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7367913221058092, 'Valid Loss': 0.7191778490176568, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.0967741935483871, 'F1': 0.16216216216216214, 'Acc': 0.38613861386138615}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.0967741935483871, 'F1': 0.16216216216216214, 'Acc': 0.38613861386138615}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7050427355264363, 'Valid Loss': 0.6936657818464133, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.7741935483870968, 'F1': 0.676056338028169, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.7741935483870968, 'F1': 0.676056338028169, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6768912869064432, 'Valid Loss': 0.6849361749795767, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6397389157822257, 'Valid Loss': 0.6853037270215842, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6228644557689366, 'Valid Loss': 0.6932004529696244, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5835337905507338, 'Valid Loss': 0.691846476151393, 'Validation Metric': {'Precision': 0.6170212765957447, 'Recall': 0.9354838709677419, 'F1': 0.7435897435897436, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5543634820925561, 'Valid Loss': 0.693277983711316, 'Validation Metric': {'Precision': 0.6021505376344086, 'Recall': 0.9032258064516129, 'F1': 0.7225806451612904, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5161032323774538, 'Valid Loss': 0.6993951980884259, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.8709677419354839, 'F1': 0.7105263157894737, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.46982067097958763, 'Valid Loss': 0.7033112427363029, 'Validation Metric': {'Precision': 0.6046511627906976, 'Recall': 0.8387096774193549, 'F1': 0.7027027027027026, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.42849948492489365, 'Valid Loss': 0.7070728632119986, 'Validation Metric': {'Precision': 0.6024096385542169, 'Recall': 0.8064516129032258, 'F1': 0.689655172413793, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.40115729405691747, 'Valid Loss': 0.7167323048298175, 'Validation Metric': {'Precision': 0.6024096385542169, 'Recall': 0.8064516129032258, 'F1': 0.689655172413793, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3614600179226775, 'Valid Loss': 0.7326186287861604, 'Validation Metric': {'Precision': 0.5952380952380952, 'Recall': 0.8064516129032258, 'F1': 0.684931506849315, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3299416687927748, 'Valid Loss': 0.7491338803217962, 'Validation Metric': {'Precision': 0.5875, 'Recall': 0.7580645161290323, 'F1': 0.6619718309859155, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.32267552829886736, 'Valid Loss': 0.7473970342140931, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.7741935483870968, 'F1': 0.676056338028169, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2934494967523374, 'Valid Loss': 0.7607032278409371, 'Validation Metric': {'Precision': 0.5949367088607594, 'Recall': 0.7580645161290323, 'F1': 0.6666666666666667, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2854000550547713, 'Valid Loss': 0.7679408823068326, 'Validation Metric': {'Precision': 0.5822784810126582, 'Recall': 0.7419354838709677, 'F1': 0.652482269503546, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2714388401884782, 'Valid Loss': 0.7708604072148983, 'Validation Metric': {'Precision': 0.5844155844155844, 'Recall': 0.7258064516129032, 'F1': 0.6474820143884892, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.25704052397295046, 'Valid Loss': 0.7742204987085782, 'Validation Metric': {'Precision': 0.5769230769230769, 'Recall': 0.7258064516129032, 'F1': 0.6428571428571428, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.24972246557866273, 'Valid Loss': 0.7757478402211115, 'Validation Metric': {'Precision': 0.5844155844155844, 'Recall': 0.7258064516129032, 'F1': 0.6474820143884892, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}; Test loss: 0.6309218919277191
