Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6953255722397252, 'Valid Loss': 0.7247406482696533, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.01818181818181818, 'F1': 0.03508771929824561, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.01818181818181818, 'F1': 0.03508771929824561, 'Acc': 0.45}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6966205796128825, 'Valid Loss': 0.7204511594772339, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.01818181818181818, 'F1': 0.03508771929824561, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.01818181818181818, 'F1': 0.03508771929824561, 'Acc': 0.45}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6960460488733492, 'Valid Loss': 0.714980218410492, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.07272727272727272, 'F1': 0.125, 'Acc': 0.44}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4444444444444444, 'Recall': 0.07272727272727272, 'F1': 0.125, 'Acc': 0.44}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6910979888941112, 'Valid Loss': 0.7112835121154785, 'Validation Metric': {'Precision': 0.631578947368421, 'Recall': 0.21818181818181817, 'F1': 0.32432432432432434, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.631578947368421, 'Recall': 0.21818181818181817, 'F1': 0.32432432432432434, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6822545912704969, 'Valid Loss': 0.7097992515563964, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.3090909090909091, 'F1': 0.38202247191011235, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.3090909090909091, 'F1': 0.38202247191011235, 'Acc': 0.45}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6606374116320359, 'Valid Loss': 0.7183940124511718, 'Validation Metric': {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.60366642867264, 'Valid Loss': 0.7219887447357177, 'Validation Metric': {'Precision': 0.5789473684210527, 'Recall': 0.4, 'F1': 0.4731182795698925, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5710987574175784, 'Valid Loss': 0.7431335115432739, 'Validation Metric': {'Precision': 0.5365853658536586, 'Recall': 0.4, 'F1': 0.45833333333333337, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5182472663490396, 'Valid Loss': 0.7649630701541901, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.4, 'F1': 0.45360824742268047, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4785750310279821, 'Valid Loss': 0.7720697784423828, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.38181818181818183, 'F1': 0.4666666666666667, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.43793065806752757, 'Valid Loss': 0.7891229951381683, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.36363636363636365, 'F1': 0.4444444444444444, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3996823369280288, 'Valid Loss': 0.8106665754318237, 'Validation Metric': {'Precision': 0.5897435897435898, 'Recall': 0.41818181818181815, 'F1': 0.48936170212765956, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3601405197068265, 'Valid Loss': 0.8431642556190491, 'Validation Metric': {'Precision': 0.5116279069767442, 'Recall': 0.4, 'F1': 0.44897959183673475, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.33844440822538574, 'Valid Loss': 0.8471552622318268, 'Validation Metric': {'Precision': 0.5641025641025641, 'Recall': 0.4, 'F1': 0.46808510638297873, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2869352882629947, 'Valid Loss': 0.8625743162631988, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.4, 'F1': 0.46315789473684216, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.295867832377553, 'Valid Loss': 0.8689543151855469, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.4, 'F1': 0.46315789473684216, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2872193593923983, 'Valid Loss': 0.8800284337997436, 'Validation Metric': {'Precision': 0.5263157894736842, 'Recall': 0.36363636363636365, 'F1': 0.43010752688172044, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2556918567340625, 'Valid Loss': 0.8949255013465881, 'Validation Metric': {'Precision': 0.5263157894736842, 'Recall': 0.36363636363636365, 'F1': 0.43010752688172044, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.24999574777719222, 'Valid Loss': 0.8966298985481262, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.4, 'F1': 0.46315789473684216, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2519902489883335, 'Valid Loss': 0.90076744556427, 'Validation Metric': {'Precision': 0.5365853658536586, 'Recall': 0.4, 'F1': 0.45833333333333337, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5909090909090909, 'Recall': 0.4727272727272727, 'F1': 0.5252525252525252, 'Acc': 0.53}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4523809523809524, 'Recall': 0.38, 'F1': 0.41304347826086957, 'Acc': 0.46534653465346537}; Test loss: 0.7314094855235174
