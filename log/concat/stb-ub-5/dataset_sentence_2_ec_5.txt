Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6750937614001726, 'Valid Loss': 0.6811316037178039, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6791846250232897, 'Valid Loss': 0.6811354923248291, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.046511627906976744, 'F1': 0.08888888888888888, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6768425389340049, 'Valid Loss': 0.6817291176319122, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6675606620939154, 'Valid Loss': 0.6823417127132416, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6632350102851265, 'Valid Loss': 0.6799452936649323, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.046511627906976744, 'F1': 0.08888888888888888, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.06976744186046512, 'F1': 0.1276595744680851, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6405623402250441, 'Valid Loss': 0.6792151820659638, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.09302325581395349, 'F1': 0.1702127659574468, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.09302325581395349, 'F1': 0.1702127659574468, 'Acc': 0.61}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6273700618430188, 'Valid Loss': 0.6844015622138977, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.09302325581395349, 'F1': 0.16666666666666666, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.09302325581395349, 'F1': 0.1702127659574468, 'Acc': 0.61}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5816927207143683, 'Valid Loss': 0.6861378002166748, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.11627906976744186, 'F1': 0.19607843137254904, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.11627906976744186, 'F1': 0.19607843137254904, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5464968975437315, 'Valid Loss': 0.6940649163722992, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.11627906976744186, 'F1': 0.18867924528301888, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.11627906976744186, 'F1': 0.19607843137254904, 'Acc': 0.59}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.49997655968917043, 'Valid Loss': 0.6959235405921936, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.13953488372093023, 'F1': 0.22222222222222218, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.13953488372093023, 'F1': 0.22222222222222218, 'Acc': 0.58}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.457127218771922, 'Valid Loss': 0.7113453531265259, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.13953488372093023, 'F1': 0.21428571428571427, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.13953488372093023, 'F1': 0.22222222222222218, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4163538321460548, 'Valid Loss': 0.722355043888092, 'Validation Metric': {'Precision': 0.4375, 'Recall': 0.16279069767441862, 'F1': 0.23728813559322032, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.16279069767441862, 'F1': 0.23728813559322032, 'Acc': 0.55}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3871486839887343, 'Valid Loss': 0.7310865008831025, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.16279069767441862, 'F1': 0.23333333333333336, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.4375, 'Recall': 0.16279069767441862, 'F1': 0.23728813559322032, 'Acc': 0.55}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.37894967580704314, 'Valid Loss': 0.7459090638160706, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.18604651162790697, 'F1': 0.2622950819672131, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4444444444444444, 'Recall': 0.18604651162790697, 'F1': 0.2622950819672131, 'Acc': 0.55}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3490436086921315, 'Valid Loss': 0.7525726974010467, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.18604651162790697, 'F1': 0.25396825396825395, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4444444444444444, 'Recall': 0.18604651162790697, 'F1': 0.2622950819672131, 'Acc': 0.55}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.31295028828868743, 'Valid Loss': 0.7564566057920455, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.18604651162790697, 'F1': 0.25396825396825395, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4444444444444444, 'Recall': 0.18604651162790697, 'F1': 0.2622950819672131, 'Acc': 0.55}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3099610134959221, 'Valid Loss': 0.7664816379547119, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.29033005198365763, 'Valid Loss': 0.7652816444635391, 'Validation Metric': {'Precision': 0.42105263157894735, 'Recall': 0.18604651162790697, 'F1': 0.25806451612903225, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.29041649293350547, 'Valid Loss': 0.7712927097082138, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.27607494876965094, 'Valid Loss': 0.7747838985919953, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2903225806451613, 'Recall': 0.2571428571428571, 'F1': 0.27272727272727276, 'Acc': 0.5247524752475248}; Test loss: 0.8057981087611272
