Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='bert', log_dir='./log/concat/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7405459427833557, 'Valid Loss': 0.7618846457738143, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.27722772277227725}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.27722772277227725}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7360981678962708, 'Valid Loss': 0.7235789826283088, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.16666666666666666, 'F1': 0.2608695652173913, 'Acc': 0.32673267326732675}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.16666666666666666, 'F1': 0.2608695652173913, 'Acc': 0.32673267326732675}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7063065465291342, 'Valid Loss': 0.6801842428170718, 'Validation Metric': {'Precision': 0.6951219512195121, 'Recall': 0.7916666666666666, 'F1': 0.7402597402597403, 'Acc': 0.6039603960396039}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6951219512195121, 'Recall': 0.7916666666666666, 'F1': 0.7402597402597403, 'Acc': 0.6039603960396039}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6691305549939474, 'Valid Loss': 0.6557201055380014, 'Validation Metric': {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6479584129651388, 'Valid Loss': 0.6440515357714433, 'Validation Metric': {'Precision': 0.71, 'Recall': 0.9861111111111112, 'F1': 0.8255813953488371, 'Acc': 0.7029702970297029}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6229610459009807, 'Valid Loss': 0.6452240026914157, 'Validation Metric': {'Precision': 0.71, 'Recall': 0.9861111111111112, 'F1': 0.8255813953488371, 'Acc': 0.7029702970297029}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5950348162651062, 'Valid Loss': 0.6510319675390537, 'Validation Metric': {'Precision': 0.71, 'Recall': 0.9861111111111112, 'F1': 0.8255813953488371, 'Acc': 0.7029702970297029}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5598134549458822, 'Valid Loss': 0.6604020572625674, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.9444444444444444, 'F1': 0.8095238095238096, 'Acc': 0.6831683168316832}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5087806304295858, 'Valid Loss': 0.6812971967917222, 'Validation Metric': {'Precision': 0.7096774193548387, 'Recall': 0.9166666666666666, 'F1': 0.7999999999999999, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.48449428876241046, 'Valid Loss': 0.6648910160248096, 'Validation Metric': {'Precision': 0.7159090909090909, 'Recall': 0.875, 'F1': 0.7875000000000001, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4478855117162069, 'Valid Loss': 0.6866684842568177, 'Validation Metric': {'Precision': 0.7045454545454546, 'Recall': 0.8611111111111112, 'F1': 0.775, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.40156324903170265, 'Valid Loss': 0.6850333867164758, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.8333333333333334, 'F1': 0.7643312101910827, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3678504647811254, 'Valid Loss': 0.6955610502224702, 'Validation Metric': {'Precision': 0.7195121951219512, 'Recall': 0.8194444444444444, 'F1': 0.7662337662337662, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3453888730208079, 'Valid Loss': 0.7031795451274285, 'Validation Metric': {'Precision': 0.7037037037037037, 'Recall': 0.7916666666666666, 'F1': 0.7450980392156864, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.31867264688014985, 'Valid Loss': 0.7093214065982745, 'Validation Metric': {'Precision': 0.7215189873417721, 'Recall': 0.7916666666666666, 'F1': 0.7549668874172185, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3048824006319046, 'Valid Loss': 0.7142490670084953, 'Validation Metric': {'Precision': 0.7125, 'Recall': 0.7916666666666666, 'F1': 0.75, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.28661854575077694, 'Valid Loss': 0.7106836208930383, 'Validation Metric': {'Precision': 0.7125, 'Recall': 0.7916666666666666, 'F1': 0.75, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2722159617145856, 'Valid Loss': 0.7194513999498807, 'Validation Metric': {'Precision': 0.7051282051282052, 'Recall': 0.7638888888888888, 'F1': 0.7333333333333334, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.24731859117746352, 'Valid Loss': 0.7239066551511104, 'Validation Metric': {'Precision': 0.7125, 'Recall': 0.7916666666666666, 'F1': 0.75, 'Acc': 0.6237623762376238}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.27091032296419143, 'Valid Loss': 0.7258900358126714, 'Validation Metric': {'Precision': 0.7088607594936709, 'Recall': 0.7777777777777778, 'F1': 0.7417218543046357, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6020408163265306, 'Recall': 0.9516129032258065, 'F1': 0.7375, 'Acc': 0.5841584158415841}; Test loss: 0.6853049878890698
