Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_lemmatized/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.39837534098248734, 'Validation Metric': {'Precision': 0.40020227808326786, 'Recall': 0.5581114186767256, 'F1': 0.4429422628413143, 'Acc': 0.568}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40020227808326786, 'Recall': 0.5581114186767256, 'F1': 0.4429422628413143, 'Acc': 0.568}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3041178795852159, 'Validation Metric': {'Precision': 0.4055817341873028, 'Recall': 0.5768631447192554, 'F1': 0.462181018713944, 'Acc': 0.574}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4055817341873028, 'Recall': 0.5768631447192554, 'F1': 0.462181018713944, 'Acc': 0.574}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.279688228509928, 'Validation Metric': {'Precision': 0.4160383597883598, 'Recall': 0.5960652296002289, 'F1': 0.4815669702343087, 'Acc': 0.596}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4160383597883598, 'Recall': 0.5960652296002289, 'F1': 0.4815669702343087, 'Acc': 0.596}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.2627066173835805, 'Validation Metric': {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.24591598424472308, 'Validation Metric': {'Precision': 0.4424883315917799, 'Recall': 0.5946154609166883, 'F1': 0.49039160467585124, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23256784206942507, 'Validation Metric': {'Precision': 0.43110727383993874, 'Recall': 0.5583738841826354, 'F1': 0.45939441532072645, 'Acc': 0.626}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2244774216884061, 'Validation Metric': {'Precision': 0.43334054834054825, 'Recall': 0.503010717698296, 'F1': 0.41318375061207496, 'Acc': 0.624}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2139228825506411, 'Validation Metric': {'Precision': 0.3242857142857143, 'Recall': 0.4521672671689049, 'F1': 0.3754372083586935, 'Acc': 0.608}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2064705153829173, 'Validation Metric': {'Precision': 0.3199747016443931, 'Recall': 0.39913503414977375, 'F1': 0.35509704641350204, 'Acc': 0.616}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2037031674071362, 'Validation Metric': {'Precision': 0.3317691121392377, 'Recall': 0.4112287852870886, 'F1': 0.3671965469131496, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.19880463927984238, 'Validation Metric': {'Precision': 0.33187804460111137, 'Recall': 0.4168274071647803, 'F1': 0.3695331248943722, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.19712923153450615, 'Validation Metric': {'Precision': 0.33503966282642333, 'Recall': 0.4168274071647803, 'F1': 0.3714807162534436, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19637233411010943, 'Validation Metric': {'Precision': 0.33663617951727964, 'Recall': 0.4168274071647803, 'F1': 0.37244562853414537, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1953252189253506, 'Validation Metric': {'Precision': 0.3382953047058166, 'Recall': 0.4168274071647803, 'F1': 0.3734310708633727, 'Acc': 0.642}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1969328899132578, 'Validation Metric': {'Precision': 0.3286165395827461, 'Recall': 0.3982227560019896, 'F1': 0.3598140495867769, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19468805625250465, 'Validation Metric': {'Precision': 0.3289248123639916, 'Recall': 0.3945190522982859, 'F1': 0.3583988764044944, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19465679596913488, 'Validation Metric': {'Precision': 0.3298306094654409, 'Recall': 0.3991702150889835, 'F1': 0.3610164835164836, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.19205653314527713, 'Validation Metric': {'Precision': 0.33066394279877426, 'Recall': 0.3945190522982859, 'F1': 0.35931818181818187, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.19350686041932358, 'Validation Metric': {'Precision': 0.3324821246169561, 'Recall': 0.3945190522982859, 'F1': 0.3602586206896552, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19068728387355804, 'Validation Metric': {'Precision': 0.3283351088420333, 'Recall': 0.38616418580388445, 'F1': 0.35421682626538986, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4342481203007519, 'Recall': 0.6149127933737093, 'F1': 0.5013375788130345, 'Acc': 0.622}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.43478260869565216, 0.36363636363636365, 0, 0.6, 0.358695652173913], 'Recall': [0.6976744186046512, 0.42857142857142855, 0, 0.703125, 0.9428571428571428], 'F1': [0.5357142857142857, 0.3934426229508197, 0, 0.6474820143884892, 0.5196850393700787], 'Acc': [0.48, 0.63, 0.89, 0.51, 0.39]}
