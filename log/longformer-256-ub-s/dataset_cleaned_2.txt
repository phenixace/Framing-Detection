Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.4017210422377837, 'Validation Metric': {'Precision': 0.377893381052676, 'Recall': 0.5342299560904212, 'F1': 0.42096363724808683, 'Acc': 0.562}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.377893381052676, 'Recall': 0.5342299560904212, 'F1': 0.42096363724808683, 'Acc': 0.562}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.30084903420586334, 'Validation Metric': {'Precision': 0.37056918666212985, 'Recall': 0.5310402097902098, 'F1': 0.4213261707571455, 'Acc': 0.566}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37056918666212985, 'Recall': 0.5310402097902098, 'F1': 0.4213261707571455, 'Acc': 0.566}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.29129764398461894, 'Validation Metric': {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.2679220139980316, 'Validation Metric': {'Precision': 0.3706861448325405, 'Recall': 0.5138636363636364, 'F1': 0.4183613637850926, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2498232914428962, 'Validation Metric': {'Precision': 0.38881813283764155, 'Recall': 0.5039223857537811, 'F1': 0.4243168242031355, 'Acc': 0.614}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23708482243512807, 'Validation Metric': {'Precision': 0.41282658517952636, 'Recall': 0.49088754268986834, 'F1': 0.424444692424413, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22775958831373014, 'Validation Metric': {'Precision': 0.40795148955723554, 'Recall': 0.46705561879980484, 'F1': 0.4086312135339254, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2176784249512773, 'Validation Metric': {'Precision': 0.494157105628321, 'Recall': 0.44121076597820785, 'F1': 0.4090677413258058, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.21015728814037224, 'Validation Metric': {'Precision': 0.4616139004370535, 'Recall': 0.4418194015287039, 'F1': 0.4183861882894604, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.20561669962970833, 'Validation Metric': {'Precision': 0.4373733072734888, 'Recall': 0.4220712717515043, 'F1': 0.3940795317849542, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.20556922492228055, 'Validation Metric': {'Precision': 0.43089724310776945, 'Recall': 0.43703955927793137, 'F1': 0.40228677711305416, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.19897548658283135, 'Validation Metric': {'Precision': 0.4239567669172932, 'Recall': 0.43544072206862905, 'F1': 0.39738856937455064, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.20025966590956637, 'Validation Metric': {'Precision': 0.42456466965285555, 'Recall': 0.4318043584322654, 'F1': 0.3955786146234194, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1988223297031302, 'Validation Metric': {'Precision': 0.43679278842266955, 'Recall': 0.42613839648723373, 'F1': 0.3936920765318823, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19802651005355934, 'Validation Metric': {'Precision': 0.43679278842266955, 'Recall': 0.42613839648723373, 'F1': 0.3936920765318823, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19836853993566414, 'Validation Metric': {'Precision': 0.43679278842266955, 'Recall': 0.42613839648723373, 'F1': 0.3936920765318823, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19819598017554535, 'Validation Metric': {'Precision': 0.4332830381037339, 'Recall': 0.42047243454220196, 'F1': 0.39027634130575306, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.19508869436226392, 'Validation Metric': {'Precision': 0.4323143664245359, 'Recall': 0.4199129939827614, 'F1': 0.38902972560261556, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1966498074562926, 'Validation Metric': {'Precision': 0.43015188834154355, 'Recall': 0.4152618311920637, 'F1': 0.38592353263037715, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1949428817943523, 'Validation Metric': {'Precision': 0.4291365914786967, 'Recall': 0.4152618311920637, 'F1': 0.38572957477305303, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.3780242531795327, 'Recall': 0.5533216783216783, 'F1': 0.439283391960816, 'Acc': 0.584}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.5555555555555556, 0.22641509433962265, 0, 0.7051282051282052, 0.35714285714285715], 'Recall': [0.5, 0.42857142857142855, 0, 0.7638888888888888, 1.0], 'F1': [0.5263157894736842, 0.2962962962962963, 0, 0.7333333333333334, 0.5263157894736842], 'Acc': [0.5544554455445545, 0.43564356435643564, 0.9504950495049505, 0.6039603960396039, 0.37623762376237624]}
