Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.4615023316521394, 'Validation Metric': {'Precision': 0.3897707847707848, 'Recall': 0.5236005854610506, 'F1': 0.43366102837189924, 'Acc': 0.588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3897707847707848, 'Recall': 0.5236005854610506, 'F1': 0.43366102837189924, 'Acc': 0.588}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.31672373021903794, 'Validation Metric': {'Precision': 0.389347889177744, 'Recall': 0.5359965034965035, 'F1': 0.43076970681519305, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.3897707847707848, 'Recall': 0.5236005854610506, 'F1': 0.43366102837189924, 'Acc': 0.588}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.2882105025805925, 'Validation Metric': {'Precision': 0.40644595300718117, 'Recall': 0.5744143356643356, 'F1': 0.45919111277427876, 'Acc': 0.596}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40644595300718117, 'Recall': 0.5744143356643356, 'F1': 0.45919111277427876, 'Acc': 0.596}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.2670520995008318, 'Validation Metric': {'Precision': 0.4071741226228795, 'Recall': 0.566013986013986, 'F1': 0.4591277736183573, 'Acc': 0.604}}
Best validation metric so far: {'Precision': 0.40644595300718117, 'Recall': 0.5744143356643356, 'F1': 0.45919111277427876, 'Acc': 0.596}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.24878116893140892, 'Validation Metric': {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.2356662326737454, 'Validation Metric': {'Precision': 0.412821575587533, 'Recall': 0.5441949910554562, 'F1': 0.45742552892423866, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22577269728246488, 'Validation Metric': {'Precision': 0.4093252011146748, 'Recall': 0.5181801919011221, 'F1': 0.4440087458462548, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21209140553286202, 'Validation Metric': {'Precision': 0.3883982683982684, 'Recall': 0.5020517563831517, 'F1': 0.42593571536363956, 'Acc': 0.624}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2055759382875342, 'Validation Metric': {'Precision': 0.3990392648287385, 'Recall': 0.49478695722881766, 'F1': 0.42488495480970856, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19647947110627828, 'Validation Metric': {'Precision': 0.40320667284522704, 'Recall': 0.5015002439421044, 'F1': 0.4286890886890887, 'Acc': 0.642}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.19207874881593803, 'Validation Metric': {'Precision': 0.40190859592215017, 'Recall': 0.49786388030574075, 'F1': 0.4263921699215817, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.19009894171827718, 'Validation Metric': {'Precision': 0.40574382426516575, 'Recall': 0.49321271751504303, 'F1': 0.4249907269201387, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1906433928953974, 'Validation Metric': {'Precision': 0.40574382426516575, 'Recall': 0.49321271751504303, 'F1': 0.4249907269201387, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.19075586489940943, 'Validation Metric': {'Precision': 0.40574382426516575, 'Recall': 0.49321271751504303, 'F1': 0.4249907269201387, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19002041926509455, 'Validation Metric': {'Precision': 0.40574382426516575, 'Recall': 0.49321271751504303, 'F1': 0.4249907269201387, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18962937201324262, 'Validation Metric': {'Precision': 0.40440453855088, 'Recall': 0.48957635387867954, 'F1': 0.42265487732606377, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1888144051558093, 'Validation Metric': {'Precision': 0.40440453855088, 'Recall': 0.48957635387867954, 'F1': 0.42265487732606377, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18747796000618683, 'Validation Metric': {'Precision': 0.40440453855088, 'Recall': 0.48957635387867954, 'F1': 0.42265487732606377, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.18704888969659805, 'Validation Metric': {'Precision': 0.40440453855088, 'Recall': 0.48957635387867954, 'F1': 0.42265487732606377, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1832444981524819, 'Validation Metric': {'Precision': 0.4030796364129697, 'Recall': 0.4849251910879818, 'F1': 0.4204097160357412, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.4146589766725401, 'Recall': 0.5597719141323793, 'F1': 0.46448004843707913, 'Acc': 0.62}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.5166666666666667, 0.28888888888888886, 0, 0.7215189873417721, 0.3465346534653465], 'Recall': [0.62, 0.4642857142857143, 0, 0.7916666666666666, 1.0], 'F1': [0.5636363636363637, 0.3561643835616438, 0, 0.7549668874172185, 0.5147058823529412], 'Acc': [0.5247524752475248, 0.5346534653465347, 0.9504950495049505, 0.6336633663366337, 0.3465346534653465]}
