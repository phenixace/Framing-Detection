Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.4591877201670094, 'Validation Metric': {'Precision': 0.37255528922072767, 'Recall': 0.5597279900332226, 'F1': 0.42833298451779644, 'Acc': 0.586}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37255528922072767, 'Recall': 0.5597279900332226, 'F1': 0.42833298451779644, 'Acc': 0.586}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.31551931171040787, 'Validation Metric': {'Precision': 0.3759202137284329, 'Recall': 0.5873089700996678, 'F1': 0.4332269261448641, 'Acc': 0.584}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3759202137284329, 'Recall': 0.5873089700996678, 'F1': 0.4332269261448641, 'Acc': 0.584}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.28282087178606735, 'Validation Metric': {'Precision': 0.3780337155337155, 'Recall': 0.5932994186046512, 'F1': 0.44007839589929143, 'Acc': 0.594}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3780337155337155, 'Recall': 0.5932994186046512, 'F1': 0.44007839589929143, 'Acc': 0.594}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.26755572463336746, 'Validation Metric': {'Precision': 0.38582972582972586, 'Recall': 0.6103779069767442, 'F1': 0.45490990426021155, 'Acc': 0.608}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38582972582972586, 'Recall': 0.6103779069767442, 'F1': 0.45490990426021155, 'Acc': 0.608}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.25226448162605886, 'Validation Metric': {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23686610632821134, 'Validation Metric': {'Precision': 0.3860005286809411, 'Recall': 0.6044289867109635, 'F1': 0.45957503786832704, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2251320802851727, 'Validation Metric': {'Precision': 0.38112274079158087, 'Recall': 0.5762230066445182, 'F1': 0.44720398086741253, 'Acc': 0.616}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21430670548426478, 'Validation Metric': {'Precision': 0.39223715651135005, 'Recall': 0.5751598837209302, 'F1': 0.4529283910533911, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.20652941535962255, 'Validation Metric': {'Precision': 0.36491666666666667, 'Recall': 0.5408741694352159, 'F1': 0.4232962832343894, 'Acc': 0.608}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19841499391355014, 'Validation Metric': {'Precision': 0.3737756598240469, 'Recall': 0.5305087209302326, 'F1': 0.42400735578784365, 'Acc': 0.614}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.1935903665266539, 'Validation Metric': {'Precision': 0.3729212294443001, 'Recall': 0.5273837209302326, 'F1': 0.42223967902016685, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.19126491562316292, 'Validation Metric': {'Precision': 0.3729212294443001, 'Recall': 0.5273837209302326, 'F1': 0.42223967902016685, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1900921993349728, 'Validation Metric': {'Precision': 0.3729212294443001, 'Recall': 0.5273837209302326, 'F1': 0.42223967902016685, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18895490545975535, 'Validation Metric': {'Precision': 0.3720448905932777, 'Recall': 0.5242587209302326, 'F1': 0.42044710539660735, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19090369618252703, 'Validation Metric': {'Precision': 0.371436334411018, 'Recall': 0.5273837209302326, 'F1': 0.42119745080812726, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19181271328737862, 'Validation Metric': {'Precision': 0.3705599955599956, 'Recall': 0.5242587209302326, 'F1': 0.41940487718456776, 'Acc': 0.608}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1878661862329433, 'Validation Metric': {'Precision': 0.3705599955599956, 'Recall': 0.5242587209302326, 'F1': 0.41940487718456776, 'Acc': 0.608}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18799504872999692, 'Validation Metric': {'Precision': 0.3712520787539543, 'Recall': 0.5185444352159468, 'F1': 0.4187001457782508, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.18566145316550606, 'Validation Metric': {'Precision': 0.3713175713175713, 'Recall': 0.5185444352159468, 'F1': 0.4192135811539604, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.18805215703813652, 'Validation Metric': {'Precision': 0.37204448667863305, 'Recall': 0.5154194352159468, 'F1': 0.4190044296218523, 'Acc': 0.614}}
Best validation metric so far: {'Precision': 0.39036750909855444, 'Recall': 0.610045681063123, 'F1': 0.4633589712688254, 'Acc': 0.624}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.64, 0.32558139534883723, 0, 0.6455696202531646, 0.4329896907216495], 'Recall': [0.5818181818181818, 0.4375, 0, 0.7846153846153846, 0.9767441860465116], 'F1': [0.6095238095238096, 0.37333333333333335, 0, 0.7083333333333334, 0.6], 'Acc': [0.59, 0.53, 0.91, 0.58, 0.44]}
