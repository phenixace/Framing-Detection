Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.4599250986387855, 'Validation Metric': {'Precision': 0.3931678459110493, 'Recall': 0.5087199648045727, 'F1': 0.43220738413197174, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3931678459110493, 'Recall': 0.5087199648045727, 'F1': 0.43220738413197174, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3150655995858343, 'Validation Metric': {'Precision': 0.39651055103820076, 'Recall': 0.5619679337902566, 'F1': 0.44580145173642327, 'Acc': 0.598019801980198}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.39651055103820076, 'Recall': 0.5619679337902566, 'F1': 0.44580145173642327, 'Acc': 0.598019801980198}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.2890311656029601, 'Validation Metric': {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.2643607815629558, 'Validation Metric': {'Precision': 0.3946241911398706, 'Recall': 0.5454661078620763, 'F1': 0.44359138357243866, 'Acc': 0.6079207920792079}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2460583989557467, 'Validation Metric': {'Precision': 0.3910187489629998, 'Recall': 0.5234903014104634, 'F1': 0.433444250137634, 'Acc': 0.6099009900990099}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23166614849316447, 'Validation Metric': {'Precision': 0.39050846242111303, 'Recall': 0.5041660602291672, 'F1': 0.4260299136013906, 'Acc': 0.6178217821782178}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2240965284015003, 'Validation Metric': {'Precision': 0.39505430083136794, 'Recall': 0.4948654039535315, 'F1': 0.4234617142320737, 'Acc': 0.6277227722772277}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21247304074074091, 'Validation Metric': {'Precision': 0.398911149825784, 'Recall': 0.4736697517796184, 'F1': 0.4114997892997804, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.200830366658537, 'Validation Metric': {'Precision': 0.39483611626468773, 'Recall': 0.4543762735187489, 'F1': 0.3990663654880434, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19515183097437808, 'Validation Metric': {'Precision': 0.4009339994031224, 'Recall': 0.4519306213448358, 'F1': 0.4038999238964992, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18754952636204267, 'Validation Metric': {'Precision': 0.38978831777551304, 'Recall': 0.4424548148932229, 'F1': 0.39406191222570536, 'Acc': 0.6277227722772277}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.18837660394216837, 'Validation Metric': {'Precision': 0.38739470075423643, 'Recall': 0.4424548148932229, 'F1': 0.39299260529501223, 'Acc': 0.6257425742574257}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1870569606360636, 'Validation Metric': {'Precision': 0.38739470075423643, 'Recall': 0.4424548148932229, 'F1': 0.39299260529501223, 'Acc': 0.6257425742574257}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18472268785301008, 'Validation Metric': {'Precision': 0.3986748990263046, 'Recall': 0.4487048148932229, 'F1': 0.4019100275490487, 'Acc': 0.6297029702970297}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1849396130756328, 'Validation Metric': {'Precision': 0.397224281742354, 'Recall': 0.44435698880626634, 'F1': 0.3995853181377251, 'Acc': 0.6277227722772277}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18439987105758568, 'Validation Metric': {'Precision': 0.3869678714859438, 'Recall': 0.43810698880626636, 'F1': 0.391504510056917, 'Acc': 0.6257425742574257}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18562864355350794, 'Validation Metric': {'Precision': 0.3940727813440182, 'Recall': 0.43810698880626636, 'F1': 0.3931882712569573, 'Acc': 0.6297029702970297}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18435351236870415, 'Validation Metric': {'Precision': 0.3940727813440182, 'Recall': 0.43810698880626636, 'F1': 0.3931882712569573, 'Acc': 0.6297029702970297}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.18426580570246043, 'Validation Metric': {'Precision': 0.3940727813440182, 'Recall': 0.43810698880626636, 'F1': 0.3931882712569573, 'Acc': 0.6297029702970297}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.18252803855820707, 'Validation Metric': {'Precision': 0.3940727813440182, 'Recall': 0.43810698880626636, 'F1': 0.3931882712569573, 'Acc': 0.6297029702970297}}
Best validation metric so far: {'Precision': 0.3920241078887695, 'Recall': 0.5615380798645109, 'F1': 0.44886301041490606, 'Acc': 0.6}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.4864864864864865, 0.34782608695652173, 0, 0.7, 0.42857142857142855], 'Recall': [0.3333333333333333, 0.7058823529411765, 0, 0.7887323943661971, 0.9767441860465116], 'F1': [0.3956043956043956, 0.4660194174757282, 0, 0.7417218543046357, 0.5957446808510638], 'Acc': [0.45, 0.45, 0.86, 0.61, 0.43]}
