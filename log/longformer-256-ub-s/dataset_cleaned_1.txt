Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.3977136392342417, 'Validation Metric': {'Precision': 0.34989816218264497, 'Recall': 0.5360174418604651, 'F1': 0.4027205610926541, 'Acc': 0.576}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34989816218264497, 'Recall': 0.5360174418604651, 'F1': 0.4027205610926541, 'Acc': 0.576}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3094082925664751, 'Validation Metric': {'Precision': 0.33741297086145733, 'Recall': 0.539703073089701, 'F1': 0.4002445144724557, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34989816218264497, 'Recall': 0.5360174418604651, 'F1': 0.4027205610926541, 'Acc': 0.576}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.282327354346451, 'Validation Metric': {'Precision': 0.3397322375397667, 'Recall': 0.5204339700996677, 'F1': 0.3995009768258694, 'Acc': 0.576}}
Best validation metric so far: {'Precision': 0.34989816218264497, 'Recall': 0.5360174418604651, 'F1': 0.4027205610926541, 'Acc': 0.576}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.26315055042505264, 'Validation Metric': {'Precision': 0.34108082322475125, 'Recall': 0.5144850498338871, 'F1': 0.39838741961766055, 'Acc': 0.582}}
Best validation metric so far: {'Precision': 0.34989816218264497, 'Recall': 0.5360174418604651, 'F1': 0.4027205610926541, 'Acc': 0.576}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.24719841464569695, 'Validation Metric': {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23387109880384646, 'Validation Metric': {'Precision': 0.34440351315351314, 'Recall': 0.533374169435216, 'F1': 0.3938323315661893, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22195097686428772, 'Validation Metric': {'Precision': 0.3643607040631021, 'Recall': 0.5340074750830565, 'F1': 0.3973713274248033, 'Acc': 0.636}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2149897080503012, 'Validation Metric': {'Precision': 0.3845532046810819, 'Recall': 0.5028467607973421, 'F1': 0.3980238074920537, 'Acc': 0.656}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.20787654738677175, 'Validation Metric': {'Precision': 0.3445054945054945, 'Recall': 0.42087416943521594, 'F1': 0.35630711225213496, 'Acc': 0.644}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.20524516701698303, 'Validation Metric': {'Precision': 0.3402998236331569, 'Recall': 0.38346345514950164, 'F1': 0.33942609330215057, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.20125178522185275, 'Validation Metric': {'Precision': 0.29202524383247275, 'Recall': 0.3882848837209302, 'F1': 0.33287359540728806, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.19803435747560702, 'Validation Metric': {'Precision': 0.29365126009263537, 'Recall': 0.3882848837209302, 'F1': 0.33383053320633116, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19744802932990224, 'Validation Metric': {'Precision': 0.29365126009263537, 'Recall': 0.3882848837209302, 'F1': 0.33383053320633116, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1964192755128208, 'Validation Metric': {'Precision': 0.29365126009263537, 'Recall': 0.3882848837209302, 'F1': 0.33383053320633116, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19717328250408173, 'Validation Metric': {'Precision': 0.29035857716580604, 'Recall': 0.3825705980066445, 'F1': 0.3294796560133487, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19473938094942192, 'Validation Metric': {'Precision': 0.2888095238095238, 'Recall': 0.3825705980066445, 'F1': 0.3284868264490906, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19237614423036575, 'Validation Metric': {'Precision': 0.2896498599439776, 'Recall': 0.3856955980066445, 'F1': 0.33019188721455406, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1927665950436341, 'Validation Metric': {'Precision': 0.2896498599439776, 'Recall': 0.3856955980066445, 'F1': 0.33019188721455406, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1897211890471609, 'Validation Metric': {'Precision': 0.2913165266106442, 'Recall': 0.3856955980066445, 'F1': 0.33112882415149103, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19379095968447232, 'Validation Metric': {'Precision': 0.29223057644110273, 'Recall': 0.3825705980066445, 'F1': 0.33038636982808606, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.36692810457516345, 'Recall': 0.5287147009966777, 'F1': 0.41428930848969203, 'Acc': 0.612}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.5769230769230769, 0.3333333333333333, 0, 0.6363636363636364, 0.44565217391304346], 'Recall': [0.5454545454545454, 0.1875, 0, 0.8615384615384616, 0.9534883720930233], 'F1': [0.5607476635514018, 0.24000000000000005, 0, 0.7320261437908497, 0.6074074074074075], 'Acc': [0.53, 0.62, 0.91, 0.59, 0.47]}
