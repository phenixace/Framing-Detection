Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='longformer', log_dir='./log/longformer/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.397389575054771, 'Validation Metric': {'Precision': 0.40578561506405314, 'Recall': 0.5219304987344138, 'F1': 0.43302228059261305, 'Acc': 0.576}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40578561506405314, 'Recall': 0.5219304987344138, 'F1': 0.43302228059261305, 'Acc': 0.576}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.306223401897832, 'Validation Metric': {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.2799869293445035, 'Validation Metric': {'Precision': 0.40540765284172264, 'Recall': 0.5538608047943128, 'F1': 0.4576191580468759, 'Acc': 0.582}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.261938091563551, 'Validation Metric': {'Precision': 0.4110367629655981, 'Recall': 0.5464732357258513, 'F1': 0.45930184628595966, 'Acc': 0.594}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2453557288176135, 'Validation Metric': {'Precision': 0.43572666241000874, 'Recall': 0.537854476506911, 'F1': 0.4636111147078246, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23006732605005564, 'Validation Metric': {'Precision': 0.4510118796865785, 'Recall': 0.5183731563011346, 'F1': 0.4530733804883744, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2218926101922989, 'Validation Metric': {'Precision': 0.4990928854343489, 'Recall': 0.4972140692358029, 'F1': 0.43244672364672365, 'Acc': 0.642}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21326611191034317, 'Validation Metric': {'Precision': 0.5416341399947957, 'Recall': 0.46839524250942144, 'F1': 0.40118012422360244, 'Acc': 0.642}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.20536031770078758, 'Validation Metric': {'Precision': 0.3381909893385303, 'Recall': 0.4298940932416203, 'F1': 0.3781685388233668, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.20346399671153018, 'Validation Metric': {'Precision': 0.3494047619047619, 'Recall': 0.42047045407674294, 'F1': 0.38133995037220847, 'Acc': 0.656}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.19587729910486623, 'Validation Metric': {'Precision': 0.3407692307692308, 'Recall': 0.4158799480777863, 'F1': 0.3745496781044667, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.1964459489834936, 'Validation Metric': {'Precision': 0.3407692307692308, 'Recall': 0.4158799480777863, 'F1': 0.3745496781044667, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19519546431930443, 'Validation Metric': {'Precision': 0.34571428571428575, 'Recall': 0.4158799480777863, 'F1': 0.37743297329897474, 'Acc': 0.652}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.19286727121001795, 'Validation Metric': {'Precision': 0.3461830553116769, 'Recall': 0.41217624437408257, 'F1': 0.37616020343293066, 'Acc': 0.652}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19393527311714073, 'Validation Metric': {'Precision': 0.34277310924369747, 'Recall': 0.41217624437408257, 'F1': 0.37415428477438456, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19388995868595024, 'Validation Metric': {'Precision': 0.34216520650813514, 'Recall': 0.4075250815833849, 'F1': 0.3717388258371865, 'Acc': 0.648}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1918136383357801, 'Validation Metric': {'Precision': 0.34563957705080733, 'Recall': 0.4075250815833849, 'F1': 0.3737401515746766, 'Acc': 0.652}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.1886376456210488, 'Validation Metric': {'Precision': 0.3434224598930481, 'Recall': 0.4028739187926872, 'F1': 0.37020625878737806, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.18986664516361138, 'Validation Metric': {'Precision': 0.3436898395721925, 'Recall': 0.3991702150889835, 'F1': 0.368894783377542, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1912056780175159, 'Validation Metric': {'Precision': 0.3434224598930481, 'Recall': 0.4028739187926872, 'F1': 0.37020625878737806, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.4182213524679278, 'Recall': 0.5758651620927877, 'F1': 0.47121902478017585, 'Acc': 0.59}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.425531914893617, 0.29310344827586204, 0, 0.6375, 0.3548387096774194], 'Recall': [0.46511627906976744, 0.6071428571428571, 0, 0.796875, 0.9428571428571428], 'F1': [0.4444444444444445, 0.3953488372093023, 0, 0.7083333333333333, 0.515625], 'Acc': [0.5, 0.48, 0.89, 0.58, 0.38]}
