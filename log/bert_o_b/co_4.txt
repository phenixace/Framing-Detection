Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, lm='bert', log_dir='./log/bert_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='co')
parameters: 109483778
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7441790342330933, 'Valid Loss': 0.655653049548467, 'Validation Metric': {'Precision': 0.6744186046511628, 'Recall': 1.0, 'F1': 0.8055555555555556, 'Acc': 0.6744186046511628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6744186046511628, 'Recall': 1.0, 'F1': 0.8055555555555556, 'Acc': 0.6744186046511628}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6842452615499497, 'Valid Loss': 0.6621582905451456, 'Validation Metric': {'Precision': 0.6705882352941176, 'Recall': 0.9827586206896551, 'F1': 0.7972027972027971, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.6744186046511628, 'Recall': 1.0, 'F1': 0.8055555555555556, 'Acc': 0.6744186046511628}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6766510725021362, 'Valid Loss': 0.669953445593516, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.9310344827586207, 'F1': 0.7941176470588235, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.6744186046511628, 'Recall': 1.0, 'F1': 0.8055555555555556, 'Acc': 0.6744186046511628}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6733707815408707, 'Valid Loss': 0.6676175991694132, 'Validation Metric': {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6627609997987747, 'Valid Loss': 0.6614281137784322, 'Validation Metric': {'Precision': 0.7162162162162162, 'Recall': 0.9137931034482759, 'F1': 0.8030303030303031, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6580134212970734, 'Valid Loss': 0.6568230092525482, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.8793103448275862, 'F1': 0.7846153846153847, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6341547310352326, 'Valid Loss': 0.6495179434617361, 'Validation Metric': {'Precision': 0.7123287671232876, 'Recall': 0.896551724137931, 'F1': 0.7938931297709924, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6180883437395096, 'Valid Loss': 0.6501533488432566, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.8275862068965517, 'F1': 0.7741935483870968, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5939983576536179, 'Valid Loss': 0.6406853795051575, 'Validation Metric': {'Precision': 0.7301587301587301, 'Recall': 0.7931034482758621, 'F1': 0.7603305785123967, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5649722769856453, 'Valid Loss': 0.632885530591011, 'Validation Metric': {'Precision': 0.746031746031746, 'Recall': 0.8103448275862069, 'F1': 0.7768595041322314, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.541075599193573, 'Valid Loss': 0.6318171620368958, 'Validation Metric': {'Precision': 0.746031746031746, 'Recall': 0.8103448275862069, 'F1': 0.7768595041322314, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5340622067451477, 'Valid Loss': 0.6306011378765106, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8275862068965517, 'F1': 0.7868852459016394, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5298736855387688, 'Valid Loss': 0.629179651538531, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8275862068965517, 'F1': 0.7868852459016394, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5295013815164566, 'Valid Loss': 0.6278065592050552, 'Validation Metric': {'Precision': 0.7538461538461538, 'Recall': 0.8448275862068966, 'F1': 0.7967479674796748, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5232069179415703, 'Valid Loss': 0.6274942755699158, 'Validation Metric': {'Precision': 0.7538461538461538, 'Recall': 0.8448275862068966, 'F1': 0.7967479674796748, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5276493296027184, 'Valid Loss': 0.6273886114358902, 'Validation Metric': {'Precision': 0.7538461538461538, 'Recall': 0.8448275862068966, 'F1': 0.7967479674796748, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.517817285656929, 'Valid Loss': 0.6272410700718561, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8275862068965517, 'F1': 0.7868852459016394, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5146173059940338, 'Valid Loss': 0.6270087460676829, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8275862068965517, 'F1': 0.7868852459016394, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5234608724713326, 'Valid Loss': 0.6264156599839529, 'Validation Metric': {'Precision': 0.746031746031746, 'Recall': 0.8103448275862069, 'F1': 0.7768595041322314, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5039953321218491, 'Valid Loss': 0.6259043216705322, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8275862068965517, 'F1': 0.7868852459016394, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.9310344827586207, 'F1': 0.8120300751879699, 'Acc': 0.7093023255813954}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.6266666666666667, 'Recall': 0.94, 'F1': 0.752, 'Acc': 0.6395348837209303}; Test loss: 0.6576818724473318
