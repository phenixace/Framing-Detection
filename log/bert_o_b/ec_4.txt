Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, lm='bert', log_dir='./log/bert_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='ec')
parameters: 109483778
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7485116538794144, 'Valid Loss': 0.705796480178833, 'Validation Metric': {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6890507599581843, 'Valid Loss': 0.7080176174640656, 'Validation Metric': {'Precision': 0.2923076923076923, 'Recall': 0.7916666666666666, 'F1': 0.4269662921348315, 'Acc': 0.4069767441860465}}
Best validation metric so far: {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6842635377593662, 'Valid Loss': 0.7119795779387156, 'Validation Metric': {'Precision': 0.2676056338028169, 'Recall': 0.7916666666666666, 'F1': 0.39999999999999997, 'Acc': 0.3372093023255814}}
Best validation metric so far: {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.675221632356229, 'Valid Loss': 0.7061368227005005, 'Validation Metric': {'Precision': 0.28125, 'Recall': 0.75, 'F1': 0.4090909090909091, 'Acc': 0.3953488372093023}}
Best validation metric so far: {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6606678573981576, 'Valid Loss': 0.7017276386419932, 'Validation Metric': {'Precision': 0.3103448275862069, 'Recall': 0.75, 'F1': 0.4390243902439025, 'Acc': 0.46511627906976744}}
Best validation metric so far: {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6407055984372678, 'Valid Loss': 0.7059666713078817, 'Validation Metric': {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}}
Best validation metric so far: {'Precision': 0.3064516129032258, 'Recall': 0.7916666666666666, 'F1': 0.4418604651162791, 'Acc': 0.4418604651162791}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6209687927494878, 'Valid Loss': 0.6944247583548228, 'Validation Metric': {'Precision': 0.32142857142857145, 'Recall': 0.75, 'F1': 0.45000000000000007, 'Acc': 0.4883720930232558}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32142857142857145, 'Recall': 0.75, 'F1': 0.45000000000000007, 'Acc': 0.4883720930232558}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.598811546097631, 'Valid Loss': 0.6869246462980906, 'Validation Metric': {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5755319698997166, 'Valid Loss': 0.6624880135059357, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 0.6666666666666666, 'F1': 0.4776119402985074, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5312529672747073, 'Valid Loss': 0.6516551772753397, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.5833333333333334, 'F1': 0.4242424242424242, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4856968262921209, 'Valid Loss': 0.6414149204889933, 'Validation Metric': {'Precision': 0.3684210526315789, 'Recall': 0.5833333333333334, 'F1': 0.4516129032258065, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4920664222344108, 'Valid Loss': 0.6332446038722992, 'Validation Metric': {'Precision': 0.40625, 'Recall': 0.5416666666666666, 'F1': 0.46428571428571425, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4752555981926296, 'Valid Loss': 0.6263932883739471, 'Validation Metric': {'Precision': 0.41379310344827586, 'Recall': 0.5, 'F1': 0.4528301886792453, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4806776189285776, 'Valid Loss': 0.626669704914093, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.47739000812820764, 'Valid Loss': 0.6262515385945638, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.47345310967901477, 'Valid Loss': 0.6237107117970785, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4643778179002845, 'Valid Loss': 0.621541808048884, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4455846016821654, 'Valid Loss': 0.6193567415078481, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.450708384099214, 'Valid Loss': 0.6178036828835806, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.45319477241972217, 'Valid Loss': 0.6218447387218475, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.5416666666666666, 'F1': 0.4814814814814815, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.36, 'Recall': 0.75, 'F1': 0.48648648648648657, 'Acc': 0.5581395348837209}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.33962264150943394, 'Recall': 0.6666666666666666, 'F1': 0.44999999999999996, 'Acc': 0.4883720930232558}; Test loss: 0.7149909734725952
