Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, lm='longformer', log_dir='./log/longformer_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='ec')
parameters: 148660994
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7109136996061906, 'Valid Loss': 0.6398726304372152, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6974473129148069, 'Valid Loss': 0.6476962864398956, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6964236808859784, 'Valid Loss': 0.6539592643578848, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6942139604817266, 'Valid Loss': 0.658266693353653, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6929792347161666, 'Valid Loss': 0.6628053983052572, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6908091462176779, 'Valid Loss': 0.6652679542700449, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6900957304498424, 'Valid Loss': 0.6646989385286967, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6865400360978168, 'Valid Loss': 0.6657929221789042, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.045454545454545456, 'F1': 0.08333333333333334, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.045454545454545456, 'F1': 0.08333333333333334, 'Acc': 0.7411764705882353}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6816885160363239, 'Valid Loss': 0.6641673346360525, 'Validation Metric': {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6778611126153365, 'Valid Loss': 0.6511782109737396, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.5909090909090909, 'F1': 0.5531914893617023, 'Acc': 0.7529411764705882}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6562224885691768, 'Valid Loss': 0.6488036016623179, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.6363636363636364, 'F1': 0.5833333333333334, 'Acc': 0.7647058823529411}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6548903325329656, 'Valid Loss': 0.6456110775470734, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.6363636363636364, 'F1': 0.5833333333333334, 'Acc': 0.7647058823529411}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6495235951050468, 'Valid Loss': 0.6415384312470754, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.6363636363636364, 'F1': 0.5833333333333334, 'Acc': 0.7647058823529411}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6443618587825609, 'Valid Loss': 0.6380221048990885, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6436587520267653, 'Valid Loss': 0.6336363057295481, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6365025354468304, 'Valid Loss': 0.6292875409126282, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6331209099811056, 'Valid Loss': 0.6245169242223104, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6251239776611328, 'Valid Loss': 0.6195530494054159, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6208982649056808, 'Valid Loss': 0.6138178904851278, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6174943498943163, 'Valid Loss': 0.6077066560586294, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.6363636363636364, 'F1': 0.5957446808510639, 'Acc': 0.7764705882352941}}
Best validation metric so far: {'Precision': 0.65, 'Recall': 0.5909090909090909, 'F1': 0.6190476190476191, 'Acc': 0.8117647058823529}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.53125, 'Recall': 0.53125, 'F1': 0.53125, 'Acc': 0.6511627906976745}; Test loss: 0.677150696516037
