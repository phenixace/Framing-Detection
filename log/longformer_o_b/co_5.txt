Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='longformer', log_dir='./log/longformer_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='co')
parameters: 148660994
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7015362977981567, 'Valid Loss': 0.6888837814331055, 'Validation Metric': {'Precision': 0.5853658536585366, 'Recall': 0.96, 'F1': 0.7272727272727272, 'Acc': 0.5813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5853658536585366, 'Recall': 0.96, 'F1': 0.7272727272727272, 'Acc': 0.5813953488372093}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6926144093275071, 'Valid Loss': 0.6878605087598165, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.96, 'F1': 0.7500000000000001, 'Acc': 0.627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6153846153846154, 'Recall': 0.96, 'F1': 0.7500000000000001, 'Acc': 0.627906976744186}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6921665400266648, 'Valid Loss': 0.6880186498165131, 'Validation Metric': {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6896053045988083, 'Valid Loss': 0.6875011126200358, 'Validation Metric': {'Precision': 0.7115384615384616, 'Recall': 0.74, 'F1': 0.7254901960784313, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6875765174627304, 'Valid Loss': 0.6841262578964233, 'Validation Metric': {'Precision': 0.7014925373134329, 'Recall': 0.94, 'F1': 0.8034188034188033, 'Acc': 0.7325581395348837}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7014925373134329, 'Recall': 0.94, 'F1': 0.8034188034188033, 'Acc': 0.7325581395348837}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6872783988714218, 'Valid Loss': 0.677335391441981, 'Validation Metric': {'Precision': 0.6533333333333333, 'Recall': 0.98, 'F1': 0.784, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.7014925373134329, 'Recall': 0.94, 'F1': 0.8034188034188033, 'Acc': 0.7325581395348837}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6828841865062714, 'Valid Loss': 0.6688800056775411, 'Validation Metric': {'Precision': 0.6447368421052632, 'Recall': 0.98, 'F1': 0.7777777777777777, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.7014925373134329, 'Recall': 0.94, 'F1': 0.8034188034188033, 'Acc': 0.7325581395348837}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6781104803085327, 'Valid Loss': 0.6565628250439962, 'Validation Metric': {'Precision': 0.6486486486486487, 'Recall': 0.96, 'F1': 0.7741935483870968, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.7014925373134329, 'Recall': 0.94, 'F1': 0.8034188034188033, 'Acc': 0.7325581395348837}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6676690667867661, 'Valid Loss': 0.6342406372229258, 'Validation Metric': {'Precision': 0.676056338028169, 'Recall': 0.96, 'F1': 0.7933884297520661, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.7014925373134329, 'Recall': 0.94, 'F1': 0.8034188034188033, 'Acc': 0.7325581395348837}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6481977552175522, 'Valid Loss': 0.5803180932998657, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.96, 'F1': 0.8135593220338982, 'Acc': 0.7441860465116279}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7058823529411765, 'Recall': 0.96, 'F1': 0.8135593220338982, 'Acc': 0.7441860465116279}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6129030913114548, 'Valid Loss': 0.5740843613942465, 'Validation Metric': {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6013614892959595, 'Valid Loss': 0.5661021173000336, 'Validation Metric': {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6086571276187897, 'Valid Loss': 0.5600812981526057, 'Validation Metric': {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6034186616539955, 'Valid Loss': 0.5554008930921555, 'Validation Metric': {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5904525429010391, 'Valid Loss': 0.5504737198352814, 'Validation Metric': {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5900110378861427, 'Valid Loss': 0.5452837944030762, 'Validation Metric': {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.7164179104477612, 'Recall': 0.96, 'F1': 0.8205128205128206, 'Acc': 0.7558139534883721}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5851506441831589, 'Valid Loss': 0.5404335608084997, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.96, 'F1': 0.8275862068965517, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7272727272727273, 'Recall': 0.96, 'F1': 0.8275862068965517, 'Acc': 0.7674418604651163}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.580387918651104, 'Valid Loss': 0.536095400651296, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.96, 'F1': 0.8275862068965517, 'Acc': 0.7674418604651163}}
Best validation metric so far: {'Precision': 0.7272727272727273, 'Recall': 0.96, 'F1': 0.8275862068965517, 'Acc': 0.7674418604651163}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5703052684664727, 'Valid Loss': 0.5315446505943934, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.96, 'F1': 0.8275862068965517, 'Acc': 0.7674418604651163}}
Best validation metric so far: {'Precision': 0.7272727272727273, 'Recall': 0.96, 'F1': 0.8275862068965517, 'Acc': 0.7674418604651163}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5668363913893699, 'Valid Loss': 0.5269052634636561, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.96, 'F1': 0.8421052631578947, 'Acc': 0.7906976744186046}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.96, 'F1': 0.8421052631578947, 'Acc': 0.7906976744186046}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.7941176470588235, 'Recall': 0.9152542372881356, 'F1': 0.8503937007874015, 'Acc': 0.7764705882352941}; Test loss: 0.5645168423652649
