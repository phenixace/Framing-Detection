Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='longformer', log_dir='./log/longformer_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='mo')
parameters: 148660994
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7252911123736151, 'Valid Loss': 0.5946607689062754, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6993263034984983, 'Valid Loss': 0.6117863555749258, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6965157307427505, 'Valid Loss': 0.6238197982311249, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6941785401311414, 'Valid Loss': 0.6344265937805176, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6885243181524605, 'Valid Loss': 0.6380885044733683, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6842777585161144, 'Valid Loss': 0.6349840064843496, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.66991395169291, 'Valid Loss': 0.6271961331367493, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.2857142857142857, 'F1': 0.4, 'Acc': 0.9302325581395349}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.2857142857142857, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6425668679434677, 'Valid Loss': 0.5765917201836904, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.42857142857142855, 'F1': 0.4615384615384615, 'Acc': 0.9186046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.42857142857142855, 'F1': 0.4615384615384615, 'Acc': 0.9186046511627907}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5650634005151945, 'Valid Loss': 0.5284029791752497, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 1.0, 'F1': 0.56, 'Acc': 0.872093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3888888888888889, 'Recall': 1.0, 'F1': 0.56, 'Acc': 0.872093023255814}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4786744410621709, 'Valid Loss': 0.35682062307993573, 'Validation Metric': {'Precision': 0.35714285714285715, 'Recall': 0.7142857142857143, 'F1': 0.4761904761904762, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.3888888888888889, 'Recall': 1.0, 'F1': 0.56, 'Acc': 0.872093023255814}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.34295432937556297, 'Valid Loss': 0.3107398599386215, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.7142857142857143, 'F1': 0.5263157894736842, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.3888888888888889, 'Recall': 1.0, 'F1': 0.56, 'Acc': 0.872093023255814}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.29940553831643074, 'Valid Loss': 0.274228277305762, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.276070350716854, 'Valid Loss': 0.252042551835378, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.25975054553870497, 'Valid Loss': 0.23946018144488335, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2428544713505383, 'Valid Loss': 0.22995721672972044, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2286482874689431, 'Valid Loss': 0.22263185679912567, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.22084399466884547, 'Valid Loss': 0.2204310012360414, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.21229434116133328, 'Valid Loss': 0.21841080114245415, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.19992763420631146, 'Valid Loss': 0.21184919153650603, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.42857142857142855, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19620161940311565, 'Valid Loss': 0.2072435555358728, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.42857142857142855, 'F1': 0.42857142857142855, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7142857142857143, 'F1': 0.588235294117647, 'Acc': 0.9186046511627907}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.6666666666666666, 'Recall': 0.5454545454545454, 'F1': 0.6, 'Acc': 0.9058823529411765}; Test loss: 0.3000671863555908
