Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, lm='longformer', log_dir='./log/longformer_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='co')
parameters: 148660994
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.701872119307518, 'Valid Loss': 0.6889952421188354, 'Validation Metric': {'Precision': 0.6744186046511628, 'Recall': 1.0, 'F1': 0.8055555555555556, 'Acc': 0.6744186046511628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6744186046511628, 'Recall': 1.0, 'F1': 0.8055555555555556, 'Acc': 0.6744186046511628}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6925956428050994, 'Valid Loss': 0.6882900396982828, 'Validation Metric': {'Precision': 0.6823529411764706, 'Recall': 1.0, 'F1': 0.8111888111888113, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6823529411764706, 'Recall': 1.0, 'F1': 0.8111888111888113, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6925950437784195, 'Valid Loss': 0.6884114841620127, 'Validation Metric': {'Precision': 0.6962025316455697, 'Recall': 0.9482758620689655, 'F1': 0.8029197080291972, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.6823529411764706, 'Recall': 1.0, 'F1': 0.8111888111888113, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6903812408447265, 'Valid Loss': 0.6890736222267151, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.8620689655172413, 'F1': 0.7812500000000001, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.6823529411764706, 'Recall': 1.0, 'F1': 0.8111888111888113, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6897394359111786, 'Valid Loss': 0.6853067576885223, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.9655172413793104, 'F1': 0.8115942028985508, 'Acc': 0.6976744186046512}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7, 'Recall': 0.9655172413793104, 'F1': 0.8115942028985508, 'Acc': 0.6976744186046512}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6890499293804169, 'Valid Loss': 0.6823804179827372, 'Validation Metric': {'Precision': 0.7037037037037037, 'Recall': 0.9827586206896551, 'F1': 0.8201438848920862, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7037037037037037, 'Recall': 0.9827586206896551, 'F1': 0.8201438848920862, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6854732513427735, 'Valid Loss': 0.6805688043435415, 'Validation Metric': {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6831605225801468, 'Valid Loss': 0.675555020570755, 'Validation Metric': {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6777778327465057, 'Valid Loss': 0.6650648216406504, 'Validation Metric': {'Precision': 0.7402597402597403, 'Recall': 0.9827586206896551, 'F1': 0.8444444444444446, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6643186748027802, 'Valid Loss': 0.6683669785658518, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.7241379310344828, 'F1': 0.736842105263158, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6557831346988678, 'Valid Loss': 0.6618683437506357, 'Validation Metric': {'Precision': 0.7333333333333333, 'Recall': 0.7586206896551724, 'F1': 0.7457627118644068, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6465550333261489, 'Valid Loss': 0.6550118724505106, 'Validation Metric': {'Precision': 0.7538461538461538, 'Recall': 0.8448275862068966, 'F1': 0.7967479674796748, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6415571659803391, 'Valid Loss': 0.6547607878843943, 'Validation Metric': {'Precision': 0.7419354838709677, 'Recall': 0.7931034482758621, 'F1': 0.7666666666666667, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6382950514554977, 'Valid Loss': 0.651463528474172, 'Validation Metric': {'Precision': 0.746031746031746, 'Recall': 0.8103448275862069, 'F1': 0.7768595041322314, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6333172231912613, 'Valid Loss': 0.6479079723358154, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8275862068965517, 'F1': 0.7868852459016394, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6264689326286316, 'Valid Loss': 0.6466626524925232, 'Validation Metric': {'Precision': 0.7377049180327869, 'Recall': 0.7758620689655172, 'F1': 0.7563025210084033, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6281303614377975, 'Valid Loss': 0.6432167192300161, 'Validation Metric': {'Precision': 0.7419354838709677, 'Recall': 0.7931034482758621, 'F1': 0.7666666666666667, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6216129928827285, 'Valid Loss': 0.6418014764785767, 'Validation Metric': {'Precision': 0.7377049180327869, 'Recall': 0.7758620689655172, 'F1': 0.7563025210084033, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6231191247701645, 'Valid Loss': 0.6381170352300009, 'Validation Metric': {'Precision': 0.746031746031746, 'Recall': 0.8103448275862069, 'F1': 0.7768595041322314, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6171152204275131, 'Valid Loss': 0.6396274665991465, 'Validation Metric': {'Precision': 0.7368421052631579, 'Recall': 0.7241379310344828, 'F1': 0.7304347826086957, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 0.76, 'Recall': 0.9827586206896551, 'F1': 0.8571428571428572, 'Acc': 0.7790697674418605}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.6857142857142857, 'Recall': 0.96, 'F1': 0.7999999999999999, 'Acc': 0.7209302325581395}; Test loss: 0.6784586409727732
