Namespace(batch_size=16, checkpoint_dir='./ckp/', ckp_path='', dataset='./dataset_original/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='longformer', log_dir='./log/longformer_o_b/', lr=2e-06, max_len=256, model='FD_SIN', random_seed=1042, specified_label='ec')
parameters: 148660994
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7102888045103654, 'Valid Loss': 0.6604162156581879, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6982170939445496, 'Valid Loss': 0.6667232314745585, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6949121278265248, 'Valid Loss': 0.6718150873978933, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6918347089186959, 'Valid Loss': 0.6753676136334738, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6911790137705596, 'Valid Loss': 0.6783460378646851, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6876053784204565, 'Valid Loss': 0.6819926699002584, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.2222222222222222, 'F1': 0.32432432432432434, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.2222222222222222, 'F1': 0.32432432432432434, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6853834675705951, 'Valid Loss': 0.6819192965825399, 'Validation Metric': {'Precision': 0.5357142857142857, 'Recall': 0.5555555555555556, 'F1': 0.5454545454545454, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5357142857142857, 'Recall': 0.5555555555555556, 'F1': 0.5454545454545454, 'Acc': 0.7093023255813954}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6766188041023586, 'Valid Loss': 0.681725392738978, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6664663734643356, 'Valid Loss': 0.679000973701477, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.7777777777777778, 'F1': 0.5384615384615384, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6452150111613066, 'Valid Loss': 0.6669257680575053, 'Validation Metric': {'Precision': 0.40816326530612246, 'Recall': 0.7407407407407407, 'F1': 0.5263157894736843, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6074500602224598, 'Valid Loss': 0.664216548204422, 'Validation Metric': {'Precision': 0.3958333333333333, 'Recall': 0.7037037037037037, 'F1': 0.5066666666666667, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6002177738625071, 'Valid Loss': 0.6603982150554657, 'Validation Metric': {'Precision': 0.3829787234042553, 'Recall': 0.6666666666666666, 'F1': 0.48648648648648646, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5884738318298174, 'Valid Loss': 0.6576994160811106, 'Validation Metric': {'Precision': 0.3829787234042553, 'Recall': 0.6666666666666666, 'F1': 0.48648648648648646, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.589320279981779, 'Valid Loss': 0.6537080109119415, 'Validation Metric': {'Precision': 0.3829787234042553, 'Recall': 0.6666666666666666, 'F1': 0.48648648648648646, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5822241098984428, 'Valid Loss': 0.6504929264386495, 'Validation Metric': {'Precision': 0.391304347826087, 'Recall': 0.6666666666666666, 'F1': 0.4931506849315068, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5807240553524183, 'Valid Loss': 0.6468012928962708, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.6666666666666666, 'F1': 0.5, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5657024085521698, 'Valid Loss': 0.6422229011853536, 'Validation Metric': {'Precision': 0.38636363636363635, 'Recall': 0.6296296296296297, 'F1': 0.47887323943661975, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5649868470171223, 'Valid Loss': 0.6384399235248566, 'Validation Metric': {'Precision': 0.40476190476190477, 'Recall': 0.6296296296296297, 'F1': 0.4927536231884058, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5597059104753577, 'Valid Loss': 0.6343115369478861, 'Validation Metric': {'Precision': 0.4146341463414634, 'Recall': 0.6296296296296297, 'F1': 0.5, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5513803518336752, 'Valid Loss': 0.6315102477868398, 'Validation Metric': {'Precision': 0.4146341463414634, 'Recall': 0.6296296296296297, 'F1': 0.5, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.43478260869565216, 'Recall': 0.7407407407407407, 'F1': 0.5479452054794521, 'Acc': 0.6162790697674418}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': 0.5405405405405406, 'Recall': 0.9090909090909091, 'F1': 0.6779661016949153, 'Acc': 0.7764705882352941}; Test loss: 0.6759146352608999
