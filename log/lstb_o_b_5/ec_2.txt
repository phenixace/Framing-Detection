Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ec')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6949473165947458, 'Valid Loss': 0.6996723738583651, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6985634623662286, 'Valid Loss': 0.6980614174496044, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.9545454545454546, 'F1': 0.39622641509433965, 'Acc': 0.24705882352941178}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6998954363491224, 'Valid Loss': 0.6962600973519412, 'Validation Metric': {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.702422700498415, 'Valid Loss': 0.6957399465821006, 'Validation Metric': {'Precision': 0.27631578947368424, 'Recall': 0.9545454545454546, 'F1': 0.4285714285714286, 'Acc': 0.3411764705882353}}
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.700608584543933, 'Valid Loss': 0.698757139119235, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7012003945267719, 'Valid Loss': 0.7054158069870688, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6966212961984717, 'Valid Loss': 0.7084571692076597, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6821177990540214, 'Valid Loss': 0.7144575606692921, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6668012203729671, 'Valid Loss': 0.721401878378608, 'Validation Metric': {'Precision': 0.2972972972972973, 'Recall': 1.0, 'F1': 0.4583333333333333, 'Acc': 0.38823529411764707}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2972972972972973, 'Recall': 1.0, 'F1': 0.4583333333333333, 'Acc': 0.38823529411764707}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5889372835340707, 'Valid Loss': 0.9387039894407446, 'Validation Metric': {'Precision': 0.2716049382716049, 'Recall': 1.0, 'F1': 0.4271844660194175, 'Acc': 0.3058823529411765}}
Best validation metric so far: {'Precision': 0.2972972972972973, 'Recall': 1.0, 'F1': 0.4583333333333333, 'Acc': 0.38823529411764707}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5065308168692433, 'Valid Loss': 0.8734104958447543, 'Validation Metric': {'Precision': 0.3235294117647059, 'Recall': 1.0, 'F1': 0.48888888888888893, 'Acc': 0.4588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3235294117647059, 'Recall': 1.0, 'F1': 0.48888888888888893, 'Acc': 0.4588235294117647}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.422991835957636, 'Valid Loss': 0.703712518919598, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.9090909090909091, 'F1': 0.5555555555555556, 'Acc': 0.6235294117647059}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4, 'Recall': 0.9090909090909091, 'F1': 0.5555555555555556, 'Acc': 0.6235294117647059}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3437518717964058, 'Valid Loss': 0.5784775465726852, 'Validation Metric': {'Precision': 0.4878048780487805, 'Recall': 0.9090909090909091, 'F1': 0.6349206349206349, 'Acc': 0.7294117647058823}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.9090909090909091, 'F1': 0.6349206349206349, 'Acc': 0.7294117647058823}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.28523262820975936, 'Valid Loss': 0.49639973179860547, 'Validation Metric': {'Precision': 0.5128205128205128, 'Recall': 0.9090909090909091, 'F1': 0.6557377049180326, 'Acc': 0.7529411764705882}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5128205128205128, 'Recall': 0.9090909090909091, 'F1': 0.6557377049180326, 'Acc': 0.7529411764705882}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.24896774570579114, 'Valid Loss': 0.42507927830923686, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.9090909090909091, 'F1': 0.7017543859649122, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.9090909090909091, 'F1': 0.7017543859649122, 'Acc': 0.8}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.22342059368510608, 'Valid Loss': 0.3850830475037748, 'Validation Metric': {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.19417507213580867, 'Valid Loss': 0.35575124621391296, 'Validation Metric': {'Precision': 0.6551724137931034, 'Recall': 0.8636363636363636, 'F1': 0.7450980392156864, 'Acc': 0.8470588235294118}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6551724137931034, 'Recall': 0.8636363636363636, 'F1': 0.7450980392156864, 'Acc': 0.8470588235294118}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.17627101213387822, 'Valid Loss': 0.3400915026326071, 'Validation Metric': {'Precision': 0.72, 'Recall': 0.8181818181818182, 'F1': 0.7659574468085107, 'Acc': 0.8705882352941177}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.8181818181818182, 'F1': 0.7659574468085107, 'Acc': 0.8705882352941177}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16911360568812359, 'Valid Loss': 0.3342622354287993, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.7727272727272727, 'F1': 0.7391304347826088, 'Acc': 0.8588235294117647}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.8181818181818182, 'F1': 0.7659574468085107, 'Acc': 0.8705882352941177}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1530200483520394, 'Valid Loss': 0.33228817057203164, 'Validation Metric': {'Precision': 0.7083333333333334, 'Recall': 0.7727272727272727, 'F1': 0.7391304347826088, 'Acc': 0.8588235294117647}}
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.8181818181818182, 'F1': 0.7659574468085107, 'Acc': 0.8705882352941177}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6842105263157895, 'Recall': 0.8125, 'F1': 0.742857142857143, 'Acc': 0.7906976744186046}; Test loss: 0.448496698486534
