Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ec')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6925712724526724, 'Valid Loss': 0.6979414956136183, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.3023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.3023255813953488}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6950474361578624, 'Valid Loss': 0.6966684325174852, 'Validation Metric': {'Precision': 0.2839506172839506, 'Recall': 0.9583333333333334, 'F1': 0.43809523809523804, 'Acc': 0.313953488372093}}
Best validation metric so far: {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.3023255813953488}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7006990843349032, 'Valid Loss': 0.6935525319793008, 'Validation Metric': {'Precision': 0.32786885245901637, 'Recall': 0.8333333333333334, 'F1': 0.4705882352941176, 'Acc': 0.47674418604651164}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32786885245901637, 'Recall': 0.8333333333333334, 'F1': 0.4705882352941176, 'Acc': 0.47674418604651164}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7014989409181807, 'Valid Loss': 0.691126368262551, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6998199674818251, 'Valid Loss': 0.6928271326151761, 'Validation Metric': {'Precision': 0.3484848484848485, 'Recall': 0.9583333333333334, 'F1': 0.5111111111111112, 'Acc': 0.4883720930232558}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6987541139125824, 'Valid Loss': 0.6969192732464183, 'Validation Metric': {'Precision': 0.2891566265060241, 'Recall': 1.0, 'F1': 0.44859813084112143, 'Acc': 0.313953488372093}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6896087918016646, 'Valid Loss': 0.7072903541001406, 'Validation Metric': {'Precision': 0.27906976744186046, 'Recall': 1.0, 'F1': 0.43636363636363634, 'Acc': 0.27906976744186046}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6805853022469415, 'Valid Loss': 0.7105756781317971, 'Validation Metric': {'Precision': 0.27906976744186046, 'Recall': 1.0, 'F1': 0.43636363636363634, 'Acc': 0.27906976744186046}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6342951671944724, 'Valid Loss': 0.7552956234325062, 'Validation Metric': {'Precision': 0.3, 'Recall': 1.0, 'F1': 0.4615384615384615, 'Acc': 0.3488372093023256}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5367066166467137, 'Valid Loss': 0.9193588210777803, 'Validation Metric': {'Precision': 0.3116883116883117, 'Recall': 1.0, 'F1': 0.4752475247524752, 'Acc': 0.38372093023255816}}
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.75, 'F1': 0.5454545454545454, 'Acc': 0.6511627906976745}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.438851094742616, 'Valid Loss': 0.7571947384964336, 'Validation Metric': {'Precision': 0.38333333333333336, 'Recall': 0.9583333333333334, 'F1': 0.5476190476190476, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38333333333333336, 'Recall': 0.9583333333333334, 'F1': 0.5476190476190476, 'Acc': 0.5581395348837209}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3555244263675478, 'Valid Loss': 0.6597475788810037, 'Validation Metric': {'Precision': 0.4339622641509434, 'Recall': 0.9583333333333334, 'F1': 0.5974025974025975, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4339622641509434, 'Recall': 0.9583333333333334, 'F1': 0.5974025974025975, 'Acc': 0.6395348837209303}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.29780028959115346, 'Valid Loss': 0.548484317958355, 'Validation Metric': {'Precision': 0.5277777777777778, 'Recall': 0.7916666666666666, 'F1': 0.6333333333333333, 'Acc': 0.7441860465116279}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7916666666666666, 'F1': 0.6333333333333333, 'Acc': 0.7441860465116279}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2583066392276022, 'Valid Loss': 0.4855017932978543, 'Validation Metric': {'Precision': 0.5428571428571428, 'Recall': 0.7916666666666666, 'F1': 0.6440677966101694, 'Acc': 0.7558139534883721}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5428571428571428, 'Recall': 0.7916666666666666, 'F1': 0.6440677966101694, 'Acc': 0.7558139534883721}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.22155275257925192, 'Valid Loss': 0.4755073887380687, 'Validation Metric': {'Precision': 0.5757575757575758, 'Recall': 0.7916666666666666, 'F1': 0.6666666666666667, 'Acc': 0.7790697674418605}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5757575757575758, 'Recall': 0.7916666666666666, 'F1': 0.6666666666666667, 'Acc': 0.7790697674418605}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.20671231461067993, 'Valid Loss': 0.4456795115362514, 'Validation Metric': {'Precision': 0.5757575757575758, 'Recall': 0.7916666666666666, 'F1': 0.6666666666666667, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.5757575757575758, 'Recall': 0.7916666666666666, 'F1': 0.6666666666666667, 'Acc': 0.7790697674418605}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18282896354794503, 'Valid Loss': 0.4309054579247128, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.5757575757575758, 'Recall': 0.7916666666666666, 'F1': 0.6666666666666667, 'Acc': 0.7790697674418605}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.16428869991666742, 'Valid Loss': 0.4242974424904043, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.5757575757575758, 'Recall': 0.7916666666666666, 'F1': 0.6666666666666667, 'Acc': 0.7790697674418605}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16079527003069718, 'Valid Loss': 0.421594268896363, 'Validation Metric': {'Precision': 0.6538461538461539, 'Recall': 0.7083333333333334, 'F1': 0.68, 'Acc': 0.813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6538461538461539, 'Recall': 0.7083333333333334, 'F1': 0.68, 'Acc': 0.813953488372093}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.15507377054956223, 'Valid Loss': 0.41791498457843607, 'Validation Metric': {'Precision': 0.6538461538461539, 'Recall': 0.7083333333333334, 'F1': 0.68, 'Acc': 0.813953488372093}}
Best validation metric so far: {'Precision': 0.6538461538461539, 'Recall': 0.7083333333333334, 'F1': 0.68, 'Acc': 0.813953488372093}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.72, 'Recall': 0.6666666666666666, 'F1': 0.6923076923076923, 'Acc': 0.813953488372093}; Test loss: 0.38896199010989885
