Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ar')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6956619161206323, 'Valid Loss': 0.6923004470088265, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6921837249317685, 'Valid Loss': 0.6924293745647777, 'Validation Metric': {'Precision': 0.5487804878048781, 'Recall': 0.9574468085106383, 'F1': 0.6976744186046512, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.693292876353135, 'Valid Loss': 0.6927614970640703, 'Validation Metric': {'Precision': 0.5263157894736842, 'Recall': 0.851063829787234, 'F1': 0.6504065040650406, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6985251428307714, 'Valid Loss': 0.6933421302925457, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.3829787234042553, 'F1': 0.4444444444444445, 'Acc': 0.47674418604651164}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6961220220939534, 'Valid Loss': 0.6934220032258467, 'Validation Metric': {'Precision': 0.6875, 'Recall': 0.23404255319148937, 'F1': 0.3492063492063492, 'Acc': 0.5232558139534884}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6946165932191385, 'Valid Loss': 0.6934801475568251, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.1276595744680851, 'F1': 0.21428571428571427, 'Acc': 0.4883720930232558}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6945288132976841, 'Valid Loss': 0.6936481242830103, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.0851063829787234, 'F1': 0.1509433962264151, 'Acc': 0.47674418604651164}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6905532245700424, 'Valid Loss': 0.6928131715817885, 'Validation Metric': {'Precision': 0.8888888888888888, 'Recall': 0.1702127659574468, 'F1': 0.2857142857142857, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6898338488630347, 'Valid Loss': 0.6925082613121379, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.1702127659574468, 'F1': 0.2807017543859649, 'Acc': 0.5232558139534884}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6828957490018897, 'Valid Loss': 0.6918935613198713, 'Validation Metric': {'Precision': 0.7692307692307693, 'Recall': 0.2127659574468085, 'F1': 0.33333333333333337, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6789634944619359, 'Valid Loss': 0.6899110674858093, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.425531914893617, 'F1': 0.5194805194805194, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6729461929282626, 'Valid Loss': 0.6869819624857469, 'Validation Metric': {'Precision': 0.6341463414634146, 'Recall': 0.5531914893617021, 'F1': 0.5909090909090909, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6644059000788508, 'Valid Loss': 0.6830021386796777, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.5106382978723404, 'F1': 0.5925925925925926, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6410402381742323, 'Valid Loss': 0.6700172857804731, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5957446808510638, 'F1': 0.6292134831460674, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6120777685899992, 'Valid Loss': 0.6583839654922485, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.6595744680851063, 'F1': 0.6595744680851063, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5935473208491867, 'Valid Loss': 0.6582541276108135, 'Validation Metric': {'Precision': 0.7073170731707317, 'Recall': 0.6170212765957447, 'F1': 0.6590909090909092, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5700889970805194, 'Valid Loss': 0.6585327806797895, 'Validation Metric': {'Precision': 0.7714285714285715, 'Recall': 0.574468085106383, 'F1': 0.6585365853658536, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5429825001471752, 'Valid Loss': 0.6574321822686628, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.574468085106383, 'F1': 0.6506024096385542, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5341400681315241, 'Valid Loss': 0.6595189544287595, 'Validation Metric': {'Precision': 0.7714285714285715, 'Recall': 0.574468085106383, 'F1': 0.6585365853658536, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5200503271173786, 'Valid Loss': 0.6592786271463741, 'Validation Metric': {'Precision': 0.7714285714285715, 'Recall': 0.574468085106383, 'F1': 0.6585365853658536, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.5476190476190477, 'Recall': 0.9787234042553191, 'F1': 0.7022900763358778, 'Acc': 0.5465116279069767}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}; Test loss: 0.6949881586161527
