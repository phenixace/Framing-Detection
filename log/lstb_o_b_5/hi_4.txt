Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='hi')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6932760229152916, 'Valid Loss': 0.7018043317578055, 'Validation Metric': {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6990914835339099, 'Valid Loss': 0.7011723057790236, 'Validation Metric': {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7051994510456524, 'Valid Loss': 0.7025919502431696, 'Validation Metric': {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7057401617016412, 'Valid Loss': 0.7069451321255077, 'Validation Metric': {'Precision': 0.12790697674418605, 'Recall': 1.0, 'F1': 0.2268041237113402, 'Acc': 0.12790697674418605}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7075195723930291, 'Valid Loss': 0.7175687524405393, 'Validation Metric': {'Precision': 0.12790697674418605, 'Recall': 1.0, 'F1': 0.2268041237113402, 'Acc': 0.12790697674418605}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7049532268954589, 'Valid Loss': 0.735332884571769, 'Validation Metric': {'Precision': 0.12790697674418605, 'Recall': 1.0, 'F1': 0.2268041237113402, 'Acc': 0.12790697674418605}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.7046444210330997, 'Valid Loss': 0.7385604977607727, 'Validation Metric': {'Precision': 0.12790697674418605, 'Recall': 1.0, 'F1': 0.2268041237113402, 'Acc': 0.12790697674418605}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6844109895482527, 'Valid Loss': 0.750631719827652, 'Validation Metric': {'Precision': 0.12790697674418605, 'Recall': 1.0, 'F1': 0.2268041237113402, 'Acc': 0.12790697674418605}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6417159327363546, 'Valid Loss': 0.8354558484120802, 'Validation Metric': {'Precision': 0.12941176470588237, 'Recall': 1.0, 'F1': 0.22916666666666669, 'Acc': 0.13953488372093023}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5224218369189617, 'Valid Loss': 1.02124791524627, 'Validation Metric': {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1511627906976744}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4055814631612955, 'Valid Loss': 0.6775056611407887, 'Validation Metric': {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.27375157467559375, 'Valid Loss': 0.5242263038050045, 'Validation Metric': {'Precision': 0.2222222222222222, 'Recall': 0.36363636363636365, 'F1': 0.27586206896551724, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19002784307287857, 'Valid Loss': 0.4269567145542665, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.18181818181818182, 'F1': 0.23529411764705885, 'Acc': 0.8488372093023255}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.13340339071191518, 'Valid Loss': 0.3866891095584089, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.10436725596674776, 'Valid Loss': 0.37137043780901213, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.08246127227568521, 'Valid Loss': 0.3695213029330427, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.0711844182054026, 'Valid Loss': 0.3709520733153278, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.060563176004957836, 'Valid Loss': 0.37531080774285575, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09090909090909091, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.05559566961518959, 'Valid Loss': 0.37860383321954444, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.09090909090909091, 'F1': 0.16666666666666669, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.05035845236440675, 'Valid Loss': 0.3810329326343807, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.09090909090909091, 'F1': 0.16666666666666669, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.18604651162790697, 'Recall': 0.7272727272727273, 'F1': 0.2962962962962963, 'Acc': 0.5581395348837209}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.12244897959183673, 'Recall': 0.75, 'F1': 0.21052631578947364, 'Acc': 0.47674418604651164}; Test loss: 0.7183083742856979
