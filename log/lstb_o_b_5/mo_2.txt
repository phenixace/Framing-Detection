Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='mo')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6931419797565626, 'Valid Loss': 0.7048540169542487, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.700283308132835, 'Valid Loss': 0.7042345811020244, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}}
Best validation metric so far: {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7024682122728099, 'Valid Loss': 0.7064888748255643, 'Validation Metric': {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7041678423466889, 'Valid Loss': 0.7137632126157935, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}}
Best validation metric so far: {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7021486453388048, 'Valid Loss': 0.7354600863023237, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}}
Best validation metric so far: {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6942354513251263, 'Valid Loss': 0.7988569709387693, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}}
Best validation metric so far: {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.648426841393761, 'Valid Loss': 1.2159773869947954, 'Validation Metric': {'Precision': 0.058823529411764705, 'Recall': 1.0, 'F1': 0.1111111111111111, 'Acc': 0.058823529411764705}}
Best validation metric so far: {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5859139357572016, 'Valid Loss': 1.2494263974103061, 'Validation Metric': {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}}
Best validation metric so far: {'Precision': 0.05952380952380952, 'Recall': 1.0, 'F1': 0.11235955056179775, 'Acc': 0.07058823529411765}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.4341503263167713, 'Valid Loss': 1.0901256935162977, 'Validation Metric': {'Precision': 0.06944444444444445, 'Recall': 1.0, 'F1': 0.12987012987012989, 'Acc': 0.21176470588235294}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.06944444444444445, 'Recall': 1.0, 'F1': 0.12987012987012989, 'Acc': 0.21176470588235294}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.30031695242809214, 'Valid Loss': 0.7063434950330041, 'Validation Metric': {'Precision': 0.1388888888888889, 'Recall': 1.0, 'F1': 0.24390243902439027, 'Acc': 0.6352941176470588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1388888888888889, 'Recall': 1.0, 'F1': 0.24390243902439027, 'Acc': 0.6352941176470588}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18998899701172892, 'Valid Loss': 0.48352825912562286, 'Validation Metric': {'Precision': 0.21739130434782608, 'Recall': 1.0, 'F1': 0.3571428571428571, 'Acc': 0.788235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.21739130434782608, 'Recall': 1.0, 'F1': 0.3571428571428571, 'Acc': 0.788235294117647}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.12775845587577508, 'Valid Loss': 0.3254739078269763, 'Validation Metric': {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.08803496615070364, 'Valid Loss': 0.2346586056730964, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.4, 'F1': 0.3076923076923077, 'Acc': 0.8941176470588236}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.06861904589054377, 'Valid Loss': 0.19031216864558784, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.2, 'F1': 0.1818181818181818, 'Acc': 0.8941176470588236}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.04986704961275277, 'Valid Loss': 0.1629029648717154, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2, 'F1': 0.28571428571428575, 'Acc': 0.9411764705882353}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.04103575795888901, 'Valid Loss': 0.1510739183392037, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2, 'F1': 0.28571428571428575, 'Acc': 0.9411764705882353}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.03365836186415475, 'Valid Loss': 0.14640018724921075, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2, 'F1': 0.28571428571428575, 'Acc': 0.9411764705882353}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.029361865612799708, 'Valid Loss': 0.1440343960526992, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2, 'F1': 0.28571428571428575, 'Acc': 0.9411764705882353}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.027593064291969588, 'Valid Loss': 0.14351436258717018, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2, 'F1': 0.28571428571428575, 'Acc': 0.9411764705882353}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.025905712191825327, 'Valid Loss': 0.14346942320381376, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2, 'F1': 0.28571428571428575, 'Acc': 0.9411764705882353}}
Best validation metric so far: {'Precision': 0.26666666666666666, 'Recall': 0.8, 'F1': 0.4, 'Acc': 0.8588235294117647}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5789473684210527, 'Recall': 0.9166666666666666, 'F1': 0.7096774193548387, 'Acc': 0.8953488372093024}; Test loss: 0.30967227030884137
