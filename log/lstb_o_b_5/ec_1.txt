Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ec')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6935139339078557, 'Valid Loss': 0.6992610069838437, 'Validation Metric': {'Precision': 0.2682926829268293, 'Recall': 1.0, 'F1': 0.4230769230769231, 'Acc': 0.29411764705882354}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2682926829268293, 'Recall': 1.0, 'F1': 0.4230769230769231, 'Acc': 0.29411764705882354}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6927735683592883, 'Valid Loss': 0.6983955096114766, 'Validation Metric': {'Precision': 0.26582278481012656, 'Recall': 0.9545454545454546, 'F1': 0.41584158415841577, 'Acc': 0.3058823529411765}}
Best validation metric so far: {'Precision': 0.2682926829268293, 'Recall': 1.0, 'F1': 0.4230769230769231, 'Acc': 0.29411764705882354}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6980247931046919, 'Valid Loss': 0.6973065788095648, 'Validation Metric': {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.28, 'Recall': 0.9545454545454546, 'F1': 0.43298969072164956, 'Acc': 0.35294117647058826}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6999219974333589, 'Valid Loss': 0.6962936439297416, 'Validation Metric': {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6998303607106209, 'Valid Loss': 0.6980984319340099, 'Validation Metric': {'Precision': 0.27848101265822783, 'Recall': 1.0, 'F1': 0.43564356435643564, 'Acc': 0.32941176470588235}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.700443642383272, 'Valid Loss': 0.7010242315855894, 'Validation Metric': {'Precision': 0.2682926829268293, 'Recall': 1.0, 'F1': 0.4230769230769231, 'Acc': 0.29411764705882354}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6952303532849659, 'Valid Loss': 0.7043156650933352, 'Validation Metric': {'Precision': 0.2619047619047619, 'Recall': 1.0, 'F1': 0.41509433962264153, 'Acc': 0.27058823529411763}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.687677027149634, 'Valid Loss': 0.703758256001906, 'Validation Metric': {'Precision': 0.27848101265822783, 'Recall': 1.0, 'F1': 0.43564356435643564, 'Acc': 0.32941176470588235}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6722775812853466, 'Valid Loss': 0.7108130725947294, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.35294117647058826}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6145844818516211, 'Valid Loss': 0.867019918831912, 'Validation Metric': {'Precision': 0.2682926829268293, 'Recall': 1.0, 'F1': 0.4230769230769231, 'Acc': 0.29411764705882354}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5283010546118021, 'Valid Loss': 0.9577963040633635, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.35294117647058826}}
Best validation metric so far: {'Precision': 0.2916666666666667, 'Recall': 0.9545454545454546, 'F1': 0.4468085106382979, 'Acc': 0.38823529411764707}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.46113383973186667, 'Valid Loss': 0.7277575609358874, 'Validation Metric': {'Precision': 0.3559322033898305, 'Recall': 0.9545454545454546, 'F1': 0.5185185185185185, 'Acc': 0.5411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3559322033898305, 'Recall': 0.9545454545454546, 'F1': 0.5185185185185185, 'Acc': 0.5411764705882353}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.38130449249663134, 'Valid Loss': 0.5812718935988166, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.9090909090909091, 'F1': 0.6060606060606061, 'Acc': 0.6941176470588235}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45454545454545453, 'Recall': 0.9090909090909091, 'F1': 0.6060606060606061, 'Acc': 0.6941176470588235}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.3276489936661991, 'Valid Loss': 0.5115058378062465, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.8636363636363636, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.8636363636363636, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.3005865603177385, 'Valid Loss': 0.4525582113049247, 'Validation Metric': {'Precision': 0.5757575757575758, 'Recall': 0.8636363636363636, 'F1': 0.6909090909090909, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5757575757575758, 'Recall': 0.8636363636363636, 'F1': 0.6909090909090909, 'Acc': 0.8}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.26025767683644185, 'Valid Loss': 0.4131341949105263, 'Validation Metric': {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.23718933236192574, 'Valid Loss': 0.3923929933119904, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}}
Best validation metric so far: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.21739432626319202, 'Valid Loss': 0.381697202609344, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.788235294117647}}
Best validation metric so far: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.20356767599216916, 'Valid Loss': 0.37279290942983195, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.6818181818181818, 'F1': 0.6382978723404256, 'Acc': 0.8}}
Best validation metric so far: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19840466214174574, 'Valid Loss': 0.37076579948717897, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.6818181818181818, 'F1': 0.6382978723404256, 'Acc': 0.8}}
Best validation metric so far: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6129032258064516, 'Recall': 0.8636363636363636, 'F1': 0.7169811320754716, 'Acc': 0.8235294117647058}; Test loss: 0.42238942364400084
