Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='mo')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6922606318666223, 'Valid Loss': 0.7030677389014851, 'Validation Metric': {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6974056478132281, 'Valid Loss': 0.7029132843017578, 'Validation Metric': {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}}
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.702707669714041, 'Valid Loss': 0.7049386961893602, 'Validation Metric': {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}}
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7037737866242727, 'Valid Loss': 0.7109289304776625, 'Validation Metric': {'Precision': 0.10465116279069768, 'Recall': 1.0, 'F1': 0.18947368421052632, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6995836355184254, 'Valid Loss': 0.7378024838187478, 'Validation Metric': {'Precision': 0.10465116279069768, 'Recall': 1.0, 'F1': 0.18947368421052632, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6812524518422913, 'Valid Loss': 0.8859664445573633, 'Validation Metric': {'Precision': 0.10465116279069768, 'Recall': 1.0, 'F1': 0.18947368421052632, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6207534240787489, 'Valid Loss': 1.341468637639826, 'Validation Metric': {'Precision': 0.10465116279069768, 'Recall': 1.0, 'F1': 0.18947368421052632, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.10588235294117647, 'Recall': 1.0, 'F1': 0.19148936170212766, 'Acc': 0.11627906976744186}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.49641814723349453, 'Valid Loss': 1.252765495668758, 'Validation Metric': {'Precision': 0.10975609756097561, 'Recall': 1.0, 'F1': 0.1978021978021978, 'Acc': 0.1511627906976744}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.10975609756097561, 'Recall': 1.0, 'F1': 0.1978021978021978, 'Acc': 0.1511627906976744}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.33313036347298247, 'Valid Loss': 0.8836927657777612, 'Validation Metric': {'Precision': 0.14893617021276595, 'Recall': 0.7777777777777778, 'F1': 0.25, 'Acc': 0.5116279069767442}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.14893617021276595, 'Recall': 0.7777777777777778, 'F1': 0.25, 'Acc': 0.5116279069767442}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.21548797226135144, 'Valid Loss': 0.5673512396487322, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.7777777777777778, 'F1': 0.3783783783783784, 'Acc': 0.7325581395348837}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.7777777777777778, 'F1': 0.3783783783783784, 'Acc': 0.7325581395348837}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.14070945961825682, 'Valid Loss': 0.4052924161607569, 'Validation Metric': {'Precision': 0.3125, 'Recall': 0.5555555555555556, 'F1': 0.39999999999999997, 'Acc': 0.8255813953488372}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3125, 'Recall': 0.5555555555555556, 'F1': 0.39999999999999997, 'Acc': 0.8255813953488372}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.10036968073823996, 'Valid Loss': 0.32209371064196934, 'Validation Metric': {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.07011008573075135, 'Valid Loss': 0.2875454562123526, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.3333333333333333, 'F1': 0.35294117647058826, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.055946414105659516, 'Valid Loss': 0.2743603022430431, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2222222222222222, 'F1': 0.2857142857142857, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.04602490541966338, 'Valid Loss': 0.2738807548091493, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2222222222222222, 'F1': 0.2857142857142857, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.038224903139563504, 'Valid Loss': 0.2781946731900627, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2222222222222222, 'F1': 0.2857142857142857, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.032718644003596226, 'Valid Loss': 0.2802013299766589, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2222222222222222, 'F1': 0.2857142857142857, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.03155503388526931, 'Valid Loss': 0.2822859499561177, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.2222222222222222, 'F1': 0.2857142857142857, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.03080118600311771, 'Valid Loss': 0.2860311850143427, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.1111111111111111, 'F1': 0.15384615384615383, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.02817488812204254, 'Valid Loss': 0.2870712182696231, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.1111111111111111, 'F1': 0.15384615384615383, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.38461538461538464, 'Recall': 0.5555555555555556, 'F1': 0.4545454545454546, 'Acc': 0.8604651162790697}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7, 'Recall': 1.0, 'F1': 0.8235294117647058, 'Acc': 0.9651162790697675}; Test loss: 0.14557329853149978
