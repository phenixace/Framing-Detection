Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ar')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6933248928851552, 'Valid Loss': 0.6977273307063363, 'Validation Metric': {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6950536055697335, 'Valid Loss': 0.6972309134223245, 'Validation Metric': {'Precision': 0.358974358974359, 'Recall': 0.875, 'F1': 0.509090909090909, 'Acc': 0.36470588235294116}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.693826718462838, 'Valid Loss': 0.6952070648019965, 'Validation Metric': {'Precision': 0.3793103448275862, 'Recall': 0.6875, 'F1': 0.4888888888888889, 'Acc': 0.4588235294117647}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.694140194190873, 'Valid Loss': 0.6931136331774972, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.3125, 'F1': 0.3225806451612903, 'Acc': 0.5058823529411764}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6950139105319977, 'Valid Loss': 0.6897966265678406, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6954393254386054, 'Valid Loss': 0.6896522695367987, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6927052529321777, 'Valid Loss': 0.6895390017466112, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6918575341502825, 'Valid Loss': 0.687091125683351, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6872551093498865, 'Valid Loss': 0.6896935511719097, 'Validation Metric': {'Precision': 0.2727272727272727, 'Recall': 0.09375, 'F1': 0.13953488372093023, 'Acc': 0.5647058823529412}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6874846253130171, 'Valid Loss': 0.6881187449802052, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.09375, 'F1': 0.14634146341463417, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6813791609472699, 'Valid Loss': 0.6876931976188313, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.25, 'F1': 0.32, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6730317191945182, 'Valid Loss': 0.6877432628111406, 'Validation Metric': {'Precision': 0.4666666666666667, 'Recall': 0.4375, 'F1': 0.45161290322580644, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.657217677268717, 'Valid Loss': 0.684687462720004, 'Validation Metric': {'Precision': 0.4857142857142857, 'Recall': 0.53125, 'F1': 0.5074626865671641, 'Acc': 0.611764705882353}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.637324092288812, 'Valid Loss': 0.6771251423792406, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.53125, 'F1': 0.5151515151515151, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.37349397590361444, 'Recall': 0.96875, 'F1': 0.5391304347826087, 'Acc': 0.3764705882352941}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6089097203479873, 'Valid Loss': 0.6710383946245367, 'Validation Metric': {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.571008313447237, 'Valid Loss': 0.6659281633116982, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.59375, 'F1': 0.5428571428571428, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5490551942752467, 'Valid Loss': 0.6597607921470295, 'Validation Metric': {'Precision': 0.4857142857142857, 'Recall': 0.53125, 'F1': 0.5074626865671641, 'Acc': 0.611764705882353}}
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5185307438174883, 'Valid Loss': 0.6589183035221967, 'Validation Metric': {'Precision': 0.4722222222222222, 'Recall': 0.53125, 'F1': 0.4999999999999999, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5096006633506881, 'Valid Loss': 0.6634723327376626, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.59375, 'F1': 0.5428571428571428, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5022066574957635, 'Valid Loss': 0.66313966431401, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.59375, 'F1': 0.5428571428571428, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.5135135135135135, 'Recall': 0.59375, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6538461538461539, 'Recall': 0.7391304347826086, 'F1': 0.693877551020408, 'Acc': 0.6511627906976745}; Test loss: 0.6616859165104952
