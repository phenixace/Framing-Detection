Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ar')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6945908940755404, 'Valid Loss': 0.6976495276797902, 'Validation Metric': {'Precision': 0.3493975903614458, 'Recall': 0.9666666666666667, 'F1': 0.5132743362831859, 'Acc': 0.35294117647058826}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3493975903614458, 'Recall': 0.9666666666666667, 'F1': 0.5132743362831859, 'Acc': 0.35294117647058826}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6940889450219961, 'Valid Loss': 0.6970426088029688, 'Validation Metric': {'Precision': 0.3625, 'Recall': 0.9666666666666667, 'F1': 0.5272727272727272, 'Acc': 0.38823529411764707}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3625, 'Recall': 0.9666666666666667, 'F1': 0.5272727272727272, 'Acc': 0.38823529411764707}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6916805331523602, 'Valid Loss': 0.6960947947068648, 'Validation Metric': {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6937976167752192, 'Valid Loss': 0.693942820483988, 'Validation Metric': {'Precision': 0.3870967741935484, 'Recall': 0.8, 'F1': 0.5217391304347827, 'Acc': 0.4823529411764706}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6920034445249117, 'Valid Loss': 0.6928980621424589, 'Validation Metric': {'Precision': 0.3673469387755102, 'Recall': 0.6, 'F1': 0.45569620253164556, 'Acc': 0.49411764705882355}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6942370708172138, 'Valid Loss': 0.6916547498919747, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.5, 'F1': 0.47619047619047616, 'Acc': 0.611764705882353}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6923019950206463, 'Valid Loss': 0.6897399723529816, 'Validation Metric': {'Precision': 0.29411764705882354, 'Recall': 0.16666666666666666, 'F1': 0.21276595744680848, 'Acc': 0.5647058823529412}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6914853875453656, 'Valid Loss': 0.689588338136673, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.3333333333333333, 'F1': 0.3773584905660377, 'Acc': 0.611764705882353}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6880673619417044, 'Valid Loss': 0.6893353055823933, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.43333333333333335, 'F1': 0.43333333333333335, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6804373475221487, 'Valid Loss': 0.6873534240505912, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.4, 'F1': 0.4444444444444445, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.3670886075949367, 'Recall': 0.9666666666666667, 'F1': 0.5321100917431193, 'Acc': 0.4}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6854641015713031, 'Valid Loss': 0.6876303661953319, 'Validation Metric': {'Precision': 0.48717948717948717, 'Recall': 0.6333333333333333, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.48717948717948717, 'Recall': 0.6333333333333333, 'F1': 0.5507246376811593, 'Acc': 0.6352941176470588}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6763531978313739, 'Valid Loss': 0.6857837032188069, 'Validation Metric': {'Precision': 0.4772727272727273, 'Recall': 0.7, 'F1': 0.5675675675675677, 'Acc': 0.6235294117647059}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4772727272727273, 'Recall': 0.7, 'F1': 0.5675675675675677, 'Acc': 0.6235294117647059}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6745412606459398, 'Valid Loss': 0.6814367391846397, 'Validation Metric': {'Precision': 0.4878048780487805, 'Recall': 0.6666666666666666, 'F1': 0.5633802816901409, 'Acc': 0.6352941176470588}}
Best validation metric so far: {'Precision': 0.4772727272727273, 'Recall': 0.7, 'F1': 0.5675675675675677, 'Acc': 0.6235294117647059}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6613001484137315, 'Valid Loss': 0.6785416088320992, 'Validation Metric': {'Precision': 0.4772727272727273, 'Recall': 0.7, 'F1': 0.5675675675675677, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.4772727272727273, 'Recall': 0.7, 'F1': 0.5675675675675677, 'Acc': 0.6235294117647059}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6439395528573256, 'Valid Loss': 0.6767436428503557, 'Validation Metric': {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6168758869171143, 'Valid Loss': 0.6709004125811837, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.8333333333333334, 'F1': 0.5882352941176471, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5947214044057406, 'Valid Loss': 0.6629748994653876, 'Validation Metric': {'Precision': 0.45098039215686275, 'Recall': 0.7666666666666667, 'F1': 0.5679012345679013, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5759650225822742, 'Valid Loss': 0.6603639857335524, 'Validation Metric': {'Precision': 0.45098039215686275, 'Recall': 0.7666666666666667, 'F1': 0.5679012345679013, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5591247278910417, 'Valid Loss': 0.6587491468949751, 'Validation Metric': {'Precision': 0.46, 'Recall': 0.7666666666666667, 'F1': 0.575, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5583335468402275, 'Valid Loss': 0.6579385128888217, 'Validation Metric': {'Precision': 0.4489795918367347, 'Recall': 0.7333333333333333, 'F1': 0.5569620253164558, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.4716981132075472, 'Recall': 0.8333333333333334, 'F1': 0.6024096385542169, 'Acc': 0.611764705882353}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.46511627906976744, 'Recall': 0.625, 'F1': 0.5333333333333334, 'Acc': 0.5882352941176471}; Test loss: 0.692894152619622
