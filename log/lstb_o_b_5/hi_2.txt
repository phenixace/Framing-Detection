Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='hi')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6937092808740479, 'Valid Loss': 0.7035153860395605, 'Validation Metric': {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7012211467538562, 'Valid Loss': 0.7027325061234561, 'Validation Metric': {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7015914980854306, 'Valid Loss': 0.7056552930311724, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7068702386958259, 'Valid Loss': 0.7097183980725028, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7097111567854881, 'Valid Loss': 0.7200657589869066, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7045962741332394, 'Valid Loss': 0.7369008551944386, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6991143498037543, 'Valid Loss': 0.7434190620075573, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6897911434727055, 'Valid Loss': 0.7436682852831754, 'Validation Metric': {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6650417872837612, 'Valid Loss': 0.7787220180034637, 'Validation Metric': {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5861293084121176, 'Valid Loss': 1.1483628424731167, 'Validation Metric': {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.49703882155673845, 'Valid Loss': 0.8625287982550535, 'Validation Metric': {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.35931246754314217, 'Valid Loss': 0.679863914847374, 'Validation Metric': {'Precision': 0.1, 'Recall': 0.375, 'F1': 0.15789473684210528, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.24922833791268723, 'Valid Loss': 0.5572497099637985, 'Validation Metric': {'Precision': 0.07142857142857142, 'Recall': 0.125, 'F1': 0.09090909090909091, 'Acc': 0.7647058823529411}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18419707034315383, 'Valid Loss': 0.47550421817736194, 'Validation Metric': {'Precision': 0.1, 'Recall': 0.125, 'F1': 0.11111111111111112, 'Acc': 0.8117647058823529}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.14481410580421133, 'Valid Loss': 0.4199498187411915, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 0.125, 'F1': 0.11764705882352941, 'Acc': 0.8235294117647058}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.11042527994140983, 'Valid Loss': 0.3940747654573484, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8235294117647058}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.09237171170700874, 'Valid Loss': 0.38086075301874767, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.084388294090916, 'Valid Loss': 0.3746188589456407, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8470588235294118}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.07287415669166616, 'Valid Loss': 0.37183528393507004, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8470588235294118}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.06924454859524433, 'Valid Loss': 0.37010598995468835, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8588235294117647}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.35294117647058826}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.12121212121212122, 'Recall': 1.0, 'F1': 0.21621621621621626, 'Acc': 0.32558139534883723}; Test loss: 0.8356220708651976
