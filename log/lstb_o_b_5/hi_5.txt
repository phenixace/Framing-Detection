Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='hi')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6919878073360609, 'Valid Loss': 0.7038942548361692, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6996095869852149, 'Valid Loss': 0.7029486704956401, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7042017040045365, 'Valid Loss': 0.70419365438548, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7047944296961245, 'Valid Loss': 0.7094959914684296, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7064749256424282, 'Valid Loss': 0.7243719778277657, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7057522939599079, 'Valid Loss': 0.7360427894375541, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.697062885761261, 'Valid Loss': 0.7448920011520386, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6781506525433582, 'Valid Loss': 0.7666816765611822, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5804619581803031, 'Valid Loss': 1.2908894257111982, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.44634456634521485, 'Valid Loss': 0.8093177432363684, 'Validation Metric': {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.36046511627906974}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 0.875, 'F1': 0.20289855072463767, 'Acc': 0.36046511627906974}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.2825534600602544, 'Valid Loss': 0.5548831752755425, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.17562172247663788, 'Valid Loss': 0.40313173830509186, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.11382576293595459, 'Valid Loss': 0.32313541627743025, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.07868191674351692, 'Valid Loss': 0.29632654633711686, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.0626408759828495, 'Valid Loss': 0.2839793070134791, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.04693250737112501, 'Valid Loss': 0.28462858802892943, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.04009492976348037, 'Valid Loss': 0.28584427310323174, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.033785233573745126, 'Valid Loss': 0.28855007590556686, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.031884462062431417, 'Valid Loss': 0.2908859315582297, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.027716422931331655, 'Valid Loss': 0.292203468778594, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.75, 'F1': 0.375, 'Acc': 0.7674418604651163}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.25925925925925924, 'Recall': 0.5, 'F1': 0.3414634146341463, 'Acc': 0.6823529411764706}; Test loss: 0.624458597464995
