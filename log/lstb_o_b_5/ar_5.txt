Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='ar')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6958622092550452, 'Valid Loss': 0.6949881586161527, 'Validation Metric': {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6928588386737939, 'Valid Loss': 0.694668097929521, 'Validation Metric': {'Precision': 0.4235294117647059, 'Recall': 0.972972972972973, 'F1': 0.5901639344262295, 'Acc': 0.4186046511627907}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6939731854380984, 'Valid Loss': 0.6940956088629636, 'Validation Metric': {'Precision': 0.42168674698795183, 'Recall': 0.9459459459459459, 'F1': 0.5833333333333334, 'Acc': 0.4186046511627907}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6929355950066538, 'Valid Loss': 0.6926932741295208, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.4864864864864865, 'F1': 0.5142857142857143, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6926748228795601, 'Valid Loss': 0.6928595331582156, 'Validation Metric': {'Precision': 0.4523809523809524, 'Recall': 0.5135135135135135, 'F1': 0.48101265822784806, 'Acc': 0.5232558139534884}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6949600189021139, 'Valid Loss': 0.6929308582435955, 'Validation Metric': {'Precision': 0.42, 'Recall': 0.5675675675675675, 'F1': 0.4827586206896552, 'Acc': 0.47674418604651164}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6902591613205996, 'Valid Loss': 0.6931746466593309, 'Validation Metric': {'Precision': 0.42028985507246375, 'Recall': 0.7837837837837838, 'F1': 0.5471698113207547, 'Acc': 0.4418604651162791}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6917014754179752, 'Valid Loss': 0.6919548457319086, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.4864864864864865, 'F1': 0.5217391304347827, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.688677660443566, 'Valid Loss': 0.6908038394017653, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.08108108108108109, 'F1': 0.14634146341463414, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6869690445336428, 'Valid Loss': 0.6908453242345289, 'Validation Metric': {'Precision': 0.631578947368421, 'Recall': 0.32432432432432434, 'F1': 0.42857142857142855, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.684791464697231, 'Valid Loss': 0.6892711872404272, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.10810810810810811, 'F1': 0.17777777777777778, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6789972637638901, 'Valid Loss': 0.6886334392157468, 'Validation Metric': {'Precision': 0.6470588235294118, 'Recall': 0.2972972972972973, 'F1': 0.40740740740740744, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6816051891355803, 'Valid Loss': 0.6896906928582625, 'Validation Metric': {'Precision': 0.49019607843137253, 'Recall': 0.6756756756756757, 'F1': 0.5681818181818181, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.66542331106735, 'Valid Loss': 0.6862457990646362, 'Validation Metric': {'Precision': 0.5581395348837209, 'Recall': 0.6486486486486487, 'F1': 0.6, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6528223789099491, 'Valid Loss': 0.6831111718307842, 'Validation Metric': {'Precision': 0.5106382978723404, 'Recall': 0.6486486486486487, 'F1': 0.5714285714285715, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6365531701030154, 'Valid Loss': 0.677380995316939, 'Validation Metric': {'Precision': 0.5333333333333333, 'Recall': 0.6486486486486487, 'F1': 0.5853658536585367, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.43023255813953487, 'Recall': 1.0, 'F1': 0.6016260162601627, 'Acc': 0.43023255813953487}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6139789052081831, 'Valid Loss': 0.6691905178806998, 'Validation Metric': {'Precision': 0.5416666666666666, 'Recall': 0.7027027027027027, 'F1': 0.611764705882353, 'Acc': 0.6162790697674418}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7027027027027027, 'F1': 0.611764705882353, 'Acc': 0.6162790697674418}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5966088351878253, 'Valid Loss': 0.6629124825650995, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.6216216216216216, 'F1': 0.5822784810126581, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7027027027027027, 'F1': 0.611764705882353, 'Acc': 0.6162790697674418}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5854046669873324, 'Valid Loss': 0.6593243019147352, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.6216216216216216, 'F1': 0.5822784810126581, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7027027027027027, 'F1': 0.611764705882353, 'Acc': 0.6162790697674418}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5774286312587333, 'Valid Loss': 0.657903714613481, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.6216216216216216, 'F1': 0.5822784810126581, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5416666666666666, 'Recall': 0.7027027027027027, 'F1': 0.611764705882353, 'Acc': 0.6162790697674418}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.48, 'Recall': 0.8, 'F1': 0.6, 'Acc': 0.6235294117647059}; Test loss: 0.6692077463323419
