Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='mo')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6912083923816681, 'Valid Loss': 0.704035141251304, 'Validation Metric': {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6977201206930752, 'Valid Loss': 0.7037923525680195, 'Validation Metric': {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7029547994506771, 'Valid Loss': 0.7058362337675962, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7045384080245577, 'Valid Loss': 0.7103850055824626, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7026750286077631, 'Valid Loss': 0.7312443825331602, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6819649862832037, 'Valid Loss': 0.8181749853220853, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6390346855182072, 'Valid Loss': 1.4667450894008984, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5132170703647465, 'Valid Loss': 1.2726274105635556, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 1.0, 'F1': 0.15217391304347827, 'Acc': 0.09302325581395349}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.40592516040236787, 'Valid Loss': 0.8449632335792888, 'Validation Metric': {'Precision': 0.11290322580645161, 'Recall': 1.0, 'F1': 0.2028985507246377, 'Acc': 0.36046511627906974}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11290322580645161, 'Recall': 1.0, 'F1': 0.2028985507246377, 'Acc': 0.36046511627906974}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.25339266779864655, 'Valid Loss': 0.5326409380544316, 'Validation Metric': {'Precision': 0.22580645161290322, 'Recall': 1.0, 'F1': 0.3684210526315789, 'Acc': 0.7209302325581395}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.22580645161290322, 'Recall': 1.0, 'F1': 0.3684210526315789, 'Acc': 0.7209302325581395}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.15825449704224692, 'Valid Loss': 0.26564674790609966, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.10026982996677017, 'Valid Loss': 0.18059982427141882, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.7142857142857143, 'F1': 0.7142857142857143, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.07133704765924606, 'Valid Loss': 0.14120879049666904, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5714285714285714, 'F1': 0.6153846153846153, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.058058261132702745, 'Valid Loss': 0.12682727351784706, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5714285714285714, 'F1': 0.6153846153846153, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.04672632167308495, 'Valid Loss': 0.12099375838244503, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.5714285714285714, 'F1': 0.6666666666666666, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.040264362686088885, 'Valid Loss': 0.12293798594989559, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.42857142857142855, 'F1': 0.5454545454545454, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.03616322127395663, 'Valid Loss': 0.12207810788161376, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.42857142857142855, 'F1': 0.5454545454545454, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.03159299747343978, 'Valid Loss': 0.12372428881512447, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.2857142857142857, 'F1': 0.4, 'Acc': 0.9302325581395349}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.030695664515750933, 'Valid Loss': 0.12609948222102088, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.2857142857142857, 'F1': 0.4, 'Acc': 0.9302325581395349}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.02744012696925422, 'Valid Loss': 0.12666181491857226, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.2857142857142857, 'F1': 0.4, 'Acc': 0.9302325581395349}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.8571428571428571, 'F1': 0.7999999999999999, 'Acc': 0.9651162790697675}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6363636363636364, 'Recall': 0.6363636363636364, 'F1': 0.6363636363636364, 'Acc': 0.9058823529411765}; Test loss: 0.34330288794907654
