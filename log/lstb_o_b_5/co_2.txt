Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='co')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6961398990381331, 'Valid Loss': 0.6910996708002958, 'Validation Metric': {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.696599929815247, 'Valid Loss': 0.6914355023340746, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.9230769230769231, 'F1': 0.7218045112781956, 'Acc': 0.5647058823529412}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6957706922576541, 'Valid Loss': 0.692283803766424, 'Validation Metric': {'Precision': 0.5857142857142857, 'Recall': 0.7884615384615384, 'F1': 0.6721311475409837, 'Acc': 0.5294117647058824}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6951164929639726, 'Valid Loss': 0.6940027556636117, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.40384615384615385, 'F1': 0.4941176470588235, 'Acc': 0.49411764705882355}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6977782795826594, 'Valid Loss': 0.6957293450832367, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.07692307692307693, 'F1': 0.13333333333333336, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7006280003559022, 'Valid Loss': 0.6992899179458618, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6981224999541328, 'Valid Loss': 0.6980931894345717, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6929927645694642, 'Valid Loss': 0.6981782642277804, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6894252619573048, 'Valid Loss': 0.6977491568435322, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6855296010062808, 'Valid Loss': 0.6979962316426364, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.057692307692307696, 'F1': 0.10526315789473685, 'Acc': 0.4}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6705757684650875, 'Valid Loss': 0.6990864222699945, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.07692307692307693, 'F1': 0.14035087719298248, 'Acc': 0.4235294117647059}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6369009454335485, 'Valid Loss': 0.7199392562562769, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.07692307692307693, 'F1': 0.14035087719298248, 'Acc': 0.4235294117647059}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5840865937726838, 'Valid Loss': 0.7240225740454413, 'Validation Metric': {'Precision': 0.7857142857142857, 'Recall': 0.21153846153846154, 'F1': 0.3333333333333333, 'Acc': 0.4823529411764706}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5198824749816031, 'Valid Loss': 0.686586928638545, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.40384615384615385, 'F1': 0.5316455696202531, 'Acc': 0.5647058823529412}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.48044463495413464, 'Valid Loss': 0.6412558704614639, 'Validation Metric': {'Precision': 0.7674418604651163, 'Recall': 0.6346153846153846, 'F1': 0.6947368421052632, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4268754271879083, 'Valid Loss': 0.6199678399346091, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.6730769230769231, 'F1': 0.6930693069306932, 'Acc': 0.6352941176470588}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.389090791876827, 'Valid Loss': 0.6109221672469919, 'Validation Metric': {'Precision': 0.7254901960784313, 'Recall': 0.7115384615384616, 'F1': 0.7184466019417477, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.36461822865974336, 'Valid Loss': 0.6043119423768737, 'Validation Metric': {'Precision': 0.7115384615384616, 'Recall': 0.7115384615384616, 'F1': 0.7115384615384616, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.352185179789861, 'Valid Loss': 0.5982771901921793, 'Validation Metric': {'Precision': 0.7169811320754716, 'Recall': 0.7307692307692307, 'F1': 0.7238095238095238, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.33976202582319576, 'Valid Loss': 0.5968748459761793, 'Validation Metric': {'Precision': 0.7169811320754716, 'Recall': 0.7307692307692307, 'F1': 0.7238095238095238, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5647058823529412, 'Recall': 0.9795918367346939, 'F1': 0.7164179104477613, 'Acc': 0.5581395348837209}; Test loss: 0.691811119968241
