Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='hi')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6936373863599997, 'Valid Loss': 0.7029371017759497, 'Validation Metric': {'Precision': 0.08235294117647059, 'Recall': 0.875, 'F1': 0.15053763440860213, 'Acc': 0.08139534883720931}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 0.875, 'F1': 0.15053763440860213, 'Acc': 0.08139534883720931}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7002975091470026, 'Valid Loss': 0.7024316083301197, 'Validation Metric': {'Precision': 0.08235294117647059, 'Recall': 0.875, 'F1': 0.15053763440860213, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08235294117647059, 'Recall': 0.875, 'F1': 0.15053763440860213, 'Acc': 0.08139534883720931}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7046524834843864, 'Valid Loss': 0.7047052139585669, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7063986421686358, 'Valid Loss': 0.7094726372848857, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7074326097437765, 'Valid Loss': 0.7216492782939564, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7073368709699243, 'Valid Loss': 0.736569575288079, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.7034185022379444, 'Valid Loss': 0.7427054155956615, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6893833216312713, 'Valid Loss': 0.7543943686918779, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6700667219351878, 'Valid Loss': 0.7780618532137438, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6122961766951907, 'Valid Loss': 0.9912216446616433, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5049321677832477, 'Valid Loss': 0.8493965864181519, 'Validation Metric': {'Precision': 0.11764705882352941, 'Recall': 1.0, 'F1': 0.21052631578947367, 'Acc': 0.3023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11764705882352941, 'Recall': 1.0, 'F1': 0.21052631578947367, 'Acc': 0.3023255813953488}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.39094253860216227, 'Valid Loss': 0.6475103321400556, 'Validation Metric': {'Precision': 0.13513513513513514, 'Recall': 0.625, 'F1': 0.22222222222222224, 'Acc': 0.5930232558139535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13513513513513514, 'Recall': 0.625, 'F1': 0.22222222222222224, 'Acc': 0.5930232558139535}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2813499683959294, 'Valid Loss': 0.5061746131290089, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.5, 'F1': 0.28571428571428575, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.5, 'F1': 0.28571428571428575, 'Acc': 0.7674418604651163}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.21176585426504632, 'Valid Loss': 0.41790035502477124, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1657245842888292, 'Valid Loss': 0.36470548198981717, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1344762699332385, 'Valid Loss': 0.3283421674912626, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.25, 'F1': 0.3076923076923077, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.11225553832750405, 'Valid Loss': 0.3076255561953241, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.10053683632770472, 'Valid Loss': 0.29572867263447156, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.25, 'F1': 0.36363636363636365, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.09047950245440006, 'Valid Loss': 0.28939533165910025, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.25, 'F1': 0.36363636363636365, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.08665254339575768, 'Valid Loss': 0.2850766454569318, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.25, 'F1': 0.36363636363636365, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0.36363636363636365, 'Recall': 0.5, 'F1': 0.4210526315789474, 'Acc': 0.872093023255814}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.3333333333333333, 'Recall': 0.09090909090909091, 'F1': 0.14285714285714288, 'Acc': 0.8604651162790697}; Test loss: 0.4114817225120284
