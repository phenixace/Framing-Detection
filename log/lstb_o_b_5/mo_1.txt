Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/lstb_o_b_5/', lr=2e-06, max_len=256, n_passages=5, random_seed=1042, specified_label='mo')
parameters: 148667138
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6912775920784991, 'Valid Loss': 0.7032756101001393, 'Validation Metric': {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6993353527525197, 'Valid Loss': 0.7025950442660939, 'Validation Metric': {'Precision': 0.12048192771084337, 'Recall': 0.9090909090909091, 'F1': 0.21276595744680848, 'Acc': 0.12941176470588237}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7011190782422605, 'Valid Loss': 0.7041991705244238, 'Validation Metric': {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7027102926503057, 'Valid Loss': 0.7100409865379333, 'Validation Metric': {'Precision': 0.12941176470588237, 'Recall': 1.0, 'F1': 0.22916666666666669, 'Acc': 0.12941176470588237}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7014680955720984, 'Valid Loss': 0.7264858240431006, 'Validation Metric': {'Precision': 0.12941176470588237, 'Recall': 1.0, 'F1': 0.22916666666666669, 'Acc': 0.12941176470588237}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6937778400338215, 'Valid Loss': 0.7689493921670046, 'Validation Metric': {'Precision': 0.12941176470588237, 'Recall': 1.0, 'F1': 0.22916666666666669, 'Acc': 0.12941176470588237}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6377679020166397, 'Valid Loss': 1.2379479895938525, 'Validation Metric': {'Precision': 0.12941176470588237, 'Recall': 1.0, 'F1': 0.22916666666666669, 'Acc': 0.12941176470588237}}
Best validation metric so far: {'Precision': 0.13095238095238096, 'Recall': 1.0, 'F1': 0.23157894736842108, 'Acc': 0.1411764705882353}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5463273819374002, 'Valid Loss': 1.2374181855808606, 'Validation Metric': {'Precision': 0.13253012048192772, 'Recall': 1.0, 'F1': 0.23404255319148937, 'Acc': 0.15294117647058825}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.13253012048192772, 'Recall': 1.0, 'F1': 0.23404255319148937, 'Acc': 0.15294117647058825}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.3885183228422766, 'Valid Loss': 0.9481560479510914, 'Validation Metric': {'Precision': 0.16923076923076924, 'Recall': 1.0, 'F1': 0.2894736842105263, 'Acc': 0.36470588235294116}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.16923076923076924, 'Recall': 1.0, 'F1': 0.2894736842105263, 'Acc': 0.36470588235294116}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2489957913108494, 'Valid Loss': 0.5368425622582436, 'Validation Metric': {'Precision': 0.2571428571428571, 'Recall': 0.8181818181818182, 'F1': 0.39130434782608686, 'Acc': 0.6705882352941176}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2571428571428571, 'Recall': 0.8181818181818182, 'F1': 0.39130434782608686, 'Acc': 0.6705882352941176}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.1561378348780715, 'Valid Loss': 0.3369533568620682, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.1023465214540129, 'Valid Loss': 0.2739052902907133, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5454545454545454, 'F1': 0.6, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.07628319299091464, 'Valid Loss': 0.2533533794974739, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.5454545454545454, 'F1': 0.631578947368421, 'Acc': 0.9176470588235294}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.0603218043304008, 'Valid Loss': 0.2510037533938885, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.047160469408592455, 'Valid Loss': 0.25750816469504073, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.03906418644701657, 'Valid Loss': 0.2649322891269218, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.036540910974144934, 'Valid Loss': 0.27221445277841255, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.03218895371031502, 'Valid Loss': 0.278897645375268, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.030651806339459575, 'Valid Loss': 0.28375688730739057, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.027916403629047716, 'Valid Loss': 0.2868456231133843, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.36363636363636365, 'F1': 0.4705882352941177, 'Acc': 0.8941176470588236}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.2857142857142857, 'Recall': 0.8, 'F1': 0.4210526315789473, 'Acc': 0.8705882352941177}; Test loss: 0.3436073068190705
