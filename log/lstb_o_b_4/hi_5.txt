Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='hi')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.695326573889831, 'Valid Loss': 0.7273293137550354, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6962770346937508, 'Valid Loss': 0.7259172905575145, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7004616836021686, 'Valid Loss': 0.7223498712886464, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7073289361493341, 'Valid Loss': 0.717683347788724, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7045293111225654, 'Valid Loss': 0.7167330167510293, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7062270805753511, 'Valid Loss': 0.713754269209775, 'Validation Metric': {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}}
Best validation metric so far: {'Precision': 0.09302325581395349, 'Recall': 1.0, 'F1': 0.1702127659574468, 'Acc': 0.09302325581395349}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6988823639935461, 'Valid Loss': 0.7113697257908908, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.10465116279069768}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6939814368198658, 'Valid Loss': 0.7108835848894987, 'Validation Metric': {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.12790697674418605}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.12790697674418605}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6841627801286763, 'Valid Loss': 0.7074690948833119, 'Validation Metric': {'Precision': 0.0945945945945946, 'Recall': 0.875, 'F1': 0.17073170731707316, 'Acc': 0.20930232558139536}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.12790697674418605}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.672000705168165, 'Valid Loss': 0.7018370736729015, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 0.75, 'F1': 0.19354838709677416, 'Acc': 0.4186046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1111111111111111, 'Recall': 0.75, 'F1': 0.19354838709677416, 'Acc': 0.4186046511627907}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6284337449690391, 'Valid Loss': 0.7254882292314009, 'Validation Metric': {'Precision': 0.10526315789473684, 'Recall': 0.75, 'F1': 0.1846153846153846, 'Acc': 0.38372093023255816}}
Best validation metric so far: {'Precision': 0.1111111111111111, 'Recall': 0.75, 'F1': 0.19354838709677416, 'Acc': 0.4186046511627907}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5688397008283385, 'Valid Loss': 0.6770384528420188, 'Validation Metric': {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.46985209013881357, 'Valid Loss': 0.5966495519334619, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.625, 'F1': 0.30303030303030304, 'Acc': 0.7325581395348837}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.625, 'F1': 0.30303030303030304, 'Acc': 0.7325581395348837}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.37934434863513916, 'Valid Loss': 0.5005356696518984, 'Validation Metric': {'Precision': 0.21428571428571427, 'Recall': 0.375, 'F1': 0.2727272727272727, 'Acc': 0.813953488372093}}
Best validation metric so far: {'Precision': 0.2, 'Recall': 0.625, 'F1': 0.30303030303030304, 'Acc': 0.7325581395348837}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.296410815982983, 'Valid Loss': 0.4314298223365437, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.24326346467795043, 'Valid Loss': 0.39489763704213227, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.25, 'F1': 0.25, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2098766684789082, 'Valid Loss': 0.36562182009220123, 'Validation Metric': {'Precision': 0.14285714285714285, 'Recall': 0.125, 'F1': 0.13333333333333333, 'Acc': 0.8488372093023255}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18460925687746754, 'Valid Loss': 0.3471374592997811, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.125, 'F1': 0.14285714285714288, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.16227667162130618, 'Valid Loss': 0.33881778540936386, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.125, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.15708044518170686, 'Valid Loss': 0.3343103765086694, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.125, 'F1': 0.15384615384615385, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.21428571428571427, 'Recall': 0.21428571428571427, 'F1': 0.21428571428571427, 'Acc': 0.7411764705882353}; Test loss: 0.5236947563561526
