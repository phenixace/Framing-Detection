Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='co')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6946986332535744, 'Valid Loss': 0.6781649047678168, 'Validation Metric': {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6970484375953674, 'Valid Loss': 0.6792106845162131, 'Validation Metric': {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6963548377156258, 'Valid Loss': 0.6822339729829268, 'Validation Metric': {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6936451882123947, 'Valid Loss': 0.6859084638682279, 'Validation Metric': {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6932597398757935, 'Valid Loss': 0.6889846920967102, 'Validation Metric': {'Precision': 0.6829268292682927, 'Recall': 0.9491525423728814, 'F1': 0.7943262411347518, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6916484788060189, 'Valid Loss': 0.6941217942671343, 'Validation Metric': {'Precision': 0.8421052631578947, 'Recall': 0.2711864406779661, 'F1': 0.41025641025641024, 'Acc': 0.4588235294117647}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.694982048869133, 'Valid Loss': 0.6958656311035156, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.05084745762711865, 'F1': 0.0967741935483871, 'Acc': 0.3411764705882353}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6899855226278305, 'Valid Loss': 0.6975634694099426, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.01694915254237288, 'F1': 0.03333333333333333, 'Acc': 0.3176470588235294}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6886218905448913, 'Valid Loss': 0.6983220739798113, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.01694915254237288, 'F1': 0.03333333333333333, 'Acc': 0.3176470588235294}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6856058016419411, 'Valid Loss': 0.696436649019068, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.0847457627118644, 'F1': 0.15625, 'Acc': 0.36470588235294116}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6845509901642799, 'Valid Loss': 0.6921721751039679, 'Validation Metric': {'Precision': 0.8275862068965517, 'Recall': 0.4067796610169492, 'F1': 0.5454545454545454, 'Acc': 0.5294117647058824}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6797090396285057, 'Valid Loss': 0.689363257451491, 'Validation Metric': {'Precision': 0.8125, 'Recall': 0.4406779661016949, 'F1': 0.5714285714285714, 'Acc': 0.5411764705882353}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6738846600055695, 'Valid Loss': 0.6854318109425631, 'Validation Metric': {'Precision': 0.8108108108108109, 'Recall': 0.5084745762711864, 'F1': 0.6249999999999999, 'Acc': 0.5764705882352941}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6635150820016861, 'Valid Loss': 0.6784869920123707, 'Validation Metric': {'Precision': 0.7959183673469388, 'Recall': 0.6610169491525424, 'F1': 0.7222222222222222, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6604062333703041, 'Valid Loss': 0.6730301976203918, 'Validation Metric': {'Precision': 0.7916666666666666, 'Recall': 0.6440677966101694, 'F1': 0.7102803738317757, 'Acc': 0.6352941176470588}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6494412809610367, 'Valid Loss': 0.6649332046508789, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.6779661016949152, 'F1': 0.7339449541284404, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.632006399333477, 'Valid Loss': 0.6553021506829695, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.6779661016949152, 'F1': 0.7339449541284404, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.622495000064373, 'Valid Loss': 0.6474038850177418, 'Validation Metric': {'Precision': 0.8113207547169812, 'Recall': 0.7288135593220338, 'F1': 0.7678571428571428, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6116312742233276, 'Valid Loss': 0.6400776397098195, 'Validation Metric': {'Precision': 0.8148148148148148, 'Recall': 0.7457627118644068, 'F1': 0.7787610619469028, 'Acc': 0.7058823529411765}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6053306356072425, 'Valid Loss': 0.6374334313652732, 'Validation Metric': {'Precision': 0.8148148148148148, 'Recall': 0.7457627118644068, 'F1': 0.7787610619469028, 'Acc': 0.7058823529411765}}
Best validation metric so far: {'Precision': 0.6941176470588235, 'Recall': 1.0, 'F1': 0.8194444444444444, 'Acc': 0.6941176470588235}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.611764705882353, 'Recall': 1.0, 'F1': 0.759124087591241, 'Acc': 0.611764705882353}; Test loss: 0.6840808716687289
