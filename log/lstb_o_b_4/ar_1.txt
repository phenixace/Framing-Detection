Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='ar')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6930787256269744, 'Valid Loss': 0.705043760212985, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 1.0, 'F1': 0.5217391304347826, 'Acc': 0.35294117647058826}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 1.0, 'F1': 0.5217391304347826, 'Acc': 0.35294117647058826}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6956648411172809, 'Valid Loss': 0.7038539322939786, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 1.0, 'F1': 0.5217391304347826, 'Acc': 0.35294117647058826}}
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 1.0, 'F1': 0.5217391304347826, 'Acc': 0.35294117647058826}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.692242853569262, 'Valid Loss': 0.7002677863294428, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 1.0, 'F1': 0.5217391304347826, 'Acc': 0.35294117647058826}}
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 1.0, 'F1': 0.5217391304347826, 'Acc': 0.35294117647058826}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6964629996906627, 'Valid Loss': 0.6955891630866311, 'Validation Metric': {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6909384348175742, 'Valid Loss': 0.6919846317984841, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.6666666666666666, 'F1': 0.5, 'Acc': 0.5294117647058824}}
Best validation metric so far: {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6864789706287961, 'Valid Loss': 0.6905992952260104, 'Validation Metric': {'Precision': 0.45714285714285713, 'Recall': 0.5333333333333333, 'F1': 0.4923076923076923, 'Acc': 0.611764705882353}}
Best validation metric so far: {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6911790370941162, 'Valid Loss': 0.6903722394596447, 'Validation Metric': {'Precision': 0.45, 'Recall': 0.6, 'F1': 0.5142857142857143, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6879642352913365, 'Valid Loss': 0.6905931830406189, 'Validation Metric': {'Precision': 0.4318181818181818, 'Recall': 0.6333333333333333, 'F1': 0.5135135135135135, 'Acc': 0.5764705882352941}}
Best validation metric so far: {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6852251200964956, 'Valid Loss': 0.6882017471573569, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.4666666666666667, 'F1': 0.5, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.36585365853658536, 'Recall': 1.0, 'F1': 0.5357142857142857, 'Acc': 0.38823529411764707}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.686110642823306, 'Valid Loss': 0.6865840066562999, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.5, 'F1': 0.5454545454545454, 'Acc': 0.7058823529411765}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.5, 'F1': 0.5454545454545454, 'Acc': 0.7058823529411765}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6839360576687437, 'Valid Loss': 0.6840545047413219, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.4666666666666667, 'F1': 0.5490196078431373, 'Acc': 0.7294117647058823}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.4666666666666667, 'F1': 0.5490196078431373, 'Acc': 0.7294117647058823}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.682646272760449, 'Valid Loss': 0.6815513914281671, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.4666666666666667, 'F1': 0.56, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7, 'Recall': 0.4666666666666667, 'F1': 0.56, 'Acc': 0.7411764705882353}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6808479157361117, 'Valid Loss': 0.6802417256615378, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.5, 'F1': 0.5454545454545454, 'Acc': 0.7058823529411765}}
Best validation metric so far: {'Precision': 0.7, 'Recall': 0.4666666666666667, 'F1': 0.56, 'Acc': 0.7411764705882353}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6770203384486112, 'Valid Loss': 0.6789983023296703, 'Validation Metric': {'Precision': 0.6206896551724138, 'Recall': 0.6, 'F1': 0.6101694915254238, 'Acc': 0.7294117647058823}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.6, 'F1': 0.6101694915254238, 'Acc': 0.7294117647058823}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6685685587651802, 'Valid Loss': 0.6765954006801952, 'Validation Metric': {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6653761899832523, 'Valid Loss': 0.6740434874187816, 'Validation Metric': {'Precision': 0.5757575757575758, 'Recall': 0.6333333333333333, 'F1': 0.6031746031746033, 'Acc': 0.7058823529411765}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6596909905924941, 'Valid Loss': 0.6724403554742987, 'Validation Metric': {'Precision': 0.5405405405405406, 'Recall': 0.6666666666666666, 'F1': 0.5970149253731343, 'Acc': 0.6823529411764706}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6611843018820791, 'Valid Loss': 0.6699836145747792, 'Validation Metric': {'Precision': 0.5405405405405406, 'Recall': 0.6666666666666666, 'F1': 0.5970149253731343, 'Acc': 0.6823529411764706}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.653338145125996, 'Valid Loss': 0.6684324741363525, 'Validation Metric': {'Precision': 0.5526315789473685, 'Recall': 0.7, 'F1': 0.6176470588235295, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6513299436280222, 'Valid Loss': 0.6675796183672819, 'Validation Metric': {'Precision': 0.5526315789473685, 'Recall': 0.7, 'F1': 0.6176470588235295, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4230769230769231, 'Recall': 0.34375, 'F1': 0.3793103448275862, 'Acc': 0.5764705882352941}; Test loss: 0.6835533488880504
