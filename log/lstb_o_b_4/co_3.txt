Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='co')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6954229256001915, 'Valid Loss': 0.6875100298361345, 'Validation Metric': {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6951955847623872, 'Valid Loss': 0.6877646825530312, 'Validation Metric': {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6937221724812578, 'Valid Loss': 0.6884870258244601, 'Validation Metric': {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.692331141088067, 'Valid Loss': 0.6893531246618791, 'Validation Metric': {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.5697674418604651, 'Recall': 1.0, 'F1': 0.7259259259259259, 'Acc': 0.5697674418604651}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.692802906036377, 'Valid Loss': 0.691048876805739, 'Validation Metric': {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6956054233923191, 'Valid Loss': 0.6917013255032626, 'Validation Metric': {'Precision': 0.6304347826086957, 'Recall': 0.5918367346938775, 'F1': 0.6105263157894736, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.691941376139478, 'Valid Loss': 0.6921792897311124, 'Validation Metric': {'Precision': 0.7037037037037037, 'Recall': 0.3877551020408163, 'F1': 0.5, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6900906591880612, 'Valid Loss': 0.6922434405847029, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.24489795918367346, 'F1': 0.36363636363636365, 'Acc': 0.5116279069767442}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6861500914503889, 'Valid Loss': 0.69150986996564, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.30612244897959184, 'F1': 0.42857142857142855, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6835110187530518, 'Valid Loss': 0.6902416565201499, 'Validation Metric': {'Precision': 0.72, 'Recall': 0.3673469387755102, 'F1': 0.4864864864864865, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6789984979280611, 'Valid Loss': 0.6874133998697455, 'Validation Metric': {'Precision': 0.7419354838709677, 'Recall': 0.46938775510204084, 'F1': 0.5750000000000001, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6738933470191025, 'Valid Loss': 0.6825819557363336, 'Validation Metric': {'Precision': 0.725, 'Recall': 0.5918367346938775, 'F1': 0.6516853932584269, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6617367354834952, 'Valid Loss': 0.6760177395560525, 'Validation Metric': {'Precision': 0.6888888888888889, 'Recall': 0.6326530612244898, 'F1': 0.6595744680851063, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.644736308877061, 'Valid Loss': 0.6659348065202887, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.6530612244897959, 'F1': 0.6597938144329897, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6267077254086006, 'Valid Loss': 0.6561988592147827, 'Validation Metric': {'Precision': 0.6875, 'Recall': 0.673469387755102, 'F1': 0.6804123711340205, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6008607701557439, 'Valid Loss': 0.6485258557579734, 'Validation Metric': {'Precision': 0.6808510638297872, 'Recall': 0.6530612244897959, 'F1': 0.6666666666666666, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5789768237893175, 'Valid Loss': 0.6423105543309992, 'Validation Metric': {'Precision': 0.673469387755102, 'Recall': 0.673469387755102, 'F1': 0.673469387755102, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5536410881251823, 'Valid Loss': 0.6377840529788624, 'Validation Metric': {'Precision': 0.673469387755102, 'Recall': 0.673469387755102, 'F1': 0.673469387755102, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5519178684164838, 'Valid Loss': 0.635770938613198, 'Validation Metric': {'Precision': 0.673469387755102, 'Recall': 0.673469387755102, 'F1': 0.673469387755102, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5296863978955804, 'Valid Loss': 0.6347173452377319, 'Validation Metric': {'Precision': 0.673469387755102, 'Recall': 0.673469387755102, 'F1': 0.673469387755102, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5974025974025974, 'Recall': 0.9387755102040817, 'F1': 0.73015873015873, 'Acc': 0.6046511627906976}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6666666666666666, 'Recall': 0.8620689655172413, 'F1': 0.7518796992481203, 'Acc': 0.6162790697674418}; Test loss: 0.6904089288278059
