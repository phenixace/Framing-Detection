Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='co')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6977410614490509, 'Valid Loss': 0.6866920156912371, 'Validation Metric': {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6945054456591606, 'Valid Loss': 0.6869661428711631, 'Validation Metric': {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6923558935523033, 'Valid Loss': 0.6876982396299188, 'Validation Metric': {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6949160158634186, 'Valid Loss': 0.6887136155908758, 'Validation Metric': {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6937185198068618, 'Valid Loss': 0.6897455724802884, 'Validation Metric': {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6927823677659035, 'Valid Loss': 0.6908628940582275, 'Validation Metric': {'Precision': 0.6056338028169014, 'Recall': 0.86, 'F1': 0.7107438016528925, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6934719443321228, 'Valid Loss': 0.6913334456357089, 'Validation Metric': {'Precision': 0.6730769230769231, 'Recall': 0.7, 'F1': 0.6862745098039216, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6907056450843811, 'Valid Loss': 0.690602345900102, 'Validation Metric': {'Precision': 0.6842105263157895, 'Recall': 0.78, 'F1': 0.7289719626168225, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.689283873140812, 'Valid Loss': 0.6906013109467246, 'Validation Metric': {'Precision': 0.723404255319149, 'Recall': 0.68, 'F1': 0.7010309278350516, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6866108760237694, 'Valid Loss': 0.689419838515195, 'Validation Metric': {'Precision': 0.7254901960784313, 'Recall': 0.74, 'F1': 0.7326732673267328, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.5813953488372093, 'Recall': 1.0, 'F1': 0.7352941176470588, 'Acc': 0.5813953488372093}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6819806978106498, 'Valid Loss': 0.6875878572463989, 'Validation Metric': {'Precision': 0.7307692307692307, 'Recall': 0.76, 'F1': 0.7450980392156863, 'Acc': 0.6976744186046512}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7307692307692307, 'Recall': 0.76, 'F1': 0.7450980392156863, 'Acc': 0.6976744186046512}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6784330323338509, 'Valid Loss': 0.6849577155980197, 'Validation Metric': {'Precision': 0.6909090909090909, 'Recall': 0.76, 'F1': 0.7238095238095238, 'Acc': 0.6627906976744186}}
Best validation metric so far: {'Precision': 0.7307692307692307, 'Recall': 0.76, 'F1': 0.7450980392156863, 'Acc': 0.6976744186046512}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.672373853623867, 'Valid Loss': 0.6814228675582192, 'Validation Metric': {'Precision': 0.6724137931034483, 'Recall': 0.78, 'F1': 0.7222222222222223, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.7307692307692307, 'Recall': 0.76, 'F1': 0.7450980392156863, 'Acc': 0.6976744186046512}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6609613284468651, 'Valid Loss': 0.6749867038293318, 'Validation Metric': {'Precision': 0.6774193548387096, 'Recall': 0.84, 'F1': 0.75, 'Acc': 0.6744186046511628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6774193548387096, 'Recall': 0.84, 'F1': 0.75, 'Acc': 0.6744186046511628}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6469107553362846, 'Valid Loss': 0.6643890684301202, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.9, 'F1': 0.7826086956521738, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.9, 'F1': 0.7826086956521738, 'Acc': 0.7093023255813954}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6325507923960686, 'Valid Loss': 0.6535060080614957, 'Validation Metric': {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6105861037969589, 'Valid Loss': 0.6429978338154879, 'Validation Metric': {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5882421672344208, 'Valid Loss': 0.6376567374576222, 'Validation Metric': {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5757281661033631, 'Valid Loss': 0.6345082738182761, 'Validation Metric': {'Precision': 0.6984126984126984, 'Recall': 0.88, 'F1': 0.7787610619469026, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5626005195081234, 'Valid Loss': 0.6326592402024702, 'Validation Metric': {'Precision': 0.6984126984126984, 'Recall': 0.88, 'F1': 0.7787610619469026, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.703125, 'Recall': 0.9, 'F1': 0.7894736842105263, 'Acc': 0.7209302325581395}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.78125, 'Recall': 0.847457627118644, 'F1': 0.8130081300813008, 'Acc': 0.7294117647058823}; Test loss: 0.6345140500502153
