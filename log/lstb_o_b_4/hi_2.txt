Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='hi')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6962400291647229, 'Valid Loss': 0.7270522225986827, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6975254874144282, 'Valid Loss': 0.7255387956445868, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7005205335361617, 'Valid Loss': 0.7209702784364874, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7044366034013885, 'Valid Loss': 0.7144896550612017, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7050654089876583, 'Valid Loss': 0.7127910906618292, 'Validation Metric': {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}}
Best validation metric so far: {'Precision': 0.09411764705882353, 'Recall': 1.0, 'F1': 0.17204301075268816, 'Acc': 0.09411764705882353}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7046854730163302, 'Valid Loss': 0.7124039205637845, 'Validation Metric': {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.7011986353567669, 'Valid Loss': 0.710859168659557, 'Validation Metric': {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}}
Best validation metric so far: {'Precision': 0.09523809523809523, 'Recall': 1.0, 'F1': 0.17391304347826084, 'Acc': 0.10588235294117647}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6984274493796485, 'Valid Loss': 0.7072562846270475, 'Validation Metric': {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6901772767305374, 'Valid Loss': 0.7051829262213274, 'Validation Metric': {'Precision': 0.08196721311475409, 'Recall': 0.625, 'F1': 0.14492753623188404, 'Acc': 0.3058823529411765}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6796445271798542, 'Valid Loss': 0.697760359807448, 'Validation Metric': {'Precision': 0.0851063829787234, 'Recall': 0.5, 'F1': 0.14545454545454545, 'Acc': 0.4470588235294118}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6589000512446676, 'Valid Loss': 0.6984374523162842, 'Validation Metric': {'Precision': 0.08888888888888889, 'Recall': 0.5, 'F1': 0.1509433962264151, 'Acc': 0.47058823529411764}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6342080969895635, 'Valid Loss': 0.6902734420516274, 'Validation Metric': {'Precision': 0.10526315789473684, 'Recall': 0.5, 'F1': 0.17391304347826086, 'Acc': 0.5529411764705883}}
Best validation metric so far: {'Precision': 0.0963855421686747, 'Recall': 1.0, 'F1': 0.1758241758241758, 'Acc': 0.11764705882352941}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5806178056768009, 'Valid Loss': 0.653173414143649, 'Validation Metric': {'Precision': 0.14814814814814814, 'Recall': 0.5, 'F1': 0.22857142857142856, 'Acc': 0.6823529411764706}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.14814814814814814, 'Recall': 0.5, 'F1': 0.22857142857142856, 'Acc': 0.6823529411764706}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5122331577752318, 'Valid Loss': 0.6144862581383098, 'Validation Metric': {'Precision': 0.09090909090909091, 'Recall': 0.25, 'F1': 0.13333333333333333, 'Acc': 0.6941176470588235}}
Best validation metric so far: {'Precision': 0.14814814814814814, 'Recall': 0.5, 'F1': 0.22857142857142856, 'Acc': 0.6823529411764706}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4451525259230818, 'Valid Loss': 0.5574546320871874, 'Validation Metric': {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.38655492157808374, 'Valid Loss': 0.514252711426128, 'Validation Metric': {'Precision': 0.09090909090909091, 'Recall': 0.125, 'F1': 0.10526315789473685, 'Acc': 0.8}}
Best validation metric so far: {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.33415470777877737, 'Valid Loss': 0.48561828515746375, 'Validation Metric': {'Precision': 0.1, 'Recall': 0.125, 'F1': 0.11111111111111112, 'Acc': 0.8117647058823529}}
Best validation metric so far: {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3038894824151482, 'Valid Loss': 0.46363439749587665, 'Validation Metric': {'Precision': 0.125, 'Recall': 0.125, 'F1': 0.125, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.27829391935041975, 'Valid Loss': 0.44928793473677203, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.125, 'F1': 0.14285714285714288, 'Acc': 0.8588235294117647}}
Best validation metric so far: {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.25951034389436245, 'Valid Loss': 0.4428843043067239, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8470588235294118}}
Best validation metric so far: {'Precision': 0.1875, 'Recall': 0.375, 'F1': 0.25, 'Acc': 0.788235294117647}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.13636363636363635, 'Recall': 0.375, 'F1': 0.19999999999999998, 'Acc': 0.7209302325581395}; Test loss: 0.5439690324393186
