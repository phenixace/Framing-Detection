Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='ar')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6924503611193763, 'Valid Loss': 0.7051426551558755, 'Validation Metric': {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6956998954216639, 'Valid Loss': 0.7043240178715099, 'Validation Metric': {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6932368725538254, 'Valid Loss': 0.7020641348578713, 'Validation Metric': {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6926720920536253, 'Valid Loss': 0.6997962214730002, 'Validation Metric': {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6935745924711227, 'Valid Loss': 0.6970448656515642, 'Validation Metric': {'Precision': 0.36904761904761907, 'Recall': 0.96875, 'F1': 0.5344827586206897, 'Acc': 0.36470588235294116}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6927576578325696, 'Valid Loss': 0.6931733705780723, 'Validation Metric': {'Precision': 0.41509433962264153, 'Recall': 0.6875, 'F1': 0.5176470588235295, 'Acc': 0.5176470588235295}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6893636269701852, 'Valid Loss': 0.6910572322932157, 'Validation Metric': {'Precision': 0.43333333333333335, 'Recall': 0.40625, 'F1': 0.41935483870967744, 'Acc': 0.5764705882352941}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6884716153144836, 'Valid Loss': 0.6899861530824141, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.34375, 'F1': 0.4150943396226415, 'Acc': 0.6352941176470588}}
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.3764705882352941}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6837818606032265, 'Valid Loss': 0.6905633861368353, 'Validation Metric': {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6867793020274904, 'Valid Loss': 0.6882418231530623, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.5, 'F1': 0.5333333333333333, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.68121913406584, 'Valid Loss': 0.6840331825343046, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.1875, 'F1': 0.2857142857142857, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6772446599271562, 'Valid Loss': 0.6806559616869147, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.15625, 'F1': 0.24390243902439024, 'Acc': 0.6352941176470588}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6735593676567078, 'Valid Loss': 0.6778476509180936, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.34375, 'F1': 0.44000000000000006, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6630934807989333, 'Valid Loss': 0.6748266870325262, 'Validation Metric': {'Precision': 0.5416666666666666, 'Recall': 0.40625, 'F1': 0.46428571428571425, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6512253201670117, 'Valid Loss': 0.6707053130323236, 'Validation Metric': {'Precision': 0.5517241379310345, 'Recall': 0.5, 'F1': 0.5245901639344263, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.644730688797103, 'Valid Loss': 0.6656743667342446, 'Validation Metric': {'Precision': 0.53125, 'Recall': 0.53125, 'F1': 0.53125, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6312527043951882, 'Valid Loss': 0.6620117805220864, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5625, 'F1': 0.5294117647058824, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6081940415832732, 'Valid Loss': 0.6595434167168357, 'Validation Metric': {'Precision': 0.47368421052631576, 'Recall': 0.5625, 'F1': 0.5142857142857142, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5984554356998868, 'Valid Loss': 0.6581042625687339, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.5625, 'F1': 0.5070422535211268, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.592943635251787, 'Valid Loss': 0.6584148190238259, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.5625, 'F1': 0.5070422535211268, 'Acc': 0.5882352941176471}}
Best validation metric so far: {'Precision': 0.4878048780487805, 'Recall': 0.625, 'F1': 0.547945205479452, 'Acc': 0.611764705882353}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6304347826086957, 'Recall': 0.6304347826086957, 'F1': 0.6304347826086957, 'Acc': 0.6046511627906976}; Test loss: 0.690218058499423
