Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='ec')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6953917534455009, 'Valid Loss': 0.7141641161658547, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6944175531034884, 'Valid Loss': 0.7128205136819319, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6976635559745457, 'Valid Loss': 0.7091617475856434, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6982044370278068, 'Valid Loss': 0.7047503861514005, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7017655009808748, 'Valid Loss': 0.6995158303867687, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.696226267710976, 'Valid Loss': 0.6958446285941384, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.35294117647058826}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2857142857142857, 'Recall': 1.0, 'F1': 0.4444444444444445, 'Acc': 0.35294117647058826}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.696618350951568, 'Valid Loss': 0.6918445879762823, 'Validation Metric': {'Precision': 0.3508771929824561, 'Recall': 0.9090909090909091, 'F1': 0.5063291139240507, 'Acc': 0.5411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3508771929824561, 'Recall': 0.9090909090909091, 'F1': 0.5063291139240507, 'Acc': 0.5411764705882353}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6891866676185442, 'Valid Loss': 0.688294833356684, 'Validation Metric': {'Precision': 0.40425531914893614, 'Recall': 0.8636363636363636, 'F1': 0.5507246376811594, 'Acc': 0.6352941176470588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40425531914893614, 'Recall': 0.8636363636363636, 'F1': 0.5507246376811594, 'Acc': 0.6352941176470588}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6835332240747369, 'Valid Loss': 0.6824514811689203, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.8181818181818182, 'F1': 0.5454545454545455, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.40425531914893614, 'Recall': 0.8636363636363636, 'F1': 0.5507246376811594, 'Acc': 0.6352941176470588}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6700767252756201, 'Valid Loss': 0.6764623089270159, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.9090909090909091, 'F1': 0.5714285714285715, 'Acc': 0.6470588235294118}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.9090909090909091, 'F1': 0.5714285714285715, 'Acc': 0.6470588235294118}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6505499922710917, 'Valid Loss': 0.6632052009755914, 'Validation Metric': {'Precision': 0.40425531914893614, 'Recall': 0.8636363636363636, 'F1': 0.5507246376811594, 'Acc': 0.6352941176470588}}
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.9090909090909091, 'F1': 0.5714285714285715, 'Acc': 0.6470588235294118}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6181105809367221, 'Valid Loss': 0.6293942332267761, 'Validation Metric': {'Precision': 0.4186046511627907, 'Recall': 0.8181818181818182, 'F1': 0.5538461538461539, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.4166666666666667, 'Recall': 0.9090909090909091, 'F1': 0.5714285714285715, 'Acc': 0.6470588235294118}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5635726918344912, 'Valid Loss': 0.5800068568099629, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.8181818181818182, 'F1': 0.6206896551724137, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.8181818181818182, 'F1': 0.6206896551724137, 'Acc': 0.7411764705882353}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5019841712454091, 'Valid Loss': 0.5241733491420746, 'Validation Metric': {'Precision': 0.5142857142857142, 'Recall': 0.8181818181818182, 'F1': 0.6315789473684209, 'Acc': 0.7529411764705882}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5142857142857142, 'Recall': 0.8181818181818182, 'F1': 0.6315789473684209, 'Acc': 0.7529411764705882}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4547778044057929, 'Valid Loss': 0.4819194051352414, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.8181818181818182, 'F1': 0.6545454545454545, 'Acc': 0.7764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.8181818181818182, 'F1': 0.6545454545454545, 'Acc': 0.7764705882352941}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.39881326193394867, 'Valid Loss': 0.4523068232969804, 'Validation Metric': {'Precision': 0.5806451612903226, 'Recall': 0.8181818181818182, 'F1': 0.679245283018868, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5806451612903226, 'Recall': 0.8181818181818182, 'F1': 0.679245283018868, 'Acc': 0.8}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3599188920596372, 'Valid Loss': 0.4273665926673196, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3370220269198003, 'Valid Loss': 0.4154231385751204, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.32308455200298974, 'Valid Loss': 0.4078861569816416, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3127958583443061, 'Valid Loss': 0.4033733443780379, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.8181818181818182, 'F1': 0.7200000000000001, 'Acc': 0.8352941176470589}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6341463414634146, 'Recall': 0.8125, 'F1': 0.7123287671232876, 'Acc': 0.7558139534883721}; Test loss: 0.4940786768089641
