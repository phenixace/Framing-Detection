Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='mo')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6941975303765001, 'Valid Loss': 0.7285012765364214, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6955830557592984, 'Valid Loss': 0.726847155527635, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.701755048899815, 'Valid Loss': 0.7230243520303206, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7025440756616921, 'Valid Loss': 0.7192839221520857, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7043831420355829, 'Valid Loss': 0.7147002545270053, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7061846184319464, 'Valid Loss': 0.7095714428208091, 'Validation Metric': {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}}
Best validation metric so far: {'Precision': 0.08139534883720931, 'Recall': 1.0, 'F1': 0.15053763440860218, 'Acc': 0.08139534883720931}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6966718805247339, 'Valid Loss': 0.7077591473406012, 'Validation Metric': {'Precision': 0.08333333333333333, 'Recall': 1.0, 'F1': 0.15384615384615385, 'Acc': 0.10465116279069768}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.08333333333333333, 'Recall': 1.0, 'F1': 0.15384615384615385, 'Acc': 0.10465116279069768}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6881641355054132, 'Valid Loss': 0.7064546888524835, 'Validation Metric': {'Precision': 0.09333333333333334, 'Recall': 1.0, 'F1': 0.17073170731707318, 'Acc': 0.20930232558139536}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.09333333333333334, 'Recall': 1.0, 'F1': 0.17073170731707318, 'Acc': 0.20930232558139536}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6729532994073013, 'Valid Loss': 0.7037673863497648, 'Validation Metric': {'Precision': 0.1044776119402985, 'Recall': 1.0, 'F1': 0.18918918918918917, 'Acc': 0.3023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1044776119402985, 'Recall': 1.0, 'F1': 0.18918918918918917, 'Acc': 0.3023255813953488}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6326741591609758, 'Valid Loss': 0.7073321396654303, 'Validation Metric': {'Precision': 0.11475409836065574, 'Recall': 1.0, 'F1': 0.2058823529411765, 'Acc': 0.37209302325581395}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 1.0, 'F1': 0.2058823529411765, 'Acc': 0.37209302325581395}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5488737816440648, 'Valid Loss': 0.7404834953221408, 'Validation Metric': {'Precision': 0.11475409836065574, 'Recall': 1.0, 'F1': 0.2058823529411765, 'Acc': 0.37209302325581395}}
Best validation metric so far: {'Precision': 0.11475409836065574, 'Recall': 1.0, 'F1': 0.2058823529411765, 'Acc': 0.37209302325581395}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4687392280019563, 'Valid Loss': 0.5345561639829115, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 1.0, 'F1': 0.5, 'Acc': 0.8372093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 1.0, 'F1': 0.5, 'Acc': 0.8372093023255814}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3467926776100849, 'Valid Loss': 0.3982601355422627, 'Validation Metric': {'Precision': 0.5, 'Recall': 1.0, 'F1': 0.6666666666666666, 'Acc': 0.9186046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 1.0, 'F1': 0.6666666666666666, 'Acc': 0.9186046511627907}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2586892518246996, 'Valid Loss': 0.29148145290938293, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.19853040331910396, 'Valid Loss': 0.21703591400926764, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.7142857142857143, 'F1': 0.7142857142857143, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.15449453119573922, 'Valid Loss': 0.1806135827844793, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.5714285714285714, 'F1': 0.6666666666666666, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.13226208521117425, 'Valid Loss': 0.15913338146426462, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.5714285714285714, 'F1': 0.7272727272727273, 'Acc': 0.9651162790697675}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.11610394363002531, 'Valid Loss': 0.14709978212009778, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.42857142857142855, 'F1': 0.6, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.10632769570782266, 'Valid Loss': 0.1397948908534917, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.42857142857142855, 'F1': 0.6, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.09878219214492831, 'Valid Loss': 0.13699139045043426, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.42857142857142855, 'F1': 0.6, 'Acc': 0.9534883720930233}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 1.0, 'F1': 0.7777777777777778, 'Acc': 0.9534883720930233}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5, 'Recall': 0.5454545454545454, 'F1': 0.5217391304347826, 'Acc': 0.8705882352941177}; Test loss: 0.3774381076747721
