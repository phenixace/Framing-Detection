Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='ar')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6934650540351868, 'Valid Loss': 0.6899285262281244, 'Validation Metric': {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6989607682099214, 'Valid Loss': 0.6900517615404996, 'Validation Metric': {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6943852547052745, 'Valid Loss': 0.6903180100701072, 'Validation Metric': {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6935185258452957, 'Valid Loss': 0.6906586614522067, 'Validation Metric': {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.5465116279069767, 'Recall': 1.0, 'F1': 0.706766917293233, 'Acc': 0.5465116279069767}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6929718562074609, 'Valid Loss': 0.6911310120062395, 'Validation Metric': {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6936068744272799, 'Valid Loss': 0.6917104070836847, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.2978723404255319, 'F1': 0.4117647058823529, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6905636336352374, 'Valid Loss': 0.6914734786207025, 'Validation Metric': {'Precision': 0.6875, 'Recall': 0.23404255319148937, 'F1': 0.3492063492063492, 'Acc': 0.5232558139534884}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6896916176821735, 'Valid Loss': 0.6909494725140658, 'Validation Metric': {'Precision': 0.6842105263157895, 'Recall': 0.2765957446808511, 'F1': 0.393939393939394, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6867033210960595, 'Valid Loss': 0.6900169903581793, 'Validation Metric': {'Precision': 0.6818181818181818, 'Recall': 0.3191489361702128, 'F1': 0.43478260869565216, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6827558987849468, 'Valid Loss': 0.6894815835085782, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.2127659574468085, 'F1': 0.32786885245901637, 'Acc': 0.5232558139534884}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6787204967962729, 'Valid Loss': 0.6877409544858065, 'Validation Metric': {'Precision': 0.6956521739130435, 'Recall': 0.3404255319148936, 'F1': 0.4571428571428571, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6726436051162513, 'Valid Loss': 0.6857057647271589, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.40425531914893614, 'F1': 0.5066666666666666, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6680940550726813, 'Valid Loss': 0.6822163137522611, 'Validation Metric': {'Precision': 0.7037037037037037, 'Recall': 0.40425531914893614, 'F1': 0.5135135135135135, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6538173443562275, 'Valid Loss': 0.6787654757499695, 'Validation Metric': {'Precision': 0.7241379310344828, 'Recall': 0.44680851063829785, 'F1': 0.5526315789473684, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6364643605979713, 'Valid Loss': 0.6713190945712003, 'Validation Metric': {'Precision': 0.7096774193548387, 'Recall': 0.46808510638297873, 'F1': 0.5641025641025641, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6199993313969793, 'Valid Loss': 0.6680049733682112, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.44680851063829785, 'F1': 0.5454545454545453, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6023190690053476, 'Valid Loss': 0.6631144881248474, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.5106382978723404, 'F1': 0.6075949367088608, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5923145316742562, 'Valid Loss': 0.6610408316959034, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.5106382978723404, 'F1': 0.6075949367088608, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.578294561521427, 'Valid Loss': 0.6582008871165189, 'Validation Metric': {'Precision': 0.7575757575757576, 'Recall': 0.5319148936170213, 'F1': 0.625, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5750402727642575, 'Valid Loss': 0.6576543612913652, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.5106382978723404, 'F1': 0.6075949367088608, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.9148936170212766, 'F1': 0.7288135593220338, 'Acc': 0.627906976744186}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4594594594594595, 'Recall': 0.918918918918919, 'F1': 0.6126126126126126, 'Acc': 0.5}; Test loss: 0.6928767941214822
