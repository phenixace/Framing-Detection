Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='ec')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.697040242227641, 'Valid Loss': 0.7141418836333535, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6931476525285027, 'Valid Loss': 0.7127733338962902, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6949338912963867, 'Valid Loss': 0.7101959531957452, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6967597915367647, 'Valid Loss': 0.7056604786352678, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6980211369015954, 'Valid Loss': 0.7024644233963706, 'Validation Metric': {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}}
Best validation metric so far: {'Precision': 0.25882352941176473, 'Recall': 1.0, 'F1': 0.4112149532710281, 'Acc': 0.25882352941176473}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6963413046164946, 'Valid Loss': 0.6964827992699363, 'Validation Metric': {'Precision': 0.2727272727272727, 'Recall': 0.9545454545454546, 'F1': 0.4242424242424242, 'Acc': 0.32941176470588235}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2727272727272727, 'Recall': 0.9545454545454546, 'F1': 0.4242424242424242, 'Acc': 0.32941176470588235}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6919684220444072, 'Valid Loss': 0.6943055120381442, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.9545454545454546, 'F1': 0.47727272727272724, 'Acc': 0.4588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3181818181818182, 'Recall': 0.9545454545454546, 'F1': 0.47727272727272724, 'Acc': 0.4588235294117647}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6840645196762952, 'Valid Loss': 0.6911348917267539, 'Validation Metric': {'Precision': 0.3508771929824561, 'Recall': 0.9090909090909091, 'F1': 0.5063291139240507, 'Acc': 0.5411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3508771929824561, 'Recall': 0.9090909090909091, 'F1': 0.5063291139240507, 'Acc': 0.5411764705882353}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6804784536361694, 'Valid Loss': 0.682877394286069, 'Validation Metric': {'Precision': 0.3958333333333333, 'Recall': 0.8636363636363636, 'F1': 0.5428571428571428, 'Acc': 0.6235294117647059}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3958333333333333, 'Recall': 0.8636363636363636, 'F1': 0.5428571428571428, 'Acc': 0.6235294117647059}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6626088565046137, 'Valid Loss': 0.6735433394258673, 'Validation Metric': {'Precision': 0.41304347826086957, 'Recall': 0.8636363636363636, 'F1': 0.5588235294117647, 'Acc': 0.6470588235294118}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41304347826086957, 'Recall': 0.8636363636363636, 'F1': 0.5588235294117647, 'Acc': 0.6470588235294118}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.632881449027495, 'Valid Loss': 0.6582679748535156, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.9545454545454546, 'F1': 0.5915492957746478, 'Acc': 0.6588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.9545454545454546, 'F1': 0.5915492957746478, 'Acc': 0.6588235294117647}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.584983388131315, 'Valid Loss': 0.6249514438889243, 'Validation Metric': {'Precision': 0.4772727272727273, 'Recall': 0.9545454545454546, 'F1': 0.6363636363636365, 'Acc': 0.7176470588235294}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4772727272727273, 'Recall': 0.9545454545454546, 'F1': 0.6363636363636365, 'Acc': 0.7176470588235294}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5304691385139119, 'Valid Loss': 0.5620888688347556, 'Validation Metric': {'Precision': 0.5675675675675675, 'Recall': 0.9545454545454546, 'F1': 0.711864406779661, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5675675675675675, 'Recall': 0.9545454545454546, 'F1': 0.711864406779661, 'Acc': 0.8}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.45895908772945404, 'Valid Loss': 0.5284576578573748, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.9090909090909091, 'F1': 0.6896551724137931, 'Acc': 0.788235294117647}}
Best validation metric so far: {'Precision': 0.5675675675675675, 'Recall': 0.9545454545454546, 'F1': 0.711864406779661, 'Acc': 0.8}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.41780131310224533, 'Valid Loss': 0.495956534689123, 'Validation Metric': {'Precision': 0.5882352941176471, 'Recall': 0.9090909090909091, 'F1': 0.7142857142857143, 'Acc': 0.8117647058823529}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.9090909090909091, 'F1': 0.7142857142857143, 'Acc': 0.8117647058823529}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.37515234540809284, 'Valid Loss': 0.4696998216889121, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.7727272727272727, 'F1': 0.6938775510204083, 'Acc': 0.8235294117647058}}
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.9090909090909091, 'F1': 0.7142857142857143, 'Acc': 0.8117647058823529}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.34771856564012443, 'Valid Loss': 0.4619237794117494, 'Validation Metric': {'Precision': 0.6333333333333333, 'Recall': 0.8636363636363636, 'F1': 0.7307692307692307, 'Acc': 0.8352941176470589}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.8636363636363636, 'F1': 0.7307692307692307, 'Acc': 0.8352941176470589}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.32911007749763405, 'Valid Loss': 0.4458733079108325, 'Validation Metric': {'Precision': 0.6538461538461539, 'Recall': 0.7727272727272727, 'F1': 0.7083333333333333, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.8636363636363636, 'F1': 0.7307692307692307, 'Acc': 0.8352941176470589}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3148797841911966, 'Valid Loss': 0.43780574202537537, 'Validation Metric': {'Precision': 0.6538461538461539, 'Recall': 0.7727272727272727, 'F1': 0.7083333333333333, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.8636363636363636, 'F1': 0.7307692307692307, 'Acc': 0.8352941176470589}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.30212096666747873, 'Valid Loss': 0.43511323766274884, 'Validation Metric': {'Precision': 0.6538461538461539, 'Recall': 0.7727272727272727, 'F1': 0.7083333333333333, 'Acc': 0.8352941176470589}}
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.8636363636363636, 'F1': 0.7307692307692307, 'Acc': 0.8352941176470589}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5483870967741935, 'Recall': 0.7727272727272727, 'F1': 0.6415094339622641, 'Acc': 0.7764705882352941}; Test loss: 0.4347531930966811
