Namespace(batch_size=8, checkpoint_dir='./ckp2/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_4/', lr=2e-06, max_len=256, n_passages=4, random_seed=1042, specified_label='ec')
parameters: 148665602
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6941024217199772, 'Valid Loss': 0.7039766365831549, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6950391569036118, 'Valid Loss': 0.7034724734046243, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6974218880876581, 'Valid Loss': 0.702026443047957, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.698149432527258, 'Valid Loss': 0.6999072866006331, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6993136849809201, 'Valid Loss': 0.6969866752624512, 'Validation Metric': {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}}
Best validation metric so far: {'Precision': 0.37209302325581395, 'Recall': 1.0, 'F1': 0.5423728813559322, 'Acc': 0.37209302325581395}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6984502559012555, 'Valid Loss': 0.694640576839447, 'Validation Metric': {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.38372093023255816}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3764705882352941, 'Recall': 1.0, 'F1': 0.547008547008547, 'Acc': 0.38372093023255816}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6931592809393051, 'Valid Loss': 0.6935221173546531, 'Validation Metric': {'Precision': 0.38271604938271603, 'Recall': 0.96875, 'F1': 0.5486725663716814, 'Acc': 0.4069767441860465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38271604938271603, 'Recall': 0.96875, 'F1': 0.5486725663716814, 'Acc': 0.4069767441860465}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6877227856757793, 'Valid Loss': 0.6909545172344554, 'Validation Metric': {'Precision': 0.41333333333333333, 'Recall': 0.96875, 'F1': 0.5794392523364486, 'Acc': 0.47674418604651164}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41333333333333333, 'Recall': 0.96875, 'F1': 0.5794392523364486, 'Acc': 0.47674418604651164}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.676481102375274, 'Valid Loss': 0.6857540173964067, 'Validation Metric': {'Precision': 0.45588235294117646, 'Recall': 0.96875, 'F1': 0.62, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.45588235294117646, 'Recall': 0.96875, 'F1': 0.62, 'Acc': 0.5581395348837209}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6588056556721951, 'Valid Loss': 0.6757313013076782, 'Validation Metric': {'Precision': 0.47692307692307695, 'Recall': 0.96875, 'F1': 0.6391752577319587, 'Acc': 0.5930232558139535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47692307692307695, 'Recall': 0.96875, 'F1': 0.6391752577319587, 'Acc': 0.5930232558139535}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6166760686864244, 'Valid Loss': 0.6478362896225669, 'Validation Metric': {'Precision': 0.5084745762711864, 'Recall': 0.9375, 'F1': 0.6593406593406593, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5084745762711864, 'Recall': 0.9375, 'F1': 0.6593406593406593, 'Acc': 0.6395348837209303}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5513693297162969, 'Valid Loss': 0.6104696799408306, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.9375, 'F1': 0.6896551724137931, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.9375, 'F1': 0.6896551724137931, 'Acc': 0.686046511627907}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4818721442146504, 'Valid Loss': 0.5534113835204731, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.84375, 'F1': 0.7012987012987012, 'Acc': 0.7325581395348837}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.84375, 'F1': 0.7012987012987012, 'Acc': 0.7325581395348837}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4007710885811359, 'Valid Loss': 0.5284307138486342, 'Validation Metric': {'Precision': 0.6046511627906976, 'Recall': 0.8125, 'F1': 0.6933333333333334, 'Acc': 0.7325581395348837}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.84375, 'F1': 0.7012987012987012, 'Acc': 0.7325581395348837}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.35239969035412405, 'Valid Loss': 0.504353252324191, 'Validation Metric': {'Precision': 0.6578947368421053, 'Recall': 0.78125, 'F1': 0.7142857142857143, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6578947368421053, 'Recall': 0.78125, 'F1': 0.7142857142857143, 'Acc': 0.7674418604651163}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3068997492181494, 'Valid Loss': 0.4913349679925225, 'Validation Metric': {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2796599830084659, 'Valid Loss': 0.48303214663808997, 'Validation Metric': {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}}
Best validation metric so far: {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2578278000050403, 'Valid Loss': 0.47789311002601276, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.78125, 'F1': 0.7462686567164178, 'Acc': 0.8023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.78125, 'F1': 0.7462686567164178, 'Acc': 0.8023255813953488}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.23684128199486024, 'Valid Loss': 0.47859948738054797, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.78125, 'F1': 0.7462686567164178, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.78125, 'F1': 0.7462686567164178, 'Acc': 0.8023255813953488}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.23072904649567097, 'Valid Loss': 0.4769242324612357, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.78125, 'F1': 0.7462686567164178, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.78125, 'F1': 0.7462686567164178, 'Acc': 0.8023255813953488}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5172413793103449, 'Recall': 0.625, 'F1': 0.5660377358490567, 'Acc': 0.7325581395348837}; Test loss: 0.5017928995869376
