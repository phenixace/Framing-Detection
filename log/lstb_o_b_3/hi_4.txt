Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='hi')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.694807956093236, 'Valid Loss': 0.6763838963075117, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.696020600042845, 'Valid Loss': 0.6764682693914934, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7000864995153326, 'Valid Loss': 0.6771784912456166, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6983022313368948, 'Valid Loss': 0.6811851967464794, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7030408894806578, 'Valid Loss': 0.6859247196804393, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 0.09090909090909091, 'F1': 0.09999999999999999, 'Acc': 0.7906976744186046}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.1111111111111111, 'Recall': 0.09090909090909091, 'F1': 0.09999999999999999, 'Acc': 0.7906976744186046}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7008537921989173, 'Valid Loss': 0.6931792118332603, 'Validation Metric': {'Precision': 0.19148936170212766, 'Recall': 0.8181818181818182, 'F1': 0.31034482758620685, 'Acc': 0.5348837209302325}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.19148936170212766, 'Recall': 0.8181818181818182, 'F1': 0.31034482758620685, 'Acc': 0.5348837209302325}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6993796041137293, 'Valid Loss': 0.6932666084983132, 'Validation Metric': {'Precision': 0.18, 'Recall': 0.8181818181818182, 'F1': 0.29508196721311475, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.19148936170212766, 'Recall': 0.8181818181818182, 'F1': 0.31034482758620685, 'Acc': 0.5348837209302325}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6867597218145404, 'Valid Loss': 0.6955724358558655, 'Validation Metric': {'Precision': 0.19642857142857142, 'Recall': 1.0, 'F1': 0.3283582089552239, 'Acc': 0.47674418604651164}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.19642857142857142, 'Recall': 1.0, 'F1': 0.3283582089552239, 'Acc': 0.47674418604651164}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6750947372955188, 'Valid Loss': 0.693106624213132, 'Validation Metric': {'Precision': 0.1702127659574468, 'Recall': 0.7272727272727273, 'F1': 0.27586206896551724, 'Acc': 0.5116279069767442}}
Best validation metric so far: {'Precision': 0.19642857142857142, 'Recall': 1.0, 'F1': 0.3283582089552239, 'Acc': 0.47674418604651164}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.641725176259091, 'Valid Loss': 0.6944309364665638, 'Validation Metric': {'Precision': 0.16326530612244897, 'Recall': 0.7272727272727273, 'F1': 0.26666666666666666, 'Acc': 0.4883720930232558}}
Best validation metric so far: {'Precision': 0.19642857142857142, 'Recall': 1.0, 'F1': 0.3283582089552239, 'Acc': 0.47674418604651164}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5652578985481932, 'Valid Loss': 0.6633828986774791, 'Validation Metric': {'Precision': 0.175, 'Recall': 0.6363636363636364, 'F1': 0.27450980392156865, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0.19642857142857142, 'Recall': 1.0, 'F1': 0.3283582089552239, 'Acc': 0.47674418604651164}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.47823355961264225, 'Valid Loss': 0.5651332329620015, 'Validation Metric': {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.3790329297383626, 'Valid Loss': 0.48690799149599945, 'Validation Metric': {'Precision': 0.07692307692307693, 'Recall': 0.09090909090909091, 'F1': 0.08333333333333334, 'Acc': 0.7441860465116279}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2893556460999606, 'Valid Loss': 0.4396224455399947, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 0.09090909090909091, 'F1': 0.09999999999999999, 'Acc': 0.7906976744186046}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.2340711476771455, 'Valid Loss': 0.4120292677120729, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.09090909090909091, 'F1': 0.11764705882352942, 'Acc': 0.8255813953488372}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19473721884321749, 'Valid Loss': 0.394530407407067, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.09090909090909091, 'F1': 0.13333333333333333, 'Acc': 0.8488372093023255}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.16697727758110614, 'Valid Loss': 0.38339129970832303, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8372093023255814}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.15030143775960855, 'Valid Loss': 0.3779691064899618, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8372093023255814}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.13723043613789374, 'Valid Loss': 0.3744650144468654, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8488372093023255}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.12563194164581465, 'Valid Loss': 0.3733815984292464, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8488372093023255}}
Best validation metric so far: {'Precision': 0.2608695652173913, 'Recall': 0.5454545454545454, 'F1': 0.3529411764705882, 'Acc': 0.7441860465116279}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.04, 'Recall': 0.125, 'F1': 0.06060606060606061, 'Acc': 0.6395348837209303}; Test loss: 0.605206700888547
