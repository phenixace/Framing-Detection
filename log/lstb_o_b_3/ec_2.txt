Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ec')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.696976760159368, 'Valid Loss': 0.6817423484542153, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6917916821396869, 'Valid Loss': 0.6818498589775779, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6955593746641408, 'Valid Loss': 0.6818382143974304, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6971209761889084, 'Valid Loss': 0.6819542050361633, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7411764705882353}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6955172484335692, 'Valid Loss': 0.6827812899242748, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.045454545454545456, 'F1': 0.08695652173913045, 'Acc': 0.7529411764705882}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.045454545454545456, 'F1': 0.08695652173913045, 'Acc': 0.7529411764705882}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6947963147059731, 'Valid Loss': 0.684341549873352, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.22727272727272727, 'F1': 0.37037037037037035, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.22727272727272727, 'F1': 0.37037037037037035, 'Acc': 0.8}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6976458831973698, 'Valid Loss': 0.6829252784902399, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.3181818181818182, 'F1': 0.4827586206896552, 'Acc': 0.8235294117647058}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.3181818181818182, 'F1': 0.4827586206896552, 'Acc': 0.8235294117647058}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.691991212575332, 'Valid Loss': 0.6820673996751959, 'Validation Metric': {'Precision': 0.9166666666666666, 'Recall': 0.5, 'F1': 0.6470588235294118, 'Acc': 0.8588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.9166666666666666, 'Recall': 0.5, 'F1': 0.6470588235294118, 'Acc': 0.8588235294117647}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.688615875399631, 'Valid Loss': 0.6776325756853278, 'Validation Metric': {'Precision': 0.9166666666666666, 'Recall': 0.5, 'F1': 0.6470588235294118, 'Acc': 0.8588235294117647}}
Best validation metric so far: {'Precision': 0.9166666666666666, 'Recall': 0.5, 'F1': 0.6470588235294118, 'Acc': 0.8588235294117647}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6795649385970571, 'Valid Loss': 0.6740840836004778, 'Validation Metric': {'Precision': 0.5277777777777778, 'Recall': 0.8636363636363636, 'F1': 0.6551724137931034, 'Acc': 0.7647058823529411}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.8636363636363636, 'F1': 0.6551724137931034, 'Acc': 0.7647058823529411}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6658470138259556, 'Valid Loss': 0.6684115691618486, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.9090909090909091, 'F1': 0.5882352941176471, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.8636363636363636, 'F1': 0.6551724137931034, 'Acc': 0.7647058823529411}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6432526383710944, 'Valid Loss': 0.6465147354386069, 'Validation Metric': {'Precision': 0.41304347826086957, 'Recall': 0.8636363636363636, 'F1': 0.5588235294117647, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.8636363636363636, 'F1': 0.6551724137931034, 'Acc': 0.7647058823529411}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5958345798046693, 'Valid Loss': 0.6119953231378035, 'Validation Metric': {'Precision': 0.4318181818181818, 'Recall': 0.8636363636363636, 'F1': 0.5757575757575758, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.8636363636363636, 'F1': 0.6551724137931034, 'Acc': 0.7647058823529411}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5392315854196963, 'Valid Loss': 0.5556502667340365, 'Validation Metric': {'Precision': 0.48717948717948717, 'Recall': 0.8636363636363636, 'F1': 0.6229508196721312, 'Acc': 0.7294117647058823}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.8636363636363636, 'F1': 0.6551724137931034, 'Acc': 0.7647058823529411}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.49071268413377844, 'Valid Loss': 0.5036419196562334, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.8181818181818182, 'F1': 0.6666666666666666, 'Acc': 0.788235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5625, 'Recall': 0.8181818181818182, 'F1': 0.6666666666666666, 'Acc': 0.788235294117647}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4287517514565717, 'Valid Loss': 0.4737224660136483, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.39361173659563065, 'Valid Loss': 0.4515342116355896, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.7727272727272727, 'F1': 0.68, 'Acc': 0.8117647058823529}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.36027317299791006, 'Valid Loss': 0.43945531953464856, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.7727272727272727, 'F1': 0.68, 'Acc': 0.8117647058823529}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.33765356339838193, 'Valid Loss': 0.4320082556117665, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.7272727272727273, 'F1': 0.6530612244897959, 'Acc': 0.8}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.32494138731904654, 'Valid Loss': 0.42791248722509906, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.7272727272727273, 'F1': 0.6530612244897959, 'Acc': 0.8}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8181818181818182, 'F1': 0.6923076923076923, 'Acc': 0.8117647058823529}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6341463414634146, 'Recall': 0.8125, 'F1': 0.7123287671232876, 'Acc': 0.7558139534883721}; Test loss: 0.5360424681143328
