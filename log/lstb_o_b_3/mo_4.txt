Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='mo')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6925407919967383, 'Valid Loss': 0.6758075519041582, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6929752481611151, 'Valid Loss': 0.6760903109203685, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6972546797049674, 'Valid Loss': 0.6772452159361406, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6989071494654605, 'Valid Loss': 0.6803572069514882, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8953488372093024}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6967542924379048, 'Valid Loss': 0.6877736286683516, 'Validation Metric': {'Precision': 0.19047619047619047, 'Recall': 0.4444444444444444, 'F1': 0.26666666666666666, 'Acc': 0.7441860465116279}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.4444444444444444, 'F1': 0.26666666666666666, 'Acc': 0.7441860465116279}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6964593822495979, 'Valid Loss': 0.6976381919600747, 'Validation Metric': {'Precision': 0.13114754098360656, 'Recall': 0.8888888888888888, 'F1': 0.2285714285714286, 'Acc': 0.37209302325581395}}
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.4444444444444444, 'F1': 0.26666666666666666, 'Acc': 0.7441860465116279}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6873797795228791, 'Valid Loss': 0.6994095065376975, 'Validation Metric': {'Precision': 0.13333333333333333, 'Recall': 0.8888888888888888, 'F1': 0.2318840579710145, 'Acc': 0.38372093023255816}}
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.4444444444444444, 'F1': 0.26666666666666666, 'Acc': 0.7441860465116279}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.658128371364192, 'Valid Loss': 0.7262746529145674, 'Validation Metric': {'Precision': 0.1232876712328767, 'Recall': 1.0, 'F1': 0.2195121951219512, 'Acc': 0.2558139534883721}}
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.4444444444444444, 'F1': 0.26666666666666666, 'Acc': 0.7441860465116279}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5886361379372446, 'Valid Loss': 0.8664401227777655, 'Validation Metric': {'Precision': 0.12162162162162163, 'Recall': 1.0, 'F1': 0.21686746987951808, 'Acc': 0.2441860465116279}}
Best validation metric so far: {'Precision': 0.19047619047619047, 'Recall': 0.4444444444444444, 'F1': 0.26666666666666666, 'Acc': 0.7441860465116279}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.516274322281804, 'Valid Loss': 0.6959279829805548, 'Validation Metric': {'Precision': 0.18421052631578946, 'Recall': 0.7777777777777778, 'F1': 0.2978723404255319, 'Acc': 0.6162790697674418}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.18421052631578946, 'Recall': 0.7777777777777778, 'F1': 0.2978723404255319, 'Acc': 0.6162790697674418}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.39060961808028977, 'Valid Loss': 0.5164875659075651, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2735779622667714, 'Valid Loss': 0.418570106679743, 'Validation Metric': {'Precision': 0.3076923076923077, 'Recall': 0.4444444444444444, 'F1': 0.3636363636363637, 'Acc': 0.8372093023255814}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.19254776064241141, 'Valid Loss': 0.3469760919159109, 'Validation Metric': {'Precision': 0.2727272727272727, 'Recall': 0.3333333333333333, 'F1': 0.3, 'Acc': 0.8372093023255814}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.14563162592157983, 'Valid Loss': 0.3148143955252387, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.3333333333333333, 'F1': 0.3333333333333333, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.10783020132466366, 'Valid Loss': 0.3000413463874297, 'Validation Metric': {'Precision': 0.2857142857142857, 'Recall': 0.2222222222222222, 'F1': 0.25, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.08391791771639857, 'Valid Loss': 0.2982960492372513, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 0.1111111111111111, 'F1': 0.13333333333333333, 'Acc': 0.8488372093023255}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.07612752136692666, 'Valid Loss': 0.2989441379904747, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.1111111111111111, 'F1': 0.15384615384615383, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.06522841222192112, 'Valid Loss': 0.3002787611701272, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.06306279104268342, 'Valid Loss': 0.301112289455804, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.05666038658665983, 'Valid Loss': 0.3020291216671467, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.3, 'Recall': 0.6666666666666666, 'F1': 0.41379310344827586, 'Acc': 0.8023255813953488}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4117647058823529, 'Recall': 1.0, 'F1': 0.5833333333333334, 'Acc': 0.8837209302325582}; Test loss: 0.4178471971641887
