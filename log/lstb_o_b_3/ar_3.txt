Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ar')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6953038290143013, 'Valid Loss': 0.6939070874994452, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6887964352965354, 'Valid Loss': 0.6937812620943243, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6942170053720474, 'Valid Loss': 0.6936574524099176, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.694695521891117, 'Valid Loss': 0.693388516252691, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46511627906976744}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6918180838227272, 'Valid Loss': 0.6926274462179705, 'Validation Metric': {'Precision': 0.8333333333333334, 'Recall': 0.10869565217391304, 'F1': 0.1923076923076923, 'Acc': 0.5116279069767442}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8333333333333334, 'Recall': 0.10869565217391304, 'F1': 0.1923076923076923, 'Acc': 0.5116279069767442}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6962313577532768, 'Valid Loss': 0.692569147456776, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.10869565217391304, 'F1': 0.18867924528301885, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.8333333333333334, 'Recall': 0.10869565217391304, 'F1': 0.1923076923076923, 'Acc': 0.5116279069767442}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.69394151866436, 'Valid Loss': 0.6922210075638511, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.2608695652173913, 'F1': 0.3870967741935483, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.2608695652173913, 'F1': 0.3870967741935483, 'Acc': 0.5581395348837209}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6905666351318359, 'Valid Loss': 0.6918839866464789, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.34782608695652173, 'F1': 0.4571428571428571, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.34782608695652173, 'F1': 0.4571428571428571, 'Acc': 0.5581395348837209}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6878537580370903, 'Valid Loss': 0.6914672363888134, 'Validation Metric': {'Precision': 0.6451612903225806, 'Recall': 0.43478260869565216, 'F1': 0.5194805194805194, 'Acc': 0.5697674418604651}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6451612903225806, 'Recall': 0.43478260869565216, 'F1': 0.5194805194805194, 'Acc': 0.5697674418604651}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6869083538651466, 'Valid Loss': 0.6908268386667425, 'Validation Metric': {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6842798843979836, 'Valid Loss': 0.6900163347070868, 'Validation Metric': {'Precision': 0.5681818181818182, 'Recall': 0.5434782608695652, 'F1': 0.5555555555555556, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6775233641266822, 'Valid Loss': 0.6888633262027394, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.5217391304347826, 'F1': 0.5454545454545454, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6743782967329025, 'Valid Loss': 0.6871616461060264, 'Validation Metric': {'Precision': 0.5945945945945946, 'Recall': 0.4782608695652174, 'F1': 0.5301204819277109, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6636132061481476, 'Valid Loss': 0.6838521632281217, 'Validation Metric': {'Precision': 0.6052631578947368, 'Recall': 0.5, 'F1': 0.5476190476190477, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6537407964468003, 'Valid Loss': 0.6780054298314181, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.43478260869565216, 'F1': 0.5063291139240507, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 0.6388888888888888, 'Recall': 0.5, 'F1': 0.5609756097560975, 'Acc': 0.5813953488372093}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6326263159513473, 'Valid Loss': 0.6719938245686617, 'Validation Metric': {'Precision': 0.6190476190476191, 'Recall': 0.5652173913043478, 'F1': 0.5909090909090909, 'Acc': 0.5813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6190476190476191, 'Recall': 0.5652173913043478, 'F1': 0.5909090909090909, 'Acc': 0.5813953488372093}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6174034968018531, 'Valid Loss': 0.6663972627032887, 'Validation Metric': {'Precision': 0.6170212765957447, 'Recall': 0.6304347826086957, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6170212765957447, 'Recall': 0.6304347826086957, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6000906109809876, 'Valid Loss': 0.6615967587991194, 'Validation Metric': {'Precision': 0.6170212765957447, 'Recall': 0.6304347826086957, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.6170212765957447, 'Recall': 0.6304347826086957, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5811950318515301, 'Valid Loss': 0.6592642556537281, 'Validation Metric': {'Precision': 0.6136363636363636, 'Recall': 0.5869565217391305, 'F1': 0.6, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.6170212765957447, 'Recall': 0.6304347826086957, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5763993099331856, 'Valid Loss': 0.6584387421607971, 'Validation Metric': {'Precision': 0.6136363636363636, 'Recall': 0.5869565217391305, 'F1': 0.6, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.6170212765957447, 'Recall': 0.6304347826086957, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7, 'Recall': 0.44680851063829785, 'F1': 0.5454545454545453, 'Acc': 0.5930232558139535}; Test loss: 0.6627283909104087
