Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ar')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6940410330488875, 'Valid Loss': 0.694690157066692, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6928656133445533, 'Valid Loss': 0.694695461880077, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6907523016671877, 'Valid Loss': 0.6945966753092679, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6913357409271034, 'Valid Loss': 0.6944053227251227, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4418604651162791}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6936890643996161, 'Valid Loss': 0.6941363323818553, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4418604651162791}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6968892103916889, 'Valid Loss': 0.6939311948689547, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4418604651162791}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45348837209302323}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6915155697513271, 'Valid Loss': 0.693384284322912, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.02127659574468085, 'F1': 0.0392156862745098, 'Acc': 0.43023255813953487}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.02127659574468085, 'F1': 0.0392156862745098, 'Acc': 0.43023255813953487}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6888339841688002, 'Valid Loss': 0.6931871609254316, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.02127659574468085, 'F1': 0.03846153846153846, 'Acc': 0.4186046511627907}}
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.02127659574468085, 'F1': 0.0392156862745098, 'Acc': 0.43023255813953487}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6856986638661977, 'Valid Loss': 0.6927219954403964, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.06382978723404255, 'F1': 0.1111111111111111, 'Acc': 0.4418604651162791}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.06382978723404255, 'F1': 0.1111111111111111, 'Acc': 0.4418604651162791}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6847170043636013, 'Valid Loss': 0.6919460513375022, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.10638297872340426, 'F1': 0.17543859649122806, 'Acc': 0.45348837209302323}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.10638297872340426, 'F1': 0.17543859649122806, 'Acc': 0.45348837209302323}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6834053944897007, 'Valid Loss': 0.6912414485758002, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.1276595744680851, 'F1': 0.20338983050847456, 'Acc': 0.45348837209302323}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.1276595744680851, 'F1': 0.20338983050847456, 'Acc': 0.45348837209302323}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6813221316079836, 'Valid Loss': 0.690261575308713, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.1276595744680851, 'F1': 0.20338983050847456, 'Acc': 0.45348837209302323}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.1276595744680851, 'F1': 0.20338983050847456, 'Acc': 0.45348837209302323}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6754119798943803, 'Valid Loss': 0.6890960823405873, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.1276595744680851, 'F1': 0.20338983050847456, 'Acc': 0.45348837209302323}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.1276595744680851, 'F1': 0.20338983050847456, 'Acc': 0.45348837209302323}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6769430717906436, 'Valid Loss': 0.6874923435124484, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.19148936170212766, 'F1': 0.29032258064516125, 'Acc': 0.4883720930232558}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.19148936170212766, 'F1': 0.29032258064516125, 'Acc': 0.4883720930232558}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.664929528494139, 'Valid Loss': 0.6850632591681047, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.23404255319148937, 'F1': 0.3384615384615385, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.23404255319148937, 'F1': 0.3384615384615385, 'Acc': 0.5}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6567814462893719, 'Valid Loss': 0.6807885332541033, 'Validation Metric': {'Precision': 0.72, 'Recall': 0.3829787234042553, 'F1': 0.4999999999999999, 'Acc': 0.5813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.72, 'Recall': 0.3829787234042553, 'F1': 0.4999999999999999, 'Acc': 0.5813953488372093}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6471962783787701, 'Valid Loss': 0.6763540181246671, 'Validation Metric': {'Precision': 0.7419354838709677, 'Recall': 0.48936170212765956, 'F1': 0.5897435897435898, 'Acc': 0.627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7419354838709677, 'Recall': 0.48936170212765956, 'F1': 0.5897435897435898, 'Acc': 0.627906976744186}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6392502494760461, 'Valid Loss': 0.6726995218883861, 'Validation Metric': {'Precision': 0.7352941176470589, 'Recall': 0.5319148936170213, 'F1': 0.617283950617284, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7352941176470589, 'Recall': 0.5319148936170213, 'F1': 0.617283950617284, 'Acc': 0.6395348837209303}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6363793224901766, 'Valid Loss': 0.6703453280709006, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.574468085106383, 'F1': 0.6506024096385542, 'Acc': 0.6627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.574468085106383, 'F1': 0.6506024096385542, 'Acc': 0.6627906976744186}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6288753683502609, 'Valid Loss': 0.6693858666853472, 'Validation Metric': {'Precision': 0.7297297297297297, 'Recall': 0.574468085106383, 'F1': 0.6428571428571429, 'Acc': 0.6511627906976745}}
Best validation metric so far: {'Precision': 0.75, 'Recall': 0.574468085106383, 'F1': 0.6506024096385542, 'Acc': 0.6627906976744186}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6129032258064516, 'Recall': 0.5135135135135135, 'F1': 0.5588235294117647, 'Acc': 0.6511627906976745}; Test loss: 0.6597998955033042
