Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ec')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6961865835719638, 'Valid Loss': 0.6824735240502791, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6934978736771478, 'Valid Loss': 0.6825795823877508, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6944361858897738, 'Valid Loss': 0.6830997521227057, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6939813004599678, 'Valid Loss': 0.6840305111624978, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7209302325581395}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6940294252501593, 'Valid Loss': 0.685343471440402, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.20833333333333334, 'F1': 0.3225806451612903, 'Acc': 0.7558139534883721}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.20833333333333334, 'F1': 0.3225806451612903, 'Acc': 0.7558139534883721}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6974848124716017, 'Valid Loss': 0.6833818554878235, 'Validation Metric': {'Precision': 0.8333333333333334, 'Recall': 0.20833333333333334, 'F1': 0.33333333333333337, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8333333333333334, 'Recall': 0.20833333333333334, 'F1': 0.33333333333333337, 'Acc': 0.7674418604651163}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6944498976071676, 'Valid Loss': 0.6805868148803711, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 0.2916666666666667, 'F1': 0.42424242424242425, 'Acc': 0.7790697674418605}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 0.2916666666666667, 'F1': 0.42424242424242425, 'Acc': 0.7790697674418605}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.685392967859904, 'Valid Loss': 0.6782312393188477, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5, 'F1': 0.5714285714285715, 'Acc': 0.7906976744186046}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.5, 'F1': 0.5714285714285715, 'Acc': 0.7906976744186046}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6821936554378933, 'Valid Loss': 0.6729987913911993, 'Validation Metric': {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6650465250015258, 'Valid Loss': 0.6675150069323453, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.75, 'F1': 0.6, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6458719372749329, 'Valid Loss': 0.6519043770703402, 'Validation Metric': {'Precision': 0.4634146341463415, 'Recall': 0.7916666666666666, 'F1': 0.5846153846153846, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6049360679255591, 'Valid Loss': 0.6237115643241189, 'Validation Metric': {'Precision': 0.4634146341463415, 'Recall': 0.7916666666666666, 'F1': 0.5846153846153846, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5580626640054914, 'Valid Loss': 0.5717786604707892, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.75, 'F1': 0.6, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.49484490553538, 'Valid Loss': 0.528459291566502, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.75, 'F1': 0.631578947368421, 'Acc': 0.7558139534883721}}
Best validation metric so far: {'Precision': 0.6296296296296297, 'Recall': 0.7083333333333334, 'F1': 0.6666666666666667, 'Acc': 0.8023255813953488}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.43091526362631055, 'Valid Loss': 0.5017177218740637, 'Validation Metric': {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.383345416519377, 'Valid Loss': 0.4851224422454834, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.6666666666666666, 'F1': 0.627450980392157, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.34520852631992766, 'Valid Loss': 0.4716671813618053, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.625, 'F1': 0.6122448979591836, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.315728203786744, 'Valid Loss': 0.4650809277187694, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.5833333333333334, 'F1': 0.5833333333333334, 'Acc': 0.7674418604651163}}
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3045840942197376, 'Valid Loss': 0.46252131868492474, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.5833333333333334, 'F1': 0.5833333333333334, 'Acc': 0.7674418604651163}}
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.29065995613733925, 'Valid Loss': 0.4605578536337072, 'Validation Metric': {'Precision': 0.6086956521739131, 'Recall': 0.5833333333333334, 'F1': 0.5957446808510638, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.75, 'F1': 0.679245283018868, 'Acc': 0.8023255813953488}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7037037037037037, 'Recall': 0.7037037037037037, 'F1': 0.7037037037037037, 'Acc': 0.813953488372093}; Test loss: 0.486551897092299
