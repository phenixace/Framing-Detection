Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='co')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6944122806191444, 'Valid Loss': 0.7015195651487871, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6963308990001679, 'Valid Loss': 0.7011613683267073, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6936983346939087, 'Valid Loss': 0.7001446810635653, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6931769624352455, 'Valid Loss': 0.6990935694087635, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6946771308779717, 'Valid Loss': 0.6978536627509377, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.32558139534883723}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6954454332590103, 'Valid Loss': 0.6971010945060037, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.017241379310344827, 'F1': 0.03333333333333333, 'Acc': 0.32558139534883723}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.017241379310344827, 'F1': 0.03333333333333333, 'Acc': 0.32558139534883723}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6942376449704171, 'Valid Loss': 0.6957927508787676, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.034482758620689655, 'F1': 0.06557377049180328, 'Acc': 0.3372093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.034482758620689655, 'F1': 0.06557377049180328, 'Acc': 0.3372093023255814}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6901937574148178, 'Valid Loss': 0.6944384195587852, 'Validation Metric': {'Precision': 0.8571428571428571, 'Recall': 0.20689655172413793, 'F1': 0.33333333333333326, 'Acc': 0.4418604651162791}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8571428571428571, 'Recall': 0.20689655172413793, 'F1': 0.33333333333333326, 'Acc': 0.4418604651162791}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6889582455158234, 'Valid Loss': 0.6927434964613481, 'Validation Metric': {'Precision': 0.84, 'Recall': 0.3620689655172414, 'F1': 0.5060240963855421, 'Acc': 0.5232558139534884}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.84, 'Recall': 0.3620689655172414, 'F1': 0.5060240963855421, 'Acc': 0.5232558139534884}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6858663961291314, 'Valid Loss': 0.6905004761435769, 'Validation Metric': {'Precision': 0.7804878048780488, 'Recall': 0.5517241379310345, 'F1': 0.6464646464646465, 'Acc': 0.5930232558139535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7804878048780488, 'Recall': 0.5517241379310345, 'F1': 0.6464646464646465, 'Acc': 0.5930232558139535}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6806751683354377, 'Valid Loss': 0.6892328479073264, 'Validation Metric': {'Precision': 0.8, 'Recall': 0.5517241379310345, 'F1': 0.6530612244897959, 'Acc': 0.6046511627906976}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.8, 'Recall': 0.5517241379310345, 'F1': 0.6530612244897959, 'Acc': 0.6046511627906976}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6789212793111801, 'Valid Loss': 0.6852624849839644, 'Validation Metric': {'Precision': 0.7884615384615384, 'Recall': 0.7068965517241379, 'F1': 0.7454545454545455, 'Acc': 0.6744186046511628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7884615384615384, 'Recall': 0.7068965517241379, 'F1': 0.7454545454545455, 'Acc': 0.6744186046511628}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6740599915385246, 'Valid Loss': 0.6804508133368059, 'Validation Metric': {'Precision': 0.7678571428571429, 'Recall': 0.7413793103448276, 'F1': 0.7543859649122806, 'Acc': 0.6744186046511628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7678571428571429, 'Recall': 0.7413793103448276, 'F1': 0.7543859649122806, 'Acc': 0.6744186046511628}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.661115138232708, 'Valid Loss': 0.673089861869812, 'Validation Metric': {'Precision': 0.7758620689655172, 'Recall': 0.7758620689655172, 'F1': 0.7758620689655173, 'Acc': 0.6976744186046512}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7758620689655172, 'Recall': 0.7758620689655172, 'F1': 0.7758620689655173, 'Acc': 0.6976744186046512}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6508133664727211, 'Valid Loss': 0.662281794981523, 'Validation Metric': {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.636275440454483, 'Valid Loss': 0.6509275057099082, 'Validation Metric': {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.620923264324665, 'Valid Loss': 0.6355087865482677, 'Validation Metric': {'Precision': 0.7580645161290323, 'Recall': 0.8103448275862069, 'F1': 0.7833333333333333, 'Acc': 0.6976744186046512}}
Best validation metric so far: {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6111776135861874, 'Valid Loss': 0.6260510574687611, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.7758620689655172, 'F1': 0.7627118644067795, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.5964265406131745, 'Valid Loss': 0.621625921942971, 'Validation Metric': {'Precision': 0.7627118644067796, 'Recall': 0.7758620689655172, 'F1': 0.7692307692307694, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5887336224317551, 'Valid Loss': 0.6184024594046853, 'Validation Metric': {'Precision': 0.7627118644067796, 'Recall': 0.7758620689655172, 'F1': 0.7692307692307694, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0.7704918032786885, 'Recall': 0.8103448275862069, 'F1': 0.7899159663865546, 'Acc': 0.7093023255813954}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6716417910447762, 'Recall': 0.9, 'F1': 0.7692307692307693, 'Acc': 0.686046511627907}; Test loss: 0.6607268235900186
