Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='mo')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6923993199036039, 'Valid Loss': 0.6749231490221891, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6943034098066133, 'Valid Loss': 0.6746027307076887, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6967024052965229, 'Valid Loss': 0.675333868373524, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6976072305235369, 'Valid Loss': 0.6770048466595736, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9186046511627907}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6979523907447683, 'Valid Loss': 0.6846723231402311, 'Validation Metric': {'Precision': 0.23076923076923078, 'Recall': 0.42857142857142855, 'F1': 0.3, 'Acc': 0.8372093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.23076923076923078, 'Recall': 0.42857142857142855, 'F1': 0.3, 'Acc': 0.8372093023255814}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.7006850653681261, 'Valid Loss': 0.6828860640525818, 'Validation Metric': {'Precision': 0.35294117647058826, 'Recall': 0.8571428571428571, 'F1': 0.5, 'Acc': 0.8604651162790697}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 0.8571428571428571, 'F1': 0.5, 'Acc': 0.8604651162790697}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6893364961805015, 'Valid Loss': 0.6874392411925576, 'Validation Metric': {'Precision': 0.17073170731707318, 'Recall': 1.0, 'F1': 0.2916666666666667, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 0.8571428571428571, 'F1': 0.5, 'Acc': 0.8604651162790697}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6696594861047022, 'Valid Loss': 0.6868256818164479, 'Validation Metric': {'Precision': 0.14893617021276595, 'Recall': 1.0, 'F1': 0.25925925925925924, 'Acc': 0.5348837209302325}}
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 0.8571428571428571, 'F1': 0.5, 'Acc': 0.8604651162790697}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6168456899708715, 'Valid Loss': 0.7303995273329995, 'Validation Metric': {'Precision': 0.1076923076923077, 'Recall': 1.0, 'F1': 0.19444444444444445, 'Acc': 0.32558139534883723}}
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 0.8571428571428571, 'F1': 0.5, 'Acc': 0.8604651162790697}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5487259865320963, 'Valid Loss': 0.6392680135640231, 'Validation Metric': {'Precision': 0.21875, 'Recall': 1.0, 'F1': 0.358974358974359, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.35294117647058826, 'Recall': 0.8571428571428571, 'F1': 0.5, 'Acc': 0.8604651162790697}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.43950443406557216, 'Valid Loss': 0.49152424931526184, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 1.0, 'F1': 0.56, 'Acc': 0.872093023255814}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3888888888888889, 'Recall': 1.0, 'F1': 0.56, 'Acc': 0.872093023255814}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.329893388624849, 'Valid Loss': 0.3606540425257249, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 1.0, 'F1': 0.7368421052631579, 'Acc': 0.9418604651162791}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5833333333333334, 'Recall': 1.0, 'F1': 0.7368421052631579, 'Acc': 0.9418604651162791}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.24045900178366694, 'Valid Loss': 0.26362950828942383, 'Validation Metric': {'Precision': 0.7, 'Recall': 1.0, 'F1': 0.8235294117647058, 'Acc': 0.9651162790697675}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7, 'Recall': 1.0, 'F1': 0.8235294117647058, 'Acc': 0.9651162790697675}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.179956561596743, 'Valid Loss': 0.20171928947622125, 'Validation Metric': {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.14053172753031912, 'Valid Loss': 0.16786699945276434, 'Validation Metric': {'Precision': 0.8333333333333334, 'Recall': 0.7142857142857143, 'F1': 0.7692307692307692, 'Acc': 0.9651162790697675}}
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.11448499611739454, 'Valid Loss': 0.1502863195809451, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.42857142857142855, 'F1': 0.5454545454545454, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.09978417249332214, 'Valid Loss': 0.14113068546761165, 'Validation Metric': {'Precision': 0.75, 'Recall': 0.42857142857142855, 'F1': 0.5454545454545454, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.08640732192273798, 'Valid Loss': 0.13694522292776543, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.2857142857142857, 'F1': 0.4, 'Acc': 0.9302325581395349}}
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.08153976808334219, 'Valid Loss': 0.13502271270210092, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.2857142857142857, 'F1': 0.4444444444444445, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.07524649548376429, 'Valid Loss': 0.1340539807623083, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.2857142857142857, 'F1': 0.4444444444444445, 'Acc': 0.9418604651162791}}
Best validation metric so far: {'Precision': 0.7777777777777778, 'Recall': 1.0, 'F1': 0.8750000000000001, 'Acc': 0.9767441860465116}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.625, 'Recall': 0.45454545454545453, 'F1': 0.5263157894736842, 'Acc': 0.8941176470588236}; Test loss: 0.30781085111878137
