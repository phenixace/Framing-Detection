Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ar')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.692554329832395, 'Valid Loss': 0.6877361102537676, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6929880628983179, 'Valid Loss': 0.6876405098221519, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6955223232507706, 'Valid Loss': 0.6877328374169089, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6953895423147414, 'Valid Loss': 0.6884198893200267, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6901908053292168, 'Valid Loss': 0.6889489564028654, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.691721111536026, 'Valid Loss': 0.6886443116448142, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6235294117647059}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6901210016674466, 'Valid Loss': 0.6896875717423179, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.0625, 'F1': 0.1, 'Acc': 0.5764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.0625, 'F1': 0.1, 'Acc': 0.5764705882352941}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.692159064941936, 'Valid Loss': 0.6905871250412681, 'Validation Metric': {'Precision': 0.4090909090909091, 'Recall': 0.28125, 'F1': 0.3333333333333333, 'Acc': 0.5764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4090909090909091, 'Recall': 0.28125, 'F1': 0.3333333333333333, 'Acc': 0.5764705882352941}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6862759987513224, 'Valid Loss': 0.690781755880876, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.46875, 'F1': 0.4838709677419355, 'Acc': 0.6235294117647059}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.46875, 'F1': 0.4838709677419355, 'Acc': 0.6235294117647059}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.685778796672821, 'Valid Loss': 0.6902836073528636, 'Validation Metric': {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6861901316377852, 'Valid Loss': 0.6886537400158969, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5, 'F1': 0.5, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6823483109474182, 'Valid Loss': 0.6866720914840698, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.40625, 'F1': 0.4482758620689655, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6762994014554553, 'Valid Loss': 0.6874590461904352, 'Validation Metric': {'Precision': 0.43902439024390244, 'Recall': 0.5625, 'F1': 0.4931506849315069, 'Acc': 0.5647058823529412}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6703027685483297, 'Valid Loss': 0.6860609704797919, 'Validation Metric': {'Precision': 0.41025641025641024, 'Recall': 0.5, 'F1': 0.4507042253521127, 'Acc': 0.5411764705882353}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6576767530706193, 'Valid Loss': 0.6855607683008368, 'Validation Metric': {'Precision': 0.4146341463414634, 'Recall': 0.53125, 'F1': 0.4657534246575343, 'Acc': 0.5411764705882353}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6479131480058035, 'Valid Loss': 0.6835107911716808, 'Validation Metric': {'Precision': 0.40476190476190477, 'Recall': 0.53125, 'F1': 0.4594594594594595, 'Acc': 0.5294117647058824}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6288609620597627, 'Valid Loss': 0.6834418502720919, 'Validation Metric': {'Precision': 0.38636363636363635, 'Recall': 0.53125, 'F1': 0.4473684210526316, 'Acc': 0.5058823529411764}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6135123156838946, 'Valid Loss': 0.6821840784766457, 'Validation Metric': {'Precision': 0.38636363636363635, 'Recall': 0.53125, 'F1': 0.4473684210526316, 'Acc': 0.5058823529411764}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6018098617593447, 'Valid Loss': 0.6812095696275885, 'Validation Metric': {'Precision': 0.3953488372093023, 'Recall': 0.53125, 'F1': 0.45333333333333325, 'Acc': 0.5176470588235295}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.5942856694261233, 'Valid Loss': 0.6806648211045698, 'Validation Metric': {'Precision': 0.3953488372093023, 'Recall': 0.53125, 'F1': 0.45333333333333325, 'Acc': 0.5176470588235295}}
Best validation metric so far: {'Precision': 0.4864864864864865, 'Recall': 0.5625, 'F1': 0.5217391304347827, 'Acc': 0.611764705882353}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6470588235294118, 'Recall': 0.4782608695652174, 'F1': 0.55, 'Acc': 0.5813953488372093}; Test loss: 0.6907013383778658
