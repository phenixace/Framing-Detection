Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ec')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6982868186970974, 'Valid Loss': 0.687673503702337, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.627906976744186}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6912636084759489, 'Valid Loss': 0.6877439509738575, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.627906976744186}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.692932406638531, 'Valid Loss': 0.6878898577256636, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.6395348837209303}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.69750399792448, 'Valid Loss': 0.6885595321655273, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.6395348837209303}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.03125, 'F1': 0.06060606060606061, 'Acc': 0.6395348837209303}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6975987401414425, 'Valid Loss': 0.6894882646473971, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.09375, 'F1': 0.16216216216216214, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.09375, 'F1': 0.16216216216216214, 'Acc': 0.6395348837209303}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6973527124587525, 'Valid Loss': 0.6896014701236378, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.5625, 'F1': 0.5538461538461538, 'Acc': 0.6627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.5625, 'F1': 0.5538461538461538, 'Acc': 0.6627906976744186}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6929065673909289, 'Valid Loss': 0.688875062899156, 'Validation Metric': {'Precision': 0.48936170212765956, 'Recall': 0.71875, 'F1': 0.5822784810126582, 'Acc': 0.6162790697674418}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.48936170212765956, 'Recall': 0.71875, 'F1': 0.5822784810126582, 'Acc': 0.6162790697674418}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6874034988119248, 'Valid Loss': 0.6862024556506764, 'Validation Metric': {'Precision': 0.5294117647058824, 'Recall': 0.84375, 'F1': 0.6506024096385543, 'Acc': 0.6627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5294117647058824, 'Recall': 0.84375, 'F1': 0.6506024096385543, 'Acc': 0.6627906976744186}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6784518728864953, 'Valid Loss': 0.6842066699808295, 'Validation Metric': {'Precision': 0.47540983606557374, 'Recall': 0.90625, 'F1': 0.6236559139784946, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.5294117647058824, 'Recall': 0.84375, 'F1': 0.6506024096385543, 'Acc': 0.6627906976744186}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6639459361421302, 'Valid Loss': 0.6738775426691229, 'Validation Metric': {'Precision': 0.5087719298245614, 'Recall': 0.90625, 'F1': 0.651685393258427, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5087719298245614, 'Recall': 0.90625, 'F1': 0.651685393258427, 'Acc': 0.6395348837209303}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6321232616901398, 'Valid Loss': 0.6601168567484076, 'Validation Metric': {'Precision': 0.4915254237288136, 'Recall': 0.90625, 'F1': 0.6373626373626373, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5087719298245614, 'Recall': 0.90625, 'F1': 0.651685393258427, 'Acc': 0.6395348837209303}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5761131041861595, 'Valid Loss': 0.6372534470124678, 'Validation Metric': {'Precision': 0.5272727272727272, 'Recall': 0.90625, 'F1': 0.6666666666666665, 'Acc': 0.6627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5272727272727272, 'Recall': 0.90625, 'F1': 0.6666666666666665, 'Acc': 0.6627906976744186}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5049535365814858, 'Valid Loss': 0.592632762410424, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.84375, 'F1': 0.675, 'Acc': 0.6976744186046512}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5625, 'Recall': 0.84375, 'F1': 0.675, 'Acc': 0.6976744186046512}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4390008382974787, 'Valid Loss': 0.5614686391570352, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.84375, 'F1': 0.7297297297297298, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.84375, 'F1': 0.7297297297297298, 'Acc': 0.7674418604651163}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.38641108889529047, 'Valid Loss': 0.5384182063016024, 'Validation Metric': {'Precision': 0.65, 'Recall': 0.8125, 'F1': 0.7222222222222223, 'Acc': 0.7674418604651163}}
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.84375, 'F1': 0.7297297297297298, 'Acc': 0.7674418604651163}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3385033921358433, 'Valid Loss': 0.5243296325206757, 'Validation Metric': {'Precision': 0.6578947368421053, 'Recall': 0.78125, 'F1': 0.7142857142857143, 'Acc': 0.7674418604651163}}
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.84375, 'F1': 0.7297297297297298, 'Acc': 0.7674418604651163}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.30163803030835823, 'Valid Loss': 0.5148365768519315, 'Validation Metric': {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2785141325377403, 'Valid Loss': 0.5103634148836136, 'Validation Metric': {'Precision': 0.6857142857142857, 'Recall': 0.75, 'F1': 0.7164179104477612, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.26462978616039806, 'Valid Loss': 0.5090080878951333, 'Validation Metric': {'Precision': 0.6857142857142857, 'Recall': 0.75, 'F1': 0.7164179104477612, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.24274562077319367, 'Valid Loss': 0.5075013502077623, 'Validation Metric': {'Precision': 0.6857142857142857, 'Recall': 0.75, 'F1': 0.7164179104477612, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.6944444444444444, 'Recall': 0.78125, 'F1': 0.7352941176470588, 'Acc': 0.7906976744186046}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5, 'Recall': 0.625, 'F1': 0.5555555555555556, 'Acc': 0.7209302325581395}; Test loss: 0.5324182889678262
