Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='mo')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6916613434923107, 'Valid Loss': 0.6775845018300143, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6938572803447987, 'Valid Loss': 0.6777491840449247, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6973675304445727, 'Valid Loss': 0.6775160486047919, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6987510015224588, 'Valid Loss': 0.6800682978196577, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8705882352941177}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6977046039597742, 'Valid Loss': 0.6861336068673567, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.2727272727272727, 'F1': 0.2608695652173913, 'Acc': 0.8}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.25, 'Recall': 0.2727272727272727, 'F1': 0.2608695652173913, 'Acc': 0.8}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6967176466152586, 'Valid Loss': 0.691000678322532, 'Validation Metric': {'Precision': 0.20454545454545456, 'Recall': 0.8181818181818182, 'F1': 0.3272727272727273, 'Acc': 0.5647058823529412}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.20454545454545456, 'Recall': 0.8181818181818182, 'F1': 0.3272727272727273, 'Acc': 0.5647058823529412}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6849715678856291, 'Valid Loss': 0.6941441893577576, 'Validation Metric': {'Precision': 0.17857142857142858, 'Recall': 0.9090909090909091, 'F1': 0.2985074626865672, 'Acc': 0.4470588235294118}}
Best validation metric so far: {'Precision': 0.20454545454545456, 'Recall': 0.8181818181818182, 'F1': 0.3272727272727273, 'Acc': 0.5647058823529412}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.65800682326843, 'Valid Loss': 0.7089810371398926, 'Validation Metric': {'Precision': 0.16666666666666666, 'Recall': 1.0, 'F1': 0.2857142857142857, 'Acc': 0.35294117647058826}}
Best validation metric so far: {'Precision': 0.20454545454545456, 'Recall': 0.8181818181818182, 'F1': 0.3272727272727273, 'Acc': 0.5647058823529412}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6003673354099537, 'Valid Loss': 0.7617619362744418, 'Validation Metric': {'Precision': 0.171875, 'Recall': 1.0, 'F1': 0.29333333333333333, 'Acc': 0.3764705882352941}}
Best validation metric so far: {'Precision': 0.20454545454545456, 'Recall': 0.8181818181818182, 'F1': 0.3272727272727273, 'Acc': 0.5647058823529412}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.4997831141126567, 'Valid Loss': 0.6760972250591625, 'Validation Metric': {'Precision': 0.23404255319148937, 'Recall': 1.0, 'F1': 0.3793103448275862, 'Acc': 0.5764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.23404255319148937, 'Recall': 1.0, 'F1': 0.3793103448275862, 'Acc': 0.5764705882352941}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.394142152548864, 'Valid Loss': 0.45080339908599854, 'Validation Metric': {'Precision': 0.42105263157894735, 'Recall': 0.7272727272727273, 'F1': 0.5333333333333333, 'Acc': 0.8352941176470589}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42105263157894735, 'Recall': 0.7272727272727273, 'F1': 0.5333333333333333, 'Acc': 0.8352941176470589}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2585905535981573, 'Valid Loss': 0.3322118737480857, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1814095936715603, 'Valid Loss': 0.26568031920628116, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.5454545454545454, 'F1': 0.5714285714285713, 'Acc': 0.8941176470588236}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.12915034714187013, 'Valid Loss': 0.2426669563759457, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.0968117209087158, 'Valid Loss': 0.23833522674712268, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.07939254052551656, 'Valid Loss': 0.240706936202266, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.070436407940398, 'Valid Loss': 0.2434451673179865, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.060273244366820515, 'Valid Loss': 0.24825269999829205, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.05449619369003279, 'Valid Loss': 0.25091978755186906, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.051199638959148835, 'Valid Loss': 0.2529785878617655, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.45454545454545453, 'F1': 0.5555555555555556, 'Acc': 0.9058823529411765}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.7272727272727273, 'F1': 0.64, 'Acc': 0.8941176470588236}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.25, 'Recall': 0.6, 'F1': 0.35294117647058826, 'Acc': 0.8705882352941177}; Test loss: 0.3682061338966543
