Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='hi')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6925275685458347, 'Valid Loss': 0.6757925586266951, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6946114815514663, 'Valid Loss': 0.6758488308299672, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6973584068232569, 'Valid Loss': 0.6758514696901495, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6981625310305891, 'Valid Loss': 0.6806529435244474, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.700500395791284, 'Valid Loss': 0.6868423982100054, 'Validation Metric': {'Precision': 0.07142857142857142, 'Recall': 0.125, 'F1': 0.09090909090909091, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.07142857142857142, 'Recall': 0.125, 'F1': 0.09090909090909091, 'Acc': 0.7674418604651163}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6987128740754621, 'Valid Loss': 0.6917665167288347, 'Validation Metric': {'Precision': 0.12195121951219512, 'Recall': 0.625, 'F1': 0.20408163265306123, 'Acc': 0.5465116279069767}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.12195121951219512, 'Recall': 0.625, 'F1': 0.20408163265306123, 'Acc': 0.5465116279069767}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.696751399286862, 'Valid Loss': 0.6910014586015181, 'Validation Metric': {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6757296457372862, 'Valid Loss': 0.7013464136557146, 'Validation Metric': {'Precision': 0.10714285714285714, 'Recall': 0.75, 'F1': 0.1875, 'Acc': 0.3953488372093023}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6512520426306231, 'Valid Loss': 0.7160223126411438, 'Validation Metric': {'Precision': 0.08771929824561403, 'Recall': 0.625, 'F1': 0.15384615384615383, 'Acc': 0.36046511627906974}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5851006631193489, 'Valid Loss': 0.7335317785089667, 'Validation Metric': {'Precision': 0.08, 'Recall': 0.5, 'F1': 0.13793103448275865, 'Acc': 0.4186046511627907}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.4931553502021165, 'Valid Loss': 0.6262379559603605, 'Validation Metric': {'Precision': 0.09523809523809523, 'Recall': 0.25, 'F1': 0.13793103448275862, 'Acc': 0.7093023255813954}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.3741329034854626, 'Valid Loss': 0.5346171747554432, 'Validation Metric': {'Precision': 0.07692307692307693, 'Recall': 0.125, 'F1': 0.09523809523809525, 'Acc': 0.7790697674418605}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.26881793969921, 'Valid Loss': 0.4852382662621411, 'Validation Metric': {'Precision': 0.09090909090909091, 'Recall': 0.125, 'F1': 0.10526315789473685, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.2049422803623923, 'Valid Loss': 0.44134635545990686, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.813953488372093}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.15564731778255825, 'Valid Loss': 0.41488886692307214, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8255813953488372}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.12774322207631736, 'Valid Loss': 0.4010372757911682, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.11095582674546488, 'Valid Loss': 0.392850205979564, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.09665367675238642, 'Valid Loss': 0.38813520764762705, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.086960903465234, 'Valid Loss': 0.38635779917240143, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.07891009067153108, 'Valid Loss': 0.38443387706171384, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 0.125, 'Recall': 0.625, 'F1': 0.20833333333333334, 'Acc': 0.5581395348837209}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.17391304347826086, 'Recall': 0.5714285714285714, 'F1': 0.26666666666666666, 'Acc': 0.4823529411764706}; Test loss: 0.6924985755573619
