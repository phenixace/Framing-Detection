Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ar')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6945652546304645, 'Valid Loss': 0.6900228912180121, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6917022358287465, 'Valid Loss': 0.6899945031512867, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6951287135933385, 'Valid Loss': 0.6899611191316084, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6923463796124314, 'Valid Loss': 0.6896100423552773, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6916120901252284, 'Valid Loss': 0.6895089528777383, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6892569625016415, 'Valid Loss': 0.6894254901192405, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6912595069769657, 'Valid Loss': 0.6887961192564531, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5697674418604651}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6861458438815493, 'Valid Loss': 0.6893576058474454, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.02702702702702703, 'F1': 0.05128205128205129, 'Acc': 0.5697674418604651}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.02702702702702703, 'F1': 0.05128205128205129, 'Acc': 0.5697674418604651}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6878602071241899, 'Valid Loss': 0.6889381517063488, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.02702702702702703, 'F1': 0.05, 'Acc': 0.5581395348837209}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.02702702702702703, 'F1': 0.05128205128205129, 'Acc': 0.5697674418604651}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6867308399894021, 'Valid Loss': 0.6889173496853221, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.08108108108108109, 'F1': 0.13636363636363638, 'Acc': 0.5581395348837209}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.08108108108108109, 'F1': 0.13636363636363638, 'Acc': 0.5581395348837209}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6836677500695894, 'Valid Loss': 0.6893565221266313, 'Validation Metric': {'Precision': 0.5217391304347826, 'Recall': 0.32432432432432434, 'F1': 0.4, 'Acc': 0.5813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.32432432432432434, 'F1': 0.4, 'Acc': 0.5813953488372093}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6873673616033612, 'Valid Loss': 0.6886747967113148, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.2972972972972973, 'F1': 0.38596491228070173, 'Acc': 0.5930232558139535}}
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.32432432432432434, 'F1': 0.4, 'Acc': 0.5813953488372093}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6837234731876489, 'Valid Loss': 0.6882136951793324, 'Validation Metric': {'Precision': 0.5652173913043478, 'Recall': 0.35135135135135137, 'F1': 0.43333333333333335, 'Acc': 0.6046511627906976}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5652173913043478, 'Recall': 0.35135135135135137, 'F1': 0.43333333333333335, 'Acc': 0.6046511627906976}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6834339156295314, 'Valid Loss': 0.6875282363458113, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.2972972972972973, 'F1': 0.37931034482758624, 'Acc': 0.5813953488372093}}
Best validation metric so far: {'Precision': 0.5652173913043478, 'Recall': 0.35135135135135137, 'F1': 0.43333333333333335, 'Acc': 0.6046511627906976}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6759989839611631, 'Valid Loss': 0.6870744878595526, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.4594594594594595, 'F1': 0.5230769230769231, 'Acc': 0.6395348837209303}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6071428571428571, 'Recall': 0.4594594594594595, 'F1': 0.5230769230769231, 'Acc': 0.6395348837209303}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6753291848934058, 'Valid Loss': 0.6864576610651884, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.4594594594594595, 'F1': 0.5151515151515151, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.6071428571428571, 'Recall': 0.4594594594594595, 'F1': 0.5230769230769231, 'Acc': 0.6395348837209303}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6723124095887849, 'Valid Loss': 0.6857224215160717, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.4594594594594595, 'F1': 0.5151515151515151, 'Acc': 0.627906976744186}}
Best validation metric so far: {'Precision': 0.6071428571428571, 'Recall': 0.4594594594594595, 'F1': 0.5230769230769231, 'Acc': 0.6395348837209303}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6726465875452216, 'Valid Loss': 0.6852674917741255, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.4864864864864865, 'F1': 0.5142857142857143, 'Acc': 0.6046511627906976}}
Best validation metric so far: {'Precision': 0.6071428571428571, 'Recall': 0.4594594594594595, 'F1': 0.5230769230769231, 'Acc': 0.6395348837209303}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6676778359846636, 'Valid Loss': 0.6850787997245789, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5405405405405406, 'F1': 0.547945205479452, 'Acc': 0.6162790697674418}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.5405405405405406, 'F1': 0.547945205479452, 'Acc': 0.6162790697674418}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6668391480590358, 'Valid Loss': 0.6848857348615472, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.5405405405405406, 'F1': 0.547945205479452, 'Acc': 0.6162790697674418}}
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.5405405405405406, 'F1': 0.547945205479452, 'Acc': 0.6162790697674418}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5588235294117647, 'Recall': 0.6333333333333333, 'F1': 0.59375, 'Acc': 0.6941176470588235}; Test loss: 0.6779101978648793
