Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='hi')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.695818937661355, 'Valid Loss': 0.67473473332145, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6964359534414191, 'Valid Loss': 0.6749385053461249, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7015329442526165, 'Valid Loss': 0.6758093454621055, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.9069767441860465}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6986164963036253, 'Valid Loss': 0.6804121786897833, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.7042309620924163, 'Valid Loss': 0.6866396177898754, 'Validation Metric': {'Precision': 0.26666666666666666, 'Recall': 0.5, 'F1': 0.3478260869565218, 'Acc': 0.8255813953488372}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.703420568976486, 'Valid Loss': 0.6929556998339567, 'Validation Metric': {'Precision': 0.14, 'Recall': 0.875, 'F1': 0.24137931034482757, 'Acc': 0.4883720930232558}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.702872097492218, 'Valid Loss': 0.6934914534742181, 'Validation Metric': {'Precision': 0.1346153846153846, 'Recall': 0.875, 'F1': 0.23333333333333334, 'Acc': 0.46511627906976744}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.691329440526795, 'Valid Loss': 0.6990319111130454, 'Validation Metric': {'Precision': 0.1111111111111111, 'Recall': 1.0, 'F1': 0.19999999999999998, 'Acc': 0.2558139534883721}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6903027714344493, 'Valid Loss': 0.6951855800368569, 'Validation Metric': {'Precision': 0.13559322033898305, 'Recall': 1.0, 'F1': 0.23880597014925373, 'Acc': 0.4069767441860465}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6805638419954401, 'Valid Loss': 0.6913186365907843, 'Validation Metric': {'Precision': 0.1702127659574468, 'Recall': 1.0, 'F1': 0.2909090909090909, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6672191578045226, 'Valid Loss': 0.6903750896453857, 'Validation Metric': {'Precision': 0.1702127659574468, 'Recall': 1.0, 'F1': 0.2909090909090909, 'Acc': 0.5465116279069767}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6361276523063057, 'Valid Loss': 0.7000563415614042, 'Validation Metric': {'Precision': 0.1509433962264151, 'Recall': 1.0, 'F1': 0.26229508196721313, 'Acc': 0.47674418604651164}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5865325253260764, 'Valid Loss': 0.7101147337393328, 'Validation Metric': {'Precision': 0.14285714285714285, 'Recall': 0.875, 'F1': 0.2456140350877193, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5262504865725836, 'Valid Loss': 0.6172934337095781, 'Validation Metric': {'Precision': 0.19230769230769232, 'Recall': 0.625, 'F1': 0.29411764705882354, 'Acc': 0.7209302325581395}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4445820207658567, 'Valid Loss': 0.5499051159078424, 'Validation Metric': {'Precision': 0.2, 'Recall': 0.375, 'F1': 0.26086956521739135, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.37590340930118893, 'Valid Loss': 0.4905849478461526, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.375, 'F1': 0.3, 'Acc': 0.8372093023255814}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.32465288696581857, 'Valid Loss': 0.4446731751615351, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.375, 'F1': 0.33333333333333326, 'Acc': 0.8604651162790697}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2782459110021591, 'Valid Loss': 0.4166495989669453, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.375, 'F1': 0.35294117647058826, 'Acc': 0.872093023255814}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.25481847203091573, 'Valid Loss': 0.39709316329522565, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.375, 'F1': 0.375, 'Acc': 0.8837209302325582}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.2358169440637555, 'Valid Loss': 0.3864133601838892, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.375, 'F1': 0.39999999999999997, 'Acc': 0.8953488372093024}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.25, 'F1': 0.4, 'Acc': 0.9302325581395349}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.872093023255814}; Test loss: 0.6814982891082764
