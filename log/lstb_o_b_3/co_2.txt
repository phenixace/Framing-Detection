Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='co')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6902616918087006, 'Valid Loss': 0.6981136473742399, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6937714644840786, 'Valid Loss': 0.6979134245352312, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38823529411764707}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6930216451485952, 'Valid Loss': 0.6969616088000211, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.019230769230769232, 'F1': 0.037037037037037035, 'Acc': 0.38823529411764707}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.019230769230769232, 'F1': 0.037037037037037035, 'Acc': 0.38823529411764707}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6939791994435447, 'Valid Loss': 0.6966762055050243, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.019230769230769232, 'F1': 0.037037037037037035, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.019230769230769232, 'F1': 0.037037037037037035, 'Acc': 0.38823529411764707}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6966059988453275, 'Valid Loss': 0.6957082856785167, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.019230769230769232, 'F1': 0.037037037037037035, 'Acc': 0.38823529411764707}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.019230769230769232, 'F1': 0.037037037037037035, 'Acc': 0.38823529411764707}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.693410975592477, 'Valid Loss': 0.695634511384097, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.038461538461538464, 'F1': 0.07272727272727274, 'Acc': 0.4}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.038461538461538464, 'F1': 0.07272727272727274, 'Acc': 0.4}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6917917018844968, 'Valid Loss': 0.6936847459186207, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.09615384615384616, 'F1': 0.16666666666666669, 'Acc': 0.4117647058823529}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.09615384615384616, 'F1': 0.16666666666666669, 'Acc': 0.4117647058823529}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6958406468232473, 'Valid Loss': 0.6924773996526544, 'Validation Metric': {'Precision': 0.7058823529411765, 'Recall': 0.23076923076923078, 'F1': 0.3478260869565218, 'Acc': 0.47058823529411764}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7058823529411765, 'Recall': 0.23076923076923078, 'F1': 0.3478260869565218, 'Acc': 0.47058823529411764}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6876143046787807, 'Valid Loss': 0.6916934468529441, 'Validation Metric': {'Precision': 0.7272727272727273, 'Recall': 0.3076923076923077, 'F1': 0.43243243243243246, 'Acc': 0.5058823529411764}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7272727272727273, 'Recall': 0.3076923076923077, 'F1': 0.43243243243243246, 'Acc': 0.5058823529411764}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6878482415562585, 'Valid Loss': 0.6899944814768705, 'Validation Metric': {'Precision': 0.7222222222222222, 'Recall': 0.5, 'F1': 0.5909090909090908, 'Acc': 0.5764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.5, 'F1': 0.5909090909090908, 'Acc': 0.5764705882352941}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6833131426856631, 'Valid Loss': 0.6902767528187145, 'Validation Metric': {'Precision': 0.6896551724137931, 'Recall': 0.38461538461538464, 'F1': 0.4938271604938272, 'Acc': 0.5176470588235295}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.5, 'F1': 0.5909090909090908, 'Acc': 0.5764705882352941}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.68306027281852, 'Valid Loss': 0.6892597566951405, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.38461538461538464, 'F1': 0.5, 'Acc': 0.5294117647058824}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.5, 'F1': 0.5909090909090908, 'Acc': 0.5764705882352941}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6778425801367987, 'Valid Loss': 0.687855904752558, 'Validation Metric': {'Precision': 0.7333333333333333, 'Recall': 0.4230769230769231, 'F1': 0.5365853658536585, 'Acc': 0.5529411764705883}}
Best validation metric so far: {'Precision': 0.7222222222222222, 'Recall': 0.5, 'F1': 0.5909090909090908, 'Acc': 0.5764705882352941}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6717725396156311, 'Valid Loss': 0.6834372715516523, 'Validation Metric': {'Precision': 0.723404255319149, 'Recall': 0.6538461538461539, 'F1': 0.6868686868686869, 'Acc': 0.6352941176470588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.723404255319149, 'Recall': 0.6538461538461539, 'F1': 0.6868686868686869, 'Acc': 0.6352941176470588}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6639207417056674, 'Valid Loss': 0.6774878718636252, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.7307692307692307, 'F1': 0.7037037037037038, 'Acc': 0.6235294117647059}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6785714285714286, 'Recall': 0.7307692307692307, 'F1': 0.7037037037037038, 'Acc': 0.6235294117647059}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6498672635782332, 'Valid Loss': 0.670138191093098, 'Validation Metric': {'Precision': 0.7049180327868853, 'Recall': 0.8269230769230769, 'F1': 0.7610619469026548, 'Acc': 0.6823529411764706}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7049180327868853, 'Recall': 0.8269230769230769, 'F1': 0.7610619469026548, 'Acc': 0.6823529411764706}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6400515593233562, 'Valid Loss': 0.6609803763302889, 'Validation Metric': {'Precision': 0.676923076923077, 'Recall': 0.8461538461538461, 'F1': 0.7521367521367521, 'Acc': 0.6588235294117647}}
Best validation metric so far: {'Precision': 0.7049180327868853, 'Recall': 0.8269230769230769, 'F1': 0.7610619469026548, 'Acc': 0.6823529411764706}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6250378219854265, 'Valid Loss': 0.6544840931892395, 'Validation Metric': {'Precision': 0.6818181818181818, 'Recall': 0.8653846153846154, 'F1': 0.7627118644067796, 'Acc': 0.6705882352941176}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6818181818181818, 'Recall': 0.8653846153846154, 'F1': 0.7627118644067796, 'Acc': 0.6705882352941176}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6122326638017382, 'Valid Loss': 0.6502668098969893, 'Validation Metric': {'Precision': 0.6818181818181818, 'Recall': 0.8653846153846154, 'F1': 0.7627118644067796, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.6818181818181818, 'Recall': 0.8653846153846154, 'F1': 0.7627118644067796, 'Acc': 0.6705882352941176}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6009335702373868, 'Valid Loss': 0.648963754827326, 'Validation Metric': {'Precision': 0.6818181818181818, 'Recall': 0.8653846153846154, 'F1': 0.7627118644067796, 'Acc': 0.6705882352941176}}
Best validation metric so far: {'Precision': 0.6818181818181818, 'Recall': 0.8653846153846154, 'F1': 0.7627118644067796, 'Acc': 0.6705882352941176}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6307692307692307, 'Recall': 0.8367346938775511, 'F1': 0.7192982456140352, 'Acc': 0.627906976744186}; Test loss: 0.660102741284804
