Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ar')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6951646858995612, 'Valid Loss': 0.6865389238704335, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6917047518672366, 'Valid Loss': 0.686507598920302, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6889653368429705, 'Valid Loss': 0.6871461109681563, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6895009766925465, 'Valid Loss': 0.6870008977976713, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6868555563868899, 'Valid Loss': 0.6868811845779419, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6920360688007239, 'Valid Loss': 0.6857662959532305, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6902170885692943, 'Valid Loss': 0.6850573041222312, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6907361511028174, 'Valid Loss': 0.6836401440880515, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6470588235294118}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6877537333604061, 'Valid Loss': 0.6837134740569375, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.03333333333333333, 'F1': 0.0625, 'Acc': 0.6470588235294118}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.03333333333333333, 'F1': 0.0625, 'Acc': 0.6470588235294118}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6849714318911234, 'Valid Loss': 0.6831105622378263, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.06666666666666667, 'F1': 0.1212121212121212, 'Acc': 0.6588235294117647}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.06666666666666667, 'F1': 0.1212121212121212, 'Acc': 0.6588235294117647}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6882893443107605, 'Valid Loss': 0.6837581883777272, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.2, 'F1': 0.27906976744186046, 'Acc': 0.6352941176470588}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.2, 'F1': 0.27906976744186046, 'Acc': 0.6352941176470588}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.6844278664299936, 'Valid Loss': 0.6820749911394987, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.2, 'F1': 0.27272727272727276, 'Acc': 0.6235294117647059}}
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.2, 'F1': 0.27906976744186046, 'Acc': 0.6352941176470588}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.6804452935854594, 'Valid Loss': 0.6802291545000944, 'Validation Metric': {'Precision': 0.6190476190476191, 'Recall': 0.43333333333333335, 'F1': 0.5098039215686274, 'Acc': 0.7058823529411765}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6190476190476191, 'Recall': 0.43333333333333335, 'F1': 0.5098039215686274, 'Acc': 0.7058823529411765}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.6824432123791088, 'Valid Loss': 0.6790192506530068, 'Validation Metric': {'Precision': 0.6206896551724138, 'Recall': 0.6, 'F1': 0.6101694915254238, 'Acc': 0.7294117647058823}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6206896551724138, 'Recall': 0.6, 'F1': 0.6101694915254238, 'Acc': 0.7294117647058823}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.6715523383834145, 'Valid Loss': 0.6769332018765536, 'Validation Metric': {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6333333333333333, 'Recall': 0.6333333333333333, 'F1': 0.6333333333333333, 'Acc': 0.7411764705882353}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.6745178988485625, 'Valid Loss': 0.674466691233895, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.7333333333333333, 'F1': 0.6984126984126984, 'Acc': 0.7764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.7333333333333333, 'F1': 0.6984126984126984, 'Acc': 0.7764705882352941}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.6662199063734575, 'Valid Loss': 0.672269198027524, 'Validation Metric': {'Precision': 0.6571428571428571, 'Recall': 0.7666666666666667, 'F1': 0.7076923076923077, 'Acc': 0.7764705882352941}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.7666666666666667, 'F1': 0.7076923076923077, 'Acc': 0.7764705882352941}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.6618502519347451, 'Valid Loss': 0.6699280684644525, 'Validation Metric': {'Precision': 0.6216216216216216, 'Recall': 0.7666666666666667, 'F1': 0.6865671641791045, 'Acc': 0.7529411764705882}}
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.7666666666666667, 'F1': 0.7076923076923077, 'Acc': 0.7764705882352941}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.6580062580831123, 'Valid Loss': 0.6683473261919889, 'Validation Metric': {'Precision': 0.631578947368421, 'Recall': 0.8, 'F1': 0.7058823529411765, 'Acc': 0.7647058823529411}}
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.7666666666666667, 'F1': 0.7076923076923077, 'Acc': 0.7764705882352941}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.6599208568081711, 'Valid Loss': 0.6671920581297441, 'Validation Metric': {'Precision': 0.631578947368421, 'Recall': 0.8, 'F1': 0.7058823529411765, 'Acc': 0.7647058823529411}}
Best validation metric so far: {'Precision': 0.6571428571428571, 'Recall': 0.7666666666666667, 'F1': 0.7076923076923077, 'Acc': 0.7764705882352941}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.42424242424242425, 'Recall': 0.4375, 'F1': 0.43076923076923074, 'Acc': 0.5647058823529412}; Test loss: 0.684161825613542
