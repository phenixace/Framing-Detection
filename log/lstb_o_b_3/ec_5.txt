Namespace(batch_size=8, checkpoint_dir='./ckp1/', dataset='./dataset_sentence/', dataset_balancing=True, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='concat', lm='longformer', log_dir='./log/stb_o_b_3/', lr=2e-06, max_len=256, n_passages=3, random_seed=1042, specified_label='ec')
parameters: 148664066
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.695302176475525, 'Valid Loss': 0.6862912015481428, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6926497128274706, 'Valid Loss': 0.6862990964542736, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6929185271263123, 'Valid Loss': 0.686798789284446, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.686046511627907}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.697541262043847, 'Valid Loss': 0.687406220219352, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.037037037037037035, 'F1': 0.06896551724137931, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.037037037037037035, 'F1': 0.06896551724137931, 'Acc': 0.686046511627907}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6925109399689569, 'Valid Loss': 0.6882945028218356, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.14814814814814814, 'F1': 0.22857142857142856, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.14814814814814814, 'F1': 0.22857142857142856, 'Acc': 0.686046511627907}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6944103850258722, 'Valid Loss': 0.6882287751544606, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.37037037037037035, 'F1': 0.4166666666666667, 'Acc': 0.6744186046511628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47619047619047616, 'Recall': 0.37037037037037035, 'F1': 0.4166666666666667, 'Acc': 0.6744186046511628}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6916437731848822, 'Valid Loss': 0.6862941601059653, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.37037037037037035, 'F1': 0.4166666666666667, 'Acc': 0.6744186046511628}}
Best validation metric so far: {'Precision': 0.47619047619047616, 'Recall': 0.37037037037037035, 'F1': 0.4166666666666667, 'Acc': 0.6744186046511628}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6858011590109931, 'Valid Loss': 0.6823470159010454, 'Validation Metric': {'Precision': 0.5185185185185185, 'Recall': 0.5185185185185185, 'F1': 0.5185185185185185, 'Acc': 0.6976744186046512}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5185185185185185, 'Recall': 0.5185185185185185, 'F1': 0.5185185185185185, 'Acc': 0.6976744186046512}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6750427616967095, 'Valid Loss': 0.6777571981603449, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.7037037037037037, 'F1': 0.5846153846153846, 'Acc': 0.686046511627907}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.7037037037037037, 'F1': 0.5846153846153846, 'Acc': 0.686046511627907}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6626039769914415, 'Valid Loss': 0.6648175608028065, 'Validation Metric': {'Precision': 0.4772727272727273, 'Recall': 0.7777777777777778, 'F1': 0.5915492957746479, 'Acc': 0.6627906976744186}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4772727272727273, 'Recall': 0.7777777777777778, 'F1': 0.5915492957746479, 'Acc': 0.6627906976744186}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.6296383447117275, 'Valid Loss': 0.6370786320079457, 'Validation Metric': {'Precision': 0.5116279069767442, 'Recall': 0.8148148148148148, 'F1': 0.6285714285714286, 'Acc': 0.6976744186046512}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5116279069767442, 'Recall': 0.8148148148148148, 'F1': 0.6285714285714286, 'Acc': 0.6976744186046512}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5743606375323401, 'Valid Loss': 0.5915284129706296, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.8148148148148148, 'F1': 0.6376811594202898, 'Acc': 0.7093023255813954}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5238095238095238, 'Recall': 0.8148148148148148, 'F1': 0.6376811594202898, 'Acc': 0.7093023255813954}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5194345851739247, 'Valid Loss': 0.5446685904806311, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.7777777777777778, 'F1': 0.6774193548387097, 'Acc': 0.7674418604651163}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.7777777777777778, 'F1': 0.6774193548387097, 'Acc': 0.7674418604651163}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.44277727405230205, 'Valid Loss': 0.5138691555369984, 'Validation Metric': {'Precision': 0.6176470588235294, 'Recall': 0.7777777777777778, 'F1': 0.6885245901639345, 'Acc': 0.7790697674418605}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6176470588235294, 'Recall': 0.7777777777777778, 'F1': 0.6885245901639345, 'Acc': 0.7790697674418605}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.39749565455648633, 'Valid Loss': 0.49529691717841406, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.7777777777777778, 'F1': 0.7000000000000001, 'Acc': 0.7906976744186046}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 0.7777777777777778, 'F1': 0.7000000000000001, 'Acc': 0.7906976744186046}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.360569942328665, 'Valid Loss': 0.4821040847084739, 'Validation Metric': {'Precision': 0.6451612903225806, 'Recall': 0.7407407407407407, 'F1': 0.689655172413793, 'Acc': 0.7906976744186046}}
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 0.7777777777777778, 'F1': 0.7000000000000001, 'Acc': 0.7906976744186046}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.32236365444130366, 'Valid Loss': 0.47728216783566907, 'Validation Metric': {'Precision': 0.6896551724137931, 'Recall': 0.7407407407407407, 'F1': 0.7142857142857143, 'Acc': 0.813953488372093}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6896551724137931, 'Recall': 0.7407407407407407, 'F1': 0.7142857142857143, 'Acc': 0.813953488372093}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.298678387204806, 'Valid Loss': 0.47378280758857727, 'Validation Metric': {'Precision': 0.6896551724137931, 'Recall': 0.7407407407407407, 'F1': 0.7142857142857143, 'Acc': 0.813953488372093}}
Best validation metric so far: {'Precision': 0.6896551724137931, 'Recall': 0.7407407407407407, 'F1': 0.7142857142857143, 'Acc': 0.813953488372093}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2868388166030248, 'Valid Loss': 0.47228340940041974, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.7037037037037037, 'F1': 0.6909090909090909, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.6896551724137931, 'Recall': 0.7407407407407407, 'F1': 0.7142857142857143, 'Acc': 0.813953488372093}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.27910451475116943, 'Valid Loss': 0.4721363037824631, 'Validation Metric': {'Precision': 0.6785714285714286, 'Recall': 0.7037037037037037, 'F1': 0.6909090909090909, 'Acc': 0.8023255813953488}}
Best validation metric so far: {'Precision': 0.6896551724137931, 'Recall': 0.7407407407407407, 'F1': 0.7142857142857143, 'Acc': 0.813953488372093}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5416666666666666, 'Recall': 0.5909090909090909, 'F1': 0.5652173913043478, 'Acc': 0.7647058823529411}; Test loss: 0.4604405449195342
