Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7708368905385335, 'Valid Loss': 0.7895361758195437, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7602004869778951, 'Valid Loss': 0.751896892602627, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7271811612447103, 'Valid Loss': 0.6988855394033285, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.5555555555555556, 'F1': 0.606060606060606, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.5555555555555556, 'F1': 0.606060606060606, 'Acc': 0.48514851485148514}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6830121942361196, 'Valid Loss': 0.6629713750802554, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6635228884220123, 'Valid Loss': 0.6416583829201185, 'Validation Metric': {'Precision': 0.7070707070707071, 'Recall': 0.9722222222222222, 'F1': 0.8187134502923977, 'Acc': 0.693069306930693}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7070707070707071, 'Recall': 0.9722222222222222, 'F1': 0.8187134502923977, 'Acc': 0.693069306930693}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6333258442083994, 'Valid Loss': 0.6471421592510663, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.9722222222222222, 'F1': 0.8235294117647058, 'Acc': 0.7029702970297029}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9722222222222222, 'F1': 0.8235294117647058, 'Acc': 0.7029702970297029}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6223156678676606, 'Valid Loss': 0.6390154854609416, 'Validation Metric': {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6032020246982575, 'Valid Loss': 0.6335430901784164, 'Validation Metric': {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5759246118863424, 'Valid Loss': 0.6428501216264871, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.9722222222222222, 'F1': 0.8235294117647058, 'Acc': 0.7029702970297029}}
Best validation metric so far: {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5713274844487508, 'Valid Loss': 0.6358861418870779, 'Validation Metric': {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5449444162845611, 'Valid Loss': 0.6402350148329368, 'Validation Metric': {'Precision': 0.71, 'Recall': 0.9861111111111112, 'F1': 0.8255813953488371, 'Acc': 0.7029702970297029}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5223149756590525, 'Valid Loss': 0.6410701870918274, 'Validation Metric': {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5080198216438293, 'Valid Loss': 0.6351187011370292, 'Validation Metric': {'Precision': 0.7171717171717171, 'Recall': 0.9861111111111112, 'F1': 0.8304093567251463, 'Acc': 0.7128712871287128}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5054211807250977, 'Valid Loss': 0.6366300491186289, 'Validation Metric': {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.48908802986145017, 'Valid Loss': 0.6382476630119177, 'Validation Metric': {'Precision': 0.7096774193548387, 'Recall': 0.9166666666666666, 'F1': 0.7999999999999999, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4777662601073583, 'Valid Loss': 0.6429197329741257, 'Validation Metric': {'Precision': 0.7127659574468085, 'Recall': 0.9305555555555556, 'F1': 0.8072289156626508, 'Acc': 0.6831683168316832}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.469814839164416, 'Valid Loss': 0.6384960688077487, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4599380099773407, 'Valid Loss': 0.6388741089747503, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.46200804551442465, 'Valid Loss': 0.6394809828354762, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.45284955501556395, 'Valid Loss': 0.6397627007502776, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.7128712871287128, 'Recall': 1.0, 'F1': 0.8323699421965318, 'Acc': 0.7128712871287128}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}; Test loss: 0.6824852079153061
