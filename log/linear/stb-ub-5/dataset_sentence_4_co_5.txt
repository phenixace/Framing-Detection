Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7657395177765897, 'Valid Loss': 0.7484612854627463, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38613861386138615}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38613861386138615}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7621292832650637, 'Valid Loss': 0.7221199296987973, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38613861386138615}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.38613861386138615}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7254528732676255, 'Valid Loss': 0.6844298518621005, 'Validation Metric': {'Precision': 0.609375, 'Recall': 0.6290322580645161, 'F1': 0.6190476190476191, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.609375, 'Recall': 0.6290322580645161, 'F1': 0.6190476190476191, 'Acc': 0.5247524752475248}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6904723228592622, 'Valid Loss': 0.6742929632847126, 'Validation Metric': {'Precision': 0.5978260869565217, 'Recall': 0.8870967741935484, 'F1': 0.7142857142857144, 'Acc': 0.5643564356435643}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5978260869565217, 'Recall': 0.8870967741935484, 'F1': 0.7142857142857144, 'Acc': 0.5643564356435643}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6650321726736269, 'Valid Loss': 0.6683554374254667, 'Validation Metric': {'Precision': 0.6122448979591837, 'Recall': 0.967741935483871, 'F1': 0.75, 'Acc': 0.6039603960396039}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6122448979591837, 'Recall': 0.967741935483871, 'F1': 0.75, 'Acc': 0.6039603960396039}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6429240789852644, 'Valid Loss': 0.672942518041684, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6200944714640316, 'Valid Loss': 0.6758332997560501, 'Validation Metric': {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6002461588696429, 'Valid Loss': 0.6815552986585177, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5690607393258497, 'Valid Loss': 0.6802144233997052, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5484908864294228, 'Valid Loss': 0.6848769726661535, 'Validation Metric': {'Precision': 0.6122448979591837, 'Recall': 0.967741935483871, 'F1': 0.75, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5280903981704461, 'Valid Loss': 0.6809275207611231, 'Validation Metric': {'Precision': 0.6122448979591837, 'Recall': 0.967741935483871, 'F1': 0.75, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5069328307321197, 'Valid Loss': 0.6819448344982587, 'Validation Metric': {'Precision': 0.6082474226804123, 'Recall': 0.9516129032258065, 'F1': 0.742138364779874, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4938980456637709, 'Valid Loss': 0.680374977680353, 'Validation Metric': {'Precision': 0.6122448979591837, 'Recall': 0.967741935483871, 'F1': 0.75, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.48521790614253596, 'Valid Loss': 0.6852298378944397, 'Validation Metric': {'Precision': 0.6145833333333334, 'Recall': 0.9516129032258065, 'F1': 0.7468354430379748, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4673768821123399, 'Valid Loss': 0.6841118828608439, 'Validation Metric': {'Precision': 0.6145833333333334, 'Recall': 0.9516129032258065, 'F1': 0.7468354430379748, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.453951306248966, 'Valid Loss': 0.6869454636023595, 'Validation Metric': {'Precision': 0.6105263157894737, 'Recall': 0.9354838709677419, 'F1': 0.7388535031847133, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.44316435899389417, 'Valid Loss': 0.6828779234335973, 'Validation Metric': {'Precision': 0.6210526315789474, 'Recall': 0.9516129032258065, 'F1': 0.7515923566878981, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4445197770470067, 'Valid Loss': 0.6831310219489611, 'Validation Metric': {'Precision': 0.6105263157894737, 'Recall': 0.9354838709677419, 'F1': 0.7388535031847133, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4369249967368026, 'Valid Loss': 0.6852404142801578, 'Validation Metric': {'Precision': 0.6170212765957447, 'Recall': 0.9354838709677419, 'F1': 0.7435897435897436, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4316828376368472, 'Valid Loss': 0.685126909842858, 'Validation Metric': {'Precision': 0.6170212765957447, 'Recall': 0.9354838709677419, 'F1': 0.7435897435897436, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.6161616161616161, 'Recall': 0.9838709677419355, 'F1': 0.7577639751552795, 'Acc': 0.6138613861386139}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7070707070707071, 'Recall': 0.9859154929577465, 'F1': 0.8235294117647058, 'Acc': 0.7}; Test loss: 0.6446030163764953
