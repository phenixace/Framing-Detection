Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7016339200107675, 'Valid Loss': 0.7310664272308349, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.704368816394555, 'Valid Loss': 0.7241022038459778, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.01818181818181818, 'F1': 0.03571428571428572, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.01818181818181818, 'F1': 0.03571428571428572, 'Acc': 0.46}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7050841364421343, 'Valid Loss': 0.714630880355835, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.01818181818181818, 'F1': 0.03508771929824561, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.01818181818181818, 'F1': 0.03571428571428572, 'Acc': 0.46}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6964869907027796, 'Valid Loss': 0.7071176743507386, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.03636363636363636, 'F1': 0.06779661016949153, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.03636363636363636, 'F1': 0.06779661016949153, 'Acc': 0.45}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6850253202413258, 'Valid Loss': 0.7011520862579346, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.12727272727272726, 'F1': 0.20588235294117643, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.12727272727272726, 'F1': 0.20588235294117643, 'Acc': 0.46}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6752769892152987, 'Valid Loss': 0.7009053707122803, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.16363636363636364, 'F1': 0.2535211267605634, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5625, 'Recall': 0.16363636363636364, 'F1': 0.2535211267605634, 'Acc': 0.47}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6590192663042169, 'Valid Loss': 0.7000436186790466, 'Validation Metric': {'Precision': 0.5588235294117647, 'Recall': 0.34545454545454546, 'F1': 0.42696629213483145, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.34545454545454546, 'F1': 0.42696629213483145, 'Acc': 0.49}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6390626030532938, 'Valid Loss': 0.7005195116996765, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.3090909090909091, 'F1': 0.4047619047619047, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.34545454545454546, 'F1': 0.42696629213483145, 'Acc': 0.49}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6166253262444547, 'Valid Loss': 0.701879198551178, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.2727272727272727, 'F1': 0.3529411764705882, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.34545454545454546, 'F1': 0.42696629213483145, 'Acc': 0.49}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5850599576768122, 'Valid Loss': 0.7047927808761597, 'Validation Metric': {'Precision': 0.5185185185185185, 'Recall': 0.2545454545454545, 'F1': 0.3414634146341463, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.5588235294117647, 'Recall': 0.34545454545454546, 'F1': 0.42696629213483145, 'Acc': 0.49}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5852569686739069, 'Valid Loss': 0.7070961022377014, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.555388169461175, 'Valid Loss': 0.7088351249694824, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.2909090909090909, 'F1': 0.35955056179775285, 'Acc': 0.43}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.532428691261693, 'Valid Loss': 0.7093886470794678, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.32727272727272727, 'F1': 0.3956043956043956, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5164264530727738, 'Valid Loss': 0.7101751923561096, 'Validation Metric': {'Precision': 0.525, 'Recall': 0.38181818181818183, 'F1': 0.4421052631578947, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5036278739571571, 'Valid Loss': 0.7097860288619995, 'Validation Metric': {'Precision': 0.5789473684210527, 'Recall': 0.4, 'F1': 0.4731182795698925, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.48473717958519336, 'Valid Loss': 0.7112803983688355, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.43636363636363634, 'F1': 0.4948453608247423, 'Acc': 0.51}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.47922672056838084, 'Valid Loss': 0.7098951220512391, 'Validation Metric': {'Precision': 0.5952380952380952, 'Recall': 0.45454545454545453, 'F1': 0.5154639175257733, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5952380952380952, 'Recall': 0.45454545454545453, 'F1': 0.5154639175257733, 'Acc': 0.53}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4653906237922217, 'Valid Loss': 0.7082645463943481, 'Validation Metric': {'Precision': 0.5853658536585366, 'Recall': 0.43636363636363634, 'F1': 0.5, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5952380952380952, 'Recall': 0.45454545454545453, 'F1': 0.5154639175257733, 'Acc': 0.53}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4601543271227887, 'Valid Loss': 0.7104876399040222, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.43636363636363634, 'F1': 0.5052631578947367, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5952380952380952, 'Recall': 0.45454545454545453, 'F1': 0.5154639175257733, 'Acc': 0.53}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4612166650201145, 'Valid Loss': 0.7110438251495361, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.43636363636363634, 'F1': 0.5052631578947367, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5952380952380952, 'Recall': 0.45454545454545453, 'F1': 0.5154639175257733, 'Acc': 0.53}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4444444444444444, 'Recall': 0.4, 'F1': 0.4210526315789474, 'Acc': 0.45544554455445546}; Test loss: 0.7070376735467178
