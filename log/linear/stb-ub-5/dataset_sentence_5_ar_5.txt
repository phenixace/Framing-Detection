Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7197523513122609, 'Valid Loss': 0.7163437294960022, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7168244625392713, 'Valid Loss': 0.7074260401725769, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7118303328752518, 'Valid Loss': 0.6959043526649475, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.05555555555555555, 'F1': 0.10169491525423728, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.05555555555555555, 'F1': 0.10169491525423728, 'Acc': 0.47}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.696849428509411, 'Valid Loss': 0.6902222156524658, 'Validation Metric': {'Precision': 0.5789473684210527, 'Recall': 0.4074074074074074, 'F1': 0.47826086956521735, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5789473684210527, 'Recall': 0.4074074074074074, 'F1': 0.47826086956521735, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6892228644145163, 'Valid Loss': 0.6897032356262207, 'Validation Metric': {'Precision': 0.5897435897435898, 'Recall': 0.42592592592592593, 'F1': 0.49462365591397855, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5897435897435898, 'Recall': 0.42592592592592593, 'F1': 0.49462365591397855, 'Acc': 0.53}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6793680504748696, 'Valid Loss': 0.6910620021820069, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.5185185185185185, 'F1': 0.5384615384615384, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.56, 'Recall': 0.5185185185185185, 'F1': 0.5384615384615384, 'Acc': 0.52}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6688961998412484, 'Valid Loss': 0.6926166319847107, 'Validation Metric': {'Precision': 0.5254237288135594, 'Recall': 0.5740740740740741, 'F1': 0.5486725663716815, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5254237288135594, 'Recall': 0.5740740740740741, 'F1': 0.5486725663716815, 'Acc': 0.49}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6460418065911845, 'Valid Loss': 0.6940582299232483, 'Validation Metric': {'Precision': 0.55, 'Recall': 0.6111111111111112, 'F1': 0.5789473684210527, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.55, 'Recall': 0.6111111111111112, 'F1': 0.5789473684210527, 'Acc': 0.52}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6289086169318149, 'Valid Loss': 0.6942699146270752, 'Validation Metric': {'Precision': 0.5689655172413793, 'Recall': 0.6111111111111112, 'F1': 0.5892857142857143, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5689655172413793, 'Recall': 0.6111111111111112, 'F1': 0.5892857142857143, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5991680375055263, 'Valid Loss': 0.6985729789733887, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.5925925925925926, 'F1': 0.5925925925925926, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5925925925925926, 'Recall': 0.5925925925925926, 'F1': 0.5925925925925926, 'Acc': 0.56}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5835842098060408, 'Valid Loss': 0.6994681072235107, 'Validation Metric': {'Precision': 0.54, 'Recall': 0.5, 'F1': 0.5192307692307693, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5925925925925926, 'Recall': 0.5925925925925926, 'F1': 0.5925925925925926, 'Acc': 0.56}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5716358956537748, 'Valid Loss': 0.6949635481834412, 'Validation Metric': {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5494789461556234, 'Valid Loss': 0.6957001876831055, 'Validation Metric': {'Precision': 0.5740740740740741, 'Recall': 0.5740740740740741, 'F1': 0.5740740740740741, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5390250192661035, 'Valid Loss': 0.6986788821220398, 'Validation Metric': {'Precision': 0.5918367346938775, 'Recall': 0.5370370370370371, 'F1': 0.5631067961165048, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.522141112700889, 'Valid Loss': 0.6975387024879456, 'Validation Metric': {'Precision': 0.5833333333333334, 'Recall': 0.5185185185185185, 'F1': 0.5490196078431373, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5095038770845062, 'Valid Loss': 0.6958432173728943, 'Validation Metric': {'Precision': 0.5961538461538461, 'Recall': 0.5740740740740741, 'F1': 0.5849056603773585, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5052841478272488, 'Valid Loss': 0.697118456363678, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.5, 'F1': 0.5294117647058824, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4924770166215144, 'Valid Loss': 0.69728679895401, 'Validation Metric': {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4839039264540923, 'Valid Loss': 0.6974476146697998, 'Validation Metric': {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.48496593025169876, 'Valid Loss': 0.6973112535476684, 'Validation Metric': {'Precision': 0.5925925925925926, 'Recall': 0.5925925925925926, 'F1': 0.5925925925925926, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5932203389830508, 'Recall': 0.6481481481481481, 'F1': 0.6194690265486725, 'Acc': 0.57}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4, 'Recall': 0.5581395348837209, 'F1': 0.4660194174757281, 'Acc': 0.45}; Test loss: 0.7297997641563415
