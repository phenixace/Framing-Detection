Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7659617348721153, 'Valid Loss': 0.8007107639312744, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.29}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.29}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7624322638699883, 'Valid Loss': 0.762432804107666, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.028169014084507043, 'F1': 0.054054054054054064, 'Acc': 0.3}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.028169014084507043, 'F1': 0.054054054054054064, 'Acc': 0.3}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7290744961876618, 'Valid Loss': 0.7090991711616517, 'Validation Metric': {'Precision': 0.6304347826086957, 'Recall': 0.4084507042253521, 'F1': 0.49572649572649574, 'Acc': 0.41}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6304347826086957, 'Recall': 0.4084507042253521, 'F1': 0.49572649572649574, 'Acc': 0.41}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6857884463511015, 'Valid Loss': 0.6711426711082459, 'Validation Metric': {'Precision': 0.6931818181818182, 'Recall': 0.8591549295774648, 'F1': 0.7672955974842768, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6931818181818182, 'Recall': 0.8591549295774648, 'F1': 0.7672955974842768, 'Acc': 0.63}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6585389987418526, 'Valid Loss': 0.6440379023551941, 'Validation Metric': {'Precision': 0.7052631578947368, 'Recall': 0.9436619718309859, 'F1': 0.8072289156626505, 'Acc': 0.68}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7052631578947368, 'Recall': 0.9436619718309859, 'F1': 0.8072289156626505, 'Acc': 0.68}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6374546689422507, 'Valid Loss': 0.63158203125, 'Validation Metric': {'Precision': 0.711340206185567, 'Recall': 0.971830985915493, 'F1': 0.8214285714285714, 'Acc': 0.7}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.971830985915493, 'F1': 0.8214285714285714, 'Acc': 0.7}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6113273540609762, 'Valid Loss': 0.6372586452960968, 'Validation Metric': {'Precision': 0.7070707070707071, 'Recall': 0.9859154929577465, 'F1': 0.8235294117647058, 'Acc': 0.7}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7070707070707071, 'Recall': 0.9859154929577465, 'F1': 0.8235294117647058, 'Acc': 0.7}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.597369079527102, 'Valid Loss': 0.6362626194953919, 'Validation Metric': {'Precision': 0.7070707070707071, 'Recall': 0.9859154929577465, 'F1': 0.8235294117647058, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.7070707070707071, 'Recall': 0.9859154929577465, 'F1': 0.8235294117647058, 'Acc': 0.7}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5624295414278382, 'Valid Loss': 0.6404095530509949, 'Validation Metric': {'Precision': 0.7010309278350515, 'Recall': 0.9577464788732394, 'F1': 0.8095238095238095, 'Acc': 0.68}}
Best validation metric so far: {'Precision': 0.7070707070707071, 'Recall': 0.9859154929577465, 'F1': 0.8235294117647058, 'Acc': 0.7}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5399001687765121, 'Valid Loss': 0.64475337266922, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5344646447583249, 'Valid Loss': 0.645854594707489, 'Validation Metric': {'Precision': 0.6989247311827957, 'Recall': 0.9154929577464789, 'F1': 0.7926829268292684, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5067568495869637, 'Valid Loss': 0.6419895613193511, 'Validation Metric': {'Precision': 0.6989247311827957, 'Recall': 0.9154929577464789, 'F1': 0.7926829268292684, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.494368684723189, 'Valid Loss': 0.6406330156326294, 'Validation Metric': {'Precision': 0.6956521739130435, 'Recall': 0.9014084507042254, 'F1': 0.7852760736196318, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4816108651851353, 'Valid Loss': 0.6438909184932708, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.8873239436619719, 'F1': 0.7777777777777779, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4664583582627146, 'Valid Loss': 0.6392862355709076, 'Validation Metric': {'Precision': 0.7032967032967034, 'Recall': 0.9014084507042254, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.45065912310230105, 'Valid Loss': 0.645777280330658, 'Validation Metric': {'Precision': 0.6966292134831461, 'Recall': 0.8732394366197183, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.44381431137260635, 'Valid Loss': 0.6440677762031555, 'Validation Metric': {'Precision': 0.6966292134831461, 'Recall': 0.8732394366197183, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.44448833677329513, 'Valid Loss': 0.6480748283863068, 'Validation Metric': {'Precision': 0.6966292134831461, 'Recall': 0.8732394366197183, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4282095453848964, 'Valid Loss': 0.6405341696739196, 'Validation Metric': {'Precision': 0.6966292134831461, 'Recall': 0.8732394366197183, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.42826481065467786, 'Valid Loss': 0.6430040800571442, 'Validation Metric': {'Precision': 0.6966292134831461, 'Recall': 0.8732394366197183, 'F1': 0.775, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.9859154929577465, 'F1': 0.8284023668639053, 'Acc': 0.71}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}; Test loss: 0.6597457242012024
