Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7068913904459853, 'Valid Loss': 0.7148462751737008, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4752475247524752}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7065541767760327, 'Valid Loss': 0.7106425005656022, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4752475247524752}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7054989894754008, 'Valid Loss': 0.7047643248851483, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.4752475247524752}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6982775118790174, 'Valid Loss': 0.6992697142637693, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.018867924528301886, 'F1': 0.03636363636363636, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.018867924528301886, 'F1': 0.03636363636363636, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6911286860704422, 'Valid Loss': 0.696415745295011, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.11320754716981132, 'F1': 0.1935483870967742, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.11320754716981132, 'F1': 0.1935483870967742, 'Acc': 0.504950495049505}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6822637507790014, 'Valid Loss': 0.6920788631989405, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.2830188679245283, 'F1': 0.38961038961038963, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.2830188679245283, 'F1': 0.38961038961038963, 'Acc': 0.5346534653465347}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6714352604589964, 'Valid Loss': 0.6915914622636942, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.41509433962264153, 'F1': 0.4943820224719102, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.41509433962264153, 'F1': 0.4943820224719102, 'Acc': 0.5544554455445545}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6514657939735212, 'Valid Loss': 0.6871461249314822, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.39622641509433965, 'F1': 0.4772727272727273, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.41509433962264153, 'F1': 0.4943820224719102, 'Acc': 0.5544554455445545}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6373110601776525, 'Valid Loss': 0.6895833290540255, 'Validation Metric': {'Precision': 0.5476190476190477, 'Recall': 0.4339622641509434, 'F1': 0.48421052631578954, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.41509433962264153, 'F1': 0.4943820224719102, 'Acc': 0.5544554455445545}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6108817234635353, 'Valid Loss': 0.694619181064459, 'Validation Metric': {'Precision': 0.5263157894736842, 'Recall': 0.37735849056603776, 'F1': 0.43956043956043955, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.41509433962264153, 'F1': 0.4943820224719102, 'Acc': 0.5544554455445545}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5908023652277494, 'Valid Loss': 0.6989182497446353, 'Validation Metric': {'Precision': 0.48717948717948717, 'Recall': 0.3584905660377358, 'F1': 0.41304347826086957, 'Acc': 0.46534653465346537}}
Best validation metric so far: {'Precision': 0.6111111111111112, 'Recall': 0.41509433962264153, 'F1': 0.4943820224719102, 'Acc': 0.5544554455445545}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5650649549145448, 'Valid Loss': 0.6995841287649595, 'Validation Metric': {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.544028876251296, 'Valid Loss': 0.7057355550619272, 'Validation Metric': {'Precision': 0.5227272727272727, 'Recall': 0.4339622641509434, 'F1': 0.4742268041237114, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5206744949284353, 'Valid Loss': 0.7101933417411951, 'Validation Metric': {'Precision': 0.5116279069767442, 'Recall': 0.41509433962264153, 'F1': 0.45833333333333337, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5089510949818712, 'Valid Loss': 0.715154060950646, 'Validation Metric': {'Precision': 0.5116279069767442, 'Recall': 0.41509433962264153, 'F1': 0.45833333333333337, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4976441522962169, 'Valid Loss': 0.7181535603908392, 'Validation Metric': {'Precision': 0.5116279069767442, 'Recall': 0.41509433962264153, 'F1': 0.45833333333333337, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4837332312998019, 'Valid Loss': 0.7207753027860935, 'Validation Metric': {'Precision': 0.5121951219512195, 'Recall': 0.39622641509433965, 'F1': 0.44680851063829785, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.479866203508879, 'Valid Loss': 0.7220628903462336, 'Validation Metric': {'Precision': 0.5121951219512195, 'Recall': 0.39622641509433965, 'F1': 0.44680851063829785, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4746102741674373, 'Valid Loss': 0.7230666772677348, 'Validation Metric': {'Precision': 0.5111111111111111, 'Recall': 0.4339622641509434, 'F1': 0.46938775510204084, 'Acc': 0.48514851485148514}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4659979649280247, 'Valid Loss': 0.7229516746906134, 'Validation Metric': {'Precision': 0.5348837209302325, 'Recall': 0.4339622641509434, 'F1': 0.47916666666666663, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5319148936170213, 'Recall': 0.4716981132075472, 'F1': 0.4999999999999999, 'Acc': 0.504950495049505}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5384615384615384, 'Recall': 0.5185185185185185, 'F1': 0.5283018867924528, 'Acc': 0.5}; Test loss: 0.6987810778617859
