Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-5/', lr=2e-06, max_len=64, n_passages=5, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7117087954753324, 'Valid Loss': 0.6846062779426575, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7112865553874719, 'Valid Loss': 0.6837330746650696, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7078667565395957, 'Valid Loss': 0.6849560451507568, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6906578078081733, 'Valid Loss': 0.6880978274345398, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.13953488372093023, 'F1': 0.2068965517241379, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4, 'Recall': 0.13953488372093023, 'F1': 0.2068965517241379, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6885944165681538, 'Valid Loss': 0.6909823441505432, 'Validation Metric': {'Precision': 0.4418604651162791, 'Recall': 0.4418604651162791, 'F1': 0.4418604651162791, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4418604651162791, 'Recall': 0.4418604651162791, 'F1': 0.4418604651162791, 'Acc': 0.52}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6752328339375948, 'Valid Loss': 0.6931784772872924, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.4883720930232558, 'F1': 0.45652173913043476, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42857142857142855, 'Recall': 0.4883720930232558, 'F1': 0.45652173913043476, 'Acc': 0.5}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.658462046008361, 'Valid Loss': 0.6955090975761413, 'Validation Metric': {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6450603376877936, 'Valid Loss': 0.7033416533470154, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.5581395348837209, 'F1': 0.48484848484848486, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6224809861496875, 'Valid Loss': 0.6982208824157715, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.4186046511627907, 'F1': 0.42352941176470593, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.602069894342046, 'Valid Loss': 0.7052236127853394, 'Validation Metric': {'Precision': 0.44, 'Recall': 0.5116279069767442, 'F1': 0.4731182795698925, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5851705007647213, 'Valid Loss': 0.7105663561820984, 'Validation Metric': {'Precision': 0.44642857142857145, 'Recall': 0.5813953488372093, 'F1': 0.5050505050505051, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5692895380289931, 'Valid Loss': 0.7134836554527283, 'Validation Metric': {'Precision': 0.45454545454545453, 'Recall': 0.5813953488372093, 'F1': 0.5102040816326531, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5509029046485299, 'Valid Loss': 0.712059326171875, 'Validation Metric': {'Precision': 0.45, 'Recall': 0.627906976744186, 'F1': 0.5242718446601942, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5239870705102619, 'Valid Loss': 0.709767324924469, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.5116279069767442, 'F1': 0.4835164835164835, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5164544915682391, 'Valid Loss': 0.7114805364608765, 'Validation Metric': {'Precision': 0.41818181818181815, 'Recall': 0.5348837209302325, 'F1': 0.4693877551020408, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4929027263271181, 'Valid Loss': 0.710618929862976, 'Validation Metric': {'Precision': 0.4230769230769231, 'Recall': 0.5116279069767442, 'F1': 0.4631578947368421, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.49214616574739156, 'Valid Loss': 0.7127006268501281, 'Validation Metric': {'Precision': 0.43636363636363634, 'Recall': 0.5581395348837209, 'F1': 0.48979591836734687, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4862150553809969, 'Valid Loss': 0.7145313739776611, 'Validation Metric': {'Precision': 0.43636363636363634, 'Recall': 0.5581395348837209, 'F1': 0.48979591836734687, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.46697334984415456, 'Valid Loss': 0.7128033232688904, 'Validation Metric': {'Precision': 0.43636363636363634, 'Recall': 0.5581395348837209, 'F1': 0.48979591836734687, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.47172725945711136, 'Valid Loss': 0.7140186691284179, 'Validation Metric': {'Precision': 0.43636363636363634, 'Recall': 0.5581395348837209, 'F1': 0.48979591836734687, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5094339622641509, 'Recall': 0.4909090909090909, 'F1': 0.5, 'Acc': 0.46}; Test loss: 0.701763641834259
