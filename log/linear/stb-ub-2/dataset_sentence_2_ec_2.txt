Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6790336331254557, 'Valid Loss': 0.6817059206962586, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6791645766873109, 'Valid Loss': 0.6812619805335999, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6772141731099078, 'Valid Loss': 0.6807664084434509, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6725254874480399, 'Valid Loss': 0.6798602938652039, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6686574244185498, 'Valid Loss': 0.6793917822837829, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6570126724086309, 'Valid Loss': 0.678835301399231, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6431857437679642, 'Valid Loss': 0.6787697100639343, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6290160017578226, 'Valid Loss': 0.6819031858444213, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.046511627906976744, 'F1': 0.08888888888888888, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.046511627906976744, 'F1': 0.08888888888888888, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6031735794324624, 'Valid Loss': 0.6869478726387024, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.09302325581395349, 'F1': 0.15686274509803924, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.09302325581395349, 'F1': 0.15686274509803924, 'Acc': 0.57}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5740369574019784, 'Valid Loss': 0.6922207176685333, 'Validation Metric': {'Precision': 0.5882352941176471, 'Recall': 0.23255813953488372, 'F1': 0.3333333333333333, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.23255813953488372, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5412299036979675, 'Valid Loss': 0.6905161428451538, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.20930232558139536, 'F1': 0.30508474576271183, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.23255813953488372, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5059495646702615, 'Valid Loss': 0.7045631718635559, 'Validation Metric': {'Precision': 0.5263157894736842, 'Recall': 0.23255813953488372, 'F1': 0.3225806451612903, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.23255813953488372, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4827945055930238, 'Valid Loss': 0.7032980990409851, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.2558139534883721, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.23255813953488372, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4546463777752299, 'Valid Loss': 0.7177261006832123, 'Validation Metric': {'Precision': 0.43478260869565216, 'Recall': 0.23255813953488372, 'F1': 0.30303030303030304, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5882352941176471, 'Recall': 0.23255813953488372, 'F1': 0.3333333333333333, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.428766186104009, 'Valid Loss': 0.7211356484889984, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.27906976744186046, 'F1': 0.3582089552238806, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.27906976744186046, 'F1': 0.3582089552238806, 'Acc': 0.57}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.41790321488913734, 'Valid Loss': 0.7244617402553558, 'Validation Metric': {'Precision': 0.4583333333333333, 'Recall': 0.2558139534883721, 'F1': 0.3283582089552239, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.27906976744186046, 'F1': 0.3582089552238806, 'Acc': 0.57}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3927855383800833, 'Valid Loss': 0.7239565169811248, 'Validation Metric': {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3928429433389714, 'Valid Loss': 0.7290791940689086, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.27906976744186046, 'F1': 0.3380281690140845, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.38015406029789073, 'Valid Loss': 0.730840586423874, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.27906976744186046, 'F1': 0.3380281690140845, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.381177778894964, 'Valid Loss': 0.7313714611530304, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.27906976744186046, 'F1': 0.3380281690140845, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.4642857142857143, 'Recall': 0.3023255813953488, 'F1': 0.36619718309859156, 'Acc': 0.55}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.52, 'Recall': 0.37142857142857144, 'F1': 0.43333333333333335, 'Acc': 0.6633663366336634}; Test loss: 0.6585104729120548
