Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7040811753586719, 'Valid Loss': 0.7086915421485901, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7029704718213332, 'Valid Loss': 0.7052716159820557, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.037037037037037035, 'F1': 0.07017543859649122, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.037037037037037035, 'F1': 0.07017543859649122, 'Acc': 0.47}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6990033568520295, 'Valid Loss': 0.7001028871536255, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.16666666666666666, 'F1': 0.2608695652173913, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.16666666666666666, 'F1': 0.2608695652173913, 'Acc': 0.49}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6936936268680974, 'Valid Loss': 0.697055823802948, 'Validation Metric': {'Precision': 0.5666666666666667, 'Recall': 0.3148148148148148, 'F1': 0.4047619047619047, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5666666666666667, 'Recall': 0.3148148148148148, 'F1': 0.4047619047619047, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6899136367597078, 'Valid Loss': 0.6937914824485779, 'Validation Metric': {'Precision': 0.4909090909090909, 'Recall': 0.5, 'F1': 0.4954128440366972, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4909090909090909, 'Recall': 0.5, 'F1': 0.4954128440366972, 'Acc': 0.45}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.678407254971956, 'Valid Loss': 0.6942479705810547, 'Validation Metric': {'Precision': 0.5074626865671642, 'Recall': 0.6296296296296297, 'F1': 0.5619834710743802, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5074626865671642, 'Recall': 0.6296296296296297, 'F1': 0.5619834710743802, 'Acc': 0.47}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6561495332341445, 'Valid Loss': 0.6951613044738769, 'Validation Metric': {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6325933686212489, 'Valid Loss': 0.693713812828064, 'Validation Metric': {'Precision': 0.53125, 'Recall': 0.6296296296296297, 'F1': 0.5762711864406779, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6134865656495094, 'Valid Loss': 0.6996421527862549, 'Validation Metric': {'Precision': 0.5535714285714286, 'Recall': 0.5740740740740741, 'F1': 0.5636363636363636, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5861004265515428, 'Valid Loss': 0.6904265403747558, 'Validation Metric': {'Precision': 0.5396825396825397, 'Recall': 0.6296296296296297, 'F1': 0.5811965811965812, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5584610084954061, 'Valid Loss': 0.6978301215171814, 'Validation Metric': {'Precision': 0.559322033898305, 'Recall': 0.6111111111111112, 'F1': 0.5840707964601771, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5240195679821467, 'Valid Loss': 0.7096041226387024, 'Validation Metric': {'Precision': 0.5740740740740741, 'Recall': 0.5740740740740741, 'F1': 0.5740740740740741, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5217391304347826, 'Recall': 0.6666666666666666, 'F1': 0.5853658536585366, 'Acc': 0.49}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5175730691928613, 'Valid Loss': 0.7063168048858642, 'Validation Metric': {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.49920381644838735, 'Valid Loss': 0.7140574645996094, 'Validation Metric': {'Precision': 0.5614035087719298, 'Recall': 0.5925925925925926, 'F1': 0.5765765765765766, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.47901749846182373, 'Valid Loss': 0.7157328128814697, 'Validation Metric': {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5818181818181818, 'Recall': 0.5925925925925926, 'F1': 0.5871559633027522, 'Acc': 0.55}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.46467999251265274, 'Valid Loss': 0.7121180391311646, 'Validation Metric': {'Precision': 0.5964912280701754, 'Recall': 0.6296296296296297, 'F1': 0.6126126126126126, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5964912280701754, 'Recall': 0.6296296296296297, 'F1': 0.6126126126126126, 'Acc': 0.57}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.44194359763672475, 'Valid Loss': 0.7144952630996704, 'Validation Metric': {'Precision': 0.6111111111111112, 'Recall': 0.6111111111111112, 'F1': 0.6111111111111112, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5964912280701754, 'Recall': 0.6296296296296297, 'F1': 0.6126126126126126, 'Acc': 0.57}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.43897156299729095, 'Valid Loss': 0.7170619821548462, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.6296296296296297, 'F1': 0.6071428571428571, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.5964912280701754, 'Recall': 0.6296296296296297, 'F1': 0.6126126126126126, 'Acc': 0.57}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.42863035358880697, 'Valid Loss': 0.7153198838233947, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.6296296296296297, 'F1': 0.6181818181818182, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6071428571428571, 'Recall': 0.6296296296296297, 'F1': 0.6181818181818182, 'Acc': 0.58}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.43335865555625214, 'Valid Loss': 0.7179057121276855, 'Validation Metric': {'Precision': 0.6071428571428571, 'Recall': 0.6296296296296297, 'F1': 0.6181818181818182, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6071428571428571, 'Recall': 0.6296296296296297, 'F1': 0.6181818181818182, 'Acc': 0.58}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.47058823529411764, 'Recall': 0.7441860465116279, 'F1': 0.5765765765765766, 'Acc': 0.53}; Test loss: 0.7470052003860473
