Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6992044229256479, 'Valid Loss': 0.712940788269043, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.45}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.697809172304053, 'Valid Loss': 0.7105628705024719, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.03636363636363636, 'F1': 0.06896551724137931, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.03636363636363636, 'F1': 0.06896551724137931, 'Acc': 0.46}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6987622301829489, 'Valid Loss': 0.705884017944336, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.09090909090909091, 'F1': 0.16129032258064518, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.09090909090909091, 'F1': 0.16129032258064518, 'Acc': 0.48}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6909518649703578, 'Valid Loss': 0.7014932823181153, 'Validation Metric': {'Precision': 0.56, 'Recall': 0.2545454545454545, 'F1': 0.35, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.56, 'Recall': 0.2545454545454545, 'F1': 0.35, 'Acc': 0.48}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6872742717203341, 'Valid Loss': 0.698973696231842, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.3090909090909091, 'F1': 0.4047619047619047, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5862068965517241, 'Recall': 0.3090909090909091, 'F1': 0.4047619047619047, 'Acc': 0.5}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6750639935857371, 'Valid Loss': 0.6975818157196045, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.38181818181818183, 'F1': 0.47727272727272735, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6363636363636364, 'Recall': 0.38181818181818183, 'F1': 0.47727272727272735, 'Acc': 0.54}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6605825781037933, 'Valid Loss': 0.6942906188964844, 'Validation Metric': {'Precision': 0.6046511627906976, 'Recall': 0.4727272727272727, 'F1': 0.5306122448979591, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6046511627906976, 'Recall': 0.4727272727272727, 'F1': 0.5306122448979591, 'Acc': 0.54}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.635228389187863, 'Valid Loss': 0.6931237864494324, 'Validation Metric': {'Precision': 0.6122448979591837, 'Recall': 0.5454545454545454, 'F1': 0.5769230769230769, 'Acc': 0.56}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6122448979591837, 'Recall': 0.5454545454545454, 'F1': 0.5769230769230769, 'Acc': 0.56}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6162628715759829, 'Valid Loss': 0.6937089967727661, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.5818181818181818, 'F1': 0.5765765765765765, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.6122448979591837, 'Recall': 0.5454545454545454, 'F1': 0.5769230769230769, 'Acc': 0.56}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5806284793897679, 'Valid Loss': 0.6945768642425537, 'Validation Metric': {'Precision': 0.5666666666666667, 'Recall': 0.6181818181818182, 'F1': 0.591304347826087, 'Acc': 0.53}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5666666666666667, 'Recall': 0.6181818181818182, 'F1': 0.591304347826087, 'Acc': 0.53}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5537621931810128, 'Valid Loss': 0.6963436722755432, 'Validation Metric': {'Precision': 0.5483870967741935, 'Recall': 0.6181818181818182, 'F1': 0.5811965811965812, 'Acc': 0.51}}
Best validation metric so far: {'Precision': 0.5666666666666667, 'Recall': 0.6181818181818182, 'F1': 0.591304347826087, 'Acc': 0.53}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5208356666721796, 'Valid Loss': 0.6959193587303162, 'Validation Metric': {'Precision': 0.5573770491803278, 'Recall': 0.6181818181818182, 'F1': 0.5862068965517241, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5666666666666667, 'Recall': 0.6181818181818182, 'F1': 0.591304347826087, 'Acc': 0.53}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4928439502653323, 'Valid Loss': 0.6921488904953003, 'Validation Metric': {'Precision': 0.5555555555555556, 'Recall': 0.6363636363636364, 'F1': 0.5932203389830508, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.6363636363636364, 'F1': 0.5932203389830508, 'Acc': 0.52}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4657298138267116, 'Valid Loss': 0.6957477688789367, 'Validation Metric': {'Precision': 0.5666666666666667, 'Recall': 0.6181818181818182, 'F1': 0.591304347826087, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5555555555555556, 'Recall': 0.6363636363636364, 'F1': 0.5932203389830508, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4416724102277505, 'Valid Loss': 0.7007156109809876, 'Validation Metric': {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.422257293996058, 'Valid Loss': 0.6994808912277222, 'Validation Metric': {'Precision': 0.5666666666666667, 'Recall': 0.6181818181818182, 'F1': 0.591304347826087, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4115435535970487, 'Valid Loss': 0.7029086875915528, 'Validation Metric': {'Precision': 0.576271186440678, 'Recall': 0.6181818181818182, 'F1': 0.5964912280701754, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.41227254467575175, 'Valid Loss': 0.7070364546775818, 'Validation Metric': {'Precision': 0.5862068965517241, 'Recall': 0.6181818181818182, 'F1': 0.6017699115044246, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.39462551651032346, 'Valid Loss': 0.7104382848739624, 'Validation Metric': {'Precision': 0.5789473684210527, 'Recall': 0.6, 'F1': 0.5892857142857143, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.38735113371359675, 'Valid Loss': 0.7110455799102783, 'Validation Metric': {'Precision': 0.5789473684210527, 'Recall': 0.6, 'F1': 0.5892857142857143, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5737704918032787, 'Recall': 0.6363636363636364, 'F1': 0.6034482758620691, 'Acc': 0.54}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5357142857142857, 'Recall': 0.6, 'F1': 0.5660377358490566, 'Acc': 0.5445544554455446}; Test loss: 0.7118491392869216
