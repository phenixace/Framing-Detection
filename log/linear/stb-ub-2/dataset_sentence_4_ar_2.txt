Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6960335413092061, 'Valid Loss': 0.6994065665281736, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.018867924528301886, 'F1': 0.03571428571428571, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.018867924528301886, 'F1': 0.03571428571428571, 'Acc': 0.46534653465346537}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6962220378612217, 'Valid Loss': 0.6984094014534583, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03773584905660377, 'F1': 0.06779661016949153, 'Acc': 0.45544554455445546}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03773584905660377, 'F1': 0.06779661016949153, 'Acc': 0.45544554455445546}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6956730296737269, 'Valid Loss': 0.6965547112318186, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.07547169811320754, 'F1': 0.13114754098360656, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.07547169811320754, 'F1': 0.13114754098360656, 'Acc': 0.4752475247524752}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6894833139683071, 'Valid Loss': 0.6952373454203973, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.1509433962264151, 'F1': 0.2285714285714286, 'Acc': 0.46534653465346537}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47058823529411764, 'Recall': 0.1509433962264151, 'F1': 0.2285714285714286, 'Acc': 0.46534653465346537}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6867664464210209, 'Valid Loss': 0.693880713902987, 'Validation Metric': {'Precision': 0.5483870967741935, 'Recall': 0.32075471698113206, 'F1': 0.4047619047619047, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5483870967741935, 'Recall': 0.32075471698113206, 'F1': 0.4047619047619047, 'Acc': 0.504950495049505}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6729307551133005, 'Valid Loss': 0.6942307444719168, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.4528301886792453, 'F1': 0.49484536082474223, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.4528301886792453, 'F1': 0.49484536082474223, 'Acc': 0.5148514851485149}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6540311700419376, 'Valid Loss': 0.6957246156839224, 'Validation Metric': {'Precision': 0.5238095238095238, 'Recall': 0.41509433962264153, 'F1': 0.4631578947368421, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.4528301886792453, 'F1': 0.49484536082474223, 'Acc': 0.5148514851485149}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6354571329919916, 'Valid Loss': 0.6973770192036262, 'Validation Metric': {'Precision': 0.52, 'Recall': 0.49056603773584906, 'F1': 0.5048543689320388, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.52, 'Recall': 0.49056603773584906, 'F1': 0.5048543689320388, 'Acc': 0.49504950495049505}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6119929340324903, 'Valid Loss': 0.7007462978363037, 'Validation Metric': {'Precision': 0.5370370370370371, 'Recall': 0.5471698113207547, 'F1': 0.5420560747663552, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5370370370370371, 'Recall': 0.5471698113207547, 'F1': 0.5420560747663552, 'Acc': 0.5148514851485149}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5835002531346521, 'Valid Loss': 0.7030738706772144, 'Validation Metric': {'Precision': 0.5471698113207547, 'Recall': 0.5471698113207547, 'F1': 0.5471698113207547, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5471698113207547, 'Recall': 0.5471698113207547, 'F1': 0.5471698113207547, 'Acc': 0.5247524752475248}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5518177418332351, 'Valid Loss': 0.7094843341754034, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.5660377358490566, 'F1': 0.5555555555555556, 'Acc': 0.5247524752475248}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.5660377358490566, 'F1': 0.5555555555555556, 'Acc': 0.5247524752475248}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5238233961557087, 'Valid Loss': 0.7177621401273288, 'Validation Metric': {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.509274265483806, 'Valid Loss': 0.726148933172226, 'Validation Metric': {'Precision': 0.5576923076923077, 'Recall': 0.5471698113207547, 'F1': 0.5523809523809525, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4862844700876035, 'Valid Loss': 0.7317305574050317, 'Validation Metric': {'Precision': 0.5576923076923077, 'Recall': 0.5471698113207547, 'F1': 0.5523809523809525, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.45955117595823186, 'Valid Loss': 0.7384818471395053, 'Validation Metric': {'Precision': 0.5686274509803921, 'Recall': 0.5471698113207547, 'F1': 0.5576923076923078, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.442712612057987, 'Valid Loss': 0.7424511026877624, 'Validation Metric': {'Precision': 0.58, 'Recall': 0.5471698113207547, 'F1': 0.5631067961165048, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.42316122745212753, 'Valid Loss': 0.7474782810761378, 'Validation Metric': {'Precision': 0.5686274509803921, 'Recall': 0.5471698113207547, 'F1': 0.5576923076923078, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.41546399891376495, 'Valid Loss': 0.750938111772904, 'Validation Metric': {'Precision': 0.5686274509803921, 'Recall': 0.5471698113207547, 'F1': 0.5576923076923078, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4106122941563004, 'Valid Loss': 0.7514116305571336, 'Validation Metric': {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4035845038137938, 'Valid Loss': 0.7528270219381039, 'Validation Metric': {'Precision': 0.5686274509803921, 'Recall': 0.5471698113207547, 'F1': 0.5576923076923078, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5769230769230769, 'Recall': 0.5660377358490566, 'F1': 0.5714285714285713, 'Acc': 0.5544554455445545}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5957446808510638, 'Recall': 0.5185185185185185, 'F1': 0.5544554455445543, 'Acc': 0.55}; Test loss: 0.6946622610092164
