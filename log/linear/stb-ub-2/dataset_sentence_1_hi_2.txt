Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-2/', lr=2e-06, max_len=64, n_passages=2, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6654413413060339, 'Valid Loss': 0.6593338632583619, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6592282590113188, 'Valid Loss': 0.6461124706268311, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6392685284740046, 'Valid Loss': 0.6288701343536377, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6281715306012254, 'Valid Loss': 0.6141722571849823, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6185968341796022, 'Valid Loss': 0.6047660195827484, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.613857964151784, 'Valid Loss': 0.600582822561264, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6014094191946482, 'Valid Loss': 0.5985180878639221, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5913198523615536, 'Valid Loss': 0.5995192682743072, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5797804343072992, 'Valid Loss': 0.6007891130447388, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5608719116763065, 'Valid Loss': 0.6044394147396087, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.7}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5317779410826532, 'Valid Loss': 0.6127965331077576, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.06451612903225806, 'Acc': 0.71}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.06451612903225806, 'Acc': 0.71}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5029645628835026, 'Valid Loss': 0.6153308463096618, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.07142857142857142, 'F1': 0.11764705882352941, 'Acc': 0.7}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.07142857142857142, 'F1': 0.11764705882352941, 'Acc': 0.7}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4807436768161623, 'Valid Loss': 0.6241250503063202, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4447082965389678, 'Valid Loss': 0.6247789621353149, 'Validation Metric': {'Precision': 0.4, 'Recall': 0.21428571428571427, 'F1': 0.27906976744186046, 'Acc': 0.69}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.43004540706935684, 'Valid Loss': 0.625887211561203, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.17857142857142858, 'F1': 0.23255813953488372, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.3986967439322095, 'Valid Loss': 0.6310107862949371, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.21428571428571427, 'F1': 0.2608695652173913, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3907350566434233, 'Valid Loss': 0.6326146519184113, 'Validation Metric': {'Precision': 0.3157894736842105, 'Recall': 0.21428571428571427, 'F1': 0.2553191489361702, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3759783308364843, 'Valid Loss': 0.6364632701873779, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.376799810285631, 'Valid Loss': 0.638174775838852, 'Validation Metric': {'Precision': 0.3181818181818182, 'Recall': 0.25, 'F1': 0.28, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.37227008354506996, 'Valid Loss': 0.6371714997291565, 'Validation Metric': {'Precision': 0.28, 'Recall': 0.25, 'F1': 0.2641509433962264, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.25, 'F1': 0.3333333333333333, 'Acc': 0.72}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.16666666666666666, 'Recall': 0.03125, 'F1': 0.05263157894736842, 'Acc': 0.64}; Test loss: 0.6438678145408631
