Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='hi')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6856191621014947, 'Valid Loss': 0.6848532676696777, 'Validation Metric': {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6740640692020717, 'Valid Loss': 0.6691525506973267, 'Validation Metric': {'Precision': 0.375, 'Recall': 0.10714285714285714, 'F1': 0.16666666666666666, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6601980461886054, 'Valid Loss': 0.6457640695571899, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6408287953389319, 'Valid Loss': 0.6250829899311066, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6189802928190482, 'Valid Loss': 0.6092688310146331, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6063929258992797, 'Valid Loss': 0.6001267445087433, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.5909984303932441, 'Valid Loss': 0.5957004261016846, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5681851980717558, 'Valid Loss': 0.5919989049434662, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5560311459397015, 'Valid Loss': 0.5910239112377167, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03571428571428571, 'F1': 0.0689655172413793, 'Acc': 0.73}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5220879100655255, 'Valid Loss': 0.5936746323108673, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.03571428571428571, 'F1': 0.0689655172413793, 'Acc': 0.73}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.49070874542782184, 'Valid Loss': 0.595360004901886, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.03571428571428571, 'F1': 0.06666666666666667, 'Acc': 0.72}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.47055190429091454, 'Valid Loss': 0.6029732310771942, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.06451612903225806, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4428401499202377, 'Valid Loss': 0.6060271829366684, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.06451612903225806, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.42357707396149635, 'Valid Loss': 0.6083715224266052, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.03571428571428571, 'F1': 0.06451612903225806, 'Acc': 0.71}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4068389589849271, 'Valid Loss': 0.6074950504302978, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.03571428571428571, 'F1': 0.0625, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.40000675795109647, 'Valid Loss': 0.608620457649231, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.03571428571428571, 'F1': 0.0625, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3881333887969193, 'Valid Loss': 0.6112443608045578, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.03571428571428571, 'F1': 0.0625, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3768795026760352, 'Valid Loss': 0.6129174208641053, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.03571428571428571, 'F1': 0.0625, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3716007359325886, 'Valid Loss': 0.6153009063005448, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.03571428571428571, 'F1': 0.0625, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.36210467784028305, 'Valid Loss': 0.6160122007131577, 'Validation Metric': {'Precision': 0.25, 'Recall': 0.03571428571428571, 'F1': 0.0625, 'Acc': 0.7}}
Best validation metric so far: {'Precision': 0.3448275862068966, 'Recall': 0.35714285714285715, 'F1': 0.3508771929824561, 'Acc': 0.63}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.41935483870967744, 'Recall': 0.40625, 'F1': 0.4126984126984127, 'Acc': 0.63}; Test loss: 0.6871319580078125
