Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6987162467680479, 'Valid Loss': 0.702088440840061, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.3387096774193548, 'F1': 0.43298969072164945, 'Acc': 0.45544554455445546}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.3387096774193548, 'F1': 0.43298969072164945, 'Acc': 0.45544554455445546}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7012742263706107, 'Valid Loss': 0.6954057422968057, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.7258064516129032, 'F1': 0.6716417910447761, 'Acc': 0.5643564356435643}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.625, 'Recall': 0.7258064516129032, 'F1': 0.6716417910447761, 'Acc': 0.5643564356435643}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6852782847065675, 'Valid Loss': 0.685911123569195, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.9193548387096774, 'F1': 0.7261146496815286, 'Acc': 0.5742574257425742}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.668094106410679, 'Valid Loss': 0.6820371380219092, 'Validation Metric': {'Precision': 0.6020408163265306, 'Recall': 0.9516129032258065, 'F1': 0.7375, 'Acc': 0.5841584158415841}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6020408163265306, 'Recall': 0.9516129032258065, 'F1': 0.7375, 'Acc': 0.5841584158415841}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6535896725560489, 'Valid Loss': 0.6820701360702515, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6324261391633436, 'Valid Loss': 0.6867398562339636, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6018297150731087, 'Valid Loss': 0.6841964996778048, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5822904494247938, 'Valid Loss': 0.687840861769823, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5610321748413538, 'Valid Loss': 0.6851326651298083, 'Validation Metric': {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5366294685947267, 'Valid Loss': 0.6871330153483611, 'Validation Metric': {'Precision': 0.6060606060606061, 'Recall': 0.967741935483871, 'F1': 0.7453416149068324, 'Acc': 0.594059405940594}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5148582372226214, 'Valid Loss': 0.6883846120192454, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.4868007188564853, 'Valid Loss': 0.6902883236224835, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4726977958098838, 'Valid Loss': 0.6875291569874837, 'Validation Metric': {'Precision': 0.6041666666666666, 'Recall': 0.9354838709677419, 'F1': 0.7341772151898733, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4466169100058706, 'Valid Loss': 0.6915089373405163, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4279137824318911, 'Valid Loss': 0.6988482910853165, 'Validation Metric': {'Precision': 0.5979381443298969, 'Recall': 0.9354838709677419, 'F1': 0.7295597484276729, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.41835283095899384, 'Valid Loss': 0.7038530535422839, 'Validation Metric': {'Precision': 0.5894736842105263, 'Recall': 0.9032258064516129, 'F1': 0.7133757961783439, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3941902926093654, 'Valid Loss': 0.7076346518901678, 'Validation Metric': {'Precision': 0.5957446808510638, 'Recall': 0.9032258064516129, 'F1': 0.7179487179487178, 'Acc': 0.5643564356435643}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3873751181128778, 'Valid Loss': 0.6996303097559855, 'Validation Metric': {'Precision': 0.6063829787234043, 'Recall': 0.9193548387096774, 'F1': 0.7307692307692308, 'Acc': 0.5841584158415841}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.39383846188062116, 'Valid Loss': 0.7033487065480306, 'Validation Metric': {'Precision': 0.6021505376344086, 'Recall': 0.9032258064516129, 'F1': 0.7225806451612904, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3634863470337893, 'Valid Loss': 0.7035793318198278, 'Validation Metric': {'Precision': 0.6021505376344086, 'Recall': 0.9032258064516129, 'F1': 0.7225806451612904, 'Acc': 0.5742574257425742}}
Best validation metric so far: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.71, 'Recall': 1.0, 'F1': 0.8304093567251462, 'Acc': 0.71}; Test loss: 0.6301319301128387
