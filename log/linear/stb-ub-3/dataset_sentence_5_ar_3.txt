Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6957396464912515, 'Valid Loss': 0.6860589599609375, 'Validation Metric': {'Precision': 0.7142857142857143, 'Recall': 0.46296296296296297, 'F1': 0.5617977528089888, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7142857142857143, 'Recall': 0.46296296296296297, 'F1': 0.5617977528089888, 'Acc': 0.61}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7034166831719247, 'Valid Loss': 0.6855038714408874, 'Validation Metric': {'Precision': 0.6521739130434783, 'Recall': 0.5555555555555556, 'F1': 0.6, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6521739130434783, 'Recall': 0.5555555555555556, 'F1': 0.6, 'Acc': 0.6}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6970616971191607, 'Valid Loss': 0.6851749253273011, 'Validation Metric': {'Precision': 0.6226415094339622, 'Recall': 0.6111111111111112, 'F1': 0.616822429906542, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6226415094339622, 'Recall': 0.6111111111111112, 'F1': 0.616822429906542, 'Acc': 0.59}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6934283320841036, 'Valid Loss': 0.6832493376731873, 'Validation Metric': {'Precision': 0.6056338028169014, 'Recall': 0.7962962962962963, 'F1': 0.688, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6056338028169014, 'Recall': 0.7962962962962963, 'F1': 0.688, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6899960903744948, 'Valid Loss': 0.6801777982711792, 'Validation Metric': {'Precision': 0.6025641025641025, 'Recall': 0.8703703703703703, 'F1': 0.712121212121212, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6025641025641025, 'Recall': 0.8703703703703703, 'F1': 0.712121212121212, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6812429459471452, 'Valid Loss': 0.6813094663619995, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6608394345170573, 'Valid Loss': 0.6784923434257507, 'Validation Metric': {'Precision': 0.6052631578947368, 'Recall': 0.8518518518518519, 'F1': 0.7076923076923076, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6461916636479529, 'Valid Loss': 0.6790835118293762, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.8148148148148148, 'F1': 0.6717557251908397, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6196753955201099, 'Valid Loss': 0.6784768629074097, 'Validation Metric': {'Precision': 0.582089552238806, 'Recall': 0.7222222222222222, 'F1': 0.6446280991735538, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5929827207797452, 'Valid Loss': 0.6842138290405273, 'Validation Metric': {'Precision': 0.5645161290322581, 'Recall': 0.6481481481481481, 'F1': 0.603448275862069, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5745575788773989, 'Valid Loss': 0.6836425042152405, 'Validation Metric': {'Precision': 0.5689655172413793, 'Recall': 0.6111111111111112, 'F1': 0.5892857142857143, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5517875124749384, 'Valid Loss': 0.6815298342704773, 'Validation Metric': {'Precision': 0.5806451612903226, 'Recall': 0.6666666666666666, 'F1': 0.6206896551724138, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5174379752654779, 'Valid Loss': 0.681372561454773, 'Validation Metric': {'Precision': 0.5625, 'Recall': 0.6666666666666666, 'F1': 0.6101694915254238, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5106669334988845, 'Valid Loss': 0.6836531019210815, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.6666666666666666, 'F1': 0.6153846153846153, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4851267020169057, 'Valid Loss': 0.685846940279007, 'Validation Metric': {'Precision': 0.5873015873015873, 'Recall': 0.6851851851851852, 'F1': 0.6324786324786325, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4628869236299866, 'Valid Loss': 0.69133544921875, 'Validation Metric': {'Precision': 0.578125, 'Recall': 0.6851851851851852, 'F1': 0.6271186440677967, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.46651033037587214, 'Valid Loss': 0.6927830493450164, 'Validation Metric': {'Precision': 0.5692307692307692, 'Recall': 0.6851851851851852, 'F1': 0.6218487394957983, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.452324184540071, 'Valid Loss': 0.6967026448249817, 'Validation Metric': {'Precision': 0.5873015873015873, 'Recall': 0.6851851851851852, 'F1': 0.6324786324786325, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.434078081658012, 'Valid Loss': 0.697969229221344, 'Validation Metric': {'Precision': 0.59375, 'Recall': 0.7037037037037037, 'F1': 0.6440677966101694, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4394738803568639, 'Valid Loss': 0.6986635529994965, 'Validation Metric': {'Precision': 0.5873015873015873, 'Recall': 0.6851851851851852, 'F1': 0.6324786324786325, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.8888888888888888, 'F1': 0.7164179104477612, 'Acc': 0.62}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4084507042253521, 'Recall': 0.6744186046511628, 'F1': 0.5087719298245613, 'Acc': 0.44}; Test loss: 0.7017208671569825
