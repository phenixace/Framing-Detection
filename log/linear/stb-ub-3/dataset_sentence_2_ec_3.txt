Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6928816335765939, 'Valid Loss': 0.6950127530097961, 'Validation Metric': {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.687835651792978, 'Valid Loss': 0.6924466872215271, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.18604651162790697, 'F1': 0.2622950819672131, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6829710720401061, 'Valid Loss': 0.6886364388465881, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.046511627906976744, 'F1': 0.0851063829787234, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6763571289024854, 'Valid Loss': 0.6855639410018921, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6699884753478201, 'Valid Loss': 0.6832789301872253, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6592028713540027, 'Valid Loss': 0.6819588160514831, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6498732723687825, 'Valid Loss': 0.6814272427558898, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.023255813953488372, 'F1': 0.04545454545454545, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6247988288339815, 'Valid Loss': 0.6891516757011413, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6012451240890905, 'Valid Loss': 0.6999285840988159, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.023255813953488372, 'F1': 0.04347826086956522, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5761395143835168, 'Valid Loss': 0.7040965676307678, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.06976744186046512, 'F1': 0.12, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5419560180682885, 'Valid Loss': 0.7122218060493469, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.046511627906976744, 'F1': 0.08163265306122448, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5183931698924616, 'Valid Loss': 0.7231214761734008, 'Validation Metric': {'Precision': 0.3, 'Recall': 0.06976744186046512, 'F1': 0.11320754716981132, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.4970220205815215, 'Valid Loss': 0.7301180505752564, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.06976744186046512, 'F1': 0.11538461538461539, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4801638073434955, 'Valid Loss': 0.7374119591712952, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.09302325581395349, 'F1': 0.14814814814814814, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.46028230437322665, 'Valid Loss': 0.743532429933548, 'Validation Metric': {'Precision': 0.36363636363636365, 'Recall': 0.09302325581395349, 'F1': 0.14814814814814814, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.45090158989554957, 'Valid Loss': 0.7493172991275787, 'Validation Metric': {'Precision': 0.4166666666666667, 'Recall': 0.11627906976744186, 'F1': 0.1818181818181818, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4316868825178397, 'Valid Loss': 0.7525131988525391, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.13953488372093023, 'F1': 0.21818181818181817, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.41481442396578033, 'Valid Loss': 0.7529264497756958, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.13953488372093023, 'F1': 0.21818181818181817, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4074664233546508, 'Valid Loss': 0.7541116392612457, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.13953488372093023, 'F1': 0.21428571428571427, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.41818511976223244, 'Valid Loss': 0.7543750941753388, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.13953488372093023, 'F1': 0.21428571428571427, 'Acc': 0.56}}
Best validation metric so far: {'Precision': 0.34375, 'Recall': 0.2558139534883721, 'F1': 0.29333333333333333, 'Acc': 0.47}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.32142857142857145, 'Recall': 0.2571428571428571, 'F1': 0.2857142857142857, 'Acc': 0.5544554455445545}; Test loss: 0.6862185941292689
