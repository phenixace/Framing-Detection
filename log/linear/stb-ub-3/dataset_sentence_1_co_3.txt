Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-3/', lr=2e-06, max_len=64, n_passages=3, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6981846721548783, 'Valid Loss': 0.7012070465087891, 'Validation Metric': {'Precision': 0.6875, 'Recall': 0.34375, 'F1': 0.4583333333333333, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6875, 'Recall': 0.34375, 'F1': 0.4583333333333333, 'Acc': 0.48}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7028887115026775, 'Valid Loss': 0.6906579208374023, 'Validation Metric': {'Precision': 0.6176470588235294, 'Recall': 0.65625, 'F1': 0.6363636363636364, 'Acc': 0.52}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6176470588235294, 'Recall': 0.65625, 'F1': 0.6363636363636364, 'Acc': 0.52}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6909834217084082, 'Valid Loss': 0.6746756720542908, 'Validation Metric': {'Precision': 0.6391752577319587, 'Recall': 0.96875, 'F1': 0.7701863354037266, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6391752577319587, 'Recall': 0.96875, 'F1': 0.7701863354037266, 'Acc': 0.63}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6703904082900599, 'Valid Loss': 0.6605118191242219, 'Validation Metric': {'Precision': 0.6428571428571429, 'Recall': 0.984375, 'F1': 0.7777777777777778, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6428571428571429, 'Recall': 0.984375, 'F1': 0.7777777777777778, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.651315376162529, 'Valid Loss': 0.6558800935745239, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6263419036802492, 'Valid Loss': 0.6544227004051208, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.605547853990605, 'Valid Loss': 0.6610668420791626, 'Validation Metric': {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.5815051397994945, 'Valid Loss': 0.6633960008621216, 'Validation Metric': {'Precision': 0.6363636363636364, 'Recall': 0.984375, 'F1': 0.7730061349693252, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5537834500795916, 'Valid Loss': 0.6687837135791779, 'Validation Metric': {'Precision': 0.6326530612244898, 'Recall': 0.96875, 'F1': 0.7654320987654322, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.533491661674098, 'Valid Loss': 0.6711329543590545, 'Validation Metric': {'Precision': 0.6326530612244898, 'Recall': 0.96875, 'F1': 0.7654320987654322, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5078382056794668, 'Valid Loss': 0.6762090480327606, 'Validation Metric': {'Precision': 0.6326530612244898, 'Recall': 0.96875, 'F1': 0.7654320987654322, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.47598826414660406, 'Valid Loss': 0.6827107918262482, 'Validation Metric': {'Precision': 0.6195652173913043, 'Recall': 0.890625, 'F1': 0.7307692307692307, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.462373571176278, 'Valid Loss': 0.6894637405872345, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.875, 'F1': 0.7272727272727274, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.4316321568269479, 'Valid Loss': 0.690179089307785, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.875, 'F1': 0.7272727272727274, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.42745325243786764, 'Valid Loss': 0.6959632802009582, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.875, 'F1': 0.7272727272727274, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.41102073655316707, 'Valid Loss': 0.7006374430656434, 'Validation Metric': {'Precision': 0.6292134831460674, 'Recall': 0.875, 'F1': 0.7320261437908497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.3948316111376411, 'Valid Loss': 0.7026519072055817, 'Validation Metric': {'Precision': 0.6292134831460674, 'Recall': 0.875, 'F1': 0.7320261437908497, 'Acc': 0.59}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.3838192838195123, 'Valid Loss': 0.7024283814430237, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.875, 'F1': 0.7272727272727274, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.3784930686417379, 'Valid Loss': 0.7027607226371765, 'Validation Metric': {'Precision': 0.6222222222222222, 'Recall': 0.875, 'F1': 0.7272727272727274, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.3699977382233268, 'Valid Loss': 0.7038036787509918, 'Validation Metric': {'Precision': 0.625, 'Recall': 0.859375, 'F1': 0.7236842105263158, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.64, 'Recall': 1.0, 'F1': 0.7804878048780487, 'Acc': 0.64}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.65, 'Recall': 1.0, 'F1': 0.787878787878788, 'Acc': 0.65}; Test loss: 0.6478497922420502
