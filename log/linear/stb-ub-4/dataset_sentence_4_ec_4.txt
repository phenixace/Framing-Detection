Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6655231055460478, 'Valid Loss': 0.7315724354523879, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6632470061120234, 'Valid Loss': 0.7251668228552892, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6625404902978947, 'Valid Loss': 0.7189531097045312, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6604155349104028, 'Valid Loss': 0.7153664643947895, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6487349491370352, 'Valid Loss': 0.7131766069393891, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.642793171107769, 'Valid Loss': 0.7152961584237906, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.629320254843486, 'Valid Loss': 0.709590522142557, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.5445544554455446}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6023515384448203, 'Valid Loss': 0.712556833258042, 'Validation Metric': {'Precision': 0.3333333333333333, 'Recall': 0.021739130434782608, 'F1': 0.04081632653061224, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3333333333333333, 'Recall': 0.021739130434782608, 'F1': 0.04081632653061224, 'Acc': 0.5346534653465347}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.5861180107060232, 'Valid Loss': 0.7166639979069049, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.021739130434782608, 'F1': 0.041666666666666664, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.021739130434782608, 'F1': 0.041666666666666664, 'Acc': 0.5445544554455446}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5666550523356387, 'Valid Loss': 0.7155788025030723, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.08695652173913043, 'F1': 0.14814814814814817, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.08695652173913043, 'F1': 0.14814814814814817, 'Acc': 0.5445544554455446}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5445540025830269, 'Valid Loss': 0.7187157823489263, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.08695652173913043, 'F1': 0.15384615384615383, 'Acc': 0.5643564356435643}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.08695652173913043, 'F1': 0.15384615384615383, 'Acc': 0.5643564356435643}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5313359471528154, 'Valid Loss': 0.7227317564762555, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.08695652173913043, 'F1': 0.15384615384615383, 'Acc': 0.5643564356435643}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5044847558203497, 'Valid Loss': 0.7246360973669932, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.08695652173913043, 'F1': 0.15094339622641512, 'Acc': 0.5544554455445545}}
Best validation metric so far: {'Precision': 0.6666666666666666, 'Recall': 0.08695652173913043, 'F1': 0.15384615384615383, 'Acc': 0.5643564356435643}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.47871336733040054, 'Valid Loss': 0.7216701553418086, 'Validation Metric': {'Precision': 0.4666666666666667, 'Recall': 0.15217391304347827, 'F1': 0.22950819672131148, 'Acc': 0.5346534653465347}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4666666666666667, 'Recall': 0.15217391304347827, 'F1': 0.22950819672131148, 'Acc': 0.5346534653465347}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.46440138824676214, 'Valid Loss': 0.7271057161001059, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.45711035281419754, 'Valid Loss': 0.7310726378972714, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4445426699362303, 'Valid Loss': 0.7324394171054547, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.13043478260869565, 'F1': 0.20689655172413793, 'Acc': 0.5445544554455446}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4416219305835272, 'Valid Loss': 0.7316391055400555, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.17391304347826086, 'F1': 0.25396825396825395, 'Acc': 0.5346534653465347}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4289910412932697, 'Valid Loss': 0.7315767212555959, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.17391304347826086, 'F1': 0.25, 'Acc': 0.5247524752475248}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.42527748173788976, 'Valid Loss': 0.7322303583988776, 'Validation Metric': {'Precision': 0.4117647058823529, 'Recall': 0.15217391304347827, 'F1': 0.2222222222222222, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.17391304347826086, 'F1': 0.25806451612903225, 'Acc': 0.5445544554455446}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.49}; Test loss: 0.7546194899082184
