Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7811528710942519, 'Valid Loss': 0.7044748890399933, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7732462404589904, 'Valid Loss': 0.6856656885147094, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.57}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7478526211098621, 'Valid Loss': 0.6727219128608704, 'Validation Metric': {'Precision': 0.5714285714285714, 'Recall': 0.09302325581395349, 'F1': 0.16, 'Acc': 0.58}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5714285714285714, 'Recall': 0.09302325581395349, 'F1': 0.16, 'Acc': 0.58}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7233586091744272, 'Valid Loss': 0.6762992286682129, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.5813953488372093, 'F1': 0.5376344086021505, 'Acc': 0.57}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.5813953488372093, 'F1': 0.5376344086021505, 'Acc': 0.57}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.698164668522383, 'Valid Loss': 0.6821641445159912, 'Validation Metric': {'Precision': 0.4838709677419355, 'Recall': 0.6976744186046512, 'F1': 0.5714285714285715, 'Acc': 0.55}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4838709677419355, 'Recall': 0.6976744186046512, 'F1': 0.5714285714285715, 'Acc': 0.55}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6808795826999765, 'Valid Loss': 0.6691600418090821, 'Validation Metric': {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6691501811146736, 'Valid Loss': 0.6790708756446838, 'Validation Metric': {'Precision': 0.463768115942029, 'Recall': 0.7441860465116279, 'F1': 0.5714285714285714, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6472943342830005, 'Valid Loss': 0.664444625377655, 'Validation Metric': {'Precision': 0.5306122448979592, 'Recall': 0.6046511627906976, 'F1': 0.5652173913043479, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6353661512073717, 'Valid Loss': 0.6754432487487793, 'Validation Metric': {'Precision': 0.5094339622641509, 'Recall': 0.627906976744186, 'F1': 0.5625, 'Acc': 0.58}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6152037272327825, 'Valid Loss': 0.6832789850234985, 'Validation Metric': {'Precision': 0.4603174603174603, 'Recall': 0.6744186046511628, 'F1': 0.5471698113207547, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5941171901006448, 'Valid Loss': 0.6794177985191345, 'Validation Metric': {'Precision': 0.46774193548387094, 'Recall': 0.6744186046511628, 'F1': 0.5523809523809524, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5738138717256094, 'Valid Loss': 0.6780823636054992, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.6976744186046512, 'F1': 0.5555555555555556, 'Acc': 0.52}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5433069071487376, 'Valid Loss': 0.676401903629303, 'Validation Metric': {'Precision': 0.46551724137931033, 'Recall': 0.627906976744186, 'F1': 0.5346534653465347, 'Acc': 0.53}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5325442442768499, 'Valid Loss': 0.6745703256130219, 'Validation Metric': {'Precision': 0.4727272727272727, 'Recall': 0.6046511627906976, 'F1': 0.5306122448979591, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5188043948851133, 'Valid Loss': 0.6767395257949829, 'Validation Metric': {'Precision': 0.4745762711864407, 'Recall': 0.6511627906976745, 'F1': 0.5490196078431372, 'Acc': 0.54}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.49698207566612645, 'Valid Loss': 0.676851943731308, 'Validation Metric': {'Precision': 0.4827586206896552, 'Recall': 0.6511627906976745, 'F1': 0.5544554455445545, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.499049558843437, 'Valid Loss': 0.6763930678367615, 'Validation Metric': {'Precision': 0.48214285714285715, 'Recall': 0.627906976744186, 'F1': 0.5454545454545454, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4737689208827521, 'Valid Loss': 0.6754966497421264, 'Validation Metric': {'Precision': 0.4827586206896552, 'Recall': 0.6511627906976745, 'F1': 0.5544554455445545, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.47489075833245326, 'Valid Loss': 0.6745605039596557, 'Validation Metric': {'Precision': 0.4827586206896552, 'Recall': 0.6511627906976745, 'F1': 0.5544554455445545, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.46386399002451645, 'Valid Loss': 0.6759641742706299, 'Validation Metric': {'Precision': 0.4827586206896552, 'Recall': 0.6511627906976745, 'F1': 0.5544554455445545, 'Acc': 0.55}}
Best validation metric so far: {'Precision': 0.5384615384615384, 'Recall': 0.6511627906976745, 'F1': 0.5894736842105263, 'Acc': 0.61}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6444444444444445, 'Recall': 0.5272727272727272, 'F1': 0.58, 'Acc': 0.58}; Test loss: 0.679316155910492
