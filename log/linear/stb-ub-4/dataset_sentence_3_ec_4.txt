Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ec')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.6909225193659464, 'Valid Loss': 0.6382970099265759, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.6985446027914683, 'Valid Loss': 0.6361281092350299, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.6876819451649984, 'Valid Loss': 0.6353572033918821, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.6534653465346535}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6762820176283518, 'Valid Loss': 0.6368926213337824, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.02857142857142857, 'F1': 0.05555555555555556, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.02857142857142857, 'F1': 0.05555555555555556, 'Acc': 0.6633663366336634}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6705811182657878, 'Valid Loss': 0.6373622818635061, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.02857142857142857, 'F1': 0.05555555555555556, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.02857142857142857, 'F1': 0.05555555555555556, 'Acc': 0.6633663366336634}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6578281676769256, 'Valid Loss': 0.6368900262392484, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.02857142857142857, 'F1': 0.05555555555555556, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.02857142857142857, 'F1': 0.05555555555555556, 'Acc': 0.6633663366336634}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6525099658966065, 'Valid Loss': 0.6380888773844793, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.05714285714285714, 'F1': 0.1081081081081081, 'Acc': 0.6732673267326733}}
Saving checkpoint...
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.05714285714285714, 'F1': 0.1081081081081081, 'Acc': 0.6732673267326733}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.622442274093628, 'Valid Loss': 0.6366578718790641, 'Validation Metric': {'Precision': 1.0, 'Recall': 0.05714285714285714, 'F1': 0.1081081081081081, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.05714285714285714, 'F1': 0.1081081081081081, 'Acc': 0.6732673267326733}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6078017854690552, 'Valid Loss': 0.6346096854943496, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.05714285714285714, 'F1': 0.10526315789473684, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.05714285714285714, 'F1': 0.1081081081081081, 'Acc': 0.6732673267326733}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5822640883922577, 'Valid Loss': 0.6354398796191583, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.05714285714285714, 'F1': 0.10526315789473684, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 1.0, 'Recall': 0.05714285714285714, 'F1': 0.1081081081081081, 'Acc': 0.6732673267326733}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5612518056233724, 'Valid Loss': 0.6421464475301596, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.14285714285714285, 'F1': 0.22222222222222224, 'Acc': 0.6534653465346535}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.14285714285714285, 'F1': 0.22222222222222224, 'Acc': 0.6534653465346535}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5349833528200786, 'Valid Loss': 0.6368743043679458, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.05714285714285714, 'F1': 0.10256410256410256, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.14285714285714285, 'F1': 0.22222222222222224, 'Acc': 0.6534653465346535}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5310788226127624, 'Valid Loss': 0.642261361846557, 'Validation Metric': {'Precision': 0.5454545454545454, 'Recall': 0.17142857142857143, 'F1': 0.26086956521739124, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.17142857142857143, 'F1': 0.26086956521739124, 'Acc': 0.6633663366336634}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.501610445578893, 'Valid Loss': 0.6493588410891019, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.17142857142857143, 'F1': 0.24489795918367346, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.17142857142857143, 'F1': 0.26086956521739124, 'Acc': 0.6633663366336634}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.4912276331583659, 'Valid Loss': 0.6457935789456735, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.17142857142857143, 'F1': 0.2553191489361702, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.17142857142857143, 'F1': 0.26086956521739124, 'Acc': 0.6633663366336634}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.4763992408911387, 'Valid Loss': 0.6486391218808981, 'Validation Metric': {'Precision': 0.42857142857142855, 'Recall': 0.17142857142857143, 'F1': 0.24489795918367346, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.5454545454545454, 'Recall': 0.17142857142857143, 'F1': 0.26086956521739124, 'Acc': 0.6633663366336634}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4673197460174561, 'Valid Loss': 0.6536125632432791, 'Validation Metric': {'Precision': 0.4666666666666667, 'Recall': 0.2, 'F1': 0.27999999999999997, 'Acc': 0.6435643564356436}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4666666666666667, 'Recall': 0.2, 'F1': 0.27999999999999997, 'Acc': 0.6435643564356436}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.47009625951449074, 'Valid Loss': 0.6606246588321832, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 0.2, 'F1': 0.2641509433962264, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4666666666666667, 'Recall': 0.2, 'F1': 0.27999999999999997, 'Acc': 0.6435643564356436}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.44499880154927574, 'Valid Loss': 0.664705175619859, 'Validation Metric': {'Precision': 0.3684210526315789, 'Recall': 0.2, 'F1': 0.25925925925925924, 'Acc': 0.6039603960396039}}
Best validation metric so far: {'Precision': 0.4666666666666667, 'Recall': 0.2, 'F1': 0.27999999999999997, 'Acc': 0.6435643564356436}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.440894437233607, 'Valid Loss': 0.665038681947268, 'Validation Metric': {'Precision': 0.3888888888888889, 'Recall': 0.2, 'F1': 0.2641509433962264, 'Acc': 0.6138613861386139}}
Best validation metric so far: {'Precision': 0.4666666666666667, 'Recall': 0.2, 'F1': 0.27999999999999997, 'Acc': 0.6435643564356436}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.38095238095238093, 'Recall': 0.17391304347826086, 'F1': 0.2388059701492537, 'Acc': 0.49504950495049505}; Test loss: 0.7554688763159972
