Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.8925046748236606, 'Valid Loss': 0.8769271802902222, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.36}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.869197268235056, 'Valid Loss': 0.7907156276702881, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.015625, 'F1': 0.030303030303030304, 'Acc': 0.36}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.015625, 'F1': 0.030303030303030304, 'Acc': 0.36}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7872217242655001, 'Valid Loss': 0.6771996188163757, 'Validation Metric': {'Precision': 0.711864406779661, 'Recall': 0.65625, 'F1': 0.6829268292682927, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.711864406779661, 'Recall': 0.65625, 'F1': 0.6829268292682927, 'Acc': 0.61}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6981668480132756, 'Valid Loss': 0.6524623572826386, 'Validation Metric': {'Precision': 0.6458333333333334, 'Recall': 0.96875, 'F1': 0.775, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6458333333333334, 'Recall': 0.96875, 'F1': 0.775, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.656700389949899, 'Valid Loss': 0.6507197070121765, 'Validation Metric': {'Precision': 0.6494845360824743, 'Recall': 0.984375, 'F1': 0.782608695652174, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6494845360824743, 'Recall': 0.984375, 'F1': 0.782608695652174, 'Acc': 0.65}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6437803530379346, 'Valid Loss': 0.6552831304073333, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6252120180349601, 'Valid Loss': 0.6587829947471618, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6178846943535303, 'Valid Loss': 0.6590330791473389, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.600743731777919, 'Valid Loss': 0.6609810137748718, 'Validation Metric': {'Precision': 0.6494845360824743, 'Recall': 0.984375, 'F1': 0.782608695652174, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5922325892668021, 'Valid Loss': 0.6640213978290558, 'Validation Metric': {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5557747534231136, 'Valid Loss': 0.6732516086101532, 'Validation Metric': {'Precision': 0.6521739130434783, 'Recall': 0.9375, 'F1': 0.7692307692307693, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5717403833803377, 'Valid Loss': 0.6690227556228637, 'Validation Metric': {'Precision': 0.65625, 'Recall': 0.984375, 'F1': 0.7875, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.549061123869921, 'Valid Loss': 0.6734890699386596, 'Validation Metric': {'Precision': 0.6595744680851063, 'Recall': 0.96875, 'F1': 0.7848101265822784, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5362921804189682, 'Valid Loss': 0.6745522797107697, 'Validation Metric': {'Precision': 0.6630434782608695, 'Recall': 0.953125, 'F1': 0.7820512820512819, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5264261898241545, 'Valid Loss': 0.673945381641388, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.96875, 'F1': 0.7898089171974522, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.514822608154071, 'Valid Loss': 0.6774464237689972, 'Validation Metric': {'Precision': 0.6593406593406593, 'Recall': 0.9375, 'F1': 0.7741935483870969, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6530612244897959, 'Recall': 1.0, 'F1': 0.7901234567901235, 'Acc': 0.66}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5116673280533991, 'Valid Loss': 0.6728499519824982, 'Validation Metric': {'Precision': 0.6702127659574468, 'Recall': 0.984375, 'F1': 0.7974683544303798, 'Acc': 0.68}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6702127659574468, 'Recall': 0.984375, 'F1': 0.7974683544303798, 'Acc': 0.68}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4908229728278361, 'Valid Loss': 0.6778789782524108, 'Validation Metric': {'Precision': 0.6630434782608695, 'Recall': 0.953125, 'F1': 0.7820512820512819, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.6702127659574468, 'Recall': 0.984375, 'F1': 0.7974683544303798, 'Acc': 0.68}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.49166870783818395, 'Valid Loss': 0.6785643339157105, 'Validation Metric': {'Precision': 0.6593406593406593, 'Recall': 0.9375, 'F1': 0.7741935483870969, 'Acc': 0.65}}
Best validation metric so far: {'Precision': 0.6702127659574468, 'Recall': 0.984375, 'F1': 0.7974683544303798, 'Acc': 0.68}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.48321445599982615, 'Valid Loss': 0.6798252177238464, 'Validation Metric': {'Precision': 0.6555555555555556, 'Recall': 0.921875, 'F1': 0.7662337662337663, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6702127659574468, 'Recall': 0.984375, 'F1': 0.7974683544303798, 'Acc': 0.68}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.6595744680851063, 'Recall': 0.9538461538461539, 'F1': 0.7798742138364779, 'Acc': 0.65}; Test loss: 0.6720782911777496
