Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.870468657267721, 'Valid Loss': 0.8992133939266205, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.35}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.35}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.8446141179454955, 'Valid Loss': 0.8197968101501465, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.35}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.35}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7623482503389057, 'Valid Loss': 0.7092365646362304, 'Validation Metric': {'Precision': 0.6153846153846154, 'Recall': 0.49230769230769234, 'F1': 0.5470085470085471, 'Acc': 0.47}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6153846153846154, 'Recall': 0.49230769230769234, 'F1': 0.5470085470085471, 'Acc': 0.47}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6959088276091375, 'Valid Loss': 0.6685691249370574, 'Validation Metric': {'Precision': 0.6463414634146342, 'Recall': 0.8153846153846154, 'F1': 0.7210884353741497, 'Acc': 0.59}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6463414634146342, 'Recall': 0.8153846153846154, 'F1': 0.7210884353741497, 'Acc': 0.59}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6632812713321886, 'Valid Loss': 0.6650788807868957, 'Validation Metric': {'Precision': 0.6511627906976745, 'Recall': 0.8615384615384616, 'F1': 0.7417218543046358, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6511627906976745, 'Recall': 0.8615384615384616, 'F1': 0.7417218543046358, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.651406895957495, 'Valid Loss': 0.6649767148494721, 'Validation Metric': {'Precision': 0.6590909090909091, 'Recall': 0.8923076923076924, 'F1': 0.7581699346405228, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6590909090909091, 'Recall': 0.8923076923076924, 'F1': 0.7581699346405228, 'Acc': 0.63}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6381160126704919, 'Valid Loss': 0.6626577711105347, 'Validation Metric': {'Precision': 0.651685393258427, 'Recall': 0.8923076923076924, 'F1': 0.7532467532467532, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.6590909090909091, 'Recall': 0.8923076923076924, 'F1': 0.7581699346405228, 'Acc': 0.63}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.625778148833074, 'Valid Loss': 0.6628607559204102, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6090878942295125, 'Valid Loss': 0.6621538329124451, 'Validation Metric': {'Precision': 0.6477272727272727, 'Recall': 0.8769230769230769, 'F1': 0.7450980392156863, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5922543069249705, 'Valid Loss': 0.6613668715953827, 'Validation Metric': {'Precision': 0.651685393258427, 'Recall': 0.8923076923076924, 'F1': 0.7532467532467532, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5773655701624719, 'Valid Loss': 0.658171056509018, 'Validation Metric': {'Precision': 0.6593406593406593, 'Recall': 0.9230769230769231, 'F1': 0.7692307692307692, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5564649422702036, 'Valid Loss': 0.6554264378547668, 'Validation Metric': {'Precision': 0.6506024096385542, 'Recall': 0.8307692307692308, 'F1': 0.7297297297297298, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5691665473737215, 'Valid Loss': 0.6621504497528076, 'Validation Metric': {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5350141442920032, 'Valid Loss': 0.6541664040088654, 'Validation Metric': {'Precision': 0.6588235294117647, 'Recall': 0.8615384615384616, 'F1': 0.7466666666666668, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.5195255263855583, 'Valid Loss': 0.6554918301105499, 'Validation Metric': {'Precision': 0.6590909090909091, 'Recall': 0.8923076923076924, 'F1': 0.7581699346405228, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5142929095186686, 'Valid Loss': 0.6539888501167297, 'Validation Metric': {'Precision': 0.6627906976744186, 'Recall': 0.8769230769230769, 'F1': 0.7549668874172185, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5112404388032461, 'Valid Loss': 0.6607437133789062, 'Validation Metric': {'Precision': 0.6629213483146067, 'Recall': 0.9076923076923077, 'F1': 0.7662337662337663, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4975315316727287, 'Valid Loss': 0.6580512082576752, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.8923076923076924, 'F1': 0.7631578947368421, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4929444950662161, 'Valid Loss': 0.656995165348053, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.8923076923076924, 'F1': 0.7631578947368421, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.48590567786442607, 'Valid Loss': 0.6572969853878021, 'Validation Metric': {'Precision': 0.6666666666666666, 'Recall': 0.8923076923076924, 'F1': 0.7631578947368421, 'Acc': 0.64}}
Best validation metric so far: {'Precision': 0.6559139784946236, 'Recall': 0.9384615384615385, 'F1': 0.7721518987341771, 'Acc': 0.64}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.7021276595744681, 'Recall': 0.9166666666666666, 'F1': 0.7951807228915662, 'Acc': 0.6633663366336634}; Test loss: 0.6648553277437503
