Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7755125463008881, 'Valid Loss': 0.8159387338161469, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7717897703773097, 'Valid Loss': 0.7774432456493378, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.46}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7444798679728257, 'Valid Loss': 0.7301993310451508, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.037037037037037035, 'F1': 0.06896551724137931, 'Acc': 0.46}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.037037037037037035, 'F1': 0.06896551724137931, 'Acc': 0.46}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7217731679740705, 'Valid Loss': 0.7055288195610047, 'Validation Metric': {'Precision': 0.5147058823529411, 'Recall': 0.6481481481481481, 'F1': 0.5737704918032787, 'Acc': 0.48}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5147058823529411, 'Recall': 0.6481481481481481, 'F1': 0.5737704918032787, 'Acc': 0.48}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6914451671274084, 'Valid Loss': 0.7052433633804321, 'Validation Metric': {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6725225974070398, 'Valid Loss': 0.710814757347107, 'Validation Metric': {'Precision': 0.5357142857142857, 'Recall': 0.2777777777777778, 'F1': 0.36585365853658536, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6802144442733965, 'Valid Loss': 0.7067138695716858, 'Validation Metric': {'Precision': 0.54, 'Recall': 0.5, 'F1': 0.5192307692307693, 'Acc': 0.5}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6418666894498625, 'Valid Loss': 0.7118886256217957, 'Validation Metric': {'Precision': 0.5416666666666666, 'Recall': 0.24074074074074073, 'F1': 0.33333333333333337, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6346131912187526, 'Valid Loss': 0.7163319158554077, 'Validation Metric': {'Precision': 0.525, 'Recall': 0.3888888888888889, 'F1': 0.4468085106382979, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.6097826463611502, 'Valid Loss': 0.7229907941818238, 'Validation Metric': {'Precision': 0.5084745762711864, 'Recall': 0.5555555555555556, 'F1': 0.5309734513274337, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5921493149117419, 'Valid Loss': 0.7242048239707947, 'Validation Metric': {'Precision': 0.5254237288135594, 'Recall': 0.5740740740740741, 'F1': 0.5486725663716815, 'Acc': 0.49}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5690693655296376, 'Valid Loss': 0.7323681330680847, 'Validation Metric': {'Precision': 0.4883720930232558, 'Recall': 0.3888888888888889, 'F1': 0.43298969072164956, 'Acc': 0.45}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5615728552404203, 'Valid Loss': 0.7386076402664185, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.48148148148148145, 'F1': 0.49056603773584906, 'Acc': 0.46}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5299743445296037, 'Valid Loss': 0.7430365467071534, 'Validation Metric': {'Precision': 0.5106382978723404, 'Recall': 0.4444444444444444, 'F1': 0.4752475247524752, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.530438623146007, 'Valid Loss': 0.7442297971248627, 'Validation Metric': {'Precision': 0.5106382978723404, 'Recall': 0.4444444444444444, 'F1': 0.4752475247524752, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5033707218734842, 'Valid Loss': 0.7498576200008392, 'Validation Metric': {'Precision': 0.5106382978723404, 'Recall': 0.4444444444444444, 'F1': 0.4752475247524752, 'Acc': 0.47}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5053248464276916, 'Valid Loss': 0.7520983433723449, 'Validation Metric': {'Precision': 0.5208333333333334, 'Recall': 0.46296296296296297, 'F1': 0.4901960784313726, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.4917263984680176, 'Valid Loss': 0.7540221905708313, 'Validation Metric': {'Precision': 0.5192307692307693, 'Recall': 0.5, 'F1': 0.509433962264151, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.4844734845192809, 'Valid Loss': 0.7554493093490601, 'Validation Metric': {'Precision': 0.5192307692307693, 'Recall': 0.5, 'F1': 0.509433962264151, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.4744027233437488, 'Valid Loss': 0.7565068233013154, 'Validation Metric': {'Precision': 0.5192307692307693, 'Recall': 0.5, 'F1': 0.509433962264151, 'Acc': 0.48}}
Best validation metric so far: {'Precision': 0.5277777777777778, 'Recall': 0.7037037037037037, 'F1': 0.6031746031746033, 'Acc': 0.5}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.4805194805194805, 'Recall': 0.8604651162790697, 'F1': 0.6166666666666667, 'Acc': 0.54}; Test loss: 0.6986752104759216
