Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='ar')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.7641208080450693, 'Valid Loss': 0.7589340049486893, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.504950495049505}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.7565957291920979, 'Valid Loss': 0.7317189241831119, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.504950495049505}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.7335986153284708, 'Valid Loss': 0.7063758098162137, 'Validation Metric': {'Precision': 0.6, 'Recall': 0.06, 'F1': 0.1090909090909091, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6, 'Recall': 0.06, 'F1': 0.1090909090909091, 'Acc': 0.5148514851485149}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.7090427684783935, 'Valid Loss': 0.7033043985183423, 'Validation Metric': {'Precision': 0.46153846153846156, 'Recall': 0.36, 'F1': 0.4044943820224719, 'Acc': 0.4752475247524752}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.36, 'F1': 0.4044943820224719, 'Acc': 0.4752475247524752}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.6728348827362061, 'Valid Loss': 0.7010660079809335, 'Validation Metric': {'Precision': 0.5161290322580645, 'Recall': 0.32, 'F1': 0.3950617283950617, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.36, 'F1': 0.4044943820224719, 'Acc': 0.4752475247524752}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6741254154841105, 'Valid Loss': 0.7026358980398911, 'Validation Metric': {'Precision': 0.5185185185185185, 'Recall': 0.28, 'F1': 0.36363636363636365, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.36, 'F1': 0.4044943820224719, 'Acc': 0.4752475247524752}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6529748773574829, 'Valid Loss': 0.7052995745952313, 'Validation Metric': {'Precision': 0.47058823529411764, 'Recall': 0.16, 'F1': 0.23880597014925375, 'Acc': 0.49504950495049505}}
Best validation metric so far: {'Precision': 0.46153846153846156, 'Recall': 0.36, 'F1': 0.4044943820224719, 'Acc': 0.4752475247524752}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.6404374392827352, 'Valid Loss': 0.713829939181988, 'Validation Metric': {'Precision': 0.47619047619047616, 'Recall': 0.4, 'F1': 0.43478260869565216, 'Acc': 0.48514851485148514}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47619047619047616, 'Recall': 0.4, 'F1': 0.43478260869565216, 'Acc': 0.48514851485148514}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6084321308135986, 'Valid Loss': 0.7139717294619634, 'Validation Metric': {'Precision': 0.4444444444444444, 'Recall': 0.24, 'F1': 0.3116883116883117, 'Acc': 0.4752475247524752}}
Best validation metric so far: {'Precision': 0.47619047619047616, 'Recall': 0.4, 'F1': 0.43478260869565216, 'Acc': 0.48514851485148514}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5993001882235209, 'Valid Loss': 0.7148613700499902, 'Validation Metric': {'Precision': 0.4883720930232558, 'Recall': 0.42, 'F1': 0.45161290322580644, 'Acc': 0.49504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4883720930232558, 'Recall': 0.42, 'F1': 0.45161290322580644, 'Acc': 0.49504950495049505}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5697440779209137, 'Valid Loss': 0.7087391087642083, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.28, 'F1': 0.358974358974359, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.4883720930232558, 'Recall': 0.42, 'F1': 0.45161290322580644, 'Acc': 0.49504950495049505}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5486559569835663, 'Valid Loss': 0.7064971625804901, 'Validation Metric': {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.532615426381429, 'Valid Loss': 0.7135541141033173, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.36, 'F1': 0.41860465116279066, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5185573772589366, 'Valid Loss': 0.7191135677007529, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.4, 'F1': 0.4444444444444445, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.49835169514020283, 'Valid Loss': 0.7204291155705085, 'Validation Metric': {'Precision': 0.5128205128205128, 'Recall': 0.4, 'F1': 0.449438202247191, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.48960379203160603, 'Valid Loss': 0.7230468667470492, 'Validation Metric': {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.4844065459569295, 'Valid Loss': 0.7265514341684488, 'Validation Metric': {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}}
Best validation metric so far: {'Precision': 0.5121951219512195, 'Recall': 0.42, 'F1': 0.46153846153846156, 'Acc': 0.5148514851485149}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.46746636549631754, 'Valid Loss': 0.7331500947475433, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.44, 'F1': 0.46808510638297873, 'Acc': 0.504950495049505}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.44, 'F1': 0.46808510638297873, 'Acc': 0.504950495049505}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.452073655128479, 'Valid Loss': 0.7345207012616671, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.44, 'F1': 0.46808510638297873, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.44, 'F1': 0.46808510638297873, 'Acc': 0.504950495049505}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.45928008516629537, 'Valid Loss': 0.7353413357184484, 'Validation Metric': {'Precision': 0.5, 'Recall': 0.44, 'F1': 0.46808510638297873, 'Acc': 0.504950495049505}}
Best validation metric so far: {'Precision': 0.5, 'Recall': 0.44, 'F1': 0.46808510638297873, 'Acc': 0.504950495049505}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.5777777777777777, 'Recall': 0.49056603773584906, 'F1': 0.5306122448979591, 'Acc': 0.5445544554455446}; Test loss: 0.694262486237746
