Namespace(batch_size=4, checkpoint_dir='./ckp/', dataset='./dataset_sentence/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, fusion='linear', lm='bert', log_dir='./log/linear/stb-ub-4/', lr=2e-06, max_len=64, n_passages=4, random_seed=42, specified_label='co')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.8811872887611389, 'Valid Loss': 0.9317803428723261, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}, Latest Lr: 4e-07
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.8558601113160451, 'Valid Loss': 0.8426553400663229, 'Validation Metric': {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}}
Best validation metric so far: {'Precision': 0, 'Recall': 0, 'F1': 0, 'Acc': 0.2871287128712871}, Latest Lr: 8e-07
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.776267269452413, 'Valid Loss': 0.6984990216218508, 'Validation Metric': {'Precision': 0.684931506849315, 'Recall': 0.6944444444444444, 'F1': 0.6896551724137931, 'Acc': 0.5544554455445545}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.684931506849315, 'Recall': 0.6944444444444444, 'F1': 0.6896551724137931, 'Acc': 0.5544554455445545}, Latest Lr: 1.2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.6758012429873148, 'Valid Loss': 0.6528563235814755, 'Validation Metric': {'Precision': 0.6923076923076923, 'Recall': 0.875, 'F1': 0.7730061349693251, 'Acc': 0.6336633663366337}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6923076923076923, 'Recall': 0.875, 'F1': 0.7730061349693251, 'Acc': 0.6336633663366337}, Latest Lr: 1.6e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.651655319929123, 'Valid Loss': 0.6464117421553686, 'Validation Metric': {'Precision': 0.6956521739130435, 'Recall': 0.8888888888888888, 'F1': 0.7804878048780488, 'Acc': 0.6435643564356436}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.6956521739130435, 'Recall': 0.8888888888888888, 'F1': 0.7804878048780488, 'Acc': 0.6435643564356436}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.6409493585427603, 'Valid Loss': 0.6383775105843177, 'Validation Metric': {'Precision': 0.7021276595744681, 'Recall': 0.9166666666666666, 'F1': 0.7951807228915662, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.7021276595744681, 'Recall': 0.9166666666666666, 'F1': 0.7951807228915662, 'Acc': 0.6633663366336634}, Latest Lr: 1.8666666666666667e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.6307595594724019, 'Valid Loss': 0.6350226952479436, 'Validation Metric': {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.7333333333333334e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.611934586763382, 'Valid Loss': 0.6514155096732653, 'Validation Metric': {'Precision': 0.7052631578947368, 'Recall': 0.9305555555555556, 'F1': 0.8023952095808383, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.6e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.6069089512030283, 'Valid Loss': 0.6451942187089187, 'Validation Metric': {'Precision': 0.7052631578947368, 'Recall': 0.9305555555555556, 'F1': 0.8023952095808383, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.4666666666666667e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.5821830840905508, 'Valid Loss': 0.6525474695058969, 'Validation Metric': {'Precision': 0.7096774193548387, 'Recall': 0.9166666666666666, 'F1': 0.7999999999999999, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.3333333333333334e-06
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.5849920868873596, 'Valid Loss': 0.6417638934575595, 'Validation Metric': {'Precision': 0.7052631578947368, 'Recall': 0.9305555555555556, 'F1': 0.8023952095808383, 'Acc': 0.6732673267326733}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.2e-06
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.5722455132007599, 'Valid Loss': 0.6435317993164062, 'Validation Metric': {'Precision': 0.7021276595744681, 'Recall': 0.9166666666666666, 'F1': 0.7951807228915662, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.0666666666666667e-06
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.5590420607725779, 'Valid Loss': 0.6440928268891114, 'Validation Metric': {'Precision': 0.6989247311827957, 'Recall': 0.9027777777777778, 'F1': 0.7878787878787878, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 9.333333333333333e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.5368864127000172, 'Valid Loss': 0.6499677930886929, 'Validation Metric': {'Precision': 0.7032967032967034, 'Recall': 0.8888888888888888, 'F1': 0.7852760736196318, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 8e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.536643344561259, 'Valid Loss': 0.649273870083002, 'Validation Metric': {'Precision': 0.7, 'Recall': 0.875, 'F1': 0.7777777777777777, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 6.666666666666667e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.5214802440007528, 'Valid Loss': 0.6467739710441003, 'Validation Metric': {'Precision': 0.7032967032967034, 'Recall': 0.8888888888888888, 'F1': 0.7852760736196318, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 5.333333333333335e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.5098757755756378, 'Valid Loss': 0.6483667275080314, 'Validation Metric': {'Precision': 0.7111111111111111, 'Recall': 0.8888888888888888, 'F1': 0.7901234567901234, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 3.999999999999999e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.5124849339326223, 'Valid Loss': 0.6468441073711102, 'Validation Metric': {'Precision': 0.7065217391304348, 'Recall': 0.9027777777777778, 'F1': 0.7926829268292683, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 2.666666666666666e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.49526416420936586, 'Valid Loss': 0.6507386633983026, 'Validation Metric': {'Precision': 0.7111111111111111, 'Recall': 0.8888888888888888, 'F1': 0.7901234567901234, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 1.333333333333333e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.503592779636383, 'Valid Loss': 0.6509952384691972, 'Validation Metric': {'Precision': 0.7111111111111111, 'Recall': 0.8888888888888888, 'F1': 0.7901234567901234, 'Acc': 0.6633663366336634}}
Best validation metric so far: {'Precision': 0.711340206185567, 'Recall': 0.9583333333333334, 'F1': 0.8165680473372781, 'Acc': 0.693069306930693}, Latest Lr: 0.0
Testing...
Test metric: {'Precision': 0.61, 'Recall': 0.9838709677419355, 'F1': 0.7530864197530864, 'Acc': 0.6039603960396039}; Test loss: 0.6770971165253565
