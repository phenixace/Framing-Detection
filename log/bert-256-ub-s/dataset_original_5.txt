Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.42082856987652023, 'Validation Metric': {'Precision': 0.38342424242424245, 'Recall': 0.3774924054128694, 'F1': 0.3241726643186497, 'Acc': 0.578}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38342424242424245, 'Recall': 0.3774924054128694, 'F1': 0.3241726643186497, 'Acc': 0.578}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3496379389574653, 'Validation Metric': {'Precision': 0.3413265694356373, 'Recall': 0.3943017582619902, 'F1': 0.31692950164471434, 'Acc': 0.592}}
Best validation metric so far: {'Precision': 0.38342424242424245, 'Recall': 0.3774924054128694, 'F1': 0.3241726643186497, 'Acc': 0.578}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.32036091308844716, 'Validation Metric': {'Precision': 0.3394782608695652, 'Recall': 0.41402006812114517, 'F1': 0.3252016586856755, 'Acc': 0.6}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3394782608695652, 'Recall': 0.41402006812114517, 'F1': 0.3252016586856755, 'Acc': 0.6}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.3007987349441177, 'Validation Metric': {'Precision': 0.3609838813668601, 'Recall': 0.4233575746417502, 'F1': 0.3327811212021739, 'Acc': 0.606}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3609838813668601, 'Recall': 0.4233575746417502, 'F1': 0.3327811212021739, 'Acc': 0.606}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.28093100378387853, 'Validation Metric': {'Precision': 0.3773419913419913, 'Recall': 0.43639878486605904, 'F1': 0.34413942551594373, 'Acc': 0.614}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3773419913419913, 'Recall': 0.43639878486605904, 'F1': 0.34413942551594373, 'Acc': 0.614}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.2626777836366704, 'Validation Metric': {'Precision': 0.38575618251480315, 'Recall': 0.45403050108932463, 'F1': 0.3607999570295814, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38575618251480315, 'Recall': 0.45403050108932463, 'F1': 0.3607999570295814, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2501267465321641, 'Validation Metric': {'Precision': 0.3186054089279896, 'Recall': 0.44720068906115423, 'F1': 0.3512510356255178, 'Acc': 0.614}}
Best validation metric so far: {'Precision': 0.38575618251480315, 'Recall': 0.45403050108932463, 'F1': 0.3607999570295814, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2347057434289079, 'Validation Metric': {'Precision': 0.38143598143598145, 'Recall': 0.46049044940973805, 'F1': 0.36650916382482246, 'Acc': 0.612}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.38143598143598145, 'Recall': 0.46049044940973805, 'F1': 0.36650916382482246, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.22190095170548088, 'Validation Metric': {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.21220135845636068, 'Validation Metric': {'Precision': 0.37063764580792447, 'Recall': 0.46135177585245984, 'F1': 0.3671035887915683, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.201898282687915, 'Validation Metric': {'Precision': 0.37063764580792447, 'Recall': 0.46135177585245984, 'F1': 0.3671035887915683, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2011890576073998, 'Validation Metric': {'Precision': 0.37063764580792447, 'Recall': 0.46135177585245984, 'F1': 0.3671035887915683, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.20106699592188784, 'Validation Metric': {'Precision': 0.37063764580792447, 'Recall': 0.46135177585245984, 'F1': 0.3671035887915683, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.1994395659942376, 'Validation Metric': {'Precision': 0.37063764580792447, 'Recall': 0.46135177585245984, 'F1': 0.3671035887915683, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1987907976696366, 'Validation Metric': {'Precision': 0.37239830345093505, 'Recall': 0.46223857814771285, 'F1': 0.3687800454633294, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.19768268262085162, 'Validation Metric': {'Precision': 0.3717213047000281, 'Recall': 0.4604043167654659, 'F1': 0.36806382246857955, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1958823102085214, 'Validation Metric': {'Precision': 0.37114410412282756, 'Recall': 0.4575874153570152, 'F1': 0.36668547231194887, 'Acc': 0.594}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.19706040699230998, 'Validation Metric': {'Precision': 0.3720134704005672, 'Recall': 0.4575874153570152, 'F1': 0.36750127308481273, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.19817575106495305, 'Validation Metric': {'Precision': 0.3720134704005672, 'Recall': 0.4575874153570152, 'F1': 0.36750127308481273, 'Acc': 0.596}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19583192075553693, 'Validation Metric': {'Precision': 0.37048952265020435, 'Recall': 0.4575874153570152, 'F1': 0.3667606629631411, 'Acc': 0.594}}
Best validation metric so far: {'Precision': 0.37548815640502414, 'Recall': 0.4669503977301515, 'F1': 0.370260016235555, 'Acc': 0.604}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.5, 0, 0, 0.6530612244897959, 0.35353535353535354], 'Recall': [0.46511627906976744, 0, 0, 1.0, 1.0], 'F1': [0.4819277108433735, 0, 0, 0.7901234567901235, 0.5223880597014925], 'Acc': [0.57, 0.69, 0.89, 0.66, 0.36]}
