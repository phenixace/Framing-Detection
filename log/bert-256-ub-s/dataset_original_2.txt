Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.42275126905817734, 'Validation Metric': {'Precision': 0.41541176470588237, 'Recall': 0.397770979020979, 'F1': 0.3449489883866966, 'Acc': 0.602}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41541176470588237, 'Recall': 0.397770979020979, 'F1': 0.3449489883866966, 'Acc': 0.602}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.35042770402996165, 'Validation Metric': {'Precision': 0.4315813953488372, 'Recall': 0.4176311188811189, 'F1': 0.3450735788211975, 'Acc': 0.61}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4315813953488372, 'Recall': 0.4176311188811189, 'F1': 0.3450735788211975, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.32542977207585383, 'Validation Metric': {'Precision': 0.5230037453183521, 'Recall': 0.4200524475524475, 'F1': 0.34017276840806254, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.4315813953488372, 'Recall': 0.4176311188811189, 'F1': 0.3450735788211975, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.3056110822056469, 'Validation Metric': {'Precision': 0.5237777777777778, 'Recall': 0.41687937062937064, 'F1': 0.33037328263134713, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.4315813953488372, 'Recall': 0.4176311188811189, 'F1': 0.3450735788211975, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.28278202720378576, 'Validation Metric': {'Precision': 0.5303681318681319, 'Recall': 0.4235926573426573, 'F1': 0.33695131159919894, 'Acc': 0.626}}
Best validation metric so far: {'Precision': 0.4315813953488372, 'Recall': 0.4176311188811189, 'F1': 0.3450735788211975, 'Acc': 0.61}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.26882011325735794, 'Validation Metric': {'Precision': 0.5407368421052632, 'Recall': 0.4468094405594406, 'F1': 0.3564009324009324, 'Acc': 0.638}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5407368421052632, 'Recall': 0.4468094405594406, 'F1': 0.3564009324009324, 'Acc': 0.638}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.25443502829263087, 'Validation Metric': {'Precision': 0.4262482269503546, 'Recall': 0.4442919580419581, 'F1': 0.3538420537394954, 'Acc': 0.626}}
Best validation metric so far: {'Precision': 0.5407368421052632, 'Recall': 0.4468094405594406, 'F1': 0.3564009324009324, 'Acc': 0.638}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.24059945423352092, 'Validation Metric': {'Precision': 0.43676337846550617, 'Recall': 0.45782261343307856, 'F1': 0.3707552901575193, 'Acc': 0.632}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43676337846550617, 'Recall': 0.45782261343307856, 'F1': 0.3707552901575193, 'Acc': 0.632}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2318993277455631, 'Validation Metric': {'Precision': 0.4260514923672818, 'Recall': 0.46453590014636525, 'F1': 0.37201900948172695, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4260514923672818, 'Recall': 0.46453590014636525, 'F1': 0.37201900948172695, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.21532117653834193, 'Validation Metric': {'Precision': 0.43015873015873013, 'Recall': 0.471249186859652, 'F1': 0.37783194114477786, 'Acc': 0.636}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.43015873015873013, 'Recall': 0.471249186859652, 'F1': 0.37783194114477786, 'Acc': 0.636}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.20950139745285637, 'Validation Metric': {'Precision': 0.4289805269186712, 'Recall': 0.46659802406895434, 'F1': 0.3758258621174223, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.43015873015873013, 'Recall': 0.471249186859652, 'F1': 0.37783194114477786, 'Acc': 0.636}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.20837624096556714, 'Validation Metric': {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2079567015171051, 'Validation Metric': {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.20374812734754463, 'Validation Metric': {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.20548509453472338, 'Validation Metric': {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.20457870866122999, 'Validation Metric': {'Precision': 0.3980495959877403, 'Recall': 0.47023438770531795, 'F1': 0.3788819875776398, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.4313829293210736, 'Recall': 0.47023438770531795, 'F1': 0.37921812203142136, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.2006206814395754, 'Validation Metric': {'Precision': 0.3836588894917706, 'Recall': 0.47387075134168155, 'F1': 0.381883835348071, 'Acc': 0.634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3836588894917706, 'Recall': 0.47387075134168155, 'F1': 0.381883835348071, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2026542656515774, 'Validation Metric': {'Precision': 0.3836588894917706, 'Recall': 0.47387075134168155, 'F1': 0.381883835348071, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.3836588894917706, 'Recall': 0.47387075134168155, 'F1': 0.381883835348071, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2023475919114916, 'Validation Metric': {'Precision': 0.3776939772110689, 'Recall': 0.46715746462839486, 'F1': 0.37607654889912956, 'Acc': 0.628}}
Best validation metric so far: {'Precision': 0.3836588894917706, 'Recall': 0.47387075134168155, 'F1': 0.381883835348071, 'Acc': 0.634}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19775295610490598, 'Validation Metric': {'Precision': 0.37998817424210807, 'Recall': 0.47079382826475846, 'F1': 0.37937098953056403, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.3836588894917706, 'Recall': 0.47387075134168155, 'F1': 0.381883835348071, 'Acc': 0.634}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.48148148148148145, 0.3333333333333333, 0, 0.7291666666666666, 0.3434343434343434], 'Recall': [0.26, 0.07142857142857142, 0, 0.9722222222222222, 0.9714285714285714], 'F1': [0.33766233766233766, 0.11764705882352941, 0, 0.8333333333333333, 0.5074626865671641], 'Acc': [0.49504950495049505, 0.7029702970297029, 0.9504950495049505, 0.7227722772277227, 0.3465346534653465]}
