Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_lemmatized/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.3865874064596076, 'Validation Metric': {'Precision': 0.278421052631579, 'Recall': 0.3999273255813954, 'F1': 0.2738294898672257, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.278421052631579, 'Recall': 0.3999273255813954, 'F1': 0.2738294898672257, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3307388126850128, 'Validation Metric': {'Precision': 0.47653061224489796, 'Recall': 0.4101951827242525, 'F1': 0.28724989357173264, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.47653061224489796, 'Recall': 0.4101951827242525, 'F1': 0.28724989357173264, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.30433096775883123, 'Validation Metric': {'Precision': 0.28298701298701295, 'Recall': 0.41082848837209307, 'F1': 0.2823049306975688, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.47653061224489796, 'Recall': 0.4101951827242525, 'F1': 0.28724989357173264, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.27801929375058726, 'Validation Metric': {'Precision': 0.2819047619047619, 'Recall': 0.4201308139534884, 'F1': 0.29562289562289557, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2819047619047619, 'Recall': 0.4201308139534884, 'F1': 0.29562289562289557, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2565007056844862, 'Validation Metric': {'Precision': 0.2566066383824947, 'Recall': 0.43561046511627904, 'F1': 0.30716352766969246, 'Acc': 0.608}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2566066383824947, 'Recall': 0.43561046511627904, 'F1': 0.30716352766969246, 'Acc': 0.608}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.24001616749324298, 'Validation Metric': {'Precision': 0.26517857142857143, 'Recall': 0.45574127906976747, 'F1': 0.32364551083591325, 'Acc': 0.606}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.26517857142857143, 'Recall': 0.45574127906976747, 'F1': 0.32364551083591325, 'Acc': 0.606}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2269329381616492, 'Validation Metric': {'Precision': 0.26510693607467795, 'Recall': 0.43958887043189365, 'F1': 0.32098423753665684, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.26517857142857143, 'Recall': 0.45574127906976747, 'F1': 0.32364551083591325, 'Acc': 0.606}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21240628118577756, 'Validation Metric': {'Precision': 0.2749991168678246, 'Recall': 0.42283637873754154, 'F1': 0.32747481607243917, 'Acc': 0.612}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2749991168678246, 'Recall': 0.42283637873754154, 'F1': 0.32747481607243917, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.20299002332122704, 'Validation Metric': {'Precision': 0.26974789915966385, 'Recall': 0.39426495016611296, 'F1': 0.3165166359439575, 'Acc': 0.606}}
Best validation metric so far: {'Precision': 0.2749991168678246, 'Recall': 0.42283637873754154, 'F1': 0.32747481607243917, 'Acc': 0.612}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19501011230443654, 'Validation Metric': {'Precision': 0.32222234681138945, 'Recall': 0.3899792358803987, 'F1': 0.3290177304964539, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.32222234681138945, 'Recall': 0.3899792358803987, 'F1': 0.3290177304964539, 'Acc': 0.618}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.1894174304447676, 'Validation Metric': {'Precision': 0.3237125428898208, 'Recall': 0.3899792358803987, 'F1': 0.32988709677419353, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3237125428898208, 'Recall': 0.3899792358803987, 'F1': 0.32988709677419353, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.18665606214811928, 'Validation Metric': {'Precision': 0.3263921568627451, 'Recall': 0.3899792358803987, 'F1': 0.3318184520079154, 'Acc': 0.624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3263921568627451, 'Recall': 0.3899792358803987, 'F1': 0.3318184520079154, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.18659003314219022, 'Validation Metric': {'Precision': 0.3263921568627451, 'Recall': 0.3899792358803987, 'F1': 0.3318184520079154, 'Acc': 0.624}}
Best validation metric so far: {'Precision': 0.3263921568627451, 'Recall': 0.3899792358803987, 'F1': 0.3318184520079154, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18354106184683347, 'Validation Metric': {'Precision': 0.3263921568627451, 'Recall': 0.3899792358803987, 'F1': 0.3318184520079154, 'Acc': 0.624}}
Best validation metric so far: {'Precision': 0.3263921568627451, 'Recall': 0.3899792358803987, 'F1': 0.3318184520079154, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.18653790535111175, 'Validation Metric': {'Precision': 0.3276350947158524, 'Recall': 0.3899792358803987, 'F1': 0.33280389433714275, 'Acc': 0.626}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3276350947158524, 'Recall': 0.3899792358803987, 'F1': 0.33280389433714275, 'Acc': 0.626}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18081653314201454, 'Validation Metric': {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.1813247595962725, 'Validation Metric': {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}}
Best validation metric so far: {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18375327594970403, 'Validation Metric': {'Precision': 0.3285890390842975, 'Recall': 0.39463039867109634, 'F1': 0.33522340425531916, 'Acc': 0.626}}
Best validation metric so far: {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.1814247628575877, 'Validation Metric': {'Precision': 0.3285890390842975, 'Recall': 0.39463039867109634, 'F1': 0.33522340425531916, 'Acc': 0.626}}
Best validation metric so far: {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17981745694812976, 'Validation Metric': {'Precision': 0.325551048005409, 'Recall': 0.3857911129568106, 'F1': 0.3302108428185156, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.330066467264872, 'Recall': 0.39463039867109634, 'F1': 0.3361898472083393, 'Acc': 0.628}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.509090909090909, 0.6, 0, 0.6477272727272727, 0.5283018867924528], 'Recall': [0.509090909090909, 0.09375, 0, 0.8769230769230769, 0.6511627906976745], 'F1': [0.509090909090909, 0.16216216216216214, 0, 0.7450980392156863, 0.5833333333333333], 'Acc': [0.46, 0.69, 0.91, 0.61, 0.6]}
