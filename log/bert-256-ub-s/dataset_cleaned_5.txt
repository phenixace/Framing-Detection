Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.38355147054320887, 'Validation Metric': {'Precision': 0.39885714285714285, 'Recall': 0.41120316671269447, 'F1': 0.32879986322968785, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.39885714285714285, 'Recall': 0.41120316671269447, 'F1': 0.32879986322968785, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.32809056067153025, 'Validation Metric': {'Precision': 0.41641666666666666, 'Recall': 0.42247077234649727, 'F1': 0.3338599921683755, 'Acc': 0.626}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41641666666666666, 'Recall': 0.42247077234649727, 'F1': 0.3338599921683755, 'Acc': 0.626}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.30028349670924637, 'Validation Metric': {'Precision': 0.33415039417828984, 'Recall': 0.427699530516432, 'F1': 0.3352696599175472, 'Acc': 0.622}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.33415039417828984, 'Recall': 0.427699530516432, 'F1': 0.3352696599175472, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.27355548543365377, 'Validation Metric': {'Precision': 0.3365494505494505, 'Recall': 0.44903495044340114, 'F1': 0.35596019365250137, 'Acc': 0.626}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3365494505494505, 'Recall': 0.44903495044340114, 'F1': 0.35596019365250137, 'Acc': 0.626}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2540679664203995, 'Validation Metric': {'Precision': 0.3341203007518797, 'Recall': 0.47125717266562334, 'F1': 0.3729167153916318, 'Acc': 0.626}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3341203007518797, 'Recall': 0.47125717266562334, 'F1': 0.3729167153916318, 'Acc': 0.626}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.2347923105484561, 'Validation Metric': {'Precision': 0.3510718927769619, 'Recall': 0.503547209181012, 'F1': 0.40238158182465006, 'Acc': 0.644}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3510718927769619, 'Recall': 0.503547209181012, 'F1': 0.40238158182465006, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.21935079991817474, 'Validation Metric': {'Precision': 0.34858520445502233, 'Recall': 0.4922286518421467, 'F1': 0.4028418803418804, 'Acc': 0.644}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.34858520445502233, 'Recall': 0.4922286518421467, 'F1': 0.4028418803418804, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.211375419246523, 'Validation Metric': {'Precision': 0.354287563046096, 'Recall': 0.4940022564326528, 'F1': 0.40879001268451554, 'Acc': 0.65}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.354287563046096, 'Recall': 0.4940022564326528, 'F1': 0.40879001268451554, 'Acc': 0.65}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.1985647960713035, 'Validation Metric': {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.1889255003709542, 'Validation Metric': {'Precision': 0.3653666465687156, 'Recall': 0.43720566291807683, 'F1': 0.3980054761486096, 'Acc': 0.666}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18030888351954913, 'Validation Metric': {'Precision': 0.36894873612095436, 'Recall': 0.43720566291807683, 'F1': 0.4001722932886887, 'Acc': 0.67}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.17758306233506455, 'Validation Metric': {'Precision': 0.3695798319327731, 'Recall': 0.44002256432652764, 'F1': 0.4017307348471304, 'Acc': 0.672}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.17986348898787247, 'Validation Metric': {'Precision': 0.3716190476190476, 'Recall': 0.44002256432652764, 'F1': 0.4029203939640372, 'Acc': 0.674}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.17760282421582624, 'Validation Metric': {'Precision': 0.3716190476190476, 'Recall': 0.44002256432652764, 'F1': 0.4029203939640372, 'Acc': 0.674}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.17846400682863436, 'Validation Metric': {'Precision': 0.3733975903614458, 'Recall': 0.44002256432652764, 'F1': 0.40395935500299823, 'Acc': 0.676}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.17585943266749382, 'Validation Metric': {'Precision': 0.3733975903614458, 'Recall': 0.44002256432652764, 'F1': 0.40395935500299823, 'Acc': 0.676}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.17824222912129603, 'Validation Metric': {'Precision': 0.37709451219512197, 'Recall': 0.44002256432652764, 'F1': 0.4061228500877297, 'Acc': 0.678}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.17698690393253377, 'Validation Metric': {'Precision': 0.3751353285216526, 'Recall': 0.43537140153583, 'F1': 0.40299054527239536, 'Acc': 0.676}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17935030240761607, 'Validation Metric': {'Precision': 0.3764240948465131, 'Recall': 0.434423942448836, 'F1': 0.40321195144724553, 'Acc': 0.676}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17276910221890399, 'Validation Metric': {'Precision': 0.3764240948465131, 'Recall': 0.434423942448836, 'F1': 0.40321195144724553, 'Acc': 0.676}}
Best validation metric so far: {'Precision': 0.36288430995130055, 'Recall': 0.47445014618286807, 'F1': 0.4101721517593555, 'Acc': 0.666}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.46153846153846156, 0, 0, 0.6626506024096386, 0.3253012048192771], 'Recall': [0.6976744186046512, 0, 0, 0.859375, 0.7714285714285715], 'F1': [0.5555555555555556, 0, 0, 0.7482993197278912, 0.45762711864406785], 'Acc': [0.52, 0.68, 0.89, 0.63, 0.36]}
