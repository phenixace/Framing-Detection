Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_lemmatized/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.38904045992775965, 'Validation Metric': {'Precision': 0.4156703296703297, 'Recall': 0.4013111888111888, 'F1': 0.30753366851727504, 'Acc': 0.616}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4156703296703297, 'Recall': 0.4013111888111888, 'F1': 0.30753366851727504, 'Acc': 0.616}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.33223717424430343, 'Validation Metric': {'Precision': 0.38391666666666663, 'Recall': 0.40998251748251746, 'F1': 0.30592023335651525, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.4156703296703297, 'Recall': 0.4013111888111888, 'F1': 0.30753366851727504, 'Acc': 0.616}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.30851692588705765, 'Validation Metric': {'Precision': 0.4492302405498282, 'Recall': 0.4136188811188811, 'F1': 0.312251740726317, 'Acc': 0.624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4492302405498282, 'Recall': 0.4136188811188811, 'F1': 0.312251740726317, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.28449627717858866, 'Validation Metric': {'Precision': 0.44775438596491224, 'Recall': 0.42201048951048953, 'F1': 0.3314577586592512, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.44775438596491224, 'Recall': 0.42201048951048953, 'F1': 0.3314577586592512, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2616374649499592, 'Validation Metric': {'Precision': 0.44441331880803636, 'Recall': 0.44802447552447555, 'F1': 0.3615939663136049, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.44441331880803636, 'Recall': 0.44802447552447555, 'F1': 0.3615939663136049, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.244573081794538, 'Validation Metric': {'Precision': 0.4226042774429871, 'Recall': 0.4647361359570662, 'F1': 0.38481415828292725, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4226042774429871, 'Recall': 0.4647361359570662, 'F1': 0.38481415828292725, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22881030918736206, 'Validation Metric': {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21769927285219492, 'Validation Metric': {'Precision': 0.4559078176725236, 'Recall': 0.45411692958204586, 'F1': 0.41794617353653524, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.20496377662608498, 'Validation Metric': {'Precision': 0.44518982309679983, 'Recall': 0.43197999674743864, 'F1': 0.41212032450650893, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.1953782596086201, 'Validation Metric': {'Precision': 0.4610598010311066, 'Recall': 0.401451455521223, 'F1': 0.3997937763171408, 'Acc': 0.662}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18846416355747925, 'Validation Metric': {'Precision': 0.4635742296918767, 'Recall': 0.40246625467555697, 'F1': 0.40145141133376433, 'Acc': 0.664}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.1859891940104334, 'Validation Metric': {'Precision': 0.468855614973262, 'Recall': 0.40086741746625465, 'F1': 0.39496773620911546, 'Acc': 0.664}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.18722559237166456, 'Validation Metric': {'Precision': 0.4669780639528539, 'Recall': 0.39723105382989105, 'F1': 0.3921105933519726, 'Acc': 0.662}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18705484623971738, 'Validation Metric': {'Precision': 0.4669780639528539, 'Recall': 0.39723105382989105, 'F1': 0.3921105933519726, 'Acc': 0.662}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.18533436718739962, 'Validation Metric': {'Precision': 0.4652042280326765, 'Recall': 0.38792872824849567, 'F1': 0.3865276705276705, 'Acc': 0.66}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18520316285522362, 'Validation Metric': {'Precision': 0.46288715486194476, 'Recall': 0.383277565457798, 'F1': 0.38297058504287423, 'Acc': 0.658}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18358011465323598, 'Validation Metric': {'Precision': 0.4667728554836569, 'Recall': 0.38792872824849567, 'F1': 0.3875299076641358, 'Acc': 0.662}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18365106888507543, 'Validation Metric': {'Precision': 0.4667728554836569, 'Recall': 0.38792872824849567, 'F1': 0.3875299076641358, 'Acc': 0.662}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.18410791731194445, 'Validation Metric': {'Precision': 0.469025641025641, 'Recall': 0.38691392909416167, 'F1': 0.3880641701496178, 'Acc': 0.664}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.18403374442928716, 'Validation Metric': {'Precision': 0.48416289592760176, 'Recall': 0.3968002927305253, 'F1': 0.40054023537642786, 'Acc': 0.668}}
Best validation metric so far: {'Precision': 0.4484078176725236, 'Recall': 0.4773727435355342, 'F1': 0.4186452085642687, 'Acc': 0.648}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.41818181818181815, 0, 0, 0.7303370786516854, 0.36046511627906974], 'Recall': [0.46, 0, 0, 0.9027777777777778, 0.8857142857142857], 'F1': [0.43809523809523804, 0, 0, 0.8074534161490682, 0.512396694214876], 'Acc': [0.4158415841584158, 0.6732673267326733, 0.9504950495049505, 0.693069306930693, 0.4158415841584158]}
