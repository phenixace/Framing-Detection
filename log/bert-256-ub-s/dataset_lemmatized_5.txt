Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_lemmatized/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=5, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.38258889552794006, 'Validation Metric': {'Precision': 0.4308979591836735, 'Recall': 0.4206971677559913, 'F1': 0.32524462028184115, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4308979591836735, 'Recall': 0.4206971677559913, 'F1': 0.32524462028184115, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3276280054920598, 'Validation Metric': {'Precision': 0.4613333333333333, 'Recall': 0.42657952069716776, 'F1': 0.33378966485927436, 'Acc': 0.626}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4613333333333333, 'Recall': 0.42657952069716776, 'F1': 0.33378966485927436, 'Acc': 0.626}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.3031955094713914, 'Validation Metric': {'Precision': 0.4844102564102564, 'Recall': 0.4413943355119826, 'F1': 0.3557444072762219, 'Acc': 0.632}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4844102564102564, 'Recall': 0.4413943355119826, 'F1': 0.3557444072762219, 'Acc': 0.632}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.27751504394568893, 'Validation Metric': {'Precision': 0.5607474747474748, 'Recall': 0.4607996563257541, 'F1': 0.38187449152155034, 'Acc': 0.64}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5607474747474748, 'Recall': 0.4607996563257541, 'F1': 0.38187449152155034, 'Acc': 0.64}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2540165487872927, 'Validation Metric': {'Precision': 0.5517384657384657, 'Recall': 0.4941329896590874, 'F1': 0.4083067259537848, 'Acc': 0.644}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5517384657384657, 'Recall': 0.4941329896590874, 'F1': 0.4083067259537848, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23925590632777466, 'Validation Metric': {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22468994322576022, 'Validation Metric': {'Precision': 0.46114832586398924, 'Recall': 0.5078790318034263, 'F1': 0.41057515175162235, 'Acc': 0.624}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2108712051259844, 'Validation Metric': {'Precision': 0.4664935064935065, 'Recall': 0.5180426838275435, 'F1': 0.41970887484234093, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2012635363559974, 'Validation Metric': {'Precision': 0.4315943630837248, 'Recall': 0.48915306705715367, 'F1': 0.4105149971703453, 'Acc': 0.63}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19323888381845072, 'Validation Metric': {'Precision': 0.4139076747720365, 'Recall': 0.4658972531036653, 'F1': 0.40505306772415606, 'Acc': 0.634}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.1870379322453549, 'Validation Metric': {'Precision': 0.4048830411664575, 'Recall': 0.457542386609264, 'F1': 0.40437039678724823, 'Acc': 0.638}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.1841059525154139, 'Validation Metric': {'Precision': 0.4080013582441082, 'Recall': 0.457542386609264, 'F1': 0.4065212101133322, 'Acc': 0.642}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.1832024780543227, 'Validation Metric': {'Precision': 0.40809048480382304, 'Recall': 0.4538386829055602, 'F1': 0.40510044508600984, 'Acc': 0.642}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18189919916422745, 'Validation Metric': {'Precision': 0.42142697881828317, 'Recall': 0.4538386829055602, 'F1': 0.40549958906025385, 'Acc': 0.644}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1833198331296444, 'Validation Metric': {'Precision': 0.423008899722238, 'Recall': 0.4538386829055602, 'F1': 0.4065656465512113, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.18063130641454145, 'Validation Metric': {'Precision': 0.4223877817098156, 'Recall': 0.4510217814971096, 'F1': 0.4050962835276561, 'Acc': 0.644}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.17866801646979233, 'Validation Metric': {'Precision': 0.42406926406926404, 'Recall': 0.4463706187064119, 'F1': 0.40454406263930076, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.17775983853559746, 'Validation Metric': {'Precision': 0.4261884183232498, 'Recall': 0.4407368158895105, 'F1': 0.40363874098410174, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17895062855984034, 'Validation Metric': {'Precision': 0.4261884183232498, 'Recall': 0.4360856530988128, 'F1': 0.40177221900906107, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17823974101951248, 'Validation Metric': {'Precision': 0.42633493846976994, 'Recall': 0.42773078660441144, 'F1': 0.39836021505376346, 'Acc': 0.646}}
Best validation metric so far: {'Precision': 0.477979797979798, 'Recall': 0.5274663229924208, 'F1': 0.4248854571984936, 'Acc': 0.644}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.32653061224489793, 0, 0, 0.6382978723404256, 0.36082474226804123], 'Recall': [0.37209302325581395, 0, 0, 0.9375, 1.0], 'F1': [0.34782608695652173, 0, 0, 0.759493670886076, 0.5303030303030303], 'Acc': [0.4, 0.7, 0.89, 0.62, 0.38]}
