Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=2, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.3910911671425167, 'Validation Metric': {'Precision': 0.41643478260869565, 'Recall': 0.4043881118881119, 'F1': 0.3091178592734404, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41643478260869565, 'Recall': 0.4043881118881119, 'F1': 0.3091178592734404, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3321809054989564, 'Validation Metric': {'Precision': 0.33791489361702126, 'Recall': 0.4095192307692308, 'F1': 0.30868699547944833, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.41643478260869565, 'Recall': 0.4043881118881119, 'F1': 0.3091178592734404, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.30766949096792623, 'Validation Metric': {'Precision': 0.4008809523809524, 'Recall': 0.41417832167832175, 'F1': 0.3158940482923652, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4008809523809524, 'Recall': 0.41417832167832175, 'F1': 0.3158940482923652, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.28168055572007833, 'Validation Metric': {'Precision': 0.40672874493927125, 'Recall': 0.4157604895104895, 'F1': 0.31983854380913207, 'Acc': 0.616}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40672874493927125, 'Recall': 0.4157604895104895, 'F1': 0.31983854380913207, 'Acc': 0.616}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.26095721949087947, 'Validation Metric': {'Precision': 0.4173344356893381, 'Recall': 0.4506460400065051, 'F1': 0.37157736352704906, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.4173344356893381, 'Recall': 0.4506460400065051, 'F1': 0.37157736352704906, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.24367530957648628, 'Validation Metric': {'Precision': 0.41461075396559266, 'Recall': 0.46008497316636854, 'F1': 0.38620290564024584, 'Acc': 0.632}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.41461075396559266, 'Recall': 0.46008497316636854, 'F1': 0.38620290564024584, 'Acc': 0.632}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22791325732281334, 'Validation Metric': {'Precision': 0.39014826355213467, 'Recall': 0.46437693120832657, 'F1': 0.3891705816871379, 'Acc': 0.614}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.39014826355213467, 'Recall': 0.46437693120832657, 'F1': 0.3891705816871379, 'Acc': 0.614}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.2176175666482825, 'Validation Metric': {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.20457102868117785, 'Validation Metric': {'Precision': 0.3928134826696817, 'Recall': 0.39221275817206047, 'F1': 0.3726120140073629, 'Acc': 0.604}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19686140551378853, 'Validation Metric': {'Precision': 0.3960016835016835, 'Recall': 0.3674542608554236, 'F1': 0.36499223405881576, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18823500526578804, 'Validation Metric': {'Precision': 0.39642685356971075, 'Recall': 0.3674542608554236, 'F1': 0.3650001971102571, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.18582023288074292, 'Validation Metric': {'Precision': 0.37966485546000367, 'Recall': 0.3612042608554236, 'F1': 0.3531417783130112, 'Acc': 0.602}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.18799246612348056, 'Validation Metric': {'Precision': 0.3784749455337691, 'Recall': 0.3612042608554236, 'F1': 0.35301195196379503, 'Acc': 0.602}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18700909575349406, 'Validation Metric': {'Precision': 0.3815161620203637, 'Recall': 0.3612042608554236, 'F1': 0.35476958378618173, 'Acc': 0.606}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.18767495963134265, 'Validation Metric': {'Precision': 0.3871334089191232, 'Recall': 0.3612042608554236, 'F1': 0.357491595162828, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1861337293919764, 'Validation Metric': {'Precision': 0.38881780608224376, 'Recall': 0.3612042608554236, 'F1': 0.35841955609078896, 'Acc': 0.614}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18501206879553042, 'Validation Metric': {'Precision': 0.3871309541844309, 'Recall': 0.3596300211416491, 'F1': 0.35664455929303446, 'Acc': 0.614}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18406672775745392, 'Validation Metric': {'Precision': 0.3850901378579003, 'Recall': 0.3596300211416491, 'F1': 0.3557288083772835, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.18381589337399132, 'Validation Metric': {'Precision': 0.3839651416122004, 'Recall': 0.35655309806472596, 'F1': 0.35397906995218964, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.18219876407008423, 'Validation Metric': {'Precision': 0.3840391334730957, 'Recall': 0.36018946170108956, 'F1': 0.35593574360697644, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.40483573274270945, 'Recall': 0.4417051553098065, 'F1': 0.3926068563429248, 'Acc': 0.62}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.6530612244897959, 0.4, 0, 0.7096774193548387, 0.3026315789473684], 'Recall': [0.64, 0.07142857142857142, 0, 0.9166666666666666, 0.6571428571428571], 'F1': [0.6464646464646464, 0.12121212121212122, 0, 0.7999999999999999, 0.4144144144144144], 'Acc': [0.6534653465346535, 0.7128712871287128, 0.9504950495049505, 0.6732673267326733, 0.3564356435643564]}
