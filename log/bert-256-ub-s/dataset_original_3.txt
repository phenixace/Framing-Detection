Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=3, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.42666871061450556, 'Validation Metric': {'Precision': 0.40863005720394757, 'Recall': 0.4006507936507937, 'F1': 0.33220338469922195, 'Acc': 0.6217821782178218}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.40863005720394757, 'Recall': 0.4006507936507937, 'F1': 0.33220338469922195, 'Acc': 0.6217821782178218}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3527244933341679, 'Validation Metric': {'Precision': 0.3848108066620616, 'Recall': 0.4129206349206349, 'F1': 0.321619718732736, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.40863005720394757, 'Recall': 0.4006507936507937, 'F1': 0.33220338469922195, 'Acc': 0.6217821782178218}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.3259248223743941, 'Validation Metric': {'Precision': 0.382041013090073, 'Recall': 0.4116984126984127, 'F1': 0.3160447629262083, 'Acc': 0.6415841584158416}}
Best validation metric so far: {'Precision': 0.40863005720394757, 'Recall': 0.4006507936507937, 'F1': 0.33220338469922195, 'Acc': 0.6217821782178218}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.3045538401133136, 'Validation Metric': {'Precision': 0.41436187574801436, 'Recall': 0.41447619047619044, 'F1': 0.31694737740732554, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.40863005720394757, 'Recall': 0.4006507936507937, 'F1': 0.33220338469922195, 'Acc': 0.6217821782178218}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.28901356693945435, 'Validation Metric': {'Precision': 0.4152631578947369, 'Recall': 0.42680952380952386, 'F1': 0.32605649811488135, 'Acc': 0.6495049504950495}}
Best validation metric so far: {'Precision': 0.40863005720394757, 'Recall': 0.4006507936507937, 'F1': 0.33220338469922195, 'Acc': 0.6217821782178218}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.26935767813732747, 'Validation Metric': {'Precision': 0.42114551083591334, 'Recall': 0.43480952380952387, 'F1': 0.3360378413984635, 'Acc': 0.6514851485148515}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.42114551083591334, 'Recall': 0.43480952380952387, 'F1': 0.3360378413984635, 'Acc': 0.6514851485148515}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.2557532991233625, 'Validation Metric': {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.24229091131373456, 'Validation Metric': {'Precision': 0.4228409090909091, 'Recall': 0.453952380952381, 'F1': 0.3596560846560847, 'Acc': 0.6514851485148515}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.22726512935600782, 'Validation Metric': {'Precision': 0.40975, 'Recall': 0.453952380952381, 'F1': 0.356989417989418, 'Acc': 0.6455445544554456}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.2178270189385665, 'Validation Metric': {'Precision': 0.3820920411006618, 'Recall': 0.4522380952380953, 'F1': 0.3558434606516979, 'Acc': 0.6376237623762376}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.20807507045959173, 'Validation Metric': {'Precision': 0.3820920411006618, 'Recall': 0.4522380952380953, 'F1': 0.3558434606516979, 'Acc': 0.6376237623762376}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2092728430503293, 'Validation Metric': {'Precision': 0.3820920411006618, 'Recall': 0.4522380952380953, 'F1': 0.3558434606516979, 'Acc': 0.6376237623762376}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.2058785914590484, 'Validation Metric': {'Precision': 0.3820920411006618, 'Recall': 0.4522380952380953, 'F1': 0.3558434606516979, 'Acc': 0.6376237623762376}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.20678989040224174, 'Validation Metric': {'Precision': 0.3814999358375039, 'Recall': 0.44946031746031745, 'F1': 0.3544319978629896, 'Acc': 0.6356435643564357}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.204826536147218, 'Validation Metric': {'Precision': 0.34851143009037744, 'Recall': 0.44231746031746033, 'F1': 0.34186678881043886, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.2027579389120403, 'Validation Metric': {'Precision': 0.34851143009037744, 'Recall': 0.44231746031746033, 'F1': 0.34186678881043886, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.20083712315873095, 'Validation Metric': {'Precision': 0.37851143009037747, 'Recall': 0.44946031746031745, 'F1': 0.3536092130528631, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.2023038538663011, 'Validation Metric': {'Precision': 0.3463078364288042, 'Recall': 0.4450952380952381, 'F1': 0.3424757824633446, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2035777333535646, 'Validation Metric': {'Precision': 0.3463078364288042, 'Recall': 0.4450952380952381, 'F1': 0.3424757824633446, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.20151073093477048, 'Validation Metric': {'Precision': 0.37630783642880417, 'Recall': 0.4522380952380953, 'F1': 0.35421820670576887, 'Acc': 0.6336633663366337}}
Best validation metric so far: {'Precision': 0.46708333333333335, 'Recall': 0.453952380952381, 'F1': 0.36236729817374974, 'Acc': 0.6574257425742575}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.6923076923076923, 0.16666666666666666, 0, 0.6161616161616161, 0.45], 'Recall': [0.33962264150943394, 0.03125, 0, 0.9838709677419355, 0.9782608695652174], 'F1': [0.4556962025316456, 0.05263157894736842, 0, 0.7577639751552795, 0.6164383561643836], 'Acc': [0.5742574257425742, 0.6435643564356436, 0.9504950495049505, 0.6138613861386139, 0.44554455445544555]}
