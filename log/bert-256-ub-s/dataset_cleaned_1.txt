Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.3859606816580421, 'Validation Metric': {'Precision': 0.24497076023391812, 'Recall': 0.40305232558139537, 'F1': 0.2750631618556147, 'Acc': 0.622}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.24497076023391812, 'Recall': 0.40305232558139537, 'F1': 0.2750631618556147, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3266900487636265, 'Validation Metric': {'Precision': 0.22555555555555556, 'Recall': 0.4046511627906977, 'F1': 0.2713960113960114, 'Acc': 0.626}}
Best validation metric so far: {'Precision': 0.24497076023391812, 'Recall': 0.40305232558139537, 'F1': 0.2750631618556147, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.29921624966357885, 'Validation Metric': {'Precision': 0.24333333333333335, 'Recall': 0.40930232558139534, 'F1': 0.27879804332634517, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.24333333333333335, 'Recall': 0.40930232558139534, 'F1': 0.27879804332634517, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.2722240909934044, 'Validation Metric': {'Precision': 0.23731431966726085, 'Recall': 0.40198920265780724, 'F1': 0.27945432075292326, 'Acc': 0.614}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.23731431966726085, 'Recall': 0.40198920265780724, 'F1': 0.27945432075292326, 'Acc': 0.614}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.25174498283549357, 'Validation Metric': {'Precision': 0.26879621413782906, 'Recall': 0.42883305647840525, 'F1': 0.31301699982305603, 'Acc': 0.616}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.26879621413782906, 'Recall': 0.42883305647840525, 'F1': 0.31301699982305603, 'Acc': 0.616}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.23445810887374377, 'Validation Metric': {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.21863652569682976, 'Validation Metric': {'Precision': 0.2822821681864235, 'Recall': 0.4409779900332226, 'F1': 0.33397959677029443, 'Acc': 0.602}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.20819408524977534, 'Validation Metric': {'Precision': 0.2824175824175824, 'Recall': 0.44243147840531566, 'F1': 0.3358697640387781, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.1982540637254715, 'Validation Metric': {'Precision': 0.27542393121566755, 'Recall': 0.4045577242524917, 'F1': 0.3220433075696234, 'Acc': 0.6}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.1881060906146702, 'Validation Metric': {'Precision': 0.28131980640357407, 'Recall': 0.41532184385382054, 'F1': 0.33276713305748784, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18159808179265574, 'Validation Metric': {'Precision': 0.2790657080429183, 'Recall': 0.4060195182724252, 'F1': 0.32809423586122616, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.17954889606488378, 'Validation Metric': {'Precision': 0.2784645734012822, 'Recall': 0.3910029069767442, 'F1': 0.3227953564587228, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.17871644543974022, 'Validation Metric': {'Precision': 0.2773656723023811, 'Recall': 0.38635174418604656, 'F1': 0.32053489367775084, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.17593391553351753, 'Validation Metric': {'Precision': 0.27525028768699655, 'Recall': 0.3806374584717608, 'F1': 0.31734297448583165, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.17760362554537623, 'Validation Metric': {'Precision': 0.2783240581787998, 'Recall': 0.3806374584717608, 'F1': 0.3198682270110842, 'Acc': 0.616}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.17483445884365784, 'Validation Metric': {'Precision': 0.27879945864182787, 'Recall': 0.3702720099667774, 'F1': 0.3169327049761833, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.17502079119807795, 'Validation Metric': {'Precision': 0.2745684695051784, 'Recall': 0.35525539867109635, 'F1': 0.3086788480336867, 'Acc': 0.618}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.17918357292288228, 'Validation Metric': {'Precision': 0.27578059071729955, 'Recall': 0.35525539867109635, 'F1': 0.30957772443818116, 'Acc': 0.62}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17731336151298724, 'Validation Metric': {'Precision': 0.2783446932814021, 'Recall': 0.35525539867109635, 'F1': 0.31143746872334194, 'Acc': 0.622}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.17304030531331113, 'Validation Metric': {'Precision': 0.2802051282051282, 'Recall': 0.3521303986710963, 'F1': 0.31157245815182044, 'Acc': 0.624}}
Best validation metric so far: {'Precision': 0.2886167800453515, 'Recall': 0.4629173588039867, 'F1': 0.3423955610952515, 'Acc': 0.624}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.5581395348837209, 0.4, 0, 0.6595744680851063, 0.43157894736842106], 'Recall': [0.43636363636363634, 0.0625, 0, 0.9538461538461539, 0.9534883720930233], 'F1': [0.48979591836734687, 0.10810810810810811, 0, 0.7798742138364779, 0.5942028985507247], 'Acc': [0.5, 0.67, 0.91, 0.65, 0.44]}
