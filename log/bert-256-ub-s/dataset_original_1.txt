Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_original/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=1, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.4250897224012174, 'Validation Metric': {'Precision': 0.262, 'Recall': 0.37311046511627904, 'F1': 0.2820180145026502, 'Acc': 0.582}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.262, 'Recall': 0.37311046511627904, 'F1': 0.2820180145026502, 'Acc': 0.582}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.35439534406912954, 'Validation Metric': {'Precision': 0.29727272727272724, 'Recall': 0.4075581395348838, 'F1': 0.3001949317738791, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.29727272727272724, 'Recall': 0.4075581395348838, 'F1': 0.3001949317738791, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.3250414705590198, 'Validation Metric': {'Precision': 0.3158426966292135, 'Recall': 0.41686046511627906, 'F1': 0.31217789797911505, 'Acc': 0.622}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3158426966292135, 'Recall': 0.41686046511627906, 'F1': 0.31217789797911505, 'Acc': 0.622}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.3040835339772074, 'Validation Metric': {'Precision': 0.3056695869837297, 'Recall': 0.43248546511627906, 'F1': 0.3181340834505392, 'Acc': 0.628}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3056695869837297, 'Recall': 0.43248546511627906, 'F1': 0.3181340834505392, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.28723593997327906, 'Validation Metric': {'Precision': 0.29989690721649487, 'Recall': 0.4340843023255814, 'F1': 0.31446273096973176, 'Acc': 0.632}}
Best validation metric so far: {'Precision': 0.3056695869837297, 'Recall': 0.43248546511627906, 'F1': 0.3181340834505392, 'Acc': 0.628}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.26720175421551656, 'Validation Metric': {'Precision': 0.29989690721649487, 'Recall': 0.4480377906976744, 'F1': 0.32791775052644623, 'Acc': 0.632}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.29989690721649487, 'Recall': 0.4480377906976744, 'F1': 0.32791775052644623, 'Acc': 0.632}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.25476856059149694, 'Validation Metric': {'Precision': 0.29929292929292933, 'Recall': 0.4558139534883721, 'F1': 0.33240070947240624, 'Acc': 0.63}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.29929292929292933, 'Recall': 0.4558139534883721, 'F1': 0.33240070947240624, 'Acc': 0.63}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.23837314781389737, 'Validation Metric': {'Precision': 0.3023843880986738, 'Recall': 0.45940199335548176, 'F1': 0.33931085382167075, 'Acc': 0.632}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.3023843880986738, 'Recall': 0.45940199335548176, 'F1': 0.33931085382167075, 'Acc': 0.632}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.22681914073856255, 'Validation Metric': {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.21599803747315155, 'Validation Metric': {'Precision': 0.28176232485729114, 'Recall': 0.46086378737541533, 'F1': 0.33793587769764744, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.20716152810736707, 'Validation Metric': {'Precision': 0.28176232485729114, 'Recall': 0.46086378737541533, 'F1': 0.33793587769764744, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.2050703728669568, 'Validation Metric': {'Precision': 0.28176232485729114, 'Recall': 0.46086378737541533, 'F1': 0.33793587769764744, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.20680127920288788, 'Validation Metric': {'Precision': 0.28176232485729114, 'Recall': 0.46086378737541533, 'F1': 0.33793587769764744, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.20369782141949, 'Validation Metric': {'Precision': 0.28176232485729114, 'Recall': 0.46086378737541533, 'F1': 0.33793587769764744, 'Acc': 0.61}}
Best validation metric so far: {'Precision': 0.2904856815578465, 'Recall': 0.467641196013289, 'F1': 0.34217351034269833, 'Acc': 0.618}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.20254353433847427, 'Validation Metric': {'Precision': 0.287349593495935, 'Recall': 0.46551495016611294, 'F1': 0.3434487514518002, 'Acc': 0.614}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.287349593495935, 'Recall': 0.46551495016611294, 'F1': 0.3434487514518002, 'Acc': 0.614}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.20114710770155253, 'Validation Metric': {'Precision': 0.28590031813361616, 'Recall': 0.4598006644518272, 'F1': 0.34106194042817817, 'Acc': 0.612}}
Best validation metric so far: {'Precision': 0.287349593495935, 'Recall': 0.46551495016611294, 'F1': 0.3434487514518002, 'Acc': 0.614}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.20124803640340505, 'Validation Metric': {'Precision': 0.288455486542443, 'Recall': 0.46445182724252493, 'F1': 0.3447033970108112, 'Acc': 0.614}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.288455486542443, 'Recall': 0.46445182724252493, 'F1': 0.3447033970108112, 'Acc': 0.614}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.19892985452162593, 'Validation Metric': {'Precision': 0.29089180990899904, 'Recall': 0.4691029900332226, 'F1': 0.3482601685566388, 'Acc': 0.616}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.29089180990899904, 'Recall': 0.4691029900332226, 'F1': 0.3482601685566388, 'Acc': 0.616}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.2017844491883328, 'Validation Metric': {'Precision': 0.29089180990899904, 'Recall': 0.4691029900332226, 'F1': 0.3482601685566388, 'Acc': 0.616}}
Best validation metric so far: {'Precision': 0.29089180990899904, 'Recall': 0.4691029900332226, 'F1': 0.3482601685566388, 'Acc': 0.616}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.19822861881632553, 'Validation Metric': {'Precision': 0.2932173913043479, 'Recall': 0.4737541528239203, 'F1': 0.35173517523934406, 'Acc': 0.618}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.2932173913043479, 'Recall': 0.4737541528239203, 'F1': 0.35173517523934406, 'Acc': 0.618}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.5, 0.5, 0, 0.6631578947368421, 0.4148936170212766], 'Recall': [0.34545454545454546, 0.0625, 0, 0.9692307692307692, 0.9069767441860465], 'F1': [0.40860215053763443, 0.1111111111111111, 0, 0.7875, 0.5693430656934306], 'Acc': [0.45, 0.68, 0.91, 0.66, 0.41]}
