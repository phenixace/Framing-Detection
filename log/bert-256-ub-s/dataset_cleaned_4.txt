Namespace(batch_size=8, checkpoint_dir='./ckp/', dataset='./dataset_cleaned/', dataset_balancing=False, device='cuda:0', epochs=20, fine_tuning=True, fold=4, lm='bert', log_dir='./log/bert/', lr=2e-06, max_len=256, model='FD_BASE', random_seed=42, specified_label='None')
=====Epoch 1
Training...
Evaluating...
{'Train Loss': 0.389736922947984, 'Validation Metric': {'Precision': 0.5063134678852501, 'Recall': 0.4192140900791236, 'F1': 0.3230220051196543, 'Acc': 0.6336633663366337}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5063134678852501, 'Recall': 0.4192140900791236, 'F1': 0.3230220051196543, 'Acc': 0.6336633663366337}, Latest Lr: 2e-06
=====Epoch 2
Training...
Evaluating...
{'Train Loss': 0.3334627998502631, 'Validation Metric': {'Precision': 0.5468714218360611, 'Recall': 0.42243989653073644, 'F1': 0.32600095756777786, 'Acc': 0.6415841584158416}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5468714218360611, 'Recall': 0.42243989653073644, 'F1': 0.32600095756777786, 'Acc': 0.6415841584158416}, Latest Lr: 2e-06
=====Epoch 3
Training...
Evaluating...
{'Train Loss': 0.30794306413123484, 'Validation Metric': {'Precision': 0.5468714218360611, 'Recall': 0.4299870663420572, 'F1': 0.3365220493791922, 'Acc': 0.6435643564356436}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5468714218360611, 'Recall': 0.4299870663420572, 'F1': 0.3365220493791922, 'Acc': 0.6435643564356436}, Latest Lr: 2e-06
=====Epoch 4
Training...
Evaluating...
{'Train Loss': 0.2822752410643979, 'Validation Metric': {'Precision': 0.5383113311331134, 'Recall': 0.4413078210590383, 'F1': 0.3511618453115537, 'Acc': 0.6475247524752475}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5383113311331134, 'Recall': 0.4413078210590383, 'F1': 0.3511618453115537, 'Acc': 0.6475247524752475}, Latest Lr: 2e-06
=====Epoch 5
Training...
Evaluating...
{'Train Loss': 0.2600668080543217, 'Validation Metric': {'Precision': 0.5533747614392776, 'Recall': 0.4712948874010955, 'F1': 0.39393054333750965, 'Acc': 0.6633663366336634}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5533747614392776, 'Recall': 0.4712948874010955, 'F1': 0.39393054333750965, 'Acc': 0.6633663366336634}, Latest Lr: 2e-06
=====Epoch 6
Training...
Evaluating...
{'Train Loss': 0.2412765284902171, 'Validation Metric': {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}}
Saving checkpoint...
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-06
=====Epoch 7
Training...
Evaluating...
{'Train Loss': 0.22768793059022804, 'Validation Metric': {'Precision': 0.47524497532365356, 'Recall': 0.46234469686945934, 'F1': 0.3960689831113832, 'Acc': 0.6435643564356436}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-06
=====Epoch 8
Training...
Evaluating...
{'Train Loss': 0.21412066487889542, 'Validation Metric': {'Precision': 0.43307757885763004, 'Recall': 0.4031449297414592, 'F1': 0.37275777996274895, 'Acc': 0.6316831683168317}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-06
=====Epoch 9
Training...
Evaluating...
{'Train Loss': 0.2034660017019824, 'Validation Metric': {'Precision': 0.44346405228758173, 'Recall': 0.39822286247320654, 'F1': 0.377856639851249, 'Acc': 0.6455445544554456}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-06
=====Epoch 10
Training...
Evaluating...
{'Train Loss': 0.19276545784975352, 'Validation Metric': {'Precision': 0.4430746545331985, 'Recall': 0.3797095384900368, 'F1': 0.3703377505788182, 'Acc': 0.6495049504950495}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 11
Training...
Evaluating...
{'Train Loss': 0.18324543104359978, 'Validation Metric': {'Precision': 0.44297212601022595, 'Recall': 0.37536171240308025, 'F1': 0.36798336798336795, 'Acc': 0.6495049504950495}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 12
Training...
Evaluating...
{'Train Loss': 0.18347308667082535, 'Validation Metric': {'Precision': 0.45195146612740145, 'Recall': 0.37536171240308025, 'F1': 0.37214032214032217, 'Acc': 0.6574257425742575}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 13
Training...
Evaluating...
{'Train Loss': 0.18543859649645655, 'Validation Metric': {'Precision': 0.45195146612740145, 'Recall': 0.37536171240308025, 'F1': 0.37214032214032217, 'Acc': 0.6574257425742575}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 14
Training...
Evaluating...
{'Train Loss': 0.18225260235761342, 'Validation Metric': {'Precision': 0.44963879267689266, 'Recall': 0.37536171240308025, 'F1': 0.3711302211302211, 'Acc': 0.6554455445544555}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 15
Training...
Evaluating...
{'Train Loss': 0.1819121088636549, 'Validation Metric': {'Precision': 0.45439049051764524, 'Recall': 0.37536171240308025, 'F1': 0.3732375008237077, 'Acc': 0.6594059405940594}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 16
Training...
Evaluating...
{'Train Loss': 0.1813598083038079, 'Validation Metric': {'Precision': 0.4520778170671365, 'Recall': 0.37536171240308025, 'F1': 0.37222739981360664, 'Acc': 0.6574257425742575}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 17
Training...
Evaluating...
{'Train Loss': 0.18141362306318784, 'Validation Metric': {'Precision': 0.45463879267689267, 'Recall': 0.37536171240308025, 'F1': 0.37335009428032684, 'Acc': 0.6594059405940594}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 18
Training...
Evaluating...
{'Train Loss': 0.18066093972639033, 'Validation Metric': {'Precision': 0.4522028952409952, 'Recall': 0.37101388631612375, 'F1': 0.36979332273449916, 'Acc': 0.6574257425742575}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 19
Training...
Evaluating...
{'Train Loss': 0.17868040776566455, 'Validation Metric': {'Precision': 0.45195146612740145, 'Recall': 0.36666606022916726, 'F1': 0.36716196716196714, 'Acc': 0.6574257425742575}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-07
=====Epoch 20
Training...
Evaluating...
{'Train Loss': 0.1783153748041705, 'Validation Metric': {'Precision': 0.4483458906476809, 'Recall': 0.3590924276905978, 'F1': 0.3616861200337965, 'Acc': 0.6534653465346535}}
Best validation metric so far: {'Precision': 0.5516553287981859, 'Recall': 0.4824140292148509, 'F1': 0.4117574945114725, 'Acc': 0.6673267326732674}, Latest Lr: 2e-08
Testing...
Test metric: {'Precision': [0.4857142857142857, 0, 0, 0.711340206185567, 0.4574468085106383], 'Recall': [0.3148148148148148, 0, 0, 0.971830985915493, 1.0], 'F1': [0.38202247191011235, 0, 0, 0.8214285714285714, 0.6277372262773723], 'Acc': [0.45, 0.65, 0.86, 0.7, 0.49]}
